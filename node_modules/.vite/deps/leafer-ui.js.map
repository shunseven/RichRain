{
  "version": 3,
  "sources": ["../../../../../src/leafer/packages/display-module/data/src/data.ts", "../../../../../src/leafer/packages/display-module/data/src/DataHelper.ts", "../../../../../src/leafer/packages/display-module/data/src/LeafData.ts", "../../../../../src/leafer/packages/math/src/IncrementId.ts", "../../../../../src/leafer/packages/math/src/FourNumberHelper.ts", "../../../../../src/leafer/packages/math/src/MathHelper.ts", "../../../../../src/leafer/packages/math/src/MatrixHelper.ts", "../../../../../src/leafer/packages/math/src/PointHelper.ts", "../../../../../src/leafer/packages/math/src/Point.ts", "../../../../../src/leafer/packages/math/src/Matrix.ts", "../../../../../src/leafer/packages/math/src/TwoPointBoundsHelper.ts", "../../../../../src/leafer/packages/math/src/Direction.ts", "../../../../../src/leafer/packages/math/src/AroundHelper.ts", "../../../../../src/leafer/packages/math/src/AlignHelper.ts", "../../../../../src/leafer/packages/math/src/BoundsHelper.ts", "../../../../../src/leafer/packages/math/src/Bounds.ts", "../../../../../src/leafer/packages/math/src/AutoBounds.ts", "../../../../../src/leafer/packages/math/src/UnitHelper.ts", "../../../../../src/leafer/packages/math/src/StringNumber.ts", "../../../../../src/leafer/packages/platform/platform/src/Platform.ts", "../../../../../src/leafer/packages/debug/src/Debug.ts", "../../../../../src/leafer/packages/debug/src/Run.ts", "../../../../../src/leafer/packages/debug/src/Plugin.ts", "../../../../../src/leafer/packages/platform/platform/src/creator/Creator.ts", "../../../../../src/leafer/packages/platform/platform/src/creator/UICreator.ts", "../../../../../src/leafer/packages/platform/platform/src/creator/EventCreator.ts", "../../../../../src/leafer/packages/canvas/canvas/src/CanvasManager.ts", "../../../../node_modules/.pnpm/@rollup+plugin-typescript@11.1.6_rollup@4.44.2_tslib@2.8.1_typescript@5.8.3/node_modules/tslib/tslib.es6.js", "../../../../../src/leafer/packages/canvas/canvas/src/Canvas.ts", "../../../../../src/leafer/packages/canvas/canvas/src/LeaferCanvasBase.ts", "../../../../../src/leafer/packages/path/src/PathHelper.ts", "../../../../../src/leafer/packages/path/src/PathCommandMap.ts", "../../../../../src/leafer/packages/path/src/RectHelper.ts", "../../../../../src/leafer/packages/path/src/BezierHelper.ts", "../../../../../src/leafer/packages/path/src/EllipseHelper.ts", "../../../../../src/leafer/packages/path/src/PathCommandNodeHelper.ts", "../../../../../src/leafer/packages/path/src/PathConvert.ts", "../../../../../src/leafer/packages/path/src/PathCommandDataHelper.ts", "../../../../../src/leafer/packages/path/src/PathCreator.ts", "../../../../../src/leafer/packages/path/src/PathDrawer.ts", "../../../../../src/leafer/packages/path/src/PathBounds.ts", "../../../../../src/leafer/packages/path/src/PathCorner.ts", "../../../../../src/leafer/packages/path/src/index.ts", "../../../../../src/leafer/packages/canvas/canvas/src/patch/roundRect.ts", "../../../../../src/leafer/packages/canvas/canvas/src/patch/index.ts", "../../../../../src/leafer/packages/file/src/FileHelper.ts", "../../../../../src/leafer/packages/task/src/TaskItem.ts", "../../../../../src/leafer/packages/task/src/TaskProcessor.ts", "../../../../../src/leafer/packages/file/src/Resource.ts", "../../../../../src/leafer/packages/image/image/src/ImageManager.ts", "../../../../../src/leafer/packages/image/image/src/LeaferImage.ts", "../../../../../src/leafer/packages/decorator/src/object.ts", "../../../../../src/leafer/packages/decorator/src/data.ts", "../../../../../src/leafer/packages/decorator/src/rewrite.ts", "../../../../../src/leafer/packages/decorator/src/class.ts", "../../../../../src/leafer/packages/display-module/helper/src/LeafHelper.ts", "../../../../../src/leafer/packages/display-module/helper/src/LeafBoundsHelper.ts", "../../../../../src/leafer/packages/display-module/helper/src/BranchHelper.ts", "../../../../../src/leafer/packages/display-module/helper/src/WaitHelper.ts", "../../../../../src/leafer/packages/display-module/layout/src/LeafLayout.ts", "../../../../../src/leafer/packages/event/src/Event.ts", "../../../../../src/leafer/packages/event/src/ChildEvent.ts", "../../../../../src/leafer/packages/event/src/PropertyEvent.ts", "../../../../../src/leafer/packages/event/src/ImageEvent.ts", "../../../../../src/leafer/packages/event/src/BoundsEvent.ts", "../../../../../src/leafer/packages/event/src/ResizeEvent.ts", "../../../../../src/leafer/packages/event/src/WatchEvent.ts", "../../../../../src/leafer/packages/event/src/LayoutEvent.ts", "../../../../../src/leafer/packages/event/src/RenderEvent.ts", "../../../../../src/leafer/packages/event/src/LeaferEvent.ts", "../../../../../src/leafer/packages/event/src/Eventer.ts", "../../../../../src/leafer/packages/display-module/display-module/src/LeafEventer.ts", "../../../../../src/leafer/packages/display-module/display-module/src/LeafDataProxy.ts", "../../../../../src/leafer/packages/display-module/display-module/src/LeafMatrix.ts", "../../../../../src/leafer/packages/display-module/display-module/src/LeafBounds.ts", "../../../../../src/leafer/packages/display-module/display-module/src/LeafRender.ts", "../../../../../src/leafer/packages/display-module/display-module/src/BranchRender.ts", "../../../../../src/leafer/packages/display/src/Leaf.ts", "../../../../../src/leafer/packages/display/src/Branch.ts", "../../../../../src/leafer/packages/list/src/LeafList.ts", "../../../../../src/leafer/packages/list/src/LeafLevelList.ts", "../../../../../src/leafer/packages/core/src/index.ts", "../../../../../node_modules/.pnpm/@rollup+plugin-typescript@11.1.6_rollup@4.44.2_tslib@2.8.1_typescript@5.8.3/node_modules/tslib/tslib.es6.js", "../../../../../../src/ui/packages/decorator/src/data.ts", "../../../../../../src/ui/packages/external/src/index.ts", "../../../../../../src/ui/packages/external/src/color.ts", "../../../../../../src/ui/packages/display-module/data/src/UIData.ts", "../../../../../../src/ui/packages/display-module/data/src/GroupData.ts", "../../../../../../src/ui/packages/display-module/data/src/BoxData.ts", "../../../../../../src/ui/packages/display-module/data/src/LeaferData.ts", "../../../../../../src/ui/packages/display-module/data/src/FrameData.ts", "../../../../../../src/ui/packages/display-module/data/src/LineData.ts", "../../../../../../src/ui/packages/display-module/data/src/RectData.ts", "../../../../../../src/ui/packages/display-module/data/src/EllipseData.ts", "../../../../../../src/ui/packages/display-module/data/src/PolygonData.ts", "../../../../../../src/ui/packages/display-module/data/src/StarData.ts", "../../../../../../src/ui/packages/display-module/data/src/PathData.ts", "../../../../../../src/ui/packages/display-module/data/src/PenData.ts", "../../../../../../src/ui/packages/display-module/data/src/TextData.ts", "../../../../../../src/ui/packages/display-module/data/src/ImageData.ts", "../../../../../../src/ui/packages/display-module/data/src/CanvasData.ts", "../../../../../../src/ui/packages/display-module/bounds/src/UIBounds.ts", "../../../../../../src/ui/packages/display-module/render/src/UIRender.ts", "../../../../../../src/ui/packages/display-module/render/src/RectRender.ts", "../../../../../../src/ui/packages/display/src/UI.ts", "../../../../../../src/ui/packages/display/src/Group.ts", "../../../../../../src/ui/packages/display/src/Leafer.ts", "../../../../../../src/ui/packages/display/src/Rect.ts", "../../../../../../src/ui/packages/display/src/Box.ts", "../../../../../../src/ui/packages/display/src/Frame.ts", "../../../../../../src/ui/packages/display/src/Ellipse.ts", "../../../../../../src/ui/packages/display/src/Polygon.ts", "../../../../../../src/ui/packages/display/src/Star.ts", "../../../../../../src/ui/packages/display/src/Line.ts", "../../../../../../src/ui/packages/display/src/Image.ts", "../../../../../../src/ui/packages/display/src/Canvas.ts", "../../../../../../src/ui/packages/display/src/Text.ts", "../../../../../../src/ui/packages/display/src/Path.ts", "../../../../../../src/ui/packages/display/src/Pen.ts", "../../../../../node_modules/.pnpm/@rollup+plugin-typescript@11.1.6_rollup@4.44.2_tslib@2.8.1_typescript@5.8.3/node_modules/tslib/tslib.es6.js", "../../../../../../src/ui/packages/app/src/App.ts", "../../../../../../src/ui/packages/event/src/Keyboard.ts", "../../../../../../src/ui/packages/event/src/PointerButton.ts", "../../../../../../src/ui/packages/event/src/UIEvent.ts", "../../../../../../src/ui/packages/event/src/DragBoundsHelper.ts", "../../../../../../src/ui/packages/event/src/PointerEvent.ts", "../../../../../../src/ui/packages/event/src/DragEvent.ts", "../../../../../../src/ui/packages/event/src/DropEvent.ts", "../../../../../../src/ui/packages/event/src/MoveEvent.ts", "../../../../../../src/ui/packages/event/src/TouchEvent.ts", "../../../../../../src/ui/packages/event/src/RotateEvent.ts", "../../../../../../src/ui/packages/event/src/SwipeEvent.ts", "../../../../../../src/ui/packages/event/src/ZoomEvent.ts", "../../../../../../src/ui/packages/event/src/KeyEvent.ts", "../../../../../../src/ui/packages/interaction/interaction/src/InteractionHelper.ts", "../../../../../../src/ui/packages/interaction/interaction/src/Dragger.ts", "../../../../../../src/ui/packages/interaction/interaction/src/emit.ts", "../../../../../../src/ui/packages/interaction/interaction/src/config.ts", "../../../../../../src/ui/packages/interaction/interaction/src/Interaction.ts", "../../../../../../src/ui/packages/interaction/interaction/src/Cursor.ts", "../../../../../../src/ui/packages/hit/src/HitCanvasManager.ts", "../../../../../../src/ui/packages/hit/src/selector.ts", "../../../../../../src/ui/packages/hit/src/LeafHit.ts", "../../../../../../src/ui/packages/hit/src/UIHit.ts", "../../../../../../src/ui/packages/hit/src/RectHit.ts", "../../../../../../src/ui/packages/hit/src/TextHit.ts", "../../../../../../src/ui/packages/hit/src/pick.ts", "../../../../../../src/ui/packages/hit/src/canvas.ts", "../../../../src/leafer/packages/interface/src/path/IPathCommand.ts", "../../../../src/leafer/packages/canvas/canvas-web/src/LeaferCanvas.ts", "../../../../src/leafer/packages/canvas/canvas-web/src/index.ts", "../../../../src/ui/packages/platform/web/src/core.ts", "../../../../src/leafer/packages/partner/watcher/src/Watcher.ts", "../../../../src/leafer/packages/partner/layouter/src/LayouterHelper.ts", "../../../../src/leafer/packages/partner/layouter/src/LayoutBlockData.ts", "../../../../src/leafer/packages/partner/layouter/src/Layouter.ts", "../../../../src/leafer/packages/partner/renderer/src/Renderer.ts", "../../../../src/leafer/packages/partner/selector/src/Picker.ts", "../../../../src/leafer/packages/partner/selector/src/Selector.ts", "../../../../src/leafer/packages/partner/partner/src/index.ts", "../../../../src/ui/packages/interaction/interaction-web/src/PointerEventHelper.ts", "../../../../src/ui/packages/interaction/interaction-web/src/KeyEventHelper.ts", "../../../../src/ui/packages/interaction/interaction-web/src/Interaction.ts", "../../../../src/ui/packages/partner/paint/src/Fill.ts", "../../../../src/ui/packages/partner/paint/src/Stroke.ts", "../../../../src/ui/packages/partner/paint/src/StrokeText.ts", "../../../../src/ui/packages/partner/paint/src/Shape.ts", "../../../../src/ui/packages/partner/paint/src/Compute.ts", "../../../../src/ui/packages/partner/paint/src/index.ts", "../../../../src/ui/packages/partner/paint/src/FillText.ts", "../../../../src/ui/packages/partner/image/src/image.ts", "../../../../src/ui/packages/partner/image/src/data.ts", "../../../../src/ui/packages/partner/image/src/mode.ts", "../../.pnpm/@rollup+plugin-typescript@11.1.6_rollup@4.44.2_tslib@2.8.1_typescript@5.8.3/node_modules/tslib/tslib.es6.js", "../../../../src/ui/packages/partner/image/src/pattern.ts", "../../../../src/ui/packages/partner/image/src/index.ts", "../../../../src/ui/packages/partner/image/src/check.ts", "../../../../src/ui/packages/partner/image/src/recycle.ts", "../../../../src/ui/packages/partner/gradient/src/linear.ts", "../../../../src/ui/packages/partner/gradient/src/radial.ts", "../../../../src/ui/packages/partner/gradient/src/conic.ts", "../../../../src/ui/packages/partner/gradient/src/index.ts", "../../../../src/ui/packages/partner/effect/src/Shadow.ts", "../../../../src/ui/packages/partner/effect/src/InnerShadow.ts", "../../../../src/ui/packages/partner/effect/src/index.ts", "../../../../src/ui/packages/partner/effect/src/Blur.ts", "../../../../src/ui/packages/partner/effect/src/BackgroundBlur.ts", "../../../../src/ui/packages/partner/mask/src/index.ts", "../../../../src/ui/packages/partner/text/src/CharType.ts", "../../../../src/ui/packages/partner/text/src/TextRowHelper.ts", "../../../../src/ui/packages/partner/text/src/TextCase.ts", "../../../../src/ui/packages/partner/text/src/TextRows.ts", "../../../../src/ui/packages/partner/text/src/TextConvert.ts", "../../../../src/ui/packages/partner/text/src/index.ts", "../../../../src/ui/packages/partner/text/src/TextLayout.ts", "../../../../src/ui/packages/partner/text/src/CharLayout.ts", "../../../../src/ui/packages/partner/text/src/TextClip.ts", "../../../../src/ui/packages/partner/text/src/TextDecoration.ts", "../../../../src/ui/packages/partner/color/src/index.ts", "../../../../src/ui/packages/partner/color/src/color.ts", "../../../../src/ui/packages/partner/partner/src/index.ts", "../../../../src/ui/packages/platform/web/src/index.ts"],
  "sourcesContent": ["import { IObject } from '@leafer/interface'\n\nexport enum Answer {\n    No = 0,\n    Yes = 1,\n    NoAndSkip = 2,\n    YesAndSkip = 3\n}\n\nexport const emptyData: IObject = {}\n\nexport function isUndefined(value: any): boolean {\n    return value === undefined\n}\n\nexport function isNull(value: any): boolean {\n    return value == null // = value === undefined || value === null\n}\n\nexport function isString<T extends string>(value: any): value is T {\n    return typeof value === 'string'\n}\n\nexport const { isFinite } = Number\n\nexport function isNumber<T extends number>(value: any): value is T {\n    return typeof value === 'number'\n}\n\nconst numberReg = /^-?\\d+(?:\\.\\d+)?$/\n\nexport function tryToNumber(value: any): number {\n    return (typeof value === 'string' && numberReg.test(value)) ? +value : value\n}\n\nexport const { isArray } = Array\n\nexport function isObject<T extends object>(value: any): value is T {\n    return value && typeof value === 'object' // fix: null is object\n}\n\nexport function isData<T extends object>(value: any): value is T { // 检测 {} 对象\n    return isObject(value) && !isArray(value) // 排除数组\n}\n\nexport function isEmptyData(value: any): boolean {\n    return JSON.stringify(value) === '{}'\n}", "import { IBooleanMap, IObject } from '@leafer/interface'\nimport { isUndefined } from './data'\n\nexport const DataHelper = {\n\n    default<T>(t: T, defaultData: IObject): T {\n        assign(defaultData, t)\n        assign(t, defaultData)\n        return t\n    },\n\n    assign(t: IObject, merge: IObject, exclude?: IObject): void {\n        let value: unknown\n        Object.keys(merge).forEach(key => {\n            value = merge[key]\n            if (value?.constructor === Object && t[key]?.constructor === Object) return assign(t[key], merge[key], exclude && exclude[key])\n            if (exclude && (key in exclude)) {\n                if (exclude[key]?.constructor === Object) assign(t[key] = {}, merge[key], exclude[key])\n                return\n            }\n            t[key] = merge[key]\n        })\n    },\n\n    copyAttrs(t: IObject, from: IObject, include: string[]): IObject {\n        include.forEach(key => {\n            if (!isUndefined(from[key])) t[key] = from[key]\n        })\n        return t\n    },\n\n    clone(data: unknown): IObject {\n        return JSON.parse(JSON.stringify(data))\n    },\n\n    toMap(list: string[]): IBooleanMap {\n        const map = {} as IBooleanMap\n        for (let i = 0, len = list.length; i < len; i++)  map[list[i]] = true\n        return map\n    },\n\n    stintSet<T extends object, K extends keyof T>(data: T, attrName: K, value: T[K]): void {\n        value || (value = undefined)\n        data[attrName] !== value && (data[attrName] = value) // 只有值不一样时才设置，节省内存开销\n    }\n\n}\n\nconst { assign } = DataHelper", "import { ILeafData, ILeaf, IObject, IValue, IPathCommandData, IJSONOptions } from '@leafer/interface'\nimport { isArray, isUndefined } from './data'\n\n\nexport class LeafData implements ILeafData {\n\n    public __leaf: ILeaf\n    public __input: IObject\n    public __middle: IObject\n\n    public __single: boolean\n\n    public __naturalWidth?: number\n    public __naturalHeight?: number\n\n    public __pathForRender?: IPathCommandData\n\n    public __useStroke?: boolean\n    public get __useNaturalRatio() { return true }\n\n    public get __isLinePath(): boolean {\n        const { path } = this as ILeafData\n        return path && path.length === 6 && path[0] === 1 // M = 1\n    }\n\n    public get __usePathBox(): boolean {\n        return (this as ILeafData).__pathInputed as any as boolean\n    }\n\n    public get __blendMode(): string {\n        if ((this as ILeafData).eraser && (this as ILeafData).eraser !== 'path') return 'destination-out'\n        const { blendMode } = (this as ILeafData)\n        return blendMode === 'pass-through' ? null : blendMode\n    }\n\n    constructor(leaf: ILeaf) {\n        this.__leaf = leaf\n    }\n\n    public __get(name: string): any {\n        if (this.__input) {\n            const value = this.__input[name]\n            if (!isUndefined(value)) return value\n        }\n        return (this as IObject)[name]\n    }\n\n    public __getData(): IObject {\n        const data: IObject = { tag: this.__leaf.tag }, { __input } = this\n        let inputValue: IValue\n        for (let key in this) {\n            if (key[0] !== '_') {\n                inputValue = __input ? __input[key] : undefined\n                data[key] = isUndefined(inputValue) ? this[key] : inputValue\n            }\n        }\n        return data\n    }\n\n    public __setInput(name: string, value: any): void {\n        this.__input || (this.__input = {})\n        this.__input[name] = value\n    }\n\n    public __getInput(name: string): any {\n        if (this.__input) {\n            const value = this.__input[name]\n            if (!isUndefined(value)) return value\n        }\n\n        if (name === 'path' && !(this as ILeafData).__pathInputed) return // no path mode\n\n        return (this as IObject)['_' + name]\n    }\n\n    public __removeInput(name: string): void {\n        if (this.__input && !isUndefined(this.__input[name])) this.__input[name] = undefined\n    }\n\n    public __getInputData(names?: string[] | IObject, options?: IJSONOptions): IObject {\n        const data: IObject = {}\n\n        if (names) {\n\n            if (isArray(names)) {\n                for (let name of names) data[name] = this.__getInput(name)\n            } else {\n                for (let name in names) data[name] = this.__getInput(name)\n            }\n\n        } else {\n\n            let value: IValue, inputValue: IValue, { __input } = this\n            data.tag = this.__leaf.tag\n            for (let key in this) {\n                if (key[0] !== '_') {\n                    value = (this as IObject)['_' + key]\n                    if (!isUndefined(value)) {\n\n                        if (key === 'path' && !(this as ILeafData).__pathInputed) continue // no path mode\n\n                        inputValue = __input ? __input[key] : undefined\n                        data[key] = isUndefined(inputValue) ? value : inputValue\n                    }\n                }\n            }\n\n        }\n\n        if (options) {\n            if (options.matrix) {\n                const { a, b, c, d, e, f } = this.__leaf.__localMatrix\n                data.matrix = { a, b, c, d, e, f }\n            }\n        }\n\n        return data\n    }\n\n    public __setMiddle(name: string, value: any): void {\n        this.__middle || (this.__middle = {})\n        this.__middle[name] = value\n    }\n\n    public __getMiddle(name: string): any {\n        return this.__middle && this.__middle[name]\n    }\n\n    public __checkSingle(): void {\n        const t = this as ILeafData\n        if (t.blendMode === 'pass-through') {\n            const leaf = this.__leaf\n            if ((t.opacity < 1 && (leaf.isBranch || t.__hasMultiPaint)) || leaf.__hasEraser || t.eraser || t.filter) {\n                t.__single = true\n            } else if (t.__single) {\n                t.__single = false\n            }\n        } else {\n            t.__single = true\n        }\n    }\n\n    public __removeNaturalSize(): void {\n        this.__naturalWidth = this.__naturalHeight = undefined\n    }\n\n    public destroy(): void {\n        this.__input = this.__middle = null\n    }\n}", "import { INumberMap } from '@leafer/interface'\n\n\nexport const IncrementId = {\n\n    RUNTIME: 'runtime',\n    LEAF: 'leaf',\n    TASK: 'task',\n    CNAVAS: 'canvas',\n    IMAGE: 'image',\n\n    types: {} as INumberMap,\n\n    create(typeName: string): number {\n        const { types } = I\n        if (types[typeName]) {\n            return types[typeName]++\n        } else {\n            types[typeName] = 1\n            return 0\n        }\n    }\n}\n\nconst I = IncrementId", "import { IFourNumber } from '@leafer/interface'\nimport { isNumber, isUndefined } from '@leafer/data'\n\n\nlet tempA: number[], tempB: number[], tempTo: number[]\nconst { max } = Math, tempFour = [0, 0, 0, 0]\n\nexport const FourNumberHelper = {\n\n    zero: [...tempFour],\n\n    tempFour,\n\n    set(to: number[], top: number, right?: number, bottom?: number, left?: number): number[] {\n        if (right === undefined) right = bottom = left = top\n        to[0] = top\n        to[1] = right\n        to[2] = bottom\n        to[3] = left\n        return to\n    },\n\n    setTemp(top: number, right?: number, bottom?: number, left?: number) {\n        return set(tempFour, top, right, bottom, left)\n    },\n\n    toTempAB(a: IFourNumber, b: IFourNumber, change?: boolean): void {\n        tempTo = change ? (isNumber(a) ? b : a) as number[] : []\n        if (isNumber(a)) tempA = setTemp(a), tempB = b as number[]\n        else if (isNumber(b)) tempA = a, tempB = setTemp(b)\n        else tempA = a, tempB = b\n\n        if (tempA.length !== 4) tempA = get(tempA)\n        if (tempB.length !== 4) tempB = get(tempB)\n    },\n\n    get(num: IFourNumber, maxValue?: number): number[] { // top right bottom left || topLeft, topRight, bottomRight, bottomLeft\n        let data: number[]\n        if (!isNumber(num)) {\n            switch (num.length) {\n                case 4:\n                    data = isUndefined(maxValue) ? num : [...num]\n                    break\n                case 2:\n                    data = [num[0], num[1], num[0], num[1]]\n                    break\n                case 3:\n                    data = [num[0], num[1], num[2], num[1]]\n                    break\n                case 1:\n                    num = num[0]\n                    break\n                default:\n                    num = 0\n            }\n        }\n        if (!data) data = [num as number, num as number, num as number, num as number]\n        if (!isUndefined(maxValue)) for (let i = 0; i < 4; i++)  if (data[i] > maxValue) data[i] = maxValue\n        return data\n    },\n\n    max(t: IFourNumber, other: IFourNumber, change?: boolean): IFourNumber {\n        if (isNumber(t) && isNumber(other)) return max(t, other)\n\n        toTempAB(t, other, change)\n\n        return set(\n            tempTo,\n            max(tempA[0], tempB[0]),\n            max(tempA[1], tempB[1]),\n            max(tempA[2], tempB[2]),\n            max(tempA[3], tempB[3])\n        )\n    },\n\n    add(t: IFourNumber, other: IFourNumber, change?: boolean): IFourNumber {\n        if (isNumber(t) && isNumber(other)) return t + other\n\n        toTempAB(t, other, change)\n\n        return set(\n            tempTo,\n            tempA[0] + tempB[0],\n            tempA[1] + tempB[1],\n            tempA[2] + tempB[2],\n            tempA[3] + tempB[3]\n        )\n    },\n\n    swapAndScale(t: IFourNumber, scaleX: number, scaleY: number, change?: boolean): IFourNumber { // 反向交换并缩放\n        if (isNumber(t)) return scaleX === scaleY ? t * scaleX : [t * scaleY, t * scaleX]\n\n        const to = change ? t : []\n        const [top, right, bottom, left] = t.length === 4 ? t : get(t)\n\n        return set(\n            to,\n            bottom * scaleY,\n            left * scaleX,\n            top * scaleY,\n            right * scaleX\n        )\n    }\n\n}\n\nconst { set, get, setTemp, toTempAB } = FourNumberHelper", "import { IPointData, IBoundsData, IMatrixData, IRangeSize, IScaleData, ISizeData, IOptionSizeData } from '@leafer/interface'\nimport { isObject, isNumber, isUndefined } from '@leafer/data'\nimport { FourNumberHelper } from './FourNumberHelper'\n\n\nconst { round, pow, max, floor, PI } = Math\n\nexport const MathHelper = {\n\n    within(value: number, min: number | IRangeSize, max?: number): number {\n        if (isObject(min)) max = min.max, min = min.min\n        if (!isUndefined(min) && value < min) value = min\n        if (!isUndefined(max) && value > max) value = max\n        return value\n    },\n\n    fourNumber: FourNumberHelper.get,\n\n    formatRotation(rotation: number, unsign?: boolean): number {\n        rotation %= 360\n        if (unsign) {\n            if (rotation < 0) rotation += 360\n        } else {\n            if (rotation > 180) rotation -= 360\n            if (rotation < -180) rotation += 360\n        }\n        return MathHelper.float(rotation)\n    },\n\n    getGapRotation(addRotation: number, gap: number, oldRotation: number = 0): number {\n        let rotation = addRotation + oldRotation\n        if (gap > 1) {\n            const r = Math.abs(rotation % gap)\n            if (r < 1 || r > gap - 1) rotation = Math.round(rotation / gap) * gap\n        }\n        return rotation - oldRotation\n    },\n\n    float(num: number, maxLength?: number): number {\n        const a = !isUndefined(maxLength) ? pow(10, maxLength) : 1000000000000 // default\n        num = round(num * a) / a\n        return num === -0 ? 0 : num\n    },\n\n    sign(num: number): number {\n        return num < 0 ? -1 : 1\n    },\n\n    getScaleData(scale: number | IPointData, size: number | IOptionSizeData, originSize: ISizeData, scaleData?: IScaleData): IScaleData {\n        if (!scaleData) scaleData = {} as IScaleData\n        if (size) {\n            const scaleX = (isNumber(size) ? size : size.width || 0) / originSize.width, scaleY = (isNumber(size) ? size : size.height || 0) / originSize.height\n            scaleData.scaleX = scaleX || scaleY || 1\n            scaleData.scaleY = scaleY || scaleX || 1\n        } else if (scale) MathHelper.assignScale(scaleData, scale)\n        return scaleData\n    },\n\n    assignScale(scaleData: IScaleData, scale: number | IPointData): void {\n        if (isNumber(scale)) {\n            scaleData.scaleX = scaleData.scaleY = scale\n        } else {\n            scaleData.scaleX = scale.x\n            scaleData.scaleY = scale.y\n        }\n    },\n\n    getFloorScale(num: number, min = 1): number {\n        return max(floor(num), min) / num\n    },\n\n    randInt,\n\n    randColor(opacity?: number): string {\n        return `rgba(${randInt(255)},${randInt(255)},${randInt(255)},${opacity || 1})`\n    }\n}\n\nfunction randInt(num: number): number {\n    return Math.round(Math.random() * num)\n}\n\nexport const OneRadian = PI / 180\nexport const PI2 = PI * 2\nexport const PI_2 = PI / 2\n\nexport function getPointData(): IPointData { return { x: 0, y: 0 } }\nexport function getBoundsData(): IBoundsData { return { x: 0, y: 0, width: 0, height: 0 } }\nexport function getMatrixData(): IMatrixData { return { a: 1, b: 0, c: 0, d: 1, e: 0, f: 0 } }", "import { IMatrixData, IPointData, ILayoutData, IMatrixWithLayoutData, IMatrixWithOptionScaleData, IScaleData, IMatrixWithScaleData } from '@leafer/interface'\nimport { isUndefined } from '@leafer/data'\n\nimport { MathHelper, OneRadian, PI_2, getBoundsData, getMatrixData } from './MathHelper'\n\n\nconst { sin, cos, acos, sqrt } = Math\nconst { float } = MathHelper\nconst tempPoint = {} as IPointData\n\nfunction getWorld(): IMatrixWithLayoutData {\n    return { ...getMatrixData(), ...getBoundsData(), scaleX: 1, scaleY: 1, rotation: 0, skewX: 0, skewY: 0 }\n}\n\nexport const MatrixHelper = {\n\n    defaultMatrix: getMatrixData(),\n\n    defaultWorld: getWorld(),\n\n    tempMatrix: {} as IMatrixData,\n\n    set(t: IMatrixData, a = 1, b = 0, c = 0, d = 1, e = 0, f = 0): void {\n        t.a = a\n        t.b = b\n        t.c = c\n        t.d = d\n        t.e = e\n        t.f = f\n    },\n\n    get: getMatrixData,\n\n    getWorld,\n\n    copy(t: IMatrixData, matrix: IMatrixData): void {\n        t.a = matrix.a\n        t.b = matrix.b\n        t.c = matrix.c\n        t.d = matrix.d\n        t.e = matrix.e\n        t.f = matrix.f\n    },\n\n    translate(t: IMatrixData, x: number, y: number): void {\n        t.e += x\n        t.f += y\n    },\n\n    translateInner(t: IMatrixData, x: number, y: number, hasOrigin?: boolean): void {\n        t.e += t.a * x + t.c * y\n        t.f += t.b * x + t.d * y\n        if (hasOrigin) t.e -= x, t.f -= y\n    },\n\n    scale(t: IMatrixData, scaleX: number, scaleY: number = scaleX): void {\n        t.a *= scaleX\n        t.b *= scaleX\n        t.c *= scaleY\n        t.d *= scaleY\n    },\n\n    pixelScale(t: IMatrixData, pixelRatio: number, to?: IMatrixData): void {\n        to || (to = t)\n        to.a = t.a * pixelRatio\n        to.b = t.b * pixelRatio\n        to.c = t.c * pixelRatio\n        to.d = t.d * pixelRatio\n        to.e = t.e * pixelRatio\n        to.f = t.f * pixelRatio\n    },\n\n    scaleOfOuter(t: IMatrixData, origin: IPointData, scaleX: number, scaleY?: number): void {\n        M.toInnerPoint(t, origin, tempPoint)\n        M.scaleOfInner(t, tempPoint, scaleX, scaleY)\n    },\n\n    scaleOfInner(t: IMatrixData, origin: IPointData, scaleX: number, scaleY: number = scaleX): void {\n        M.translateInner(t, origin.x, origin.y)\n        M.scale(t, scaleX, scaleY)\n        M.translateInner(t, -origin.x, -origin.y)\n    },\n\n\n    rotate(t: IMatrixData, rotation: number): void {\n        const { a, b, c, d } = t\n\n        rotation *= OneRadian\n        const cosR = cos(rotation)\n        const sinR = sin(rotation)\n\n        t.a = a * cosR - b * sinR\n        t.b = a * sinR + b * cosR\n        t.c = c * cosR - d * sinR\n        t.d = c * sinR + d * cosR\n    },\n\n    rotateOfOuter(t: IMatrixData, origin: IPointData, rotation: number): void {\n        M.toInnerPoint(t, origin, tempPoint)\n        M.rotateOfInner(t, tempPoint, rotation)\n    },\n\n    rotateOfInner(t: IMatrixData, origin: IPointData, rotation: number): void {\n        M.translateInner(t, origin.x, origin.y)\n        M.rotate(t, rotation)\n        M.translateInner(t, -origin.x, -origin.y)\n    },\n\n\n    skew(t: IMatrixData, skewX: number, skewY?: number): void {\n        const { a, b, c, d } = t\n\n        if (skewY) {\n            skewY *= OneRadian\n            t.a = a + c * skewY\n            t.b = b + d * skewY\n        }\n\n        if (skewX) {\n            skewX *= OneRadian\n            t.c = c + a * skewX\n            t.d = d + b * skewX\n        }\n    },\n\n    skewOfOuter(t: IMatrixData, origin: IPointData, skewX: number, skewY?: number): void {\n        M.toInnerPoint(t, origin, tempPoint)\n        M.skewOfInner(t, tempPoint, skewX, skewY)\n    },\n\n    skewOfInner(t: IMatrixData, origin: IPointData, skewX: number, skewY: number = 0): void {\n        M.translateInner(t, origin.x, origin.y)\n        M.skew(t, skewX, skewY)\n        M.translateInner(t, -origin.x, -origin.y)\n    },\n\n\n    multiply(t: IMatrixData, child: IMatrixData): void {\n        const { a, b, c, d, e, f } = t\n\n        t.a = child.a * a + child.b * c\n        t.b = child.a * b + child.b * d\n        t.c = child.c * a + child.d * c\n        t.d = child.c * b + child.d * d\n        t.e = child.e * a + child.f * c + e\n        t.f = child.e * b + child.f * d + f\n    },\n\n    multiplyParent(t: IMatrixWithOptionScaleData, parent: IMatrixWithOptionScaleData, to?: IMatrixWithOptionScaleData, abcdChanged?: boolean | number, childScaleData?: IScaleData): void { // = transform\n        const { e, f } = t\n\n        to || (to = t)\n\n        if (isUndefined(abcdChanged)) abcdChanged = t.a !== 1 || t.b || t.c || t.d !== 1\n\n        if (abcdChanged) {\n            const { a, b, c, d } = t\n\n            to.a = a * parent.a + b * parent.c\n            to.b = a * parent.b + b * parent.d\n            to.c = c * parent.a + d * parent.c\n            to.d = c * parent.b + d * parent.d\n\n            if (childScaleData) {\n                to.scaleX = parent.scaleX * childScaleData.scaleX\n                to.scaleY = parent.scaleY * childScaleData.scaleY\n            }\n\n        } else {\n            to.a = parent.a\n            to.b = parent.b\n            to.c = parent.c\n            to.d = parent.d\n\n            if (childScaleData) {\n                to.scaleX = parent.scaleX\n                to.scaleY = parent.scaleY\n            }\n        }\n\n        to.e = e * parent.a + f * parent.c + parent.e\n        to.f = e * parent.b + f * parent.d + parent.f\n    },\n\n\n    divide(t: IMatrixData, child: IMatrixData): void {\n        M.multiply(t, M.tempInvert(child))\n    },\n\n    divideParent(t: IMatrixData, parent: IMatrixData): void {\n        M.multiplyParent(t, M.tempInvert(parent))\n    },\n\n    tempInvert(t: IMatrixData): IMatrixData {\n        const { tempMatrix } = M\n        M.copy(tempMatrix, t)\n        M.invert(tempMatrix)\n        return tempMatrix\n    },\n\n    invert(t: IMatrixData): void {\n        const { a, b, c, d, e, f } = t\n        if (!b && !c) {\n            if (a === 1 && d === 1) {\n                t.e = -e\n                t.f = -f\n            } else {\n                const s = 1 / (a * d)\n                t.a = d * s\n                t.d = a * s\n                t.e = -e * d * s\n                t.f = -f * a * s\n            }\n        } else {\n            const s = 1 / (a * d - b * c)\n            t.a = d * s\n            t.b = -b * s\n            t.c = -c * s\n            t.d = a * s\n            t.e = -(e * d - f * c) * s\n            t.f = -(f * a - e * b) * s\n        }\n\n    },\n\n\n    toOuterPoint(t: IMatrixData, inner: IPointData, to?: IPointData, distance?: boolean): void {\n        const { x, y } = inner\n\n        // outer\n        to || (to = inner)\n        to.x = x * t.a + y * t.c\n        to.y = x * t.b + y * t.d\n\n        if (!distance) {\n            to.x += t.e\n            to.y += t.f\n        }\n    },\n\n    toInnerPoint(t: IMatrixData, outer: IPointData, to?: IPointData, distance?: boolean): void {\n        const { a, b, c, d } = t\n        const s = 1 / (a * d - b * c)\n\n        const { x, y } = outer\n\n        // inner\n        to || (to = outer)\n        to.x = (x * d - y * c) * s\n        to.y = (y * a - x * b) * s\n\n        if (!distance) {\n            const { e, f } = t\n            to.x -= (e * d - f * c) * s\n            to.y -= (f * a - e * b) * s\n        }\n    },\n\n    setLayout(t: IMatrixData, layout: ILayoutData, origin?: IPointData, around?: IPointData, bcChanged?: boolean | number): void {\n        const { x, y, scaleX, scaleY } = layout\n\n        if (isUndefined(bcChanged)) bcChanged = layout.rotation || layout.skewX || layout.skewY\n\n        if (bcChanged) {\n\n            const { rotation, skewX, skewY } = layout\n            const r = rotation * OneRadian\n            const cosR = cos(r)\n            const sinR = sin(r)\n\n            if (skewX || skewY) {\n\n                // rotate -> skew -> scale\n                const sx = skewX * OneRadian\n                const sy = skewY * OneRadian\n\n                t.a = (cosR + sy * -sinR) * scaleX\n                t.b = (sinR + sy * cosR) * scaleX\n                t.c = (-sinR + sx * cosR) * scaleY\n                t.d = (cosR + sx * sinR) * scaleY\n\n            } else {\n\n                // rotate -> scale\n                t.a = cosR * scaleX\n                t.b = sinR * scaleX\n                t.c = -sinR * scaleY\n                t.d = cosR * scaleY\n\n            }\n\n        } else {\n            t.a = scaleX\n            t.b = 0\n            t.c = 0\n            t.d = scaleY\n        }\n\n        // translate\n\n        t.e = x\n        t.f = y\n\n        if (origin = origin || around) M.translateInner(t, -origin.x, -origin.y, !around)\n\n    },\n\n    getLayout(t: IMatrixData, origin?: IPointData, around?: IPointData, firstSkewY?: boolean): ILayoutData {\n        const { a, b, c, d, e, f } = t\n\n        let x = e, y = f, scaleX: number, scaleY: number, rotation: number, skewX: number, skewY: number\n\n        if (b || c) {\n\n            const s = a * d - b * c\n\n            if (c && !firstSkewY) {\n                scaleX = sqrt(a * a + b * b)\n                scaleY = s / scaleX\n\n                const cosR = a / scaleX\n                rotation = b > 0 ? acos(cosR) : -acos(cosR)\n\n            } else {\n                scaleY = sqrt(c * c + d * d)\n                scaleX = s / scaleY\n\n                const cosR = c / scaleY\n                rotation = PI_2 - (d > 0 ? acos(-cosR) : -acos(cosR))\n            }\n\n            const cosR = float(cos(rotation)) // when -90 / 90 is 0\n            const sinR = sin(rotation)\n\n            scaleX = float(scaleX), scaleY = float(scaleY)\n            skewX = cosR ? float((c / scaleY + sinR) / cosR / OneRadian, 9) : 0\n            skewY = cosR ? float((b / scaleX - sinR) / cosR / OneRadian, 9) : 0\n            rotation = float(rotation / OneRadian)\n\n        } else {\n            scaleX = a\n            scaleY = d\n            rotation = skewX = skewY = 0\n        }\n\n        if (origin = around || origin) {\n            x += origin.x * a + origin.y * c\n            y += origin.x * b + origin.y * d\n            if (!around) x -= origin.x, y -= origin.y\n        }\n\n        return { x, y, scaleX, scaleY, rotation, skewX, skewY }\n    },\n\n    withScale(t: IMatrixData, scaleX?: number, scaleY = scaleX): IMatrixWithScaleData {\n        const world = t as unknown as IMatrixWithScaleData\n        if (!scaleX || !scaleY) {\n            const { a, b, c, d } = t\n            if (b || c) {\n                scaleX = sqrt(a * a + b * b)\n                scaleY = (a * d - b * c) / scaleX\n            } else {\n                scaleX = a\n                scaleY = d\n            }\n        }\n        world.scaleX = scaleX\n        world.scaleY = scaleY\n        return world\n    },\n\n    reset(t: IMatrixData): void {\n        M.set(t)\n    }\n}\n\nconst M = MatrixHelper", "import { IPointData, IMatrixData, IRadiusPointData, IMatrixWithScaleData } from '@leafer/interface'\nimport { isObject, isUndefined } from '@leafer/data'\n\nimport { MathHelper, OneRadian, getPointData } from './MathHelper'\nimport { MatrixHelper as M } from './MatrixHelper'\n\nconst { float } = MathHelper\nconst { toInnerPoint, toOuterPoint } = M\nconst { sin, cos, abs, sqrt, atan2, min, round } = Math\n\n\nexport const PointHelper = {\n\n    defaultPoint: getPointData(),\n\n    tempPoint: {} as IPointData,\n    tempRadiusPoint: {} as IRadiusPointData,\n\n    set(t: IPointData, x = 0, y = 0): void {\n        t.x = x\n        t.y = y\n    },\n\n    setRadius(t: IRadiusPointData, x: number, y?: number): void {\n        t.radiusX = x\n        t.radiusY = isUndefined(y) ? x : y\n    },\n\n    copy(t: IPointData, point: IPointData): void {\n        t.x = point.x\n        t.y = point.y\n    },\n\n    copyFrom(t: IPointData, x: number, y: number): void {\n        t.x = x\n        t.y = y\n    },\n\n    round(t: IPointData, halfPixel?: boolean): void {\n        t.x = halfPixel ? round(t.x - 0.5) + 0.5 : round(t.x)\n        t.y = halfPixel ? round(t.y - 0.5) + 0.5 : round(t.y)\n    },\n\n    move(t: IPointData, x: number | IPointData, y?: number): void {\n        if (isObject(x)) t.x += x.x, t.y += x.y\n        else t.x += x, t.y += y\n    },\n\n\n    scale(t: IPointData, scaleX: number, scaleY = scaleX): void {\n        if (t.x) t.x *= scaleX\n        if (t.y) t.y *= scaleY\n    },\n\n    scaleOf(t: IPointData, origin: IPointData, scaleX: number, scaleY = scaleX): void {\n        t.x += (t.x - origin.x) * (scaleX - 1)\n        t.y += (t.y - origin.y) * (scaleY - 1)\n    },\n\n    rotate(t: IPointData, rotation: number, origin?: IPointData): void {\n        if (!origin) origin = P.defaultPoint\n        rotation *= OneRadian\n        const cosR = cos(rotation)\n        const sinR = sin(rotation)\n        const rx = t.x - origin.x\n        const ry = t.y - origin.y\n        t.x = origin.x + rx * cosR - ry * sinR\n        t.y = origin.y + rx * sinR + ry * cosR\n    },\n\n\n    tempToInnerOf(t: IPointData, matrix: IMatrixData): IPointData {\n        const { tempPoint: temp } = P\n        copy(temp, t)\n        toInnerPoint(matrix, temp, temp)\n        return temp\n    },\n\n    tempToOuterOf(t: IPointData, matrix: IMatrixData): IPointData {\n        const { tempPoint: temp } = P\n        copy(temp, t)\n        toOuterPoint(matrix, temp, temp)\n        return temp\n    },\n\n    tempToInnerRadiusPointOf(t: IRadiusPointData, matrix: IMatrixWithScaleData): IRadiusPointData {\n        const { tempRadiusPoint: temp } = P\n        copy(temp, t)\n        P.toInnerRadiusPointOf(t, matrix, temp)\n        return temp\n    },\n\n    copyRadiusPoint(t: IRadiusPointData, point: IPointData, x: number, y?: number,): IRadiusPointData {\n        copy(t, point)\n        setRadius(t, x, y)\n        return t\n    },\n\n    toInnerRadiusPointOf(t: IRadiusPointData, matrix: IMatrixWithScaleData, to?: IRadiusPointData): void {\n        to || (to = t)\n        toInnerPoint(matrix, t, to)\n        to.radiusX = Math.abs(t.radiusX / matrix.scaleX)\n        to.radiusY = Math.abs(t.radiusY / matrix.scaleY)\n    },\n\n\n    toInnerOf(t: IPointData, matrix: IMatrixData, to?: IPointData): void {\n        toInnerPoint(matrix, t, to)\n    },\n\n    toOuterOf(t: IPointData, matrix: IMatrixData, to?: IPointData): void {\n        toOuterPoint(matrix, t, to)\n    },\n\n\n    getCenter(t: IPointData, to: IPointData): IPointData {\n        return { x: t.x + (to.x - t.x) / 2, y: t.y + (to.y - t.y) / 2 }\n    },\n\n    getCenterX(x1: number, x2: number): number {\n        return x1 + (x2 - x1) / 2\n    },\n\n    getCenterY(y1: number, y2: number): number {\n        return y1 + (y2 - y1) / 2\n    },\n\n    getDistance(t: IPointData, point: IPointData): number {\n        return getDistanceFrom(t.x, t.y, point.x, point.y)\n    },\n\n    getDistanceFrom(x1: number, y1: number, x2: number, y2: number): number {\n        const x = abs(x2 - x1)\n        const y = abs(y2 - y1)\n        return sqrt(x * x + y * y)\n    },\n\n    getMinDistanceFrom(x1: number, y1: number, x2: number, y2: number, x3: number, y3: number): number {\n        return min(getDistanceFrom(x1, y1, x2, y2), getDistanceFrom(x2, y2, x3, y3))\n    },\n\n    getAngle(t: IPointData, to: IPointData): number {\n        return getAtan2(t, to) / OneRadian\n    },\n\n    getRotation(t: IPointData, origin: IPointData, to: IPointData, toOrigin?: IPointData): number {\n        if (!toOrigin) toOrigin = origin\n        return P.getRadianFrom(t.x, t.y, origin.x, origin.y, to.x, to.y, toOrigin.x, toOrigin.y) / OneRadian\n    },\n\n    getRadianFrom(fromX: number, fromY: number, originX: number, originY: number, toX: number, toY: number, toOriginX?: number, toOriginY?: number): number {\n        if (isUndefined(toOriginX)) toOriginX = originX, toOriginY = originY\n        const a = fromX - originX\n        const b = fromY - originY\n        const c = toX - toOriginX\n        const d = toY - toOriginY\n        return Math.atan2(a * d - b * c, a * c + b * d)\n    },\n\n    getAtan2(t: IPointData, to: IPointData): number {\n        return atan2(to.y - t.y, to.x - t.x)\n    },\n\n\n    getDistancePoint(t: IPointData, to: IPointData, distance: number, changeTo?: boolean, fromTo?: boolean): IPointData {\n        const r = getAtan2(t, to)\n        fromTo && (t = to)\n        changeTo || (to = {} as IPointData)\n        to.x = t.x + cos(r) * distance\n        to.y = t.y + sin(r) * distance\n        return to\n    },\n\n    toNumberPoints(originPoints: number[] | IPointData[]): number[] {\n        let points = originPoints as number[]\n        if (isObject(originPoints[0])) points = [], (originPoints as IPointData[]).forEach(p => points.push(p.x, p.y))\n        return points\n    },\n\n    isSame(t: IPointData, point: IPointData): boolean {\n        return float(t.x) === float(point.x) && float(t.y) === float(point.y)\n    },\n\n    reset(t: IPointData): void {\n        P.reset(t)\n    }\n}\n\nconst P = PointHelper\nconst { getDistanceFrom, copy, setRadius, getAtan2 } = P", "import { IPoint, IPointData, IMatrixData } from '@leafer/interface'\nimport { isObject } from '@leafer/data'\n\nimport { PointHelper as P } from './PointHelper'\n\nexport class Point implements IPoint {\n\n    public x: number\n    public y: number\n\n    constructor(x?: number | IPointData, y?: number) {\n        this.set(x, y)\n    }\n\n    public set(x?: number | IPointData, y?: number): IPoint {\n        isObject(x) ? P.copy(this, x) : P.set(this, x, y)\n        return this\n    }\n\n    public get(): IPointData {\n        const { x, y } = this\n        return { x, y }\n    }\n\n\n    public clone(): IPoint {\n        return new Point(this)\n    }\n\n\n    public move(x: number | IPointData, y?: number): IPoint {\n        P.move(this, x, y)\n        return this\n    }\n\n    public scale(scaleX: number, scaleY?: number): IPoint {\n        P.scale(this, scaleX, scaleY)\n        return this\n    }\n\n    public scaleOf(origin: IPointData, scaleX: number, scaleY?: number): IPoint {\n        P.scaleOf(this, origin, scaleX, scaleY)\n        return this\n    }\n\n    public rotate(rotation: number, origin?: IPointData): IPoint {\n        P.rotate(this, rotation, origin)\n        return this\n    }\n\n    public rotateOf(origin: IPointData, rotation: number): IPoint {\n        P.rotate(this, rotation, origin)\n        return this\n    }\n\n    public getRotation(origin: IPointData, to: IPointData, toOrigin?: IPointData): number {\n        return P.getRotation(this, origin, to, toOrigin)\n    }\n\n\n    public toInnerOf(matrix: IMatrixData, to?: IPointData): IPoint {\n        P.toInnerOf(this, matrix, to)\n        return this\n    }\n\n    public toOuterOf(matrix: IMatrixData, to?: IPointData): IPoint {\n        P.toOuterOf(this, matrix, to)\n        return this\n    }\n\n\n    public getCenter(to: IPointData): IPoint {\n        return new Point(P.getCenter(this, to))\n    }\n\n    public getDistance(to: IPointData): number {\n        return P.getDistance(this, to)\n    }\n\n    public getDistancePoint(to: IPointData, distance: number, changeTo?: boolean, fromTo?: boolean): IPoint {\n        return new Point(P.getDistancePoint(this, to, distance, changeTo, fromTo))\n    }\n\n    public getAngle(to: IPointData): number {\n        return P.getAngle(this, to)\n    }\n\n    public getAtan2(to: IPointData): number {\n        return P.getAtan2(this, to)\n    }\n\n    public isSame(point: IPointData): boolean {\n        return P.isSame(this, point)\n    }\n\n    public reset(): IPoint {\n        P.reset(this)\n        return this\n    }\n\n}\n\nexport const tempPoint = new Point()", "import { IMatrix, IMatrixData, IPointData, ILayoutData, IMatrixWithScaleData } from '@leafer/interface'\nimport { isObject } from '@leafer/data'\n\nimport { MatrixHelper as M } from './MatrixHelper'\n\n\nexport class Matrix implements IMatrix {\n\n    public a: number\n    public b: number\n    public c: number\n    public d: number\n    public e: number\n    public f: number\n\n    public scaleX: number\n    public scaleY: number\n\n    constructor(a?: number | IMatrixData, b?: number, c?: number, d?: number, e?: number, f?: number) {\n        this.set(a, b, c, d, e, f)\n    }\n\n    public set(a?: number | IMatrixData, b?: number, c?: number, d?: number, e?: number, f?: number): IMatrix {\n        isObject(a) ? M.copy(this, a) : M.set(this, a, b, c, d, e, f)\n        return this\n    }\n\n    public setWith(dataWithScale: IMatrixWithScaleData): IMatrix {\n        M.copy(this, dataWithScale)\n        this.scaleX = dataWithScale.scaleX\n        this.scaleY = dataWithScale.scaleY\n        return this\n    }\n\n    public get(): IMatrixData {\n        const { a, b, c, d, e, f } = this\n        return { a, b, c, d, e, f }\n    }\n\n    public clone(): IMatrix {\n        return new Matrix(this)\n    }\n\n\n    public translate(x: number, y: number): IMatrix {\n        M.translate(this, x, y)\n        return this\n    }\n\n    public translateInner(x: number, y: number): IMatrix {\n        M.translateInner(this, x, y)\n        return this\n    }\n\n    public scale(x: number, y?: number): IMatrix {\n        M.scale(this, x, y)\n        return this\n    }\n\n    public scaleWith(x: number, y?: number): IMatrix {\n        M.scale(this, x, y)\n        this.scaleX *= x\n        this.scaleY *= y || x\n        return this\n    }\n\n    public pixelScale(pixelRatio: number): IMatrix {\n        M.pixelScale(this, pixelRatio)\n        return this\n    }\n\n    public scaleOfOuter(origin: IPointData, x: number, y?: number): IMatrix {\n        M.scaleOfOuter(this, origin, x, y)\n        return this\n    }\n    public scaleOfInner(origin: IPointData, x: number, y?: number): IMatrix {\n        M.scaleOfInner(this, origin, x, y)\n        return this\n    }\n\n    public rotate(angle: number): IMatrix {\n        M.rotate(this, angle)\n        return this\n    }\n\n    public rotateOfOuter(origin: IPointData, angle: number): IMatrix {\n        M.rotateOfOuter(this, origin, angle)\n        return this\n    }\n\n    public rotateOfInner(origin: IPointData, angle: number): IMatrix {\n        M.rotateOfInner(this, origin, angle)\n        return this\n    }\n\n\n    public skew(x: number, y?: number): IMatrix {\n        M.skew(this, x, y)\n        return this\n    }\n\n    public skewOfOuter(origin: IPointData, x: number, y?: number): IMatrix {\n        M.skewOfOuter(this, origin, x, y)\n        return this\n    }\n\n    public skewOfInner(origin: IPointData, x: number, y?: number): IMatrix {\n        M.skewOfInner(this, origin, x, y)\n        return this\n    }\n\n\n    public multiply(child: IMatrixData): IMatrix {\n        M.multiply(this, child)\n        return this\n    }\n\n    public multiplyParent(parent: IMatrixData): IMatrix {\n        M.multiplyParent(this, parent)\n        return this\n    }\n\n\n    public divide(child: IMatrixData): IMatrix {\n        M.divide(this, child)\n        return this\n    }\n\n    public divideParent(parent: IMatrixData): IMatrix {\n        M.divideParent(this, parent)\n        return this\n    }\n\n    public invert(): IMatrix {\n        M.invert(this)\n        return this\n    }\n\n    public invertWith(): IMatrix {\n        M.invert(this)\n        this.scaleX = 1 / this.scaleX\n        this.scaleY = 1 / this.scaleY\n        return this\n    }\n\n\n    public toOuterPoint(inner: IPointData, to?: IPointData, distance?: boolean): void {\n        M.toOuterPoint(this, inner, to, distance)\n    }\n\n    public toInnerPoint(outer: IPointData, to?: IPointData, distance?: boolean): void {\n        M.toInnerPoint(this, outer, to, distance)\n    }\n\n\n    public setLayout(data: ILayoutData, origin?: IPointData, around?: IPointData,): IMatrix {\n        M.setLayout(this, data, origin, around)\n        return this\n    }\n\n    public getLayout(origin?: IPointData, around?: IPointData, firstSkewY?: boolean): ILayoutData {\n        return M.getLayout(this, origin, around, firstSkewY)\n    }\n\n    public withScale(scaleX?: number, scaleY?: number): IMatrixWithScaleData {\n        return M.withScale(this, scaleX, scaleY)\n    }\n\n    public reset(): void {\n        M.reset(this)\n    }\n\n}\n\nexport const tempMatrix = new Matrix()", "import { ITwoPointBoundsData, IBoundsData } from '@leafer/interface'\n\nexport const TwoPointBoundsHelper = {\n\n    tempPointBounds: {} as ITwoPointBoundsData,\n\n    setPoint(t: ITwoPointBoundsData, minX: number, minY: number): void {\n        t.minX = t.maxX = minX\n        t.minY = t.maxY = minY\n    },\n\n    addPoint(t: ITwoPointBoundsData, x: number, y: number): void {\n        t.minX = x < t.minX ? x : t.minX\n        t.minY = y < t.minY ? y : t.minY\n        t.maxX = x > t.maxX ? x : t.maxX\n        t.maxY = y > t.maxY ? y : t.maxY\n    },\n\n    addBounds(t: ITwoPointBoundsData, x: number, y: number, width: number, height: number): void {\n        addPoint(t, x, y)\n        addPoint(t, x + width, y + height)\n    },\n\n    copy(t: ITwoPointBoundsData, pb: ITwoPointBoundsData): void {\n        t.minX = pb.minX\n        t.minY = pb.minY\n        t.maxX = pb.maxX\n        t.maxY = pb.maxY\n    },\n\n    addPointBounds(t: ITwoPointBoundsData, pb: ITwoPointBoundsData): void {\n        t.minX = pb.minX < t.minX ? pb.minX : t.minX\n        t.minY = pb.minY < t.minY ? pb.minY : t.minY\n        t.maxX = pb.maxX > t.maxX ? pb.maxX : t.maxX\n        t.maxY = pb.maxY > t.maxY ? pb.maxY : t.maxY\n    },\n\n    toBounds(t: ITwoPointBoundsData, setBounds: IBoundsData): void {\n        setBounds.x = t.minX\n        setBounds.y = t.minY\n        setBounds.width = t.maxX - t.minX\n        setBounds.height = t.maxY - t.minY\n    }\n\n}\n\nconst { addPoint } = TwoPointBoundsHelper", "export enum Direction4 {\n    top,\n    right,\n    bottom,\n    left\n}\n\nexport enum Direction9 {\n    topLeft,\n    top,\n    topRight,\n    right,\n    bottomRight,\n    bottom,\n    bottomLeft,\n    left,\n    center,\n    'top-left' = 0,\n    'top-right' = 2,\n    'bottom-right' = 4,\n    'bottom-left' = 6\n}", "import { IAround, IPointData, IBoundsData, IUnitPointData } from '@leafer/interface'\nimport { isString } from '@leafer/data'\n\nimport { Direction9 } from './Direction'\n\n\nconst directionData: IUnitPointData[] = [\n    { x: 0, y: 0 },  //topLeft\n    { x: 0.5, y: 0 },//top\n    { x: 1, y: 0 },  //topRight\n    { x: 1, y: 0.5 },// right\n    { x: 1, y: 1 },  //bottomRight\n    { x: 0.5, y: 1 },//bottom\n    { x: 0, y: 1 },  //bottomLeft\n    { x: 0, y: 0.5 },//left\n    { x: 0.5, y: 0.5 } // center\n]\ndirectionData.forEach(item => item.type = 'percent')\n\nexport const AroundHelper = {\n\n    directionData, // index Direction9\n\n    tempPoint: {} as IPointData,\n\n    get,\n\n    toPoint(around: IAround, box: IBoundsData, to: IPointData, onlyBoxSize?: boolean, content?: IBoundsData, onlyContentSize?: boolean) {\n        const point = get(around)\n\n        to.x = point.x\n        to.y = point.y\n\n\n        if (point.type === 'percent') {\n            to.x *= box.width\n            to.y *= box.height\n\n            if (content) { // align\n                if (!onlyContentSize) to.x -= content.x, to.y -= content.y\n                if (point.x) to.x -= (point.x === 1) ? content.width : (point.x === 0.5 ? point.x * content.width : 0)\n                if (point.y) to.y -= (point.y === 1) ? content.height : (point.y === 0.5 ? point.y * content.height : 0)\n            }\n        }\n\n        if (!onlyBoxSize) to.x += box.x, to.y += box.y\n    },\n\n    getPoint(around: IAround, box: IBoundsData, to?: IPointData): IPointData {\n        if (!to) to = {} as IPointData\n        AroundHelper.toPoint(around, box, to, true)\n        return to\n    }\n}\n\nfunction get(around: IAround): IUnitPointData {\n    return isString(around) ? directionData[Direction9[around]] : around\n}", "import { IPointData, IBoundsData, IAlign } from '@leafer/interface'\nimport { AroundHelper } from './AroundHelper'\n\nconst { toPoint } = AroundHelper\n\nexport const AlignHelper = {\n    toPoint(align: IAlign, content: IBoundsData, box: IBoundsData, to: IPointData, onlyBoxSize?: boolean, onlyContentSize?: boolean): void {\n        toPoint(align, box, to, onlyBoxSize, content, onlyContentSize)\n    }\n}", "import { IPointData, IBoundsData, IMatrixData, IFourNumber, IBoundsDataFn, IObject, IMatrix, IOffsetBoundsData, IRadiusPointData, IMatrixWithScaleData, ISide, IAlign, ISizeData, IScrollPointData } from '@leafer/interface'\nimport { isArray, isString } from '@leafer/data'\n\nimport { Matrix } from './Matrix'\nimport { MatrixHelper as M } from './MatrixHelper'\nimport { TwoPointBoundsHelper as TB } from './TwoPointBoundsHelper'\nimport { PointHelper as P } from './PointHelper'\nimport { MathHelper, getBoundsData } from './MathHelper'\nimport { AlignHelper } from './AlignHelper'\n\n\nconst { tempPointBounds, setPoint, addPoint, toBounds } = TB\nconst { toOuterPoint } = M\nconst { float, fourNumber } = MathHelper\nconst { floor, ceil } = Math\n\nlet right: number, bottom: number, boundsRight: number, boundsBottom: number\nconst point = {} as IPointData\nconst toPoint = {} as IPointData\nconst tempBounds = {} as IBoundsData\n\nexport const BoundsHelper = {\n\n    tempBounds,\n\n    set(t: IBoundsData, x = 0, y = 0, width = 0, height = 0): void {\n        t.x = x\n        t.y = y\n        t.width = width\n        t.height = height\n    },\n\n    copy(t: IBoundsData, bounds: IBoundsData): void {\n        t.x = bounds.x\n        t.y = bounds.y\n        t.width = bounds.width\n        t.height = bounds.height\n    },\n\n    copyAndSpread(t: IBoundsData, bounds: IBoundsData, spread: IFourNumber, isShrink?: boolean, side?: ISide): void {\n        const { x, y, width, height } = bounds\n        if (isArray(spread)) {\n            const four = fourNumber(spread)\n            isShrink\n                ? B.set(t, x + four[3], y + four[0], width - four[1] - four[3], height - four[2] - four[0])\n                : B.set(t, x - four[3], y - four[0], width + four[1] + four[3], height + four[2] + four[0])\n        } else {\n            if (isShrink) spread = -spread\n            B.set(t, x - spread, y - spread, width + spread * 2, height + spread * 2)\n        }\n\n        if (side) { // 只扩展/收缩一边\n            if (side === 'width') t.y = y, t.height = height\n            else t.x = x, t.width = width\n        }\n    },\n\n\n    minX(t: IBoundsData): number { return t.width > 0 ? t.x : t.x + t.width },\n\n    minY(t: IBoundsData): number { return t.height > 0 ? t.y : t.y + t.height },\n\n    maxX(t: IBoundsData): number { return t.width > 0 ? t.x + t.width : t.x },\n\n    maxY(t: IBoundsData): number { return t.height > 0 ? t.y + t.height : t.y },\n\n\n    move(t: IBoundsData, x: number, y: number): void {\n        t.x += x\n        t.y += y\n    },\n\n    scroll(t: IBoundsData, data: IScrollPointData): void {\n        t.x += data.scrollX\n        t.y += data.scrollY\n    },\n\n    getByMove(t: IBoundsData, x: number, y: number): IBoundsData {\n        t = { ...t }\n        B.move(t, x, y)\n        return t\n    },\n\n    toOffsetOutBounds(t: IBoundsData, to?: IOffsetBoundsData, offsetBounds?: IBoundsData): void {\n        if (!to) to = t as IOffsetBoundsData\n        else copy(to, t)\n\n        if (!offsetBounds) offsetBounds = t\n        to.offsetX = B.maxX(offsetBounds)\n        to.offsetY = B.maxY(offsetBounds)\n        B.move(to, -to.offsetX, -to.offsetY)\n    },\n\n\n    scale(t: IBoundsData, scaleX: number, scaleY = scaleX, onlySize?: boolean): void {\n        onlySize || P.scale(t, scaleX, scaleY)\n        t.width *= scaleX\n        t.height *= scaleY\n    },\n\n    scaleOf(t: IBoundsData, origin: IPointData, scaleX: number, scaleY = scaleX): void {\n        P.scaleOf(t, origin, scaleX, scaleY)\n        t.width *= scaleX\n        t.height *= scaleY\n    },\n\n    tempToOuterOf(t: IBoundsData, matrix: IMatrixData): IBoundsData {\n        B.copy(tempBounds, t)\n        B.toOuterOf(tempBounds, matrix)\n        return tempBounds\n    },\n\n    getOuterOf(t: IBoundsData, matrix: IMatrixData): IBoundsData {\n        t = { ...t }\n        B.toOuterOf(t, matrix)\n        return t\n    },\n\n    toOuterOf(t: IBoundsData, matrix: IMatrixData, to?: IBoundsData): void {\n\n        to || (to = t)\n\n        if (matrix.b === 0 && matrix.c === 0) {\n\n            const { a, d, e, f } = matrix\n            if (a > 0) {\n                to.width = t.width * a\n                to.x = e + t.x * a\n            } else {\n                to.width = t.width * -a\n                to.x = e + t.x * a - to.width\n            }\n\n            if (d > 0) {\n                to.height = t.height * d\n                to.y = f + t.y * d\n            } else {\n                to.height = t.height * -d\n                to.y = f + t.y * d - to.height\n            }\n\n        } else {\n\n            point.x = t.x\n            point.y = t.y\n\n            toOuterPoint(matrix, point, toPoint)\n            setPoint(tempPointBounds, toPoint.x, toPoint.y)\n\n            point.x = t.x + t.width\n\n            toOuterPoint(matrix, point, toPoint)\n            addPoint(tempPointBounds, toPoint.x, toPoint.y)\n\n            point.y = t.y + t.height\n\n            toOuterPoint(matrix, point, toPoint)\n            addPoint(tempPointBounds, toPoint.x, toPoint.y)\n\n            point.x = t.x\n\n            toOuterPoint(matrix, point, toPoint)\n            addPoint(tempPointBounds, toPoint.x, toPoint.y)\n\n            toBounds(tempPointBounds, to)\n        }\n    },\n\n    toInnerOf(t: IBoundsData, matrix: IMatrixData, to?: IBoundsData): void {\n        to || (to = t)\n        B.move(to, -matrix.e, -matrix.f)\n        B.scale(to, 1 / matrix.a, 1 / matrix.d)\n    },\n\n    getFitMatrix(t: IBoundsData, put: IBoundsData, baseScale = 1): IMatrix {\n        const scale = Math.min(baseScale, B.getFitScale(t, put))\n        return new Matrix(scale, 0, 0, scale, -put.x * scale, -put.y * scale)\n    },\n\n    getFitScale(t: ISizeData, put: ISizeData, isCoverMode?: boolean): number {\n        const sw = t.width / put.width, sh = t.height / put.height\n        return isCoverMode ? Math.max(sw, sh) : Math.min(sw, sh)\n    },\n\n    put(t: ISizeData, put: ISizeData, align: IAlign = 'center', putScale: number | 'fit' | 'cover' = 1, changeSize = true, to?: IPointData): void {\n        to || (to = put as unknown as IPointData)\n        if (isString(putScale)) putScale = B.getFitScale(t, put, putScale === 'cover')\n        tempBounds.width = changeSize ? put.width *= putScale : put.width * putScale\n        tempBounds.height = changeSize ? put.height *= putScale : put.height * putScale\n        AlignHelper.toPoint(align, tempBounds, t as IBoundsData, to, true, true)\n    },\n\n    getSpread(t: IBoundsData, spread: IFourNumber, side?: ISide): IBoundsData {\n        const n = {} as IBoundsData\n        B.copyAndSpread(n, t, spread, false, side)\n        return n\n    },\n\n    spread(t: IBoundsData, spread: IFourNumber, side?: ISide): void {\n        B.copyAndSpread(t, t, spread, false, side)\n    },\n\n    shrink(t: IBoundsData, shrink: IFourNumber, side?: ISide): void {\n        B.copyAndSpread(t, t, shrink, true, side)\n    },\n\n    ceil(t: IBoundsData): void {\n        const { x, y } = t\n        t.x = floor(t.x)\n        t.y = floor(t.y)\n        t.width = x > t.x ? ceil(t.width + x - t.x) : ceil(t.width)\n        t.height = y > t.y ? ceil(t.height + y - t.y) : ceil(t.height)\n    },\n\n    unsign(t: IBoundsData): void {\n        if (t.width < 0) {\n            t.x += t.width\n            t.width = -t.width\n        }\n        if (t.height < 0) {\n            t.y += t.height\n            t.height = -t.height\n        }\n    },\n\n    float(t: IBoundsData, maxLength?: number): void {\n        t.x = float(t.x, maxLength)\n        t.y = float(t.y, maxLength)\n        t.width = float(t.width, maxLength)\n        t.height = float(t.height, maxLength)\n    },\n\n    add(t: IBoundsData, bounds: IBoundsData, isPoint?: boolean): void {\n        right = t.x + t.width\n        bottom = t.y + t.height\n        boundsRight = bounds.x\n        boundsBottom = bounds.y\n\n        if (!isPoint) {\n            boundsRight += bounds.width\n            boundsBottom += bounds.height\n        }\n\n        right = right > boundsRight ? right : boundsRight\n        bottom = bottom > boundsBottom ? bottom : boundsBottom\n\n        t.x = t.x < bounds.x ? t.x : bounds.x\n        t.y = t.y < bounds.y ? t.y : bounds.y\n        t.width = right - t.x\n        t.height = bottom - t.y\n    },\n\n    addList(t: IBoundsData, list: IBoundsData[]): void {\n        B.setListWithFn(t, list, undefined, true)\n    },\n\n    setList(t: IBoundsData, list: IBoundsData[], addMode = false): void {\n        B.setListWithFn(t, list, undefined, addMode)\n    },\n\n    addListWithFn(t: IBoundsData, list: IObject[], boundsDataFn: IBoundsDataFn): void {\n        B.setListWithFn(t, list, boundsDataFn, true)\n    },\n\n    setListWithFn(t: IBoundsData, list: IObject[], boundsDataFn: IBoundsDataFn, addMode = false): void {\n        let bounds: IBoundsData, first = true\n        for (let i = 0, len = list.length; i < len; i++) {\n            bounds = boundsDataFn ? boundsDataFn(list[i], i) : list[i] as IBoundsData\n            if (bounds && (bounds.width || bounds.height)) {\n                if (first) {\n                    first = false\n                    if (!addMode) copy(t, bounds)\n                } else {\n                    add(t, bounds)\n                }\n            }\n        }\n\n        if (first) B.reset(t)\n    },\n\n\n    setPoints(t: IBoundsData, points: IPointData[]): void {\n        points.forEach((point, index) => index === 0 ? setPoint(tempPointBounds, point.x, point.y) : addPoint(tempPointBounds, point.x, point.y))\n        toBounds(tempPointBounds, t)\n    },\n\n    setPoint(t: IBoundsData, point: IPointData): void {\n        B.set(t, point.x, point.y)\n    },\n\n    addPoint(t: IBoundsData, point: IPointData): void {\n        add(t, point as IBoundsData, true)\n    },\n\n    getPoints(t: IBoundsData): IPointData[] {\n        const { x, y, width, height } = t\n        return [\n            { x, y }, // topLeft\n            { x: x + width, y }, // topRight\n            { x: x + width, y: y + height }, // bottomRight\n            { x, y: y + height } // bottomLeft\n        ]\n    },\n\n\n    hitRadiusPoint(t: IBoundsData, point: IRadiusPointData, pointMatrix?: IMatrixWithScaleData): boolean {\n        if (pointMatrix) point = P.tempToInnerRadiusPointOf(point, pointMatrix)\n        return (point.x >= t.x - point.radiusX && point.x <= t.x + t.width + point.radiusX) && (point.y >= t.y - point.radiusY && point.y <= t.y + t.height + point.radiusY)\n    },\n\n    hitPoint(t: IBoundsData, point: IPointData, pointMatrix?: IMatrixData): boolean {\n        if (pointMatrix) point = P.tempToInnerOf(point, pointMatrix)\n        return (point.x >= t.x && point.x <= t.x + t.width) && (point.y >= t.y && point.y <= t.y + t.height)\n    },\n\n\n    hit(t: IBoundsData, other: IBoundsData, otherMatrix?: IMatrixData): boolean {\n        if (otherMatrix) other = B.tempToOuterOf(other, otherMatrix)\n        return !((t.y + t.height < other.y) || (other.y + other.height < t.y) || (t.x + t.width < other.x) || (other.x + other.width < t.x))\n    },\n\n    includes(t: IBoundsData, other: IBoundsData, otherMatrix?: IMatrixData): boolean {\n        if (otherMatrix) other = B.tempToOuterOf(other, otherMatrix)\n        return (t.x <= other.x) && (t.y <= other.y) && (t.x + t.width >= other.x + other.width) && (t.y + t.height >= other.y + other.height)\n    },\n\n    getIntersectData(t: IBoundsData, other: IBoundsData, otherMatrix?: IMatrixData): IBoundsData {\n        if (otherMatrix) other = B.tempToOuterOf(other, otherMatrix)\n        if (!B.hit(t, other)) return getBoundsData()\n\n        let { x, y, width, height } = other\n\n        right = x + width\n        bottom = y + height\n        boundsRight = t.x + t.width\n        boundsBottom = t.y + t.height\n\n        x = x > t.x ? x : t.x\n        y = y > t.y ? y : t.y\n        right = right < boundsRight ? right : boundsRight\n        bottom = bottom < boundsBottom ? bottom : boundsBottom\n\n        width = right - x\n        height = bottom - y\n\n        return { x, y, width, height }\n    },\n\n    intersect(t: IBoundsData, other: IBoundsData, otherMatrix?: IMatrixData): void {\n        B.copy(t, B.getIntersectData(t, other, otherMatrix))\n    },\n\n\n    isSame(t: IBoundsData, bounds: IBoundsData): boolean {\n        return t.x === bounds.x && t.y === bounds.y && t.width === bounds.width && t.height === bounds.height\n    },\n\n    isEmpty(t: IBoundsData): boolean {\n        return t.x === 0 && t.y === 0 && t.width === 0 && t.height === 0\n    },\n\n    hasSize(t: IBoundsData): boolean {\n        return (t.width && t.height) as any as boolean\n    },\n\n    reset(t: IBoundsData): void {\n        B.set(t)\n    }\n}\n\nconst B = BoundsHelper\nconst { add, copy } = B", "import { IBounds, IBoundsData, IMatrixData, IPointData, IBoundsDataFn, IObject, IMatrix, IRadiusPointData, IMatrixWithLayoutData, IFourNumber, ISide, IAlign } from '@leafer/interface'\nimport { isObject } from '@leafer/data'\n\nimport { BoundsHelper as B } from './BoundsHelper'\n\n\nexport class Bounds implements IBounds {\n\n    public x: number\n    public y: number\n    public width: number\n    public height: number\n\n    public get minX(): number { return B.minX(this) }\n    public get minY(): number { return B.minY(this) }\n    public get maxX(): number { return B.maxX(this) }\n    public get maxY(): number { return B.maxY(this) }\n\n    constructor(x?: number | IBoundsData, y?: number, width?: number, height?: number) {\n        this.set(x, y, width, height)\n    }\n\n    public set(x?: number | IBoundsData, y?: number, width?: number, height?: number): IBounds {\n        isObject(x) ? B.copy(this, x) : B.set(this, x, y, width, height)\n        return this\n    }\n\n    public get(): IBoundsData {\n        const { x, y, width, height } = this\n        return { x, y, width, height }\n    }\n\n    public clone(): IBounds {\n        return new Bounds(this)\n    }\n\n\n    public move(x: number, y: number): IBounds {\n        B.move(this, x, y)\n        return this\n    }\n\n    public scale(scaleX: number, scaleY?: number, onlySize?: boolean): IBounds {\n        B.scale(this, scaleX, scaleY, onlySize)\n        return this\n    }\n\n    public scaleOf(origin: IPointData, scaleX: number, scaleY?: number): IBounds {\n        B.scaleOf(this, origin, scaleX, scaleY)\n        return this\n    }\n\n    public toOuterOf(matrix: IMatrixData, to?: IBoundsData): IBounds {\n        B.toOuterOf(this, matrix, to)\n        return this\n    }\n\n    public toInnerOf(matrix: IMatrixData, to?: IBoundsData): IBounds {\n        B.toInnerOf(this, matrix, to)\n        return this\n    }\n\n    public getFitMatrix(put: IBoundsData, baseScale?: number): IMatrix {\n        return B.getFitMatrix(this, put, baseScale)\n    }\n\n    public put(put: IBoundsData, align?: IAlign, putScale?: number | 'fit' | 'cover'): void {\n        B.put(this, put, align, putScale)\n    }\n\n    public spread(fourNumber: IFourNumber, side?: ISide): IBounds {\n        B.spread(this, fourNumber, side)\n        return this\n    }\n\n    public shrink(fourNumber: IFourNumber, side?: ISide): IBounds {\n        B.shrink(this, fourNumber, side)\n        return this\n    }\n\n    public ceil(): IBounds {\n        B.ceil(this)\n        return this\n    }\n\n    public unsign(): IBounds {\n        B.unsign(this)\n        return this\n    }\n\n    public float(maxLength?: number): IBounds {\n        B.float(this, maxLength)\n        return this\n    }\n\n\n    public add(bounds: IBoundsData): IBounds {\n        B.add(this, bounds)\n        return this\n    }\n\n    public addList(boundsList: IBoundsData[]): IBounds {\n        B.setList(this, boundsList, true)\n        return this\n    }\n\n    public setList(boundsList: IBoundsData[]): IBounds {\n        B.setList(this, boundsList)\n        return this\n    }\n\n    public addListWithFn(list: IObject[], boundsDataFn: IBoundsDataFn): IBounds {\n        B.setListWithFn(this, list, boundsDataFn, true)\n        return this\n    }\n\n    public setListWithFn(list: IObject[], boundsDataFn: IBoundsDataFn): IBounds {\n        B.setListWithFn(this, list, boundsDataFn)\n        return this\n    }\n\n\n    public setPoint(point: IPointData): IBounds {\n        B.setPoint(this, point)\n        return this\n    }\n\n    public setPoints(points: IPointData[]): IBounds {\n        B.setPoints(this, points)\n        return this\n    }\n\n    public addPoint(point: IPointData): IBounds {\n        B.addPoint(this, point)\n        return this\n    }\n\n    public getPoints(): IPointData[] {\n        return B.getPoints(this)\n    }\n\n\n\n    public hitPoint(point: IPointData, pointMatrix?: IMatrixData): boolean {\n        return B.hitPoint(this, point, pointMatrix)\n    }\n\n    public hitRadiusPoint(point: IRadiusPointData, pointMatrix?: IMatrixWithLayoutData): boolean {\n        return B.hitRadiusPoint(this, point, pointMatrix)\n    }\n\n    public hit(bounds: IBoundsData, boundsMatrix?: IMatrixData): boolean {\n        return B.hit(this, bounds, boundsMatrix)\n    }\n\n    public includes(bounds: IBoundsData, boundsMatrix?: IMatrixData): boolean {\n        return B.includes(this, bounds, boundsMatrix)\n    }\n\n\n    public intersect(bounds: IBoundsData, boundsMatrix?: IMatrixData): IBounds {\n        B.intersect(this, bounds, boundsMatrix)\n        return this\n    }\n\n    public getIntersect(bounds: IBoundsData, boundsMatrix?: IMatrixData): IBounds {\n        return new Bounds(B.getIntersectData(this, bounds, boundsMatrix))\n    }\n\n\n    public isSame(bounds: IBoundsData): boolean {\n        return B.isSame(this, bounds)\n    }\n\n    public isEmpty(): boolean {\n        return B.isEmpty(this)\n    }\n\n    public reset(): void {\n        B.reset(this)\n    }\n\n}\n\nexport const tempBounds = new Bounds()", "import { IAutoBounds, IAutoBoundsData, IBounds, ISizeData } from '@leafer/interface'\nimport { isObject } from '@leafer/data'\n\nimport { Bounds } from './Bounds'\n\n\nexport class AutoBounds implements IAutoBounds {\n\n    public top: number\n    public right: number\n    public bottom: number\n    public left: number\n\n    public width: number\n    public height: number\n\n    constructor(top?: number | IAutoBoundsData, right?: number, bottom?: number, left?: number, width?: number, height?: number) {\n        isObject(top) ? this.copy(top) : this.set(top, right, bottom, left, width, height)\n    }\n\n    set(top = 0, right = 0, bottom = 0, left = 0, width = 0, height = 0): void {\n        this.top = top\n        this.right = right\n        this.bottom = bottom\n        this.left = left\n        this.width = width\n        this.height = height\n    }\n\n    copy(autoSize: IAutoBoundsData): void {\n        const { top, right, bottom, left, width, height } = autoSize\n        this.set(top, right, bottom, left, width, height)\n    }\n\n    getBoundsFrom(parent: ISizeData): IBounds {\n        const { top, right, bottom, left, width, height } = this\n        return new Bounds(left, top, width ? width : parent.width - left - right, height ? height : parent.height - top - bottom)\n    }\n\n}", "import { IUnitData } from '@leafer/interface'\nimport { isObject } from '@leafer/data'\n\nexport const UnitConvertHelper = {\n    number(value: number | IUnitData, percentRefer?: number): number {\n        return isObject(value) ? (value.type === 'percent' ? value.value * percentRefer : value.value) : value\n    }\n}", "import { INumberMap } from '@leafer/interface'\n\n\nexport const StringNumberMap: INumberMap = {\n    '0': 1,\n    '1': 1,\n    '2': 1,\n    '3': 1,\n    '4': 1,\n    '5': 1,\n    '6': 1,\n    '7': 1,\n    '8': 1,\n    '9': 1,\n    '.': 1,\n    'e': 1,\n    'E': 1\n}", "import { IPlatform, IObject, IBoundsData, ICanvasPattern, IMatrixData, ILeaferImagePatternPaint, ISizeData, ICanvasContext2D, IInterlace } from '@leafer/interface'\nimport { DataHelper } from '@leafer/data'\nimport { UnitConvertHelper } from '@leafer/math'\n\n\nconst { floor, max } = Math\n\nexport const Platform: IPlatform = {\n    toURL(text: string, fileType?: 'text' | 'svg'): string {\n        let url = encodeURIComponent(text)\n        if (fileType === 'text') url = 'data:text/plain;charset=utf-8,' + url\n        else if (fileType === 'svg') url = 'data:image/svg+xml,' + url\n        return url\n    },\n    image: {\n        hitCanvasSize: 100,\n        maxCacheSize: 2560 * 1600,  // 2k\n        maxPatternSize: 4096 * 2160, // 4k\n        crossOrigin: 'anonymous',\n        isLarge(size: ISizeData, scaleX?: number, scaleY?: number, largeSize?: number): boolean {\n            return size.width * size.height * (scaleX ? scaleX * scaleY : 1) > (largeSize || image.maxCacheSize)\n        },\n        isSuperLarge(size: ISizeData, scaleX?: number, scaleY?: number): boolean {\n            return image.isLarge(size, scaleX, scaleY, image.maxPatternSize)\n        },\n        getRealURL(url: string): string {\n            const { prefix, suffix } = image\n            if (suffix && !url.startsWith('data:') && !url.startsWith('blob:')) url += (url.includes(\"?\") ? \"&\" : \"?\") + suffix\n            if (prefix && url[0] === '/') url = prefix + url\n            return url\n        },\n        resize(view: any, width: number, height: number, xGap?: number, yGap?: number, clip?: IBoundsData, smooth?: boolean, opacity?: number, _filters?: IObject, interlace?: IInterlace): any {\n            const realWidth = max(floor(width + (xGap || 0)), 1), realHeight = max(floor(height + (yGap || 0)), 1)\n\n            let interlaceX: boolean, interlaceY: boolean, interlaceOffset: number\n            if (interlace && (interlaceOffset = UnitConvertHelper.number(interlace.offset, (interlaceX = interlace.type === 'x') ? width : height))) interlaceX || (interlaceY = true)\n\n            const canvas = Platform.origin.createCanvas(interlaceY ? realWidth * 2 : realWidth, interlaceX ? realHeight * 2 : realHeight)\n            const ctx: ICanvasContext2D = canvas.getContext('2d')\n            if (opacity) ctx.globalAlpha = opacity\n            ctx.imageSmoothingEnabled = smooth === false ? false : true // 平滑绘制\n\n            if (image.canUse(view)) {\n                if (clip) {\n                    const scaleX = width / clip.width, scaleY = height / clip.height\n                    ctx.setTransform(scaleX, 0, 0, scaleY, -clip.x * scaleX, -clip.y * scaleY)\n                    ctx.drawImage(view, 0, 0, view.width, view.height)\n                } else ctx.drawImage(view, 0, 0, width, height)\n\n                if (interlaceOffset) {\n                    ctx.drawImage(canvas, 0, 0, realWidth, realHeight, interlaceX ? interlaceOffset - realWidth : realWidth, interlaceX ? realHeight : interlaceOffset - realHeight, realWidth, realHeight)\n                    ctx.drawImage(canvas, 0, 0, realWidth, realHeight, interlaceX ? interlaceOffset : realWidth, interlaceX ? realHeight : interlaceOffset, realWidth, realHeight)\n                }\n            }\n\n            return canvas\n        },\n        canUse(view: any): boolean {\n            return view && view.width && !view.__closed // __closed 为内部标记已销毁\n        },\n        setPatternTransform(pattern: ICanvasPattern, transform?: IMatrixData, paint?: ILeaferImagePatternPaint): void {\n            try {\n                if (transform && pattern.setTransform) {\n                    pattern.setTransform(transform) // maybe error \n                    transform = undefined\n                }\n            } catch { }\n            if (paint) DataHelper.stintSet(paint, 'transform', transform)\n        }\n    }\n}\n\nconst { image } = Platform", "import { IBooleanMap, IBoundsData, ILeaferCanvas, IRenderOptions, ILeaf } from '@leafer/interface'\nimport { isString } from '@leafer/data'\nimport { MathHelper } from '@leafer/math'\n\n\nconst { randColor } = MathHelper\nexport class Debug {\n\n    static enable: boolean\n\n    static filterList: string[] = []\n    static excludeList: string[] = []\n\n    // other\n    static showWarn = true\n    static showRepaint: boolean | string\n    static showBounds: boolean | string | 'hit'\n\n    public name: string\n\n    public repeatMap: IBooleanMap = {}\n\n    constructor(name: string) {\n        this.name = name\n    }\n\n    static get(name: string): Debug {\n        return new Debug(name)\n    }\n\n    static set filter(name: string | string[]) {\n        this.filterList = getNameList(name)\n    }\n\n    static set exclude(name: string | string[]) {\n        this.excludeList = getNameList(name)\n    }\n\n    static drawRepaint(canvas: ILeaferCanvas, bounds: IBoundsData): void {\n        const color = randColor()\n        canvas.fillWorld(bounds, color.replace('1)', '.1)'))\n        canvas.strokeWorld(bounds, color)\n    }\n\n    static drawBounds(leaf: ILeaf, canvas: ILeaferCanvas, _options: IRenderOptions): void {\n        const showHit = Debug.showBounds === 'hit', w = leaf.__nowWorld, color = randColor()\n        if (showHit) canvas.setWorld(w), leaf.__drawHitPath(canvas), canvas.fillStyle = color.replace('1)', '.2)'), canvas.fill()\n\n        canvas.resetTransform()\n        canvas.setStroke(color, 2)\n        showHit ? canvas.stroke() : canvas.strokeWorld(w, color)\n    }\n\n\n    log(...messages: unknown[]): void {\n        if (D.enable) {\n            if (D.filterList.length && D.filterList.every(name => name !== this.name)) return\n            if (D.excludeList.length && D.excludeList.some(name => name === this.name)) return\n            console.log('%c' + this.name, 'color:#21ae62', ...messages)\n        }\n    }\n\n    tip(...messages: unknown[]): void {\n        if (D.enable) this.warn(...messages)\n    }\n\n    warn(...messages: unknown[]): void {\n        if (D.showWarn) console.warn(this.name, ...messages)\n    }\n\n    repeat(name: string, ...messages: unknown[]) {\n        if (!this.repeatMap[name]) {\n            this.warn('repeat:' + name, ...messages)\n            this.repeatMap[name] = true\n        }\n    }\n\n    error(...messages: unknown[]): void {\n        try {\n            throw new Error()\n        } catch (e) {\n            console.error(this.name, ...messages, e)\n        }\n    }\n}\n\nfunction getNameList(name: string | string[]): string[] {\n    if (!name) name = []\n    else if (isString(name)) name = [name]\n    return name\n}\n\nconst D = Debug", "import { IncrementId } from '@leafer/math'\nimport { isUndefined } from '@leafer/data'\n\nimport { Debug } from './Debug'\n\n\ninterface ids {\n    [name: string]: number\n}\ninterface names {\n    [name: string]: string\n}\n\n\nconst debug = Debug.get('RunTime')\n\nexport const Run = {\n\n    currentId: 0,\n    currentName: '',\n\n    idMap: {} as ids,\n    nameMap: {} as names,\n    nameToIdMap: {} as ids,\n\n    start(name: string, microsecond?: boolean): number {\n        const id = IncrementId.create(IncrementId.RUNTIME)\n        R.currentId = R.idMap[id] = microsecond ? performance.now() : Date.now()\n        R.currentName = R.nameMap[id] = name\n        R.nameToIdMap[name] = id\n        return id\n    },\n\n    end(id: number, microsecond?: boolean): void {\n        const time = R.idMap[id], name = R.nameMap[id]\n        const duration = microsecond ? (performance.now() - time) / 1000 : Date.now() - time\n        R.idMap[id] = R.nameMap[id] = R.nameToIdMap[name] = undefined\n        debug.log(name, duration, 'ms')\n    },\n\n    endOfName(name: string, microsecond?: boolean): void {\n        const id = R.nameToIdMap[name]\n        if (!isUndefined(id)) R.end(id, microsecond)\n    }\n}\n\nconst R = Run", "import { IBooleanMap } from '@leafer/interface'\n\n\nconst check = [] as string[]\n\nexport const Plugin = {\n\n    list: {} as IBooleanMap,\n\n    add(name: string, ...needPlugins: string[]) {\n        this.list[name] = true\n        check.push(...needPlugins)\n    },\n\n    has(name: string, tip?: boolean): boolean {\n        const rs = this.list[name]\n        if (!rs && tip) this.need(name)\n        return rs\n    },\n\n    need(name: string): any {\n        console.error('please install and import plugin: ' + (name.includes('-x') ? '' : '@leafer-in/') + name)\n    }\n\n}\n\nsetTimeout(() => check.forEach(name => Plugin.has(name, true)))", "import { ICreator, IObject, ILeaf } from '@leafer/interface'\nimport { Plugin } from '@leafer/debug'\n\n\nexport const Creator: ICreator = {\n    editor(_options?: IObject): ILeaf {\n        return Plugin.need('editor')\n    }\n}", "import { ILeaf, IObject } from '@leafer/interface'\nimport { isUndefined } from '@leafer/data'\nimport { Debug } from '@leafer/debug'\n\n\nconst debug = Debug.get('UICreator')\n\nexport const UICreator = {\n\n    list: {} as IObject,\n\n    register(UI: IObject): void {\n        const { __tag: tag } = UI.prototype as ILeaf\n        if (list[tag]) debug.repeat(tag)\n        list[tag] = UI\n    },\n\n    get(tag: string, data?: IObject, x?: number, y?: number, width?: number, height?: number): ILeaf {\n        if (!list[tag]) debug.error('not register ' + tag)\n        const ui = new list[tag](data)\n        if (!isUndefined(x)) {\n            ui.x = x\n            if (y) ui.y = y\n            if (width) ui.width = width\n            if (height) ui.height = height\n        }\n        return ui\n    }\n\n}\n\nconst { list } = UICreator", "import { IEvent, IObject } from '@leafer/interface'\nimport { isString } from '@leafer/data'\nimport { Debug } from '@leafer/debug'\n\n\nconst debug = Debug.get('EventCreator')\n\nexport const EventCreator = {\n\n    nameList: {} as IObject,\n\n    register(Event: IObject): void {\n        let name: string\n        Object.keys(Event).forEach(key => {\n            name = Event[key]\n            if (isString(name)) nameList[name] && debug.repeat(name), nameList[name] = Event\n        })\n    },\n\n    changeName(oldName: string, newName: string): void {\n        const Event = nameList[oldName]\n        if (Event) {\n            const constName = Object.keys(Event).find(key => Event[key] === oldName)\n            if (constName) {\n                Event[constName] = newName\n                nameList[newName] = Event\n            }\n        }\n    },\n\n    has(type: string): boolean {\n        return !!this.nameList[type]\n    },\n\n    get(type: string, ...params: unknown[]): IEvent {\n        return new nameList[type](...params)\n    }\n\n}\n\nconst { nameList } = EventCreator", "import { ILeaferCanvas, IScreenSizeData, ICanvasManager } from '@leafer/interface'\nimport { Creator } from '@leafer/platform'\n\nexport class CanvasManager implements ICanvasManager {\n\n    public list: ILeaferCanvas[] = []\n\n    public add(canvas: ILeaferCanvas): void {\n        canvas.manager = this\n        this.list.push(canvas)\n    }\n\n    public get(size: IScreenSizeData): ILeaferCanvas {\n        let old: ILeaferCanvas\n        const { list } = this\n        for (let i = 0, len = list.length; i < len; i++) {\n            old = list[i]\n            if (old.recycled && old.isSameSize(size)) {\n                old.recycled = false\n                old.manager || (old.manager = this)\n                return old\n            }\n        }\n\n        const canvas = Creator.canvas(size)\n        this.add(canvas)\n        return canvas\n    }\n\n    public recycle(old: ILeaferCanvas): void {\n        old.recycled = true\n    }\n\n    public clearRecycled(): void {\n        let canvas: ILeaferCanvas\n        const filter: ILeaferCanvas[] = []\n        for (let i = 0, len = this.list.length; i < len; i++) {\n            canvas = this.list[i]\n            canvas.recycled ? canvas.destroy() : filter.push(canvas)\n        }\n        this.list = filter\n    }\n\n    public clear(): void {\n        this.list.forEach(item => { item.destroy() })\n        this.list.length = 0\n    }\n\n    public destroy(): void {\n        this.clear()\n    }\n\n}", "/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\r\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\r\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\r\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\r\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\r\n    var _, done = false;\r\n    for (var i = decorators.length - 1; i >= 0; i--) {\r\n        var context = {};\r\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\r\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\r\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\r\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\r\n        if (kind === \"accessor\") {\r\n            if (result === void 0) continue;\r\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\r\n            if (_ = accept(result.get)) descriptor.get = _;\r\n            if (_ = accept(result.set)) descriptor.set = _;\r\n            if (_ = accept(result.init)) initializers.unshift(_);\r\n        }\r\n        else if (_ = accept(result)) {\r\n            if (kind === \"field\") initializers.unshift(_);\r\n            else descriptor[key] = _;\r\n        }\r\n    }\r\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\r\n    done = true;\r\n};\r\n\r\nexport function __runInitializers(thisArg, initializers, value) {\r\n    var useValue = arguments.length > 2;\r\n    for (var i = 0; i < initializers.length; i++) {\r\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\r\n    }\r\n    return useValue ? value : void 0;\r\n};\r\n\r\nexport function __propKey(x) {\r\n    return typeof x === \"symbol\" ? x : \"\".concat(x);\r\n};\r\n\r\nexport function __setFunctionName(f, name, prefix) {\r\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\r\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\r\n};\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\r\n    return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\r\n    function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nvar ownKeys = function(o) {\r\n    ownKeys = Object.getOwnPropertyNames || function (o) {\r\n        var ar = [];\r\n        for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\r\n        return ar;\r\n    };\r\n    return ownKeys(o);\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n\r\nexport function __addDisposableResource(env, value, async) {\r\n    if (value !== null && value !== void 0) {\r\n        if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\r\n        var dispose, inner;\r\n        if (async) {\r\n            if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\r\n            dispose = value[Symbol.asyncDispose];\r\n        }\r\n        if (dispose === void 0) {\r\n            if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\r\n            dispose = value[Symbol.dispose];\r\n            if (async) inner = dispose;\r\n        }\r\n        if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\r\n        if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\r\n        env.stack.push({ value: value, dispose: dispose, async: async });\r\n    }\r\n    else if (async) {\r\n        env.stack.push({ async: true });\r\n    }\r\n    return value;\r\n\r\n}\r\n\r\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\r\n\r\nexport function __disposeResources(env) {\r\n    function fail(e) {\r\n        env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\r\n        env.hasError = true;\r\n    }\r\n    var r, s = 0;\r\n    function next() {\r\n        while (r = env.stack.pop()) {\r\n            try {\r\n                if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\r\n                if (r.dispose) {\r\n                    var result = r.dispose.call(r.value);\r\n                    if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\r\n                }\r\n                else s |= 1;\r\n            }\r\n            catch (e) {\r\n                fail(e);\r\n            }\r\n        }\r\n        if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\r\n        if (env.hasError) throw env.error;\r\n    }\r\n    return next();\r\n}\r\n\r\nexport function __rewriteRelativeImportExtension(path, preserveJsx) {\r\n    if (typeof path === \"string\" && /^\\.\\.?\\//.test(path)) {\r\n        return path.replace(/\\.(tsx)$|((?:\\.d)?)((?:\\.[^./]+?)?)\\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {\r\n            return tsx ? preserveJsx ? \".jsx\" : \".js\" : d && (!ext || !cm) ? m : (d + ext + \".\" + cm.toLowerCase() + \"js\");\r\n        });\r\n    }\r\n    return path;\r\n}\r\n\r\nexport default {\r\n    __extends: __extends,\r\n    __assign: __assign,\r\n    __rest: __rest,\r\n    __decorate: __decorate,\r\n    __param: __param,\r\n    __esDecorate: __esDecorate,\r\n    __runInitializers: __runInitializers,\r\n    __propKey: __propKey,\r\n    __setFunctionName: __setFunctionName,\r\n    __metadata: __metadata,\r\n    __awaiter: __awaiter,\r\n    __generator: __generator,\r\n    __createBinding: __createBinding,\r\n    __exportStar: __exportStar,\r\n    __values: __values,\r\n    __read: __read,\r\n    __spread: __spread,\r\n    __spreadArrays: __spreadArrays,\r\n    __spreadArray: __spreadArray,\r\n    __await: __await,\r\n    __asyncGenerator: __asyncGenerator,\r\n    __asyncDelegator: __asyncDelegator,\r\n    __asyncValues: __asyncValues,\r\n    __makeTemplateObject: __makeTemplateObject,\r\n    __importStar: __importStar,\r\n    __importDefault: __importDefault,\r\n    __classPrivateFieldGet: __classPrivateFieldGet,\r\n    __classPrivateFieldSet: __classPrivateFieldSet,\r\n    __classPrivateFieldIn: __classPrivateFieldIn,\r\n    __addDisposableResource: __addDisposableResource,\r\n    __disposeResources: __disposeResources,\r\n    __rewriteRelativeImportExtension: __rewriteRelativeImportExtension,\r\n};\r\n", "import { ICanvasAttr, ITextMetrics, ICanvasContext2D, IPath2D, IObject, InnerId, IMatrixData, IFunction, IWindingRule, IBlendMode } from '@leafer/interface'\nimport { isObject } from '@leafer/data'\n\n\nfunction contextAttr(realName?: string) {\n    return (target: Canvas, key: string) => {\n        if (!realName) realName = key\n        const property = {\n            get() { return ((this as unknown as Canvas).context as IObject)[realName] },\n            set(value: unknown) { ((this as unknown as Canvas).context as IObject)[realName] = value }\n        }\n        if (key === 'strokeCap') (property as any).set = function (value: unknown) { ((this as unknown as Canvas).context as IObject)[realName] = value === 'none' ? 'butt' : value }\n        Object.defineProperty(target, key, property)\n    }\n}\n\nconst contextMethodNameList: string[] = []\nfunction contextMethod() {\n    return (_target: Canvas, key: string) => {\n        contextMethodNameList.push(key)\n    }\n}\n\nconst emptyArray: number[] = []\n\n\nexport class Canvas implements ICanvasAttr {\n\n    public readonly innerId: InnerId\n\n    public context: ICanvasContext2D\n\n    // canvas attr\n\n    @contextAttr('imageSmoothingEnabled')\n    public smooth: boolean\n\n    @contextAttr('imageSmoothingQuality')\n    public smoothLevel: ImageSmoothingQuality\n\n    @contextAttr('globalAlpha')\n    public opacity: number\n\n    public set blendMode(value: IBlendMode) {\n        if (value === 'normal') value = 'source-over'\n        this.context.globalCompositeOperation = value as any\n    }\n\n    public get blendMode(): IBlendMode {\n        return this.context.globalCompositeOperation as IBlendMode\n    }\n\n    @contextAttr()\n    public fillStyle: string | object\n\n    @contextAttr()\n    public strokeStyle: string | object\n\n\n    @contextAttr('lineWidth')\n    public strokeWidth: number\n\n    @contextAttr('lineCap')\n    public strokeCap: string\n\n    @contextAttr('lineJoin')\n    public strokeJoin: string\n\n    public set dashPattern(value: number[]) {\n        this.context.setLineDash(value || emptyArray)\n    }\n    public get dashPattern(): number[] {\n        return this.context.getLineDash()\n    }\n\n    @contextAttr('lineDashOffset')\n    public dashOffset: number\n\n    @contextAttr()\n    public miterLimit: number\n\n\n    @contextAttr()\n    public shadowBlur: number\n\n    @contextAttr()\n    public shadowColor: string\n\n    @contextAttr()\n    public shadowOffsetX: number\n\n    @contextAttr()\n    public shadowOffsetY: number\n\n    @contextAttr()\n    public filter: string\n\n\n    @contextAttr()\n    public font: string\n\n    @contextAttr()\n    public fontKerning: string\n\n    @contextAttr()\n    public fontStretch: string\n\n    @contextAttr()\n    public fontVariantCaps: string\n\n\n    @contextAttr()\n    public textAlign: string\n\n    @contextAttr()\n    public textBaseline: string\n\n    @contextAttr()\n    public textRendering: string\n\n    @contextAttr()\n    public wordSpacing: string\n\n    @contextAttr()\n    public letterSpacing: string\n\n\n    @contextAttr()\n    public direction: string\n\n    // end\n\n    public __bindContext(): void {\n        let method: IFunction\n        contextMethodNameList.forEach(name => {\n            method = (this.context as IObject)[name]\n            if (method) (this as IObject)[name] = method.bind(this.context)\n        })\n        this.textBaseline = \"alphabetic\"\n    }\n\n    // canvas method\n\n    @contextMethod()\n    public setTransform(_a: number | IMatrixData, _b?: number, _c?: number, _d?: number, _e?: number, _f?: number): void { }\n\n    @contextMethod()\n    public resetTransform(): void { }\n\n    @contextMethod()\n    public getTransform(): IMatrixData { return void 0 }\n\n    @contextMethod()\n    public save(): void { }\n\n    @contextMethod()\n    public restore(): void { }\n\n    public transform(a: number | IMatrixData, b?: number, c?: number, d?: number, e?: number, f?: number): void {\n        if (isObject(a)) {\n            this.context.transform(a.a, a.b, a.c, a.d, a.e, a.f)\n        } else {\n            this.context.transform(a, b, c, d, e, f)\n        }\n    }\n\n    @contextMethod()\n    public translate(_x: number, _y: number): void { }\n\n    @contextMethod()\n    public scale(_x: number, _y: number): void { }\n\n    @contextMethod()\n    public rotate(_angle: number): void { }\n\n    @contextMethod()\n    public fill(_path2d?: IPath2D | IWindingRule, _rule?: IWindingRule): void { }\n\n    @contextMethod()\n    public stroke(_path2d?: IPath2D): void { }\n\n    @contextMethod()\n    public clip(_path2d?: IPath2D | IWindingRule, _rule?: IWindingRule): void { }\n\n    @contextMethod()\n    public fillRect(_x: number, _y: number, _width: number, _height: number): void { }\n\n    @contextMethod()\n    public strokeRect(_x: number, _y: number, _width: number, _height: number): void { }\n\n    @contextMethod()\n    public clearRect(_x: number, _y: number, _width: number, _height: number): void { }\n\n    public drawImage(image: CanvasImageSource, sx: number, sy: number, sw?: number, sh?: number, dx?: number, dy?: number, dw?: number, dh?: number): void {\n        switch (arguments.length) {\n            case 9:\n\n                // safari: drawimage裁剪画布外的坐标会有问题, 必须是不小于0的坐标点\n                if (sx < 0) {\n                    const d = (-sx / sw) * dw\n                    sw += sx\n                    sx = 0\n                    dx += d\n                    dw -= d\n                }\n\n                if (sy < 0) {\n                    const d = (-sy / sh) * dh\n                    sh += sy\n                    sy = 0\n                    dy += d\n                    dh -= d\n                }\n\n                this.context.drawImage(image, sx, sy, sw, sh, dx, dy, dw, dh)\n                break\n            case 5:\n                this.context.drawImage(image, sx, sy, sw, sh) // = dx, dy, dw, dh\n                break\n            case 3:\n                this.context.drawImage(image, sx, sy)\n        }\n    }\n\n\n    // canvas draw\n    @contextMethod()\n    public beginPath(): void { }\n\n    @contextMethod()\n    public moveTo(_x: number, _y: number): void { }\n\n    @contextMethod()\n    public lineTo(_x: number, _y: number): void { }\n\n    @contextMethod()\n    public bezierCurveTo(_cp1x: number, _cp1y: number, _cp2x: number, _cp2y: number, _x: number, _y: number): void { }\n\n    @contextMethod()\n    public quadraticCurveTo(_cpx: number, _cpy: number, _x: number, _y: number): void { }\n\n    @contextMethod()\n    public closePath(): void { }\n\n    @contextMethod()\n    public arc(_x: number, _y: number, _radius: number, _startAngle: number, _endAngle: number, _anticlockwise?: boolean): void { }\n\n    @contextMethod()\n    public arcTo(_x1: number, _y1: number, _x2: number, _y2: number, _radius: number): void { }\n\n    @contextMethod()\n    public ellipse(_x: number, _y: number, _radiusX: number, _radiusY: number, _rotation: number, _startAngle: number, _endAngle: number, _anticlockwise?: boolean): void { }\n\n    @contextMethod()\n    public rect(_x: number, _y: number, _width: number, _height: number): void { }\n\n    @contextMethod()\n    public roundRect(_x: number, _y: number, _width: number, _height: number, _radius?: number | number[]): void { }\n\n    // end canvas draw\n\n    // paint\n\n    @contextMethod()\n    public createConicGradient(_startAngle: number, _x: number, _y: number): CanvasGradient { return void 0 }\n\n    @contextMethod()\n    public createLinearGradient(_x0: number, _y0: number, _x1: number, _y1: number): CanvasGradient { return void 0 }\n\n    @contextMethod()\n    public createPattern(_image: CanvasImageSource, _repetition: string | null): CanvasPattern | null { return void 0 }\n\n    @contextMethod()\n    public createRadialGradient(_x0: number, _y0: number, _r0: number, _x1: number, _y1: number, _r1: number): CanvasGradient { return void 0 }\n\n    // text\n    @contextMethod()\n    public fillText(_text: string, _x: number, _y: number, _maxWidth?: number): void { }\n\n    @contextMethod()\n    public measureText(_text: string): ITextMetrics { return void 0 }\n\n    @contextMethod()\n    public strokeText(_text: string, _x: number, _y: number, _maxWidth?: number): void { }\n\n    public destroy(): void {\n        this.context = null\n    }\n}", "import { IBounds, ILeaferCanvas, ICanvasStrokeOptions, ILeaferCanvasConfig, IWindingRuleData, IExportOptions, IMatrixData, IBoundsData, IAutoBounds, IScreenSizeData, IResizeEventListener, IMatrixWithBoundsData, IPointData, InnerId, ICanvasManager, IWindingRule, IBlendMode, IExportImageType, IExportFileType, IBlob, ICursorType, ILeaferCanvasView, IRadiusPointData, IObject, IMatrixWithOptionHalfData } from '@leafer/interface'\nimport { Bounds, BoundsHelper, MatrixHelper, IncrementId } from '@leafer/math'\nimport { Creator, Platform } from '@leafer/platform'\nimport { DataHelper, isUndefined } from '@leafer/data'\n\nimport { Canvas } from './Canvas'\n\n\nconst { copy, multiplyParent, pixelScale } = MatrixHelper, { round } = Math, tempPixelBounds = new Bounds(), tempPixelBounds2 = new Bounds()\nconst minSize: IScreenSizeData = { width: 1, height: 1, pixelRatio: 1 }\n\nexport const canvasSizeAttrs = ['width', 'height', 'pixelRatio']\n\nexport class LeaferCanvasBase extends Canvas implements ILeaferCanvas {\n\n    declare public readonly innerId: InnerId\n\n    public name: string\n\n    public manager: ICanvasManager\n\n    public size: IScreenSizeData = {} as IScreenSizeData\n\n    public get width(): number { return this.size.width }\n    public get height(): number { return this.size.height }\n\n    public get pixelRatio(): number { return this.size.pixelRatio }\n    public get pixelWidth(): number { return this.width * this.pixelRatio || 0 } // 防止出现 NaN\n    public get pixelHeight(): number { return this.height * this.pixelRatio || 0 }\n\n    public get pixelSnap(): boolean { return this.config.pixelSnap }\n    public set pixelSnap(value: boolean) { this.config.pixelSnap = value }\n\n    public get allowBackgroundColor(): boolean { return this.view && this.parentView }\n\n    public bounds: IBounds\n    public clientBounds: IBoundsData\n\n    public config: ILeaferCanvasConfig\n\n    public autoLayout: boolean\n\n    public view: ILeaferCanvasView\n    public parentView: any\n\n    public unreal?: boolean\n\n    public recycled?: boolean\n\n    public worldTransform: IMatrixData = {} as IMatrixData\n\n    protected savedBlendMode: IBlendMode\n\n    constructor(config?: ILeaferCanvasConfig, manager?: ICanvasManager) {\n        super()\n        if (!config) config = minSize\n\n        this.manager = manager\n        this.innerId = IncrementId.create(IncrementId.CNAVAS)\n\n        const { width, height, pixelRatio } = config\n        this.autoLayout = !width || !height\n\n        this.size.pixelRatio = pixelRatio || Platform.devicePixelRatio\n        this.config = config\n\n        this.init()\n    }\n\n    public init(): void { }\n\n    public __createContext(): void {\n        const { view } = this\n        const { contextSettings } = this.config\n        this.context = contextSettings ? view.getContext('2d', contextSettings) : view.getContext('2d')\n        this.__bindContext()\n    }\n\n    // @leafer-in/export rewrite\n\n    public export(_filename: IExportFileType | string, _options?: IExportOptions | number | boolean): string | Promise<any> { return undefined }\n\n    public toBlob(_type?: IExportFileType, _quality?: number): Promise<IBlob> { return undefined }\n\n    public toDataURL(_type?: IExportImageType, _quality?: number): string | Promise<string> { return undefined }\n\n    public saveAs(_filename: string, _quality?: number): Promise<boolean> { return undefined }\n\n    // ---\n\n    public resize(size: IScreenSizeData, safeResize = true): void {\n        if (this.isSameSize(size)) return\n\n        let takeCanvas: ILeaferCanvas\n        if (this.context && !this.unreal && safeResize && this.width) {\n            takeCanvas = this.getSameCanvas()\n            takeCanvas.copyWorld(this)\n        }\n\n        const s = this.size as IObject\n        DataHelper.copyAttrs(s, size, canvasSizeAttrs)\n        canvasSizeAttrs.forEach(key => s[key] || (s[key] = 1)) // fix: width = 0 or height = 0\n\n        this.bounds = new Bounds(0, 0, this.width, this.height)\n\n        this.updateViewSize()\n        this.updateClientBounds()\n\n        if (this.context) {\n\n            this.smooth = this.config.smooth\n\n            if (!this.unreal && takeCanvas) {\n                this.clearWorld(takeCanvas.bounds)\n                this.copyWorld(takeCanvas)\n                takeCanvas.recycle()\n            }\n\n        }\n\n    }\n\n    public updateViewSize(): void { }\n    public updateClientBounds(): void { }\n    public getClientBounds(update?: boolean): IBoundsData {\n        if (update) this.updateClientBounds()\n        return this.clientBounds || this.bounds\n    }\n\n    public startAutoLayout(_autoBounds: IAutoBounds, _listener: IResizeEventListener): void { }\n    public stopAutoLayout(): void { }\n\n    public setCursor(_cursor: ICursorType | ICursorType[]): void { }\n\n    public setWorld(matrix: IMatrixWithOptionHalfData, parentMatrix?: IMatrixData): void {\n        const { pixelRatio, pixelSnap } = this, w = this.worldTransform\n\n        if (parentMatrix) multiplyParent(matrix, parentMatrix, w)\n        pixelScale(matrix, pixelRatio, w)\n\n        if (pixelSnap && !matrix.ignorePixelSnap) {\n            if (matrix.half && (matrix.half * pixelRatio) % 2) w.e = round(w.e - 0.5) + 0.5, w.f = round(w.f - 0.5) + 0.5\n            else w.e = round(w.e), w.f = round(w.f)\n        }\n\n        this.setTransform(w.a, w.b, w.c, w.d, w.e, w.f)\n    }\n\n    public useWorldTransform(worldTransform?: IMatrixData): void {\n        if (worldTransform) this.worldTransform = worldTransform\n        const w = this.worldTransform\n        if (w) this.setTransform(w.a, w.b, w.c, w.d, w.e, w.f)\n    }\n\n    public setStroke(color: string | object, strokeWidth: number, options?: ICanvasStrokeOptions, childOptions?: ICanvasStrokeOptions): void {\n        if (strokeWidth) this.strokeWidth = strokeWidth\n        if (color) this.strokeStyle = color\n        if (options) this.setStrokeOptions(options, childOptions)\n    }\n\n    public setStrokeOptions(options: ICanvasStrokeOptions, childOptions?: ICanvasStrokeOptions): void {\n        let { strokeCap, strokeJoin, dashPattern, dashOffset, miterLimit } = options\n        if (childOptions) {\n            if (childOptions.strokeCap) strokeCap = childOptions.strokeCap\n            if (childOptions.strokeJoin) strokeJoin = childOptions.strokeJoin\n            if (!isUndefined(childOptions.dashPattern)) dashPattern = childOptions.dashPattern\n            if (!isUndefined(childOptions.dashOffset)) dashOffset = childOptions.dashOffset\n            if (childOptions.miterLimit) miterLimit = childOptions.miterLimit\n        }\n        this.strokeCap = strokeCap\n        this.strokeJoin = strokeJoin\n        this.dashPattern = dashPattern\n        this.dashOffset = dashOffset\n        this.miterLimit = miterLimit\n    }\n\n    public saveBlendMode(blendMode: IBlendMode): void {\n        this.savedBlendMode = this.blendMode\n        this.blendMode = blendMode\n    }\n\n    public restoreBlendMode(): void {\n        this.blendMode = this.savedBlendMode\n    }\n\n    // @leafer-ui/interaction rewrite\n\n    public hitFill(_point: IPointData, _fillRule?: IWindingRule): boolean { return true }\n\n    public hitStroke(_point: IPointData, _strokeWidth?: number): boolean { return true }\n\n    public hitPixel(_radiusPoint: IRadiusPointData, _offset?: IPointData, _scale = 1): boolean { return true }\n\n    // ---\n\n    public setWorldShadow(x: number, y: number, blur: number, color?: string): void {\n        const { pixelRatio } = this\n        this.shadowOffsetX = x * pixelRatio\n        this.shadowOffsetY = y * pixelRatio\n        this.shadowBlur = blur * pixelRatio\n        this.shadowColor = color || 'black'\n    }\n\n    public setWorldBlur(blur: number): void {\n        const { pixelRatio } = this\n        this.filter = `blur(${blur * pixelRatio}px)`\n    }\n\n\n    public copyWorld(canvas: ILeaferCanvas, from?: IBoundsData, to?: IBoundsData, blendMode?: IBlendMode, ceilPixel?: boolean): void {\n        if (blendMode) this.blendMode = blendMode\n        if (from) {\n            this.setTempPixelBounds(from, ceilPixel)\n            if (!to) to = tempPixelBounds // to = from\n            else this.setTempPixelBounds2(to, ceilPixel), to = tempPixelBounds2\n\n            this.drawImage(canvas.view as HTMLCanvasElement, tempPixelBounds.x, tempPixelBounds.y, tempPixelBounds.width, tempPixelBounds.height, to.x, to.y, to.width, to.height)\n        } else {\n            this.drawImage(canvas.view as HTMLCanvasElement, 0, 0)\n        }\n        if (blendMode) this.blendMode = 'source-over'\n    }\n\n    public copyWorldToInner(canvas: ILeaferCanvas, fromWorld: IMatrixWithBoundsData, toInnerBounds: IBoundsData, blendMode?: IBlendMode, ceilPixel?: boolean): void {\n        if (fromWorld.b || fromWorld.c) {\n            this.save()\n            this.resetTransform()\n            this.copyWorld(canvas, fromWorld, BoundsHelper.tempToOuterOf(toInnerBounds, fromWorld), blendMode, ceilPixel)\n            this.restore()\n        } else {\n            if (blendMode) this.blendMode = blendMode\n            this.setTempPixelBounds(fromWorld, ceilPixel)\n            this.drawImage(canvas.view as HTMLCanvasElement, tempPixelBounds.x, tempPixelBounds.y, tempPixelBounds.width, tempPixelBounds.height, toInnerBounds.x, toInnerBounds.y, toInnerBounds.width, toInnerBounds.height)\n            if (blendMode) this.blendMode = 'source-over'\n        }\n    }\n\n    public copyWorldByReset(canvas: ILeaferCanvas, from?: IBoundsData, to?: IBoundsData, blendMode?: IBlendMode, onlyResetTransform?: boolean, ceilPixel?: boolean): void {\n        this.resetTransform()\n        this.copyWorld(canvas, from, to, blendMode, ceilPixel)\n        if (!onlyResetTransform) this.useWorldTransform() // restore world transform\n    }\n\n    public useGrayscaleAlpha(bounds: IBoundsData): void { // 先实现功能，后期需通过 shader 优化性能\n        this.setTempPixelBounds(bounds, true, true)\n\n        let alpha: number, pixel: number\n        const { context } = this, imageData = context.getImageData(tempPixelBounds.x, tempPixelBounds.y, tempPixelBounds.width, tempPixelBounds.height), { data } = imageData\n\n        for (let i = 0, len = data.length; i < len; i += 4) {\n            pixel = data[i] * 0.299 + data[i + 1] * 0.587 + data[i + 2] * 0.114\n            if (alpha = data[i + 3]) data[i + 3] = alpha === 255 ? pixel : alpha * (pixel / 255)\n        }\n\n        context.putImageData(imageData, tempPixelBounds.x, tempPixelBounds.y)\n    }\n\n    public useMask(maskCanvas: ILeaferCanvas, fromBounds?: IBoundsData, toBounds?: IBoundsData): void {\n        this.copyWorld(maskCanvas, fromBounds, toBounds, 'destination-in')\n    }\n\n    public useEraser(eraserCanvas: ILeaferCanvas, fromBounds?: IBoundsData, toBounds?: IBoundsData): void {\n        this.copyWorld(eraserCanvas, fromBounds, toBounds, 'destination-out')\n    }\n\n    public fillWorld(bounds: IBoundsData, color: string | object, blendMode?: IBlendMode, ceilPixel?: boolean): void {\n        if (blendMode) this.blendMode = blendMode\n        this.fillStyle = color\n        this.setTempPixelBounds(bounds, ceilPixel)\n        this.fillRect(tempPixelBounds.x, tempPixelBounds.y, tempPixelBounds.width, tempPixelBounds.height)\n        if (blendMode) this.blendMode = 'source-over'\n    }\n\n    public strokeWorld(bounds: IBoundsData, color: string | object, blendMode?: IBlendMode, ceilPixel?: boolean): void {\n        if (blendMode) this.blendMode = blendMode\n        this.strokeStyle = color\n        this.setTempPixelBounds(bounds, ceilPixel)\n        this.strokeRect(tempPixelBounds.x, tempPixelBounds.y, tempPixelBounds.width, tempPixelBounds.height)\n        if (blendMode) this.blendMode = 'source-over'\n    }\n\n    public clipWorld(bounds: IBoundsData, ceilPixel: boolean = true): void {\n        this.beginPath()\n        this.setTempPixelBounds(bounds, ceilPixel)\n        this.rect(tempPixelBounds.x, tempPixelBounds.y, tempPixelBounds.width, tempPixelBounds.height)\n        this.clip()\n\n    }\n\n    public clipUI(ruleData: IWindingRuleData): void {\n        ruleData.windingRule ? this.clip(ruleData.windingRule) : this.clip()\n    }\n\n    public clearWorld(bounds: IBoundsData, ceilPixel: boolean = true): void {\n        this.setTempPixelBounds(bounds, ceilPixel)\n        this.clearRect(tempPixelBounds.x, tempPixelBounds.y, tempPixelBounds.width, tempPixelBounds.height)\n    }\n\n    public clear(): void {\n        const { pixelRatio } = this\n        this.clearRect(0, 0, this.width * pixelRatio + 2, this.height * pixelRatio + 2)\n    }\n\n\n    // other\n\n    protected setTempPixelBounds(bounds: IBoundsData, ceil?: boolean, intersect?: boolean): void {\n        this.copyToPixelBounds(tempPixelBounds, bounds, ceil, intersect)\n    }\n\n    protected setTempPixelBounds2(bounds: IBoundsData, ceil?: boolean, intersect?: boolean): void {\n        this.copyToPixelBounds(tempPixelBounds2, bounds, ceil, intersect)\n    }\n\n    protected copyToPixelBounds(pixelBounds: IBounds, bounds: IBoundsData, ceil?: boolean, intersect?: boolean): void {\n        pixelBounds.set(bounds)\n        if (intersect) pixelBounds.intersect(this.bounds)\n        pixelBounds.scale(this.pixelRatio)\n        if (ceil) pixelBounds.ceil()\n    }\n\n    public isSameSize(size: IScreenSizeData): boolean {\n        return this.width === size.width && this.height === size.height && (!size.pixelRatio || this.pixelRatio === size.pixelRatio)\n    }\n\n    // 需要有 manager变量\n    public getSameCanvas(useSameWorldTransform?: boolean, useSameSmooth?: boolean): ILeaferCanvas {\n        const { size, pixelSnap } = this, canvas = this.manager ? this.manager.get(size) : Creator.canvas({ ...size })\n        canvas.save()\n\n        if (useSameWorldTransform) copy(canvas.worldTransform, this.worldTransform), canvas.useWorldTransform()\n        if (useSameSmooth) canvas.smooth = this.smooth\n        canvas.pixelSnap !== pixelSnap && (canvas.pixelSnap = pixelSnap)\n\n        return canvas\n    }\n\n    public recycle(clearBounds?: IBoundsData): void {\n        if (!this.recycled) {\n            this.restore()\n            clearBounds ? this.clearWorld(clearBounds) : this.clear()\n            this.manager ? this.manager.recycle(this) : this.destroy()\n        }\n    }\n\n    public updateRender(_bounds?: IBoundsData): void { }\n\n    public unrealCanvas(): void { }\n\n    public destroy(): void {\n        this.manager = this.view = this.parentView = null\n    }\n}", "import { IPathCommandData, IPathCreator } from '@leafer/interface'\n\nexport const PathHelper = {\n    // index.ts rewrite\n    creator: {} as IPathCreator,\n    parse(_pathString: string, _curveMode?: boolean): IPathCommandData { return undefined },\n    convertToCanvasData(_old: IPathCommandData, _curveMode?: boolean): IPathCommandData { return undefined }\n}", "import { INumberMap, IStringMap } from '@leafer/interface'\n\nexport const CanvasCommandOnlyMap: INumberMap = {\n\n    N: 21, // rect\n    D: 22, // roundRect\n    X: 23, // simple roundRect\n    G: 24, // ellipse\n    F: 25, // simple ellipse\n    O: 26, // arc\n    P: 27, // simple arc\n    U: 28 // arcTo\n\n}\n\nexport const PathCommandMap: INumberMap = {\n\n    // svg and canvas\n\n    M: 1, // moveto\n    m: 10,\n    L: 2, // lineto\n    l: 20,\n    H: 3, // horizontal lineto\n    h: 30,\n    V: 4, // vertical lineto\n    v: 40,\n    C: 5, // curveto\n    c: 50,\n    S: 6, // smooth curveto\n    s: 60,\n    Q: 7, // quadratic Belzier curve\n    q: 70,\n    T: 8, // smooth quadratic Belzier curveto\n    t: 80,\n    A: 9, //e lliptical Arc\n    a: 90,\n    Z: 11, // closepath\n    z: 11,\n\n    R: 12,  // Catmull Rom\n\n    // canvas\n    ...CanvasCommandOnlyMap\n}\n\nexport const PathCommandLengthMap: INumberMap = {\n\n    M: 3, //moveto\n    m: 3,\n    L: 3, //lineto\n    l: 3,\n    H: 2, //horizontal lineto\n    h: 2,\n    V: 2, //vertical lineto\n    v: 2,\n    C: 7, //curveto\n    c: 7,\n    S: 5, //smooth curveto\n    s: 5,\n    Q: 5, //quadratic Belzier curve\n    q: 5,\n    T: 3, //smooth quadratic Belzier curveto\n    t: 3,\n    A: 8, //elliptical Arc\n    a: 8,\n    Z: 1, //closepath\n    z: 1,\n\n    // canvas\n\n    N: 5, // rect\n    D: 9, // roundRect\n    X: 6, // simple roundRect\n    G: 9, // ellipse\n    F: 5, // simple ellipse\n    O: 7, // arc\n    P: 4, // simple arc\n    U: 6 // arcTo\n\n}\n\nexport const NeedConvertToCanvasCommandMap: INumberMap = { // convert to:  M L C Q Z\n\n    // M: 1, //moveto\n    m: 10,\n    // L: 2, //lineto\n    l: 20,\n    H: 3, //horizontal lineto\n    h: 30,\n    V: 4, //vertical lineto\n    v: 40,\n    // C: 5, //curveto\n    c: 50,\n    S: 6, //smooth curveto\n    s: 60,\n    // Q: 7, //quadratic Belzier curve\n    q: 70,\n    T: 8, //smooth quadratic Belzier curveto\n    t: 80,\n    A: 9, //elliptical Arc\n    a: 90,\n    // Z: 11, //closepath\n    // z: 11\n\n}\n\n\nexport const NeedConvertToCurveCommandMap: INumberMap = {\n    ...NeedConvertToCanvasCommandMap,\n    ...CanvasCommandOnlyMap\n}\n\nconst P = PathCommandMap\n\nexport const PathNumberCommandMap: IStringMap = {}\nfor (let key in P) {\n    PathNumberCommandMap[P[key]] = key\n}\n// {1: 'M'}\n\nexport const PathNumberCommandLengthMap: INumberMap = {}\nfor (let key in P) {\n    PathNumberCommandLengthMap[P[key]] = PathCommandLengthMap[key]\n}\n// {1: 3}", "import { IPathDrawer } from '@leafer/interface'\nimport { MathHelper } from '@leafer/math'\n\nexport const RectHelper = {\n\n    drawRoundRect(drawer: IPathDrawer, x: number, y: number, width: number, height: number, cornerRadius: number | number[]): void {\n        const data = MathHelper.fourNumber(cornerRadius, Math.min(width / 2, height / 2))\n\n        const right = x + width\n        const bottom = y + height\n\n        data[0] ? drawer.moveTo(x + data[0], y) : drawer.moveTo(x, y)\n        data[1] ? drawer.arcTo(right, y, right, bottom, data[1]) : drawer.lineTo(right, y)\n        data[2] ? drawer.arcTo(right, bottom, x, bottom, data[2]) : drawer.lineTo(right, bottom)\n        data[3] ? drawer.arcTo(x, bottom, x, y, data[3]) : drawer.lineTo(x, bottom)\n        data[0] ? drawer.arcTo(x, y, right, y, data[0]) : drawer.lineTo(x, y)\n    }\n\n}", "import { IPointData, ITwoPointBoundsData, IPathCommandData } from '@leafer/interface'\nimport { OneRadian, PI2, PI_2, PointHelper, TwoPointBoundsHelper } from '@leafer/math'\n\nimport { PathCommandMap } from './PathCommandMap'\nimport { RectHelper } from './RectHelper'\nimport { PathHelper } from './PathHelper'\n\n\nconst { sin, cos, hypot, atan2, ceil, abs, PI, sqrt, pow } = Math\nconst { setPoint, addPoint } = TwoPointBoundsHelper\nconst { set, toNumberPoints } = PointHelper\nconst { M, L, C, Q, Z } = PathCommandMap\nconst tempPoint = {} as IPointData\n\nexport const BezierHelper = {\n\n    points(data: IPathCommandData, originPoints: number[] | IPointData[], curve?: boolean | number, close?: boolean): void {\n\n        let points = toNumberPoints(originPoints)\n\n        data.push(M, points[0], points[1])\n\n        if (curve && points.length > 5) {\n\n            let aX: number, aY: number, bX: number, bY: number, cX: number, cY: number, c1X: number, c1Y: number, c2X: number, c2Y: number\n            let baX: number, baY: number, ba: number, cb: number, d: number, len = points.length\n            const t = curve === true ? 0.5 : curve as number\n\n            if (close) {\n                points = [points[len - 2], points[len - 1], ...points, points[0], points[1], points[2], points[3]]\n                len = points.length\n            }\n\n            for (let i = 2; i < len - 2; i += 2) {\n                aX = points[i - 2]\n                aY = points[i - 1]\n\n                bX = points[i]\n                bY = points[i + 1]\n\n                cX = points[i + 2]\n                cY = points[i + 3]\n\n                baX = bX - aX\n                baY = bY - aY\n\n                ba = sqrt(pow(baX, 2) + pow(baY, 2))\n                cb = sqrt(pow(cX - bX, 2) + pow(cY - bY, 2))\n\n                if (!ba && !cb) continue\n\n                d = ba + cb\n                ba = (t * ba) / d\n                cb = (t * cb) / d\n\n                cX -= aX\n                cY -= aY\n\n                c1X = bX - ba * cX\n                c1Y = bY - ba * cY\n\n                if (i === 2) {\n                    if (!close) data.push(Q, c1X, c1Y, bX, bY)\n                } else {\n                    if (baX || baY) data.push(C, c2X, c2Y, c1X, c1Y, bX, bY) // 当前点与上一个点距离为0时，需要过滤\n                }\n\n                c2X = bX + cb * cX\n                c2Y = bY + cb * cY\n            }\n\n            if (!close) data.push(Q, c2X, c2Y, points[len - 2], points[len - 1])\n\n        } else {\n\n            for (let i = 2, len = points.length; i < len; i += 2) {\n                data.push(L, points[i], points[i + 1])\n            }\n\n        }\n\n        if (close) data.push(Z)\n    },\n\n    rect(data: IPathCommandData, x: number, y: number, width: number, height: number) {\n        PathHelper.creator.path = data\n        PathHelper.creator.moveTo(x, y).lineTo(x + width, y).lineTo(x + width, y + height).lineTo(x, y + height).lineTo(x, y)\n    },\n\n    roundRect(data: IPathCommandData, x: number, y: number, width: number, height: number, radius: number | number[]): void {\n        PathHelper.creator.path = []\n        RectHelper.drawRoundRect(PathHelper.creator, x, y, width, height, radius)\n        data.push(...PathHelper.convertToCanvasData(PathHelper.creator.path, true))\n    },\n\n    arcTo(data: IPathCommandData | null | void, fromX: number, fromY: number, x1: number, y1: number, toX: number, toY: number, radius: number, setPointBounds?: ITwoPointBoundsData, setEndPoint?: IPointData, setStartPoint?: IPointData): void {\n        const BAx = x1 - fromX\n        const BAy = y1 - fromY\n        const CBx = toX - x1\n        const CBy = toY - y1\n\n        let startRadian = atan2(BAy, BAx)\n        let endRadian = atan2(CBy, CBx)\n\n        const lenBA = hypot(BAx, BAy)\n        const lenCB = hypot(CBx, CBy)\n\n        let totalRadian = endRadian - startRadian\n        if (totalRadian < 0) totalRadian += PI2\n\n        if (lenBA < 1e-12 || lenCB < 1e-12 || totalRadian < 1e-12 || abs(totalRadian - PI) < 1e-12) {\n            if (data) data.push(L, x1, y1)\n            if (setPointBounds) {\n                setPoint(setPointBounds, fromX, fromY)\n                addPoint(setPointBounds, x1, y1)\n            }\n            if (setStartPoint) set(setStartPoint, fromX, fromY)\n            if (setEndPoint) set(setEndPoint, x1, y1)\n            return\n        }\n\n        const anticlockwise = BAx * CBy - CBx * BAy < 0\n        const sign = anticlockwise ? -1 : 1\n        const c = radius / cos(totalRadian / 2)\n\n        const centerX = x1 + c * cos(startRadian + totalRadian / 2 + PI_2 * sign)\n        const centerY = y1 + c * sin(startRadian + totalRadian / 2 + PI_2 * sign)\n        startRadian -= PI_2 * sign\n        endRadian -= PI_2 * sign\n\n        return ellipse(data, centerX, centerY, radius, radius, 0, startRadian / OneRadian, endRadian / OneRadian, anticlockwise, setPointBounds, setEndPoint, setStartPoint)\n    },\n\n    arc(data: IPathCommandData | null | void, x: number, y: number, radius: number, startAngle: number, endAngle: number, anticlockwise?: boolean, setPointBounds?: ITwoPointBoundsData, setEndPoint?: IPointData, setStartPoint?: IPointData): void {\n        return ellipse(data, x, y, radius, radius, 0, startAngle, endAngle, anticlockwise, setPointBounds, setEndPoint, setStartPoint)\n    },\n\n    ellipse(data: IPathCommandData | null | void, cx: number, cy: number, radiusX: number, radiusY: number, rotation: number, startAngle: number, endAngle: number, anticlockwise?: boolean, setPointBounds?: ITwoPointBoundsData, setEndPoint?: IPointData, setStartPoint?: IPointData): void {\n        const rotationRadian = rotation * OneRadian\n        const rotationSin = sin(rotationRadian)\n        const rotationCos = cos(rotationRadian)\n\n        let startRadian = startAngle * OneRadian\n        let endRadian = endAngle * OneRadian\n\n        if (startRadian > PI) startRadian -= PI2\n        if (endRadian < 0) endRadian += PI2\n\n        let totalRadian = endRadian - startRadian\n        if (totalRadian < 0) totalRadian += PI2\n        else if (totalRadian > PI2) totalRadian -= PI2\n\n        if (anticlockwise) totalRadian -= PI2\n\n\n        const parts = ceil(abs(totalRadian / PI_2))\n        const partRadian = totalRadian / parts\n        const partRadian4Sin = sin(partRadian / 4)\n        const control = 8 / 3 * partRadian4Sin * partRadian4Sin / sin(partRadian / 2)\n\n        endRadian = startRadian + partRadian\n\n        let startCos = cos(startRadian)\n        let startSin = sin(startRadian)\n        let endCos: number, endSin: number\n\n        let x: number, y: number, x1: number, y1: number, x2: number, y2: number\n\n        let startX = x = rotationCos * radiusX * startCos - rotationSin * radiusY * startSin\n        let startY = y = rotationSin * radiusX * startCos + rotationCos * radiusY * startSin\n\n        let fromX = cx + x, fromY = cy + y\n\n        if (data) data.push(data.length ? L : M, fromX, fromY)\n        if (setPointBounds) setPoint(setPointBounds, fromX, fromY)\n        if (setStartPoint) set(setStartPoint, fromX, fromY)\n\n        for (let i = 0; i < parts; i++) {\n\n            endCos = cos(endRadian)\n            endSin = sin(endRadian)\n\n            x = rotationCos * radiusX * endCos - rotationSin * radiusY * endSin\n            y = rotationSin * radiusX * endCos + rotationCos * radiusY * endSin\n            x1 = cx + startX - control * (rotationCos * radiusX * startSin + rotationSin * radiusY * startCos)\n            y1 = cy + startY - control * (rotationSin * radiusX * startSin - rotationCos * radiusY * startCos)\n            x2 = cx + x + control * (rotationCos * radiusX * endSin + rotationSin * radiusY * endCos)\n            y2 = cy + y + control * (rotationSin * radiusX * endSin - rotationCos * radiusY * endCos)\n\n            if (data) data.push(C, x1, y1, x2, y2, cx + x, cy + y)\n            if (setPointBounds) toTwoPointBounds(cx + startX, cy + startY, x1, y1, x2, y2, cx + x, cy + y, setPointBounds, true)\n\n            startX = x\n            startY = y\n            startCos = endCos\n            startSin = endSin\n            startRadian = endRadian\n            endRadian += partRadian\n        }\n\n        if (setEndPoint) set(setEndPoint, cx + x, cy + y)\n\n    },\n\n    quadraticCurveTo(data: IPathCommandData, fromX: number, fromY: number, x1: number, y1: number, toX: number, toY: number): void {\n        data.push(C, (fromX + 2 * x1) / 3, (fromY + 2 * y1) / 3, (toX + 2 * x1) / 3, (toY + 2 * y1) / 3, toX, toY)\n    },\n\n    toTwoPointBoundsByQuadraticCurve(fromX: number, fromY: number, x1: number, y1: number, toX: number, toY: number, pointBounds: ITwoPointBoundsData, addMode?: boolean): void {\n        toTwoPointBounds(fromX, fromY, (fromX + 2 * x1) / 3, (fromY + 2 * y1) / 3, (toX + 2 * x1) / 3, (toY + 2 * y1) / 3, toX, toY, pointBounds, addMode)\n    },\n\n    toTwoPointBounds(fromX: number, fromY: number, x1: number, y1: number, x2: number, y2: number, toX: number, toY: number, pointBounds: ITwoPointBoundsData, addMode?: boolean): void {\n\n        const tList = []\n        let a, b, c, t, t1, t2, v, sqrtV\n        let f = fromX, z1 = x1, z2 = x2, o = toX\n\n        for (let i = 0; i < 2; ++i) {\n\n            if (i == 1) {\n                f = fromY, z1 = y1, z2 = y2, o = toY\n            }\n\n            a = -3 * f + 9 * z1 - 9 * z2 + 3 * o\n            b = 6 * f - 12 * z1 + 6 * z2\n            c = 3 * z1 - 3 * f\n\n            if (Math.abs(a) < 1e-12) {\n                if (Math.abs(b) < 1e-12) continue\n                t = -c / b\n                if (0 < t && t < 1) tList.push(t)\n                continue\n            }\n\n            v = b * b - 4 * c * a\n            sqrtV = Math.sqrt(v)\n            if (v < 0) continue\n\n            t1 = (-b + sqrtV) / (2 * a)\n            if (0 < t1 && t1 < 1) tList.push(t1)\n            t2 = (-b - sqrtV) / (2 * a)\n            if (0 < t2 && t2 < 1) tList.push(t2)\n        }\n\n        addMode ? addPoint(pointBounds, fromX, fromY) : setPoint(pointBounds, fromX, fromY)\n        addPoint(pointBounds, toX, toY)\n\n        for (let i = 0, len = tList.length; i < len; i++) {\n            getPointAndSet(tList[i], fromX, fromY, x1, y1, x2, y2, toX, toY, tempPoint)\n            addPoint(pointBounds, tempPoint.x, tempPoint.y)\n        }\n\n    },\n\n    getPointAndSet(t: number, fromX: number, fromY: number, x1: number, y1: number, x2: number, y2: number, toX: number, toY: number, setPoint: IPointData): void {\n        const o = 1 - t, a = o * o * o, b = 3 * o * o * t, c = 3 * o * t * t, d = t * t * t\n        setPoint.x = a * fromX + b * x1 + c * x2 + d * toX\n        setPoint.y = a * fromY + b * y1 + c * y2 + d * toY\n    },\n\n    getPoint(t: number, fromX: number, fromY: number, x1: number, y1: number, x2: number, y2: number, toX: number, toY: number): IPointData {\n        const point = {} as IPointData\n        getPointAndSet(t, fromX, fromY, x1, y1, x2, y2, toX, toY, point)\n        return point\n    },\n\n    getDerivative(t: number, fromV: number, v1: number, v2: number, toV: number): number { // 导数\n        const o = 1 - t\n        return 3 * o * o * (v1 - fromV) + 6 * o * t * (v2 - v1) + 3 * t * t * (toV - v2)\n    },\n\n}\n\nconst { getPointAndSet, toTwoPointBounds, ellipse } = BezierHelper", "import { IPathCommandData } from '@leafer/interface'\nimport { OneRadian, PI2 } from '@leafer/math'\nimport { Platform } from '@leafer/platform'\n\nimport { PathCommandMap } from './PathCommandMap'\nimport { BezierHelper } from './BezierHelper'\n\n\nconst { sin, cos, sqrt, atan2 } = Math\nconst { ellipse } = BezierHelper\n\nexport const EllipseHelper = {\n\n    // svg \n    ellipticalArc(data: IPathCommandData, fromX: number, fromY: number, radiusX: number, radiusY: number, rotation: number, largeFlag: number, sweepFlag: number, toX: number, toY: number, curveMode?: boolean): void {\n\n        const halfX = (toX - fromX) / 2\n        const halfY = (toY - fromY) / 2\n\n        const rotationRadian = rotation * OneRadian\n        const rotationSin = sin(rotationRadian)\n        const rotationCos = cos(rotationRadian)\n\n        const px = -rotationCos * halfX - rotationSin * halfY\n        const py = -rotationCos * halfY + rotationSin * halfX\n        const rxSquare = radiusX * radiusX\n        const rySquare = radiusY * radiusY\n        const pySquare = py * py\n        const pxSquare = px * px\n\n        const a = rxSquare * rySquare - rxSquare * pySquare - rySquare * pxSquare\n        let s = 0\n\n        if (a < 0) {\n            const t = sqrt(1 - a / (rxSquare * rySquare))\n            radiusX *= t\n            radiusY *= t\n        } else {\n            s = (largeFlag === sweepFlag ? -1 : 1) * sqrt(a / (rxSquare * pySquare + rySquare * pxSquare))\n        }\n\n        const cx = s * radiusX * py / radiusY\n        const cy = -s * radiusY * px / radiusX\n\n        const startRadian = atan2((py - cy) / radiusY, (px - cx) / radiusX)\n        const endRadian = atan2((-py - cy) / radiusY, (-px - cx) / radiusX)\n\n        let totalRadian = endRadian - startRadian\n\n        if (sweepFlag === 0 && totalRadian > 0) {\n            totalRadian -= PI2\n        } else if (sweepFlag === 1 && totalRadian < 0) {\n            totalRadian += PI2\n        }\n\n        const centerX = fromX + halfX + rotationCos * cx - rotationSin * cy\n        const centerY = fromY + halfY + rotationSin * cx + rotationCos * cy\n\n        const anticlockwise = totalRadian < 0 ? 1 : 0\n\n        if (curveMode || Platform.ellipseToCurve) {\n            ellipse(data, centerX, centerY, radiusX, radiusY, rotation, startRadian / OneRadian, endRadian / OneRadian, anticlockwise as unknown as boolean)\n        } else {\n            if (radiusX === radiusY && !rotation) {\n                data.push(PathCommandMap.O, centerX, centerY, radiusX, startRadian / OneRadian, endRadian / OneRadian, anticlockwise)\n            } else {\n                data.push(PathCommandMap.G, centerX, centerY, radiusX, radiusY, rotation, startRadian / OneRadian, endRadian / OneRadian, anticlockwise)\n            }\n        }\n    }\n\n}\n", "import { IPathCommandNode, IPathCommandData, IPathNodeBase } from '@leafer/interface'\n\n// 路径节点辅助(适合可视化编辑)，提供接口（需重写）\nexport const PathCommandNodeHelper = {\n    toCommand(_nodes: IPathCommandNode[] | IPathNodeBase[]): IPathCommandData {\n        return []\n    },\n    toNode(_data: IPathCommandData): IPathCommandNode[] {\n        return []\n    }\n}", "import { IPathCommandData, IPathCommandNode, IPathCommandObject, IPointData } from '@leafer/interface'\nimport { MathHelper, StringNumberMap } from '@leafer/math'\nimport { Debug } from '@leafer/debug'\n\nimport { PathCommandMap as Command, NeedConvertToCanvasCommandMap, NeedConvertToCurveCommandMap, PathCommandLengthMap, PathNumberCommandMap, PathNumberCommandLengthMap } from './PathCommandMap'\nimport { BezierHelper } from './BezierHelper'\nimport { EllipseHelper } from './EllipseHelper'\nimport { PathCommandNodeHelper } from './PathCommandNodeHelper'\n\n\ninterface ICurrentCommand {\n    name?: number\n    length?: number\n    index?: number\n    dot?: number\n}\n\n\nconst { M, m, L, l, H, h, V, v, C, c, S, s, Q, q, T, t, A, a, Z, z, N, D, X, G, F, O, P, U } = Command\nconst { rect, roundRect, arcTo, arc, ellipse, quadraticCurveTo } = BezierHelper\nconst { ellipticalArc } = EllipseHelper\nconst debug = Debug.get('PathConvert')\n\nconst setEndPoint = {} as IPointData\n\nexport const PathConvert = {\n\n    current: { dot: 0 } as ICurrentCommand,\n\n    stringify(data: IPathCommandData, floatLength?: number): string {\n        let i = 0, len = data.length, count: number, str: string = '', command: number, lastCommand: number\n        while (i < len) {\n            command = data[i]\n            count = PathNumberCommandLengthMap[command]\n            if (command === lastCommand) {\n                str += ' ' // 重复的命令可以省略\n            } else {\n                str += PathNumberCommandMap[command]\n            }\n\n            for (let j = 1; j < count; j++) {\n                str += MathHelper.float(data[i + j], floatLength);\n                (j === count - 1) || (str += ' ')\n            }\n\n            lastCommand = command\n            i += count\n        }\n        return str\n    },\n\n    parse(pathString: string, curveMode?: boolean): IPathCommandData {\n\n        let needConvert: boolean, char: string, lastChar: string, num = ''\n        const data: IPathCommandData = []\n        const convertCommand = curveMode ? NeedConvertToCurveCommandMap : NeedConvertToCanvasCommandMap\n\n        for (let i = 0, len = pathString.length; i < len; i++) {\n\n            char = pathString[i]\n\n            if (StringNumberMap[char]) {\n\n                if (char === '.') {\n                    if (current.dot) { pushData(data, num); num = '' } //  .375.375\n                    current.dot++\n                }\n\n                if (num === '0' && char !== '.') { pushData(data, num); num = '' } //  00 01\n\n                num += char\n\n            } else if (Command[char]) {\n\n                if (num) { pushData(data, num); num = '' }\n\n                current.name = Command[char]\n                current.length = PathCommandLengthMap[char]\n                current.index = 0\n                pushData(data, current.name)\n\n                if (!needConvert && convertCommand[char]) needConvert = true\n\n            } else {\n\n                if (char === '-' || char === '+') {\n\n                    if (lastChar === 'e' || lastChar === 'E') { // L45e-12  21e+22\n                        num += char\n                    } else {\n                        if (num) pushData(data, num) // L-34-35 L+12+28\n                        num = char\n                    }\n\n                } else {\n                    if (num) { pushData(data, num); num = '' }\n                }\n\n            }\n\n            lastChar = char\n\n        }\n\n        if (num) pushData(data, num)\n\n        return needConvert ? PathConvert.toCanvasData(data, curveMode) : data\n    },\n\n    toCanvasData(old: IPathCommandData, curveMode?: boolean): IPathCommandData {\n\n        let x = 0, y = 0, x1 = 0, y1 = 0, i = 0, len = old.length, controlX: number, controlY: number, command: number, lastCommand: number, smooth: boolean\n        const data: IPathCommandData = []\n\n        while (i < len) {\n\n            command = old[i]\n\n            switch (command) {\n                //moveto(x, y)\n                case m:\n                    old[i + 1] += x\n                    old[i + 2] += y\n                case M:\n                    x = old[i + 1]\n                    y = old[i + 2]\n                    data.push(M, x, y)\n                    i += 3\n                    break\n\n                //horizontal lineto(x)\n                case h:\n                    old[i + 1] += x\n                case H:\n                    x = old[i + 1]\n                    data.push(L, x, y)\n                    i += 2\n                    break\n\n                //vertical lineto(y)\n                case v:\n                    old[i + 1] += y\n                case V:\n                    y = old[i + 1]\n                    data.push(L, x, y)\n                    i += 2\n                    break\n\n                //lineto(x,y)\n                case l:\n                    old[i + 1] += x\n                    old[i + 2] += y\n                case L:\n                    x = old[i + 1]\n                    y = old[i + 2]\n                    data.push(L, x, y)\n                    i += 3\n                    break\n\n                //smooth bezierCurveTo(x2, y2, x, y)\n                case s:  //smooth\n                    old[i + 1] += x\n                    old[i + 2] += y\n                    old[i + 3] += x\n                    old[i + 4] += y\n                    command = S\n                case S:\n                    smooth = (lastCommand === C) || (lastCommand === S)\n                    x1 = smooth ? (x * 2 - controlX) : old[i + 1]\n                    y1 = smooth ? (y * 2 - controlY) : old[i + 2]\n                    controlX = old[i + 1]\n                    controlY = old[i + 2]\n                    x = old[i + 3]\n                    y = old[i + 4]\n                    data.push(C, x1, y1, controlX, controlY, x, y)\n                    i += 5\n                    break\n\n                //bezierCurveTo(x1, y1, x2, y2, x, y)\n                case c:\n                    old[i + 1] += x\n                    old[i + 2] += y\n                    old[i + 3] += x\n                    old[i + 4] += y\n                    old[i + 5] += x\n                    old[i + 6] += y\n                    command = C\n                case C:\n                    controlX = old[i + 3]\n                    controlY = old[i + 4]\n                    x = old[i + 5]\n                    y = old[i + 6]\n                    data.push(C, old[i + 1], old[i + 2], controlX, controlY, x, y)\n                    i += 7\n                    break\n\n                //smooth quadraticCurveTo(x, y)\n                case t:\n                    old[i + 1] += x\n                    old[i + 2] += y\n                    command = T\n                case T:  //smooth\n                    smooth = (lastCommand === Q) || (lastCommand === T)\n                    controlX = smooth ? (x * 2 - controlX) : old[i + 1]\n                    controlY = smooth ? (y * 2 - controlY) : old[i + 2]\n                    curveMode ? quadraticCurveTo(data, x, y, controlX, controlY, old[i + 1], old[i + 2]) : data.push(Q, controlX, controlY, old[i + 1], old[i + 2])\n                    x = old[i + 1]\n                    y = old[i + 2]\n                    i += 3\n                    break\n\n                //quadraticCurveTo(x1, y1, x, y)\n                case q:\n                    old[i + 1] += x\n                    old[i + 2] += y\n                    old[i + 3] += x\n                    old[i + 4] += y\n                    command = Q\n                case Q:\n                    controlX = old[i + 1]\n                    controlY = old[i + 2]\n                    curveMode ? quadraticCurveTo(data, x, y, controlX, controlY, old[i + 3], old[i + 4]) : data.push(Q, controlX, controlY, old[i + 3], old[i + 4])\n                    x = old[i + 3]\n                    y = old[i + 4]\n                    i += 5\n                    break\n\n                //ellipticalArc(rx, ry, x-axis-rotation, large-arc-flag, sweep-flag, x, y)\n                case a:\n                    old[i + 6] += x\n                    old[i + 7] += y\n                case A:\n                    ellipticalArc(data, x, y, old[i + 1], old[i + 2], old[i + 3], old[i + 4], old[i + 5], old[i + 6], old[i + 7], curveMode) // convert to canvas ellipse or curve\n                    x = old[i + 6]\n                    y = old[i + 7]\n                    i += 8\n                    break\n                case z:\n                case Z:\n                    data.push(Z)\n                    i++\n                    break\n\n\n                // canvas command\n\n                case N: // rect(x, y, width, height)\n                    x = old[i + 1]\n                    y = old[i + 2]\n                    curveMode ? rect(data, x, y, old[i + 3], old[i + 4]) : copyData(data, old, i, 5)\n                    i += 5\n                    break\n                case D: // roundRect(x, y, width, height, radius1, radius2, radius3, radius4)\n                    x = old[i + 1]\n                    y = old[i + 2]\n                    curveMode ? roundRect(data, x, y, old[i + 3], old[i + 4], [old[i + 5], old[i + 6], old[i + 7], old[i + 8]]) : copyData(data, old, i, 9)\n                    i += 9\n                    break\n                case X: // simple roundRect(x, y, width, height, radius)\n                    x = old[i + 1]\n                    y = old[i + 2]\n                    curveMode ? roundRect(data, x, y, old[i + 3], old[i + 4], old[i + 5]) : copyData(data, old, i, 6)\n                    i += 6\n                    break\n                case G: // ellipse(x, y, radiusX, radiusY, rotation, startAngle, endAngle, anticlockwise)\n                    ellipse(curveMode ? data : copyData(data, old, i, 9), old[i + 1], old[i + 2], old[i + 3], old[i + 4], old[i + 5], old[i + 6], old[i + 7], old[i + 8] as unknown as boolean, null, setEndPoint)\n                    x = setEndPoint.x\n                    y = setEndPoint.y\n                    i += 9\n                    break\n                case F: // simple ellipse(x, y, radiusX, radiusY)\n                    curveMode ? ellipse(data, old[i + 1], old[i + 2], old[i + 3], old[i + 4], 0, 0, 360, false) : copyData(data, old, i, 5)\n                    x = old[i + 1] + old[i + 3]\n                    y = old[i + 2]\n                    i += 5\n                    break\n                case O: // arc(x, y, radius, startAngle, endAngle, anticlockwise)\n                    arc(curveMode ? data : copyData(data, old, i, 7), old[i + 1], old[i + 2], old[i + 3], old[i + 4], old[i + 5], old[i + 6] as unknown as boolean, null, setEndPoint)\n                    x = setEndPoint.x\n                    y = setEndPoint.y\n                    i += 7\n                    break\n                case P: //  simple arc(x, y, radius)\n                    curveMode ? arc(data, old[i + 1], old[i + 2], old[i + 3], 0, 360, false) : copyData(data, old, i, 4)\n                    x = old[i + 1] + old[i + 3]\n                    y = old[i + 2]\n                    i += 4\n                    break\n                case U: // arcTo(x1, y1, x2, y2, radius)\n                    arcTo(curveMode ? data : copyData(data, old, i, 6), x, y, old[i + 1], old[i + 2], old[i + 3], old[i + 4], old[i + 5], null, setEndPoint)\n                    x = setEndPoint.x\n                    y = setEndPoint.y\n                    i += 6\n                    break\n                default:\n                    debug.error(`command: ${command} [index:${i}]`, old)\n                    return data\n            }\n\n            lastCommand = command\n        }\n\n        return data\n\n    },\n\n    objectToCanvasData(list: IPathCommandNode[] | IPathCommandObject[]): IPathCommandData {\n        if (list[0].name.length > 1) { // nodes\n            return PathCommandNodeHelper.toCommand(list as IPathCommandNode[])\n        } else {\n            const data: IPathCommandData = []\n            list.forEach(item => {\n                switch (item.name) {\n                    case 'M': data.push(M, item.x, item.y); break\n                    case 'L': data.push(L, item.x, item.y); break\n                    case 'C': data.push(C, item.x1, item.y1, item.x2, item.y2, item.x, item.y); break\n                    case 'Q': data.push(Q, item.x1, item.y1, item.x, item.y); break\n                    case 'Z': data.push(Z)\n                }\n            })\n            return data\n        }\n    },\n\n    copyData(data: IPathCommandData, old: IPathCommandData, index: number, count: number): void {\n        for (let i = index, end = index + count; i < end; i++) {\n            data.push(old[i])\n        }\n    },\n\n    pushData(data: IPathCommandData, strNum: string | number) {\n        if (current.index === current.length) { // 单个命令，多个数据的情况\n            current.index = 1\n            data.push(current.name)\n        }\n\n        data.push(Number(strNum))\n        current.index++\n        current.dot = 0\n    }\n\n}\n\nconst { current, pushData, copyData } = PathConvert", "import { IPathCommandData, IPointData } from '@leafer/interface'\nimport { MathHelper, PointHelper } from '@leafer/math'\nimport { isNumber, isUndefined, isNull } from '@leafer/data'\n\nimport { PathCommandMap } from './PathCommandMap'\nimport { BezierHelper } from './BezierHelper'\n\n\nconst { M, L, C, Q, Z, N, D, X, G, F, O, P, U } = PathCommandMap\nconst { getMinDistanceFrom, getRadianFrom } = PointHelper\nconst { tan, min, abs } = Math\nconst startPoint = {} as IPointData\n\nexport const PathCommandDataHelper = {\n\n    beginPath(data: IPathCommandData): void {\n        data.length = 0\n    },\n\n    // svg and canvas\n\n    moveTo(data: IPathCommandData, x: number, y: number): void {\n        data.push(M, x, y)\n    },\n\n    lineTo(data: IPathCommandData, x: number, y: number): void {\n        data.push(L, x, y)\n    },\n\n    bezierCurveTo(data: IPathCommandData, x1: number, y1: number, x2: number, y2: number, x: number, y: number): void {\n        data.push(C, x1, y1, x2, y2, x, y)\n    },\n\n    quadraticCurveTo(data: IPathCommandData, x1: number, y1: number, x: number, y: number): void {\n        data.push(Q, x1, y1, x, y)\n    },\n\n    closePath(data: IPathCommandData): void {\n        data.push(Z)\n    },\n\n    // canvas\n\n    rect(data: IPathCommandData, x: number, y: number, width: number, height: number): void {\n        data.push(N, x, y, width, height)\n    },\n\n    roundRect(data: IPathCommandData, x: number, y: number, width: number, height: number, cornerRadius: number | number[]): void {\n        if (isNumber(cornerRadius)) {\n            data.push(X, x, y, width, height, cornerRadius)\n        } else {\n            const fourCorners = MathHelper.fourNumber(cornerRadius)\n            if (fourCorners) {\n                data.push(D, x, y, width, height, ...fourCorners)\n            } else {\n                data.push(N, x, y, width, height)\n            }\n        }\n    },\n\n    ellipse(data: IPathCommandData, x: number, y: number, radiusX: number, radiusY: number, rotation?: number, startAngle?: number, endAngle?: number, anticlockwise?: boolean): void {\n        if (radiusX === radiusY) return arc(data, x, y, radiusX, startAngle, endAngle, anticlockwise)\n        if (isNull(rotation)) {\n            data.push(F, x, y, radiusX, radiusY)\n        } else {\n            if (isNull(startAngle)) startAngle = 0\n            if (isNull(endAngle)) endAngle = 360\n            data.push(G, x, y, radiusX, radiusY, rotation, startAngle, endAngle, anticlockwise ? 1 : 0)\n        }\n    },\n\n    arc(data: IPathCommandData, x: number, y: number, radius: number, startAngle?: number, endAngle?: number, anticlockwise?: boolean): void {\n        if (isNull(startAngle)) {\n            data.push(P, x, y, radius)\n        } else {\n            if (isNull(startAngle)) startAngle = 0\n            if (isNull(endAngle)) endAngle = 360\n            data.push(O, x, y, radius, startAngle, endAngle, anticlockwise ? 1 : 0)\n        }\n    },\n\n    arcTo(data: IPathCommandData, x1: number, y1: number, x2: number, y2: number, radius: number, lastX?: number, lastY?: number): void {\n        if (!isUndefined(lastX)) {\n            const d = getMinDistanceFrom(lastX, lastY, x1, y1, x2, y2)\n            radius = min(radius, min(d / 2, d / 2 * abs(tan(getRadianFrom(lastX, lastY, x1, y1, x2, y2) / 2))))\n        }\n        data.push(U, x1, y1, x2, y2, radius)\n    },\n\n    // new\n\n    drawEllipse(data: IPathCommandData, x: number, y: number, radiusX: number, radiusY: number, rotation?: number, startAngle?: number, endAngle?: number, anticlockwise?: boolean): void {\n        BezierHelper.ellipse(null, x, y, radiusX, radiusY, isNull(rotation) ? 0 : rotation, isNull(startAngle) ? 0 : startAngle, isNull(endAngle) ? 360 : endAngle, anticlockwise, null, null, startPoint)\n        data.push(M, startPoint.x, startPoint.y)\n        ellipse(data, x, y, radiusX, radiusY, rotation, startAngle, endAngle, anticlockwise)\n    },\n\n    drawArc(data: IPathCommandData, x: number, y: number, radius: number, startAngle?: number, endAngle?: number, anticlockwise?: boolean): void {\n        BezierHelper.arc(null, x, y, radius, isNull(startAngle) ? 0 : startAngle, isNull(endAngle) ? 360 : endAngle, anticlockwise, null, null, startPoint)\n        data.push(M, startPoint.x, startPoint.y)\n        arc(data, x, y, radius, startAngle, endAngle, anticlockwise)\n    },\n\n    drawPoints(data: IPathCommandData, points: number[] | IPointData[], curve?: boolean | number, close?: boolean): void {\n        BezierHelper.points(data, points, curve, close)\n    }\n\n}\n\nconst { ellipse, arc } = PathCommandDataHelper\n", "import { IPathCommandData, IPathCreator, IPathString, IPointData } from '@leafer/interface'\nimport { isString } from '@leafer/data'\n\nimport { PathCommandDataHelper } from './PathCommandDataHelper'\nimport { PathHelper } from './PathHelper'\n\n\nconst { moveTo, lineTo, quadraticCurveTo, bezierCurveTo, closePath, beginPath, rect, roundRect, ellipse, arc, arcTo, drawEllipse, drawArc, drawPoints } = PathCommandDataHelper\n\nexport class PathCreator implements IPathCreator { //  tip: rewrited Pen\n\n    public set path(value: IPathCommandData) { this.__path = value }\n    public get path() { return this.__path }\n\n    public __path: IPathCommandData // 提供一个更安全的内部变量（比如覆盖给Pen时需要用到，避免与原有属性冲突）\n\n    constructor(path?: IPathCommandData | IPathString) {\n        this.set(path)\n    }\n\n    public set(path?: IPathCommandData | IPathString): PathCreator {\n        this.__path = path ? (isString(path) ? PathHelper.parse(path) : path) : []\n        return this\n    }\n\n    public beginPath(): PathCreator {\n        beginPath(this.__path)\n        this.paint()\n        return this\n    }\n\n    // svg and canvas\n\n    public moveTo(x: number, y: number): PathCreator {\n        moveTo(this.__path, x, y)\n        this.paint()\n        return this\n    }\n\n    public lineTo(x: number, y: number): PathCreator {\n        lineTo(this.__path, x, y)\n        this.paint()\n        return this\n    }\n\n    public bezierCurveTo(x1: number, y1: number, x2: number, y2: number, x: number, y: number): PathCreator {\n        bezierCurveTo(this.__path, x1, y1, x2, y2, x, y)\n        this.paint()\n        return this\n    }\n\n    public quadraticCurveTo(x1: number, y1: number, x: number, y: number): PathCreator {\n        quadraticCurveTo(this.__path, x1, y1, x, y)\n        this.paint()\n        return this\n    }\n\n    public closePath(): PathCreator {\n        closePath(this.__path)\n        this.paint()\n        return this\n    }\n\n    // canvas\n\n    public rect(x: number, y: number, width: number, height: number): PathCreator {\n        rect(this.__path, x, y, width, height)\n        this.paint()\n        return this\n    }\n\n    public roundRect(x: number, y: number, width: number, height: number, cornerRadius: number | number[]): PathCreator {\n        roundRect(this.__path, x, y, width, height, cornerRadius)\n        this.paint()\n        return this\n    }\n\n    public ellipse(x: number, y: number, radiusX: number, radiusY: number, rotation?: number, startAngle?: number, endAngle?: number, anticlockwise?: boolean): PathCreator {\n        ellipse(this.__path, x, y, radiusX, radiusY, rotation, startAngle, endAngle, anticlockwise)\n        this.paint()\n        return this\n    }\n\n    public arc(x: number, y: number, radius: number, startAngle?: number, endAngle?: number, anticlockwise?: boolean): PathCreator {\n        arc(this.__path, x, y, radius, startAngle, endAngle, anticlockwise)\n        this.paint()\n        return this\n    }\n\n    public arcTo(x1: number, y1: number, x2: number, y2: number, radius: number): PathCreator {\n        arcTo(this.__path, x1, y1, x2, y2, radius)\n        this.paint()\n        return this\n    }\n\n    // moveTo, then draw\n\n    public drawEllipse(x: number, y: number, radiusX: number, radiusY: number, rotation?: number, startAngle?: number, endAngle?: number, anticlockwise?: boolean): PathCreator {\n        drawEllipse(this.__path, x, y, radiusX, radiusY, rotation, startAngle, endAngle, anticlockwise)\n        this.paint()\n        return this\n    }\n\n    public drawArc(x: number, y: number, radius: number, startAngle?: number, endAngle?: number, anticlockwise?: boolean): PathCreator {\n        drawArc(this.__path, x, y, radius, startAngle, endAngle, anticlockwise)\n        this.paint()\n        return this\n    }\n\n    public drawPoints(points: number[] | IPointData[], curve?: boolean | number, close?: boolean): PathCreator {\n        drawPoints(this.__path, points, curve, close)\n        this.paint()\n        return this\n    }\n\n    public clearPath(): PathCreator {\n        return this.beginPath()\n    }\n\n    public paint(): void { }\n\n}\n", "import { IPathDrawer, IPathCommandData } from '@leafer/interface'\nimport { OneRadian, PI2 } from '@leafer/math'\nimport { Debug } from '@leafer/debug'\n\nimport { PathCommandMap as Command } from './PathCommandMap'\n\n\nconst { M, L, C, Q, Z, N, D, X, G, F, O, P, U } = Command\nconst debug = Debug.get('PathDrawer')\n\nexport const PathDrawer = {\n\n    drawPathByData(drawer: IPathDrawer, data: IPathCommandData): void {\n        if (!data) return\n\n        let command: number\n        let i = 0, len = data.length\n\n        while (i < len) {\n            command = data[i]\n            switch (command) {\n                case M:  //moveto(x, y)\n                    drawer.moveTo(data[i + 1], data[i + 2])\n                    i += 3\n                    break\n                case L:  //lineto(x, y)\n                    drawer.lineTo(data[i + 1], data[i + 2])\n                    i += 3\n                    break\n                case C:  //bezierCurveTo(x1, y1, x2, y2, x, y)\n                    drawer.bezierCurveTo(data[i + 1], data[i + 2], data[i + 3], data[i + 4], data[i + 5], data[i + 6])\n                    i += 7\n                    break\n                case Q:  //quadraticCurveTo(x1, y1, x, y)\n                    drawer.quadraticCurveTo(data[i + 1], data[i + 2], data[i + 3], data[i + 4])\n                    i += 5\n                    break\n                case Z:  //closepath()\n                    drawer.closePath()\n                    i += 1\n                    break\n\n                // canvas command\n\n                case N: // rect(x, y, width, height)\n                    drawer.rect(data[i + 1], data[i + 2], data[i + 3], data[i + 4])\n                    i += 5\n                    break\n                case D: // roundRect(x, y, width, height, radius1, radius2, radius3, radius4)\n                    drawer.roundRect(data[i + 1], data[i + 2], data[i + 3], data[i + 4], [data[i + 5], data[i + 6], data[i + 7], data[i + 8]])\n                    i += 9\n                    break\n                case X: // simple roundRect(x, y, width, height, radius)\n                    drawer.roundRect(data[i + 1], data[i + 2], data[i + 3], data[i + 4], data[i + 5])\n                    i += 6\n                    break\n                case G: // ellipse(x, y, radiusX, radiusY, rotation, startAngle, endAngle, anticlockwise)\n                    drawer.ellipse(data[i + 1], data[i + 2], data[i + 3], data[i + 4], data[i + 5] * OneRadian, data[i + 6] * OneRadian, data[i + 7] * OneRadian, data[i + 8] as unknown as boolean)\n                    i += 9\n                    break\n                case F: // simple ellipse(x, y, radiusX, radiusY)\n                    drawer.ellipse(data[i + 1], data[i + 2], data[i + 3], data[i + 4], 0, 0, PI2, false)\n                    i += 5\n                    break\n                case O: // arc(x, y, radius, startAngle, endAngle, anticlockwise)\n                    drawer.arc(data[i + 1], data[i + 2], data[i + 3], data[i + 4] * OneRadian, data[i + 5] * OneRadian, data[i + 6] as unknown as boolean)\n                    i += 7\n                    break\n                case P: // simple arc(x, y, radius)\n                    drawer.arc(data[i + 1], data[i + 2], data[i + 3], 0, PI2, false)\n                    i += 4\n                    break\n                case U: // arcTo(x1, y1, x2, y2, radius)\n                    drawer.arcTo(data[i + 1], data[i + 2], data[i + 3], data[i + 4], data[i + 5])\n                    i += 6\n                    break\n                default:\n                    debug.error(`command: ${command} [index:${i}]`, data)\n                    return\n            }\n        }\n\n    }\n\n}", "import { ITwoPointBoundsData, IPathCommandData, IBoundsData, IPointData } from '@leafer/interface'\nimport { TwoPointBoundsHelper } from '@leafer/math'\nimport { Debug } from '@leafer/debug'\n\nimport { BezierHelper } from './BezierHelper'\nimport { PathCommandMap as Command } from './PathCommandMap'\n\n\nconst { M, L, C, Q, Z, N, D, X, G, F, O, P, U } = Command\nconst { toTwoPointBounds, toTwoPointBoundsByQuadraticCurve, arcTo, arc, ellipse } = BezierHelper\nconst { addPointBounds, copy, addPoint, setPoint, addBounds, toBounds } = TwoPointBoundsHelper\nconst debug = Debug.get('PathBounds')\n\nlet radius: number, radiusX: number, radiusY: number\nconst tempPointBounds = {} as ITwoPointBoundsData\nconst setPointBounds = {} as ITwoPointBoundsData\nconst setEndPoint = {} as IPointData\n\nexport const PathBounds = {\n\n    toBounds(data: IPathCommandData, setBounds: IBoundsData): void {\n        PathBounds.toTwoPointBounds(data, setPointBounds)\n        toBounds(setPointBounds, setBounds)\n    },\n\n    toTwoPointBounds(data: IPathCommandData, setPointBounds: ITwoPointBoundsData): void {\n        if (!data || !data.length) return setPoint(setPointBounds, 0, 0)\n\n        let i = 0, x = 0, y = 0, x1: number, y1: number, toX: number, toY: number, command: number\n\n        const len = data.length\n\n        while (i < len) {\n            command = data[i]\n\n            if (i === 0) {\n                if (command === Z || command === C || command === Q) {\n                    setPoint(setPointBounds, x, y)\n                } else {\n                    setPoint(setPointBounds, data[i + 1], data[i + 2])\n                }\n            }\n\n            switch (command) {\n                case M: //moveto(x, y)\n                case L: //lineto(x, y)\n                    x = data[i + 1]\n                    y = data[i + 2]\n                    addPoint(setPointBounds, x, y)\n                    i += 3\n                    break\n                case C: //bezierCurveTo(x1, y1, x2, y2, x,y)\n                    toX = data[i + 5]\n                    toY = data[i + 6]\n                    toTwoPointBounds(x, y, data[i + 1], data[i + 2], data[i + 3], data[i + 4], toX, toY, tempPointBounds)\n                    addPointBounds(setPointBounds, tempPointBounds)\n                    x = toX\n                    y = toY\n                    i += 7\n                    break\n                case Q: //quadraticCurveTo(x1, y1, x, y)\n                    x1 = data[i + 1]\n                    y1 = data[i + 2]\n                    toX = data[i + 3]\n                    toY = data[i + 4]\n                    toTwoPointBoundsByQuadraticCurve(x, y, x1, y1, toX, toY, tempPointBounds)\n                    addPointBounds(setPointBounds, tempPointBounds)\n                    x = toX\n                    y = toY\n                    i += 5\n                    break\n                case Z: //closepath()\n                    i += 1\n                    break\n\n                // canvas command\n\n                case N: // rect(x, y, width, height)\n                    x = data[i + 1]\n                    y = data[i + 2]\n                    addBounds(setPointBounds, x, y, data[i + 3], data[i + 4])\n                    i += 5\n                    break\n                case D: // roundRect(x, y, width, height, radius1, radius2, radius3, radius4)\n                case X: // simple roundRect(x, y, width, height, radius)\n                    x = data[i + 1]\n                    y = data[i + 2]\n                    addBounds(setPointBounds, x, y, data[i + 3], data[i + 4])\n                    i += (command === D ? 9 : 6)\n                    break\n                case G: // ellipse(x, y, radiusX, radiusY, rotation, startAngle, endAngle, anticlockwise)\n                    ellipse(null, data[i + 1], data[i + 2], data[i + 3], data[i + 4], data[i + 5], data[i + 6], data[i + 7], data[i + 8] as unknown as boolean, tempPointBounds, setEndPoint)\n                    i === 0 ? copy(setPointBounds, tempPointBounds) : addPointBounds(setPointBounds, tempPointBounds)\n                    x = setEndPoint.x\n                    y = setEndPoint.y\n                    i += 9\n                    break\n                case F: // simple ellipse(x, y, radiusX, radiusY)\n                    x = data[i + 1]\n                    y = data[i + 2]\n                    radiusX = data[i + 3]\n                    radiusY = data[i + 4]\n                    addBounds(setPointBounds, x - radiusX, y - radiusY, radiusX * 2, radiusY * 2)\n                    x += radiusX\n                    i += 5\n                    break\n                case O: // arc(x, y, radius, startAngle, endAngle, anticlockwise)\n                    arc(null, data[i + 1], data[i + 2], data[i + 3], data[i + 4], data[i + 5], data[i + 6] as unknown as boolean, tempPointBounds, setEndPoint)\n                    i === 0 ? copy(setPointBounds, tempPointBounds) : addPointBounds(setPointBounds, tempPointBounds)\n                    x = setEndPoint.x\n                    y = setEndPoint.y\n                    i += 7\n                    break\n                case P: // simple arc(x, y, radius)\n                    x = data[i + 1]\n                    y = data[i + 2]\n                    radius = data[i + 3]\n                    addBounds(setPointBounds, x - radius, y - radius, radius * 2, radius * 2)\n                    x += radius\n                    i += 4\n                    break\n                case U: // arcTo(x1, y1, x2, y2, radius)\n                    arcTo(null, x, y, data[i + 1], data[i + 2], data[i + 3], data[i + 4], data[i + 5], tempPointBounds, setEndPoint)\n                    i === 0 ? copy(setPointBounds, tempPointBounds) : addPointBounds(setPointBounds, tempPointBounds)\n                    x = setEndPoint.x\n                    y = setEndPoint.y\n                    i += 6\n                    break\n                default:\n                    debug.error(`command: ${command} [index:${i}]`, data)\n                    return\n            }\n        }\n\n    }\n\n}", "import { IPathCommandData } from '@leafer/interface'\nimport { PointHelper } from '@leafer/math'\nimport { isArray } from '@leafer/data'\n\nimport { PathCommandMap as Command, PathNumberCommandLengthMap } from './PathCommandMap'\nimport { PathCommandDataHelper } from './PathCommandDataHelper'\n\n\nconst { M, L, Z } = Command\nconst { getCenterX, getCenterY } = PointHelper\nconst { arcTo } = PathCommandDataHelper\n\nexport const PathCorner = {\n\n    smooth(data: IPathCommandData, cornerRadius: number, _cornerSmoothing?: number): IPathCommandData {\n\n        let command: number, lastCommand: number, commandLen\n        let i = 0, x = 0, y = 0, startX = 0, startY = 0, secondX = 0, secondY = 0, lastX = 0, lastY = 0\n        if (isArray(cornerRadius)) cornerRadius = cornerRadius[0] || 0\n\n        const len = data.length\n        const smooth: IPathCommandData = []\n\n        while (i < len) {\n            command = data[i]\n            switch (command) {\n                case M:  //moveto(x, y)\n                    startX = lastX = data[i + 1]\n                    startY = lastY = data[i + 2]\n                    i += 3\n                    if (data[i] === L) { // next lineTo\n                        secondX = data[i + 1]\n                        secondY = data[i + 2]\n                        smooth.push(M, getCenterX(startX, secondX), getCenterY(startY, secondY))\n                    } else {\n                        smooth.push(M, startX, startY)\n                    }\n                    break\n                case L:  //lineto(x, y)\n                    x = data[i + 1]\n                    y = data[i + 2]\n                    i += 3\n                    switch (data[i]) { // next command\n                        case L: // lineTo()\n                            arcTo(smooth, x, y, data[i + 1], data[i + 2], cornerRadius, lastX, lastY) // use arcTo(x1, y1, x2, y2, radius)\n                            break\n                        case Z: // closePath()\n                            arcTo(smooth, x, y, startX, startY, cornerRadius, lastX, lastY) // use arcTo(x1, y1, x2, y2, radius)\n                            break\n                        default:\n                            smooth.push(L, x, y)\n                    }\n                    lastX = x\n                    lastY = y\n                    break\n                case Z:  //closepath()\n                    if (lastCommand !== Z) { // fix: 重复的 Z 导致的问题\n                        arcTo(smooth, startX, startY, secondX, secondY, cornerRadius, lastX, lastY) // use arcTo(x1, y1, x2, y2, radius)\n                        smooth.push(Z)\n                    }\n                    i += 1\n                    break\n                default:\n                    commandLen = PathNumberCommandLengthMap[command]\n                    for (let j = 0; j < commandLen; j++) smooth.push(data[i + j])\n                    i += commandLen\n            }\n            lastCommand = command\n        }\n\n        if (command !== Z) {\n            smooth[1] = startX\n            smooth[2] = startY\n        }\n\n        return smooth\n    }\n\n}", "export { PathHelper } from './PathHelper'\nexport { PathConvert } from './PathConvert'\nexport { PathCreator } from './PathCreator'\nexport { PathCommandDataHelper } from './PathCommandDataHelper'\nexport { PathCommandNodeHelper } from './PathCommandNodeHelper'\nexport { PathDrawer } from './PathDrawer'\nexport { PathBounds } from './PathBounds'\nexport { PathCorner } from './PathCorner'\nexport { BezierHelper } from './BezierHelper'\nexport { EllipseHelper } from './EllipseHelper'\nexport { RectHelper } from './RectHelper'\nexport { PathCommandMap, NeedConvertToCanvasCommandMap, PathNumberCommandMap, PathNumberCommandLengthMap } from './PathCommandMap'\n\n// rewrite, prevent circular references\n\nimport { PathConvert } from './PathConvert'\nimport { PathCreator } from './PathCreator'\nimport { PathHelper } from './PathHelper'\n\nimport { IPathCommandData, IPathString } from '@leafer/interface'\n\n\nexport function path(path?: IPathCommandData | IPathString): PathCreator {\n    return new PathCreator(path)\n}\n\nexport const pen = path()\n\nPathHelper.creator = path()\nPathHelper.parse = PathConvert.parse\nPathHelper.convertToCanvasData = PathConvert.toCanvasData", "import { IPathDrawer } from '@leafer/interface'\nimport { RectHelper } from '@leafer/path'\n\n\nconst { drawRoundRect } = RectHelper\n\nexport function roundRect(drawer: IPathDrawer): void {\n\n    if (drawer && !drawer.roundRect) {\n\n        drawer.roundRect = function (x: number, y: number, width: number, height: number, cornerRadius: number | number[]): void {\n\n            drawRoundRect(this as IPathDrawer, x, y, width, height, cornerRadius)\n        }\n    }\n\n}\n\n", "import { IPathDrawer } from '@leafer/interface'\n\nimport { roundRect } from './roundRect'\n\nexport function canvasPatch(drawer: IPathDrawer): void {\n    roundRect(drawer)\n}", "import { IExportFileType, IStringMap, IExportOptions } from '@leafer/interface'\n\nexport const FileHelper = {\n\n    alphaPixelTypes: ['png', 'webp', 'svg'] as IExportFileType[],\n\n    upperCaseTypeMap: {} as IStringMap,\n\n    mineType(type: string): string {\n        if (!type || type.startsWith('image')) return type\n        if (type === 'jpg') type = 'jpeg'\n        return 'image/' + type\n    },\n\n    fileType(filename: string): string {\n        const l = filename.split('.')\n        return l[l.length - 1]\n    },\n\n    isOpaqueImage(filename: string): boolean {\n        const type = F.fileType(filename)\n        return ['jpg', 'jpeg'].some(item => item === type)\n    },\n\n    getExportOptions(options?: IExportOptions | number | boolean): IExportOptions {\n        switch (typeof options) {\n            case 'object': return options\n            case 'number': return { quality: options }\n            case 'boolean': return { blob: options }\n            default: return {}\n        }\n    }\n\n}\n\nconst F = FileHelper\n\nF.alphaPixelTypes.forEach(type => F.upperCaseTypeMap[type] = type.toUpperCase())", "import { IFunction, ITaskItem } from '@leafer/interface'\nimport { IncrementId } from '@leafer/math'\nimport { Debug } from '@leafer/debug'\n\nimport { TaskProcessor } from './TaskProcessor'\n\n\nconst debug = Debug.get('TaskProcessor')\nexport class TaskItem implements ITaskItem {\n\n    readonly id: number\n\n    public parent: TaskProcessor\n\n    public parallel = true\n    public time = 1 // 预估任务需要运行的时间， 毫秒为单位\n\n    public isComplete: boolean\n    public isCancel: boolean\n    public runing: boolean\n\n    public canUse?: IFunction\n\n    public task: IFunction\n\n    constructor(task?: IFunction) {\n        this.id = IncrementId.create(IncrementId.TASK)\n        this.task = task\n    }\n\n    async run(): Promise<void> {\n        try {\n            if (this.isComplete || this.runing) return\n            this.runing = true\n            if (this.canUse && !this.canUse()) return this.cancel()\n            if (this.task) await this.task()\n        } catch (error) {\n            debug.error(error)\n        }\n    }\n\n    public complete(): void {\n        this.isComplete = true\n        this.parent = this.task = this.canUse = null\n    }\n\n    public cancel(): void {\n        this.isCancel = true\n        this.complete()\n    }\n\n}", "import { IFunction, ITaskProcessor, ITaskProcessorConfig, ITaskOptions, ITaskItem } from '@leafer/interface'\nimport { DataHelper, isNumber, isUndefined } from '@leafer/data'\n\nimport { TaskItem } from './TaskItem'\n\n\nexport class TaskProcessor implements ITaskProcessor {\n\n    public config: ITaskProcessorConfig = { parallel: 6 }\n\n    protected list: ITaskItem[] = []\n\n    protected parallelList: ITaskItem[]\n    protected parallelSuccessNumber: number\n\n    public running = false\n    public isComplete = true\n\n    protected timer: any\n\n    public get total(): number { return this.list.length + this.delayNumber }\n\n    public index = 0\n\n    public delayNumber = 0 // 延迟执行任务\n\n    public get finishedIndex(): number {\n        return this.isComplete ? 0 : this.index + this.parallelSuccessNumber\n    }\n\n    public get remain(): number {\n        return this.isComplete ? this.total : this.total - this.finishedIndex\n    }\n\n    public get percent(): number {\n        const { total } = this\n        let totalTime = 0, runTime = 0\n\n        for (let i = 0; i < total; i++) {\n            if (i <= this.finishedIndex) {\n                runTime += this.list[i].time\n                if (i === this.finishedIndex) totalTime = runTime\n            } else {\n                totalTime += this.list[i].time\n            }\n        }\n\n        return this.isComplete ? 1 : (runTime / totalTime)\n    }\n\n\n    constructor(config?: ITaskProcessorConfig) {\n        if (config) DataHelper.assign(this.config, config)\n        this.empty()\n    }\n\n    // list\n\n    public add(taskCallback: IFunction, options?: ITaskOptions | number, canUse?: IFunction): ITaskItem {\n        let start: boolean, parallel: boolean, time: number, delay: number\n\n        const task = new TaskItem(taskCallback)\n        task.parent = this\n\n        if (isNumber(options)) {\n            delay = options\n        } else if (options) {\n            parallel = options.parallel\n            start = options.start\n            time = options.time\n            delay = options.delay\n            if (!canUse) canUse = options.canUse\n        }\n\n        if (time) task.time = time\n        if (parallel === false) task.parallel = false\n        if (canUse) task.canUse = canUse\n\n        if (isUndefined(delay)) {\n            this.push(task, start)\n        } else {\n            this.delayNumber++\n            setTimeout(() => {\n                if (this.delayNumber) {\n                    this.delayNumber--\n                    this.push(task, start)\n                }\n            }, delay)\n        }\n\n        this.isComplete = false\n\n        return task\n    }\n\n    protected push(task: ITaskItem, start?: boolean): void {\n        this.list.push(task)\n        if (start !== false && !this.timer) {\n            this.timer = setTimeout(() => this.start())\n        }\n    }\n\n    protected empty(): void {\n        this.index = 0\n        this.parallelSuccessNumber = 0\n        this.list = []\n        this.parallelList = []\n        this.delayNumber = 0\n    }\n\n    // control\n\n    public start(): void {\n        if (!this.running) {\n            this.running = true\n            this.isComplete = false\n            this.run()\n        }\n    }\n\n    public pause(): void {\n        clearTimeout(this.timer)\n        this.timer = null\n        this.running = false\n    }\n\n    public resume(): void {\n        this.start()\n    }\n\n    public skip(): void {\n        this.index++\n        this.resume()\n    }\n\n    public stop(): void {\n        this.isComplete = true\n        this.list.forEach(task => { if (!task.isComplete) task.run() })\n        this.pause()\n        this.empty()\n    }\n\n    // run \n\n    protected run(): void {\n        if (!this.running) return\n\n        this.setParallelList()\n\n        if (this.parallelList.length > 1) {\n\n            this.runParallelTasks()\n\n        } else {\n\n            this.remain ? this.runTask() : this.onComplete()\n\n        }\n    }\n\n    protected runTask(): void {\n        const task = this.list[this.index]\n        if (!task) {\n            this.timer = setTimeout(() => this.nextTask())  // 存在延时任务\n            return\n        }\n\n        task.run().then(() => {\n\n            this.onTask(task)\n\n            this.index++\n            task.isCancel ? this.runTask() : this.nextTask()\n\n        }).catch(error => {\n            this.onError(error)\n        })\n    }\n\n    protected runParallelTasks(): void {\n        this.parallelList.forEach(task => this.runParallelTask(task))\n    }\n\n    protected runParallelTask(task: ITaskItem): void {\n        task.run().then(() => {\n\n            this.onTask(task)\n            this.fillParallelTask()\n\n        }).catch(error => {\n            this.onParallelError(error)\n        })\n    }\n\n    private nextTask(): void {\n        if (this.total === this.finishedIndex) {\n            this.onComplete()\n        } else {\n            this.timer = setTimeout(() => this.run())\n        }\n    }\n\n    protected setParallelList(): void {\n        let task: ITaskItem\n        const { config, list, index } = this\n\n        this.parallelList = []\n        this.parallelSuccessNumber = 0\n        let end = index + config.parallel\n\n        if (end > list.length) end = list.length\n\n        if (config.parallel > 1) {\n            for (let i = index; i < end; i++) {\n                task = list[i]\n                if (task.parallel) this.parallelList.push(task)\n                else break\n            }\n        }\n    }\n\n\n    protected fillParallelTask(): void {\n        let task: ITaskItem\n        const parallelList = this.parallelList\n\n        // 完成一个任务\n        this.parallelSuccessNumber++\n        parallelList.pop()\n\n        // 找到下一个可以并行的任务\n        const parallelWaitNumber = parallelList.length\n        const nextIndex = this.finishedIndex + parallelWaitNumber\n\n        if (parallelList.length) {\n\n            if (!this.running) return\n\n            if (nextIndex < this.total) {\n\n                task = this.list[nextIndex]\n\n                if (task && task.parallel) {\n                    parallelList.push(task)\n                    this.runParallelTask(task)\n                }\n\n            }\n\n        } else {\n\n            this.index += this.parallelSuccessNumber\n            this.parallelSuccessNumber = 0\n            this.nextTask()\n\n        }\n    }\n\n    // event\n\n    protected onComplete(): void {\n        this.stop()\n        if (this.config.onComplete) this.config.onComplete()\n    }\n\n    protected onTask(task: ITaskItem): void {\n        task.complete()\n        if (this.config.onTask) this.config.onTask()\n    }\n\n    protected onParallelError(error: unknown): void {\n        // 并行变串行, 以便下次重试\n        this.parallelList.forEach(task => {\n            task.parallel = false\n        })\n        this.parallelList.length = 0\n        this.parallelSuccessNumber = 0\n\n        this.onError(error)\n    }\n\n    protected onError(error: unknown): void {\n        this.pause()\n        if (this.config.onError) this.config.onError(error)\n    }\n\n    public destroy(): void {\n        this.stop()\n    }\n}", "import { ILeaferImage, IResource, IObject, ILeaferCanvas, IExportFileType, ILeaferImageConfig } from '@leafer/interface'\n\nimport { Creator } from '@leafer/platform'\nimport { TaskProcessor } from '@leafer/task'\nimport { isString } from '@leafer/data'\nimport { Debug } from '@leafer/debug'\n\n\nconst debug = Debug.get('Resource')\n\nexport const Resource: IResource = {\n\n    tasker: new TaskProcessor(),\n\n    map: {},\n\n    get isComplete() { return R.tasker.isComplete },\n\n    // 通用\n\n    set(key: string, value: any): void {\n        if (R.map[key]) debug.repeat(key)\n        R.map[key] = value\n    },\n\n    get(key: string): any {\n        return R.map[key]\n    },\n\n    remove(key: string) {\n        const r = R.map[key]\n        if (r) {\n            if (r.destroy) r.destroy()\n            delete R.map[key]\n        }\n    },\n\n    // image\n\n    loadImage(key: string, format?: IExportFileType): Promise<ILeaferImage> {\n        return new Promise((resolve, reject) => {\n            const image = this.setImage(key, key, format)\n            image.load(() => resolve(image), (e: any) => reject(e))\n        })\n    },\n\n    setImage(key: string, value: string | IObject | ILeaferImage | ILeaferCanvas, format?: IExportFileType): ILeaferImage {\n        let config: ILeaferImageConfig\n        if (isString(value)) config = { url: value }\n        else if (!value.url) config = { url: key, view: value }\n        if (config) format && (config.format = format), value = Creator.image(config)\n        R.set(key, value)\n        return value as ILeaferImage\n    },\n\n\n    destroy(): void {\n        R.map = {}\n    }\n\n}\n\nconst R = Resource", "import { IImageManager, ILeaferImageConfig, ILeaferImage, IExportFileType } from '@leafer/interface'\nimport { Creator, Platform } from '@leafer/platform'\nimport { FileHelper, Resource } from '@leafer/file'\nimport { TaskProcessor } from '@leafer/task'\n\n\nexport const ImageManager: IImageManager = {\n\n    maxRecycled: 10,\n\n    recycledList: [],\n\n    patternTasker: new TaskProcessor({ parallel: 1 }),\n\n    get(config: ILeaferImageConfig): ILeaferImage {\n        let image: ILeaferImage = Resource.get(config.url)\n        if (!image) Resource.set(config.url, image = Creator.image(config))\n        image.use++\n        return image\n    },\n\n    recycle(image: ILeaferImage): void {\n        image.use--\n        setTimeout(() => {\n            if (!image.use) {\n                if (Platform.image.isLarge(image)) {\n                    if (image.url) Resource.remove(image.url)\n                } else {\n                    image.clearLevels()\n                    I.recycledList.push(image)\n                }\n            }\n        })\n    },\n\n    // maybe rewrite\n    recyclePaint(paint: any): void {\n        I.recycle(paint.image)\n    },\n\n    clearRecycled(force?: boolean): void {\n        const list = I.recycledList\n        if (list.length > I.maxRecycled || force) {\n            list.forEach(image => ((!image.use || force) && image.url) && Resource.remove(image.url))\n            list.length = 0\n        }\n    },\n\n    // need rewrite\n    clearLevels(): void { },\n\n    hasAlphaPixel(config: ILeaferImageConfig): boolean {\n        return FileHelper.alphaPixelTypes.some(item => I.isFormat(item, config))\n    },\n\n    isFormat(format: IExportFileType, config: ILeaferImageConfig): boolean {\n        if (config.format) return config.format === format\n        const { url } = config\n        if (url.startsWith('data:')) {\n            if (url.startsWith('data:' + FileHelper.mineType(format))) return true\n        } else {\n            if (url.includes('.' + format) || url.includes('.' + FileHelper.upperCaseTypeMap[format])) return true\n            else if (format === 'png' && !url.includes('.')) return true // blob: 等无后缀名协议的图片无法分析类型，直接当透明图片处理\n        }\n        return false\n    },\n\n    destroy(): void {\n        this.clearRecycled(true)\n    }\n\n}\n\nconst I = ImageManager", "import { ILeaferImage, ILeaferImageConfig, IFunction, IObject, InnerId, IMatrixData, ICanvasPattern, ILeaferImageCacheCanvas, ILeaferImagePatternPaint, ILeaferImageLevel, ISizeData, IImageCrossOrigin, IImageLOD, IInterlace } from '@leafer/interface'\nimport { Platform } from '@leafer/platform'\nimport { Resource } from '@leafer/file'\nimport { IncrementId } from '@leafer/math'\nimport { isUndefined } from '@leafer/data'\n\nimport { ImageManager } from './ImageManager'\n\n\nconst { IMAGE, create } = IncrementId\n\nexport class LeaferImage implements ILeaferImage {\n\n    public readonly innerId: InnerId\n    public get url() { return this.config.url }\n    public lod?: IImageLOD\n    public get crossOrigin(): IImageCrossOrigin { const { crossOrigin } = this.config; return isUndefined(crossOrigin) ? Platform.image.crossOrigin : crossOrigin }\n\n    public view: any\n\n    public width: number\n    public height: number\n\n    public isSVG: boolean\n    public hasAlphaPixel: boolean // check png / svg / webp\n\n    public get completed() { return this.ready || !!this.error }\n\n    public ready: boolean\n    public error: IObject\n    public loading: boolean\n\n    public use = 0\n\n    public config: ILeaferImageConfig\n\n    protected waitComplete: IFunction[] = []\n\n    protected cache: ILeaferImageCacheCanvas\n\n    constructor(config: ILeaferImageConfig) {\n        this.innerId = create(IMAGE)\n        this.config = config || (config = { url: '' })\n        if (config.view) {\n            const { view } = config\n            this.setView(view.config ? view.view : view)\n        }\n\n        ImageManager.isFormat('svg', config) && (this.isSVG = true)\n        ImageManager.hasAlphaPixel(config) && (this.hasAlphaPixel = true)\n    }\n\n    public load(onSuccess?: IFunction, onError?: IFunction, thumbSize?: ISizeData): number {\n        if (!this.loading) {\n            this.loading = true\n            Resource.tasker.add(async () => await Platform.origin.loadImage(this.getLoadUrl(thumbSize), this.crossOrigin, this).then(img => {\n                if (thumbSize) this.setThumbView(img)\n                this.setView(img)\n            }).catch((e) => {\n                this.error = e\n                this.onComplete(false)\n            }))\n        }\n        this.waitComplete.push(onSuccess, onError)\n        return this.waitComplete.length - 2\n    }\n\n    public unload(index: number, stopEvent?: boolean): void {\n        const l = this.waitComplete\n        if (stopEvent) {\n            const error = l[index + 1]\n            if (error) error({ type: 'stop' })\n        }\n        l[index] = l[index + 1] = undefined\n    }\n\n    protected setView(img: any): void {\n        this.ready = true\n        if (!this.width) {\n            this.width = img.width\n            this.height = img.height\n            this.view = img\n        }\n        this.onComplete(true)\n    }\n\n    protected onComplete(isSuccess: boolean): void {\n        let odd: number\n        this.waitComplete.forEach((item, index) => {\n            odd = index % 2\n            if (item) {\n                if (isSuccess) {\n                    if (!odd) item(this)\n                } else {\n                    if (odd) item(this.error)\n                }\n            }\n        })\n        this.waitComplete.length = 0\n        this.loading = false\n    }\n\n    public getFull(_filters?: IObject): any {\n        return this.view\n    }\n\n    public getCanvas(width: number, height: number, opacity?: number, filters?: IObject, xGap?: number, yGap?: number, smooth?: boolean, interlace?: IInterlace): any {\n        width || (width = this.width)\n        height || (height = this.height)\n\n        if (this.cache) { // when use > 1, check cache\n            let { params, data } = this.cache\n            for (let i in params) { if (params[i] !== arguments[i]) { data = null; break } }\n            if (data) return data\n        }\n\n        const canvas = Platform.image.resize(this.view, width, height, xGap, yGap, undefined, smooth, opacity, filters, interlace)\n\n        this.cache = this.use > 1 ? { data: canvas, params: arguments } : null\n\n        return canvas\n    }\n\n    public getPattern(canvas: any, repeat: string | null, transform?: IMatrixData, paint?: ILeaferImagePatternPaint): ICanvasPattern {\n        const pattern = Platform.canvas.createPattern(canvas, repeat)\n        Platform.image.setPatternTransform(pattern, transform, paint)\n        return pattern\n    }\n\n    // need rewrite\n    public getLoadUrl(_thumbSize?: ISizeData): string { return this.url }\n    public setThumbView(_view: number): void { }\n    public getThumbSize(_lod?: IImageLOD): ISizeData { return undefined }\n\n    public getMinLevel(): number { return undefined }\n    public getLevelData(_level: number, _width?: number, _height?: number,): ILeaferImageLevel { return undefined }\n    public clearLevels(_checkUse?: boolean): void { }\n\n    public destroy(): void {\n        this.clearLevels()\n\n        const { view } = this\n        if (view && view.close) view.close() // 可能为 ImageBitmap\n        this.config = { url: '' }\n        this.cache = this.view = null\n        this.waitComplete.length = 0\n    }\n\n}", "import { IObject, IValue } from '@leafer/interface'\n\nexport function defineKey<T>(target: T, key: string, descriptor: IObject & ThisType<T>, noConfigurable?: boolean): void {\n    if (!noConfigurable) descriptor.configurable = descriptor.enumerable = true\n    Object.defineProperty(target, key, descriptor)\n}\n\nexport function getDescriptor(object: IObject, name: string) {\n    return Object.getOwnPropertyDescriptor(object, name)\n}\n\nexport function createDescriptor(key: string, defaultValue?: IValue) {\n    const privateKey = '_' + key\n    return {\n        get() { const v = (this as IObject)[privateKey]; return v == null ? defaultValue : v },\n        set(value: IValue) { (this as IObject)[privateKey] = value }\n    }\n}\n\nexport function getNames(object: IObject): string[] {\n    return Object.getOwnPropertyNames(object)\n}\n\n", "import { ILeafData, ILeaf, IObject, IValue, ILeafAttrDescriptor, ILeafAttrDescriptorFn, IValueFunction, IMatrixWithBoundsScaleData } from '@leafer/interface'\nimport { DataHelper, isEmptyData, isObject, isUndefined } from '@leafer/data'\nimport { Debug } from '@leafer/debug'\n\nimport { defineKey, getDescriptor, createDescriptor } from './object'\n\n\n// name\n\nexport function decorateLeafAttr(defaultValue?: IValue, descriptorFn?: ILeafAttrDescriptorFn) {\n    return (target: ILeaf, key: string) => defineLeafAttr(target, key, defaultValue, descriptorFn && descriptorFn(key))\n}\n\nexport function attr(partDescriptor?: ILeafAttrDescriptor): ILeafAttrDescriptor {\n    return partDescriptor\n}\n\n\nexport function defineLeafAttr(target: ILeaf, key: string, defaultValue?: IValue, partDescriptor?: ILeafAttrDescriptor): void {\n    const defaultDescriptor: ILeafAttrDescriptor = {\n        get() { return this.__getAttr(key) },\n        set(value: IValue) { this.__setAttr(key, value) }\n    }\n    defineKey(target, key, Object.assign(defaultDescriptor, partDescriptor || {}))\n    defineDataProcessor(target, key, defaultValue)\n}\n\n\nexport function dataType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue)\n}\n\nexport function positionType(defaultValue?: IValue, checkFiniteNumber?: boolean) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            this.__setAttr(key, value, checkFiniteNumber) && (this.__layout.matrixChanged || this.__layout.matrixChange())\n        }\n    }))\n}\n\nexport function scrollType(defaultValue?: IValue, checkFiniteNumber?: boolean) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            if (this.__setAttr(key, value, checkFiniteNumber)) {\n                this.__layout.matrixChanged || this.__layout.matrixChange()\n                this.__scrollWorld || (this.__scrollWorld = {} as IMatrixWithBoundsScaleData)\n            }\n        }\n    }))\n}\n\nexport function autoLayoutType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            if (this.__setAttr(key, value)) {\n                this.__hasAutoLayout = !!(this.origin || this.around || this.flow)\n                if (!this.__local) this.__layout.createLocal()\n                doBoundsType(this)\n            }\n        }\n    }))\n}\n\nexport function scaleType(defaultValue?: IValue, checkFiniteNumber?: boolean) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            this.__setAttr(key, value, checkFiniteNumber) && (this.__layout.scaleChanged || this.__layout.scaleChange())\n\n        }\n    }))\n}\n\nexport function rotationType(defaultValue?: IValue, checkFiniteNumber?: boolean) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            this.__setAttr(key, value, checkFiniteNumber) && (this.__layout.rotationChanged || this.__layout.rotationChange())\n        }\n\n    }))\n}\n\nexport function boundsType(defaultValue?: IValue, checkFiniteNumber?: boolean) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            this.__setAttr(key, value, checkFiniteNumber) && doBoundsType(this)\n        }\n    }))\n}\n\nexport function naturalBoundsType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            this.__setAttr(key, value) && (doBoundsType(this), this.__.__removeNaturalSize())\n        }\n    }))\n}\n\nexport function doBoundsType(leaf: ILeaf): void {\n    leaf.__layout.boxChanged || leaf.__layout.boxChange()\n    if (leaf.__hasAutoLayout) leaf.__layout.matrixChanged || leaf.__layout.matrixChange()\n}\n\nexport function pathInputType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            const data = this.__\n            if (data.__pathInputed !== 2) data.__pathInputed = value ? 1 : 0\n            if (!value) data.__pathForRender = undefined\n            this.__setAttr(key, value)\n            doBoundsType(this)\n        }\n    }))\n}\n\nexport const pathType = boundsType\n\n\nexport function affectStrokeBoundsType(defaultValue?: IValue, useStroke?: boolean) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            if (this.__setAttr(key, value)) {\n                doStrokeType(this)\n                if (useStroke) this.__.__useStroke = true\n            }\n        }\n    }))\n}\n\nexport function doStrokeType(leaf: ILeaf): void {\n    leaf.__layout.strokeChanged || leaf.__layout.strokeChange()\n    if (leaf.__.__useArrow) doBoundsType(leaf)\n}\n\nexport const strokeType = affectStrokeBoundsType\n\nexport function affectRenderBoundsType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            this.__setAttr(key, value)\n            this.__layout.renderChanged || this.__layout.renderChange()\n        }\n    }))\n}\n\nexport function surfaceType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            this.__setAttr(key, value) && (this.__layout.surfaceChanged || this.__layout.surfaceChange())\n        }\n    }))\n}\n\nexport function dimType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            if (this.__setAttr(key, value)) {\n                const data = this.__\n                DataHelper.stintSet(data, '__useDim', (data.dim || data.bright || data.dimskip) as boolean)\n                this.__layout.surfaceChange()\n            }\n        }\n    }))\n}\n\nexport function opacityType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            this.__setAttr(key, value) && (this.__layout.opacityChanged || this.__layout.opacityChange())\n            if (this.mask) checkMask(this)\n        }\n    }))\n}\n\nexport function visibleType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            const oldValue = this.visible\n            if (oldValue === true && value === 0) {\n                if (this.animationOut) return this.__runAnimation('out', () => doVisible(this, key, value, oldValue)) // hide\n            } else if (oldValue === 0 && value === true) {\n                if (this.animation) this.__runAnimation('in') // show\n            }\n            doVisible(this, key, value, oldValue)\n            if (this.mask) checkMask(this)\n        }\n    }))\n}\n\nfunction checkMask(leaf: ILeaf): void { // mask 的透明度和可见性变更，会影响parent\n    const { parent } = leaf\n    if (parent) {\n        const { __hasMask } = parent\n        parent.__updateMask()\n        if (__hasMask !== parent.__hasMask) parent.forceUpdate()\n    }\n}\n\nfunction doVisible(leaf: ILeaf, key: string, value: IValue, oldValue: IValue): void {\n    if (leaf.__setAttr(key, value)) {\n        leaf.__layout.opacityChanged || leaf.__layout.opacityChange()\n        if (oldValue === 0 || value === 0) doBoundsType(leaf) // 0 = display: none\n    }\n}\n\nexport function sortType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            if (this.__setAttr(key, value)) {\n                this.__layout.surfaceChange()\n                this.waitParent(() => { this.parent.__layout.childrenSortChange() })\n            }\n        }\n    }))\n}\n\nexport function maskType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: boolean) {\n            if (this.__setAttr(key, value)) {\n                this.__layout.boxChanged || this.__layout.boxChange()\n                this.waitParent(() => { this.parent.__updateMask(value) })\n            }\n        }\n    }))\n}\n\nexport function eraserType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: boolean) {\n            this.__setAttr(key, value) && this.waitParent(() => { this.parent.__updateEraser(value) })\n        }\n    }))\n}\n\nexport function hitType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            if (this.__setAttr(key, value)) {\n                this.__layout.hitCanvasChanged = true\n                if (Debug.showBounds === 'hit') this.__layout.surfaceChange()\n                if (this.leafer) this.leafer.updateCursor()\n            }\n        }\n    }))\n}\n\nexport function cursorType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            this.__setAttr(key, value)\n            if (this.leafer) this.leafer.updateCursor()\n        }\n    }))\n}\n\n\n// get\n\nexport function dataProcessor(processor: IObject) {\n    return (target: IObject, _key?: string) => {\n        defineKey(target, '__DataProcessor', {\n            get() { return processor }\n        })\n    }\n}\n\nexport function layoutProcessor(processor: IObject) {\n    return (target: IObject, _key?: string) => {\n        defineKey(target, '__LayoutProcessor', {\n            get() { return processor }\n        })\n    }\n}\n\n\n// other \n\nfunction getSetMethodName(key: string): string {\n    return 'set' + key.charAt(0).toUpperCase() + key.slice(1)\n}\n\n\n// define leaf.__[key] getter/setter\nexport function defineDataProcessor(target: ILeaf, key: string, defaultValue?: IValue | IValueFunction): void {\n\n    const data = target.__DataProcessor.prototype\n    const computedKey = '_' + key\n    const setMethodName = getSetMethodName(key)\n\n    const property: IObject & ThisType<ILeafData> = createDescriptor(key, defaultValue)\n\n    if (isUndefined(defaultValue)) {\n        property.get = function () { return this[computedKey] }\n    } else if (typeof defaultValue === 'function') {\n        property.get = function () {\n            const v = this[computedKey]\n            return v == null ? defaultValue((this as ILeafData).__leaf) : v\n        }\n    } else if (isObject(defaultValue)) {\n        const isEmpty = isEmptyData(defaultValue)\n        property.get = function () {\n            const v = this[computedKey]\n            return v == null ? this[computedKey] = isEmpty ? {} : DataHelper.clone(defaultValue) : v\n        }\n    }\n\n    const isBox = target.isBranchLeaf // 仅用于 width / height\n    if (key === 'width') {\n        property.get = function () {\n            const v = this[computedKey]\n            if (v == null) {\n                const t = this as ILeafData, naturalWidth = t.__naturalWidth, leaf = t.__leaf\n                if (!defaultValue || leaf.pathInputed) return leaf.boxBounds.width\n                if (naturalWidth) return (t as IObject)._height && t.__useNaturalRatio ? (t as IObject)._height * naturalWidth / t.__naturalHeight : naturalWidth\n                return (isBox && leaf.children.length) ? leaf.boxBounds.width : defaultValue // 返回 Box / Group / Text 等的实际宽度\n            } else return v\n        }\n    } else if (key === 'height') {\n        property.get = function () {\n            const v = this[computedKey]\n            if (v == null) {\n                const t = this as ILeafData, naturalHeight = t.__naturalHeight, leaf = t.__leaf\n                if (!defaultValue || leaf.pathInputed) return leaf.boxBounds.height\n                if (naturalHeight) return (t as IObject)._width && t.__useNaturalRatio ? (t as IObject)._width * naturalHeight / t.__naturalWidth : naturalHeight\n                return (isBox && leaf.children.length) ? leaf.boxBounds.height : defaultValue // 返回 Box / Group / Text 等的实际高度\n            } else return v\n        }\n    }\n\n    // find parent proto\n    let descriptor, find = data\n    while (!descriptor && find) {\n        descriptor = getDescriptor(find, key)\n        find = find.__proto__\n    }\n\n    if (descriptor && descriptor.set) property.set = descriptor.set // use exist set\n\n    if (data[setMethodName]) {\n        property.set = data[setMethodName] // first use custom setKey(value)\n        delete data[setMethodName]\n    }\n\n    defineKey(data, key, property)\n\n}\n\n", "import { IObject, IFunction } from '@leafer/interface'\nimport { Debug } from '@leafer/debug'\nimport { getDescriptor, getNames } from './object'\n\ninterface IRewriteItem {\n    name: string\n    run: IFunction\n}\n\nconst debug = new Debug('rewrite')\n\nconst list: IRewriteItem[] = []\nconst excludeNames = ['destroy', 'constructor']\n\n\n// method\n\nexport function rewrite(method: IFunction) {\n    return (target: IObject, key: string) => {\n        list.push({ name: target.constructor.name + '.' + key, run: () => { target[key] = method } })\n    }\n}\n\nexport function rewriteAble() {\n    return (_target: IObject) => {\n        doRewrite()\n    }\n}\n\nfunction doRewrite(error?: boolean): void {\n    if (list.length) {\n        list.forEach(item => {\n            if (error) debug.error(item.name, '需在Class上装饰@rewriteAble()')\n            item.run()\n        })\n        list.length = 0\n    }\n}\n\nsetTimeout(() => doRewrite(true))\n\n\n// class\n\nexport function useModule(module: IObject, exclude?: string[]) {\n    return (target: IObject) => {\n        const names = module.prototype ? getNames(module.prototype) : Object.keys(module)\n        names.forEach(name => {\n            if (!excludeNames.includes(name) && (!exclude || !exclude.includes(name))) {\n                if (module.prototype) {\n                    const d = getDescriptor(module.prototype, name)\n                    if (d.writable) target.prototype[name] = module.prototype[name]\n                } else {\n                    target.prototype[name] = module[name]\n                }\n            }\n        })\n    }\n}", "import { IObject } from '@leafer/interface'\nimport { EventCreator, UICreator } from '@leafer/platform'\n\nexport function registerUI() {\n    return (target: IObject) => {\n        UICreator.register(target)\n    }\n}\n\nexport function registerUIEvent() {\n    return (target: IObject) => {\n        EventCreator.register(target)\n    }\n}", "import { IAlign, ILeaf, IMatrixData, IPointData, IAxis, ITransition, ILeaferCanvas, IBoundsData, IMatrixWithBoundsData } from '@leafer/interface'\nimport { MathHelper, MatrixHelper, PointHelper, AroundHelper, getMatrixData, BoundsHelper } from '@leafer/math'\nimport { Platform } from '@leafer/platform'\nimport { isObject, isNumber } from '@leafer/data'\n\n\nconst { copy, toInnerPoint, toOuterPoint, scaleOfOuter, rotateOfOuter, skewOfOuter, multiplyParent, divideParent, getLayout } = MatrixHelper\nconst matrix = {} as IMatrixData, { round } = Math\n\nexport const LeafHelper = {\n\n    updateAllMatrix(leaf: ILeaf, checkAutoLayout?: boolean, waitAutoLayout?: boolean): void {\n        if (checkAutoLayout && leaf.__hasAutoLayout && leaf.__layout.matrixChanged) waitAutoLayout = true\n\n        updateMatrix(leaf, checkAutoLayout, waitAutoLayout)\n\n        if (leaf.isBranch) {\n            const { children } = leaf\n            for (let i = 0, len = children.length; i < len; i++) {\n                updateAllMatrix(children[i], checkAutoLayout, waitAutoLayout)\n            }\n        }\n    },\n\n    updateMatrix(leaf: ILeaf, checkAutoLayout?: boolean, waitAutoLayout?: boolean): void {\n        const layout = leaf.__layout\n\n        if (checkAutoLayout) {\n            if (waitAutoLayout) {\n                layout.waitAutoLayout = true\n                if (leaf.__hasAutoLayout) layout.matrixChanged = false // wait updateAutoLayout\n            }\n        } else if (layout.waitAutoLayout) {\n            layout.waitAutoLayout = false\n        }\n\n        if (layout.matrixChanged) leaf.__updateLocalMatrix()\n        if (!layout.waitAutoLayout) leaf.__updateWorldMatrix()\n    },\n\n    updateBounds(leaf: ILeaf): void {\n        const layout = leaf.__layout\n        if (layout.boundsChanged) leaf.__updateLocalBounds()\n        if (!layout.waitAutoLayout) leaf.__updateWorldBounds()\n    },\n\n    updateAllWorldOpacity(leaf: ILeaf): void {\n        leaf.__updateWorldOpacity()\n\n        if (leaf.isBranch) {\n            const { children } = leaf\n            for (let i = 0, len = children.length; i < len; i++) {\n                updateAllWorldOpacity(children[i])\n            }\n        }\n    },\n\n    updateChange(leaf: ILeaf): void {\n        const layout = leaf.__layout\n        if (layout.stateStyleChanged) leaf.updateState()\n        if (layout.opacityChanged) updateAllWorldOpacity(leaf)\n        leaf.__updateChange()\n    },\n\n    updateAllChange(leaf: ILeaf): void {\n        updateChange(leaf)\n        if (leaf.isBranch) {\n            const { children } = leaf\n            for (let i = 0, len = children.length; i < len; i++) {\n                updateAllChange(children[i])\n            }\n        }\n    },\n\n    worldHittable(t: ILeaf): boolean {\n        while (t) {\n            if (!t.__.hittable) return false\n            t = t.parent\n        }\n        return true\n    },\n\n    draggable(t: ILeaf): boolean {\n        return (t.draggable || t.editable) && t.hitSelf && !t.locked\n    },\n\n    copyCanvasByWorld(leaf: ILeaf, currentCanvas: ILeaferCanvas, fromCanvas: ILeaferCanvas, fromWorld?: IBoundsData, blendMode?: string, onlyResetTransform?: boolean): void {\n        if (!fromWorld) fromWorld = leaf.__nowWorld\n        if (leaf.__worldFlipped || Platform.fullImageShadow) currentCanvas.copyWorldByReset(fromCanvas, fromWorld, leaf.__nowWorld, blendMode, onlyResetTransform)\n        else currentCanvas.copyWorldToInner(fromCanvas, fromWorld as IMatrixWithBoundsData, leaf.__layout.renderBounds, blendMode)\n    },\n\n    // transform\n\n    moveWorld(t: ILeaf, x: number | IPointData, y = 0, isInnerPoint?: boolean, transition?: ITransition): void {\n        const local = isObject(x) ? { ...x } : { x, y }\n        isInnerPoint ? toOuterPoint(t.localTransform, local, local, true) : (t.parent && toInnerPoint(t.parent.scrollWorldTransform, local, local, true))\n        L.moveLocal(t, local.x, local.y, transition)\n    },\n\n    moveLocal(t: ILeaf, x: number | IPointData, y = 0, transition?: ITransition): void {\n        if (isObject(x)) y = x.y, x = x.x\n        x += t.x\n        y += t.y\n        if (t.leafer && t.leafer.config.pointSnap) x = round(x), y = round(y)\n        transition ? t.animate({ x, y }, transition) : (t.x = x, t.y = y)\n    },\n\n    zoomOfWorld(t: ILeaf, origin: IPointData, scaleX: number, scaleY?: number | ITransition, resize?: boolean, transition?: ITransition): void {\n        L.zoomOfLocal(t, getTempLocal(t, origin), scaleX, scaleY, resize, transition)\n    },\n\n    zoomOfLocal(t: ILeaf, origin: IPointData, scaleX: number, scaleY: number | ITransition = scaleX, resize?: boolean, transition?: ITransition): void {\n        const o = t.__localMatrix\n        if (!isNumber(scaleY)) {\n            if (scaleY) transition = scaleY\n            scaleY = scaleX\n        }\n        copy(matrix, o)\n        scaleOfOuter(matrix, origin, scaleX, scaleY)\n        if (L.hasHighPosition(t)) {\n            L.setTransform(t, matrix, resize, transition)\n        } else {\n            const x = t.x + matrix.e - o.e, y = t.y + matrix.f - o.f\n            if (transition && !resize) t.animate({ x, y, scaleX: t.scaleX * scaleX, scaleY: t.scaleY * scaleY }, transition)\n            else t.x = x, t.y = y, t.scaleResize(scaleX, scaleY, resize !== true)\n        }\n    },\n\n    rotateOfWorld(t: ILeaf, origin: IPointData, angle: number, transition?: ITransition): void {\n        L.rotateOfLocal(t, getTempLocal(t, origin), angle, transition)\n    },\n\n    rotateOfLocal(t: ILeaf, origin: IPointData, angle: number, transition?: ITransition): void {\n        const o = t.__localMatrix\n        copy(matrix, o)\n        rotateOfOuter(matrix, origin, angle)\n        if (L.hasHighPosition(t)) L.setTransform(t, matrix, false, transition)\n        else t.set({ x: t.x + matrix.e - o.e, y: t.y + matrix.f - o.f, rotation: MathHelper.formatRotation(t.rotation + angle) }, transition)\n    },\n\n    skewOfWorld(t: ILeaf, origin: IPointData, skewX: number, skewY?: number, resize?: boolean, transition?: ITransition): void {\n        L.skewOfLocal(t, getTempLocal(t, origin), skewX, skewY, resize, transition)\n    },\n\n    skewOfLocal(t: ILeaf, origin: IPointData, skewX: number, skewY: number = 0, resize?: boolean, transition?: ITransition): void {\n        copy(matrix, t.__localMatrix)\n        skewOfOuter(matrix, origin, skewX, skewY)\n        L.setTransform(t, matrix, resize, transition)\n    },\n\n    transformWorld(t: ILeaf, transform: IMatrixData, resize?: boolean, transition?: ITransition): void {\n        copy(matrix, t.worldTransform)\n        multiplyParent(matrix, transform)\n        if (t.parent) divideParent(matrix, t.parent.scrollWorldTransform)\n        L.setTransform(t, matrix, resize, transition)\n    },\n\n    transform(t: ILeaf, transform: IMatrixData, resize?: boolean, transition?: ITransition): void {\n        copy(matrix, t.localTransform)\n        multiplyParent(matrix, transform)\n        L.setTransform(t, matrix, resize, transition)\n    },\n\n    setTransform(t: ILeaf, transform: IMatrixData, resize?: boolean, transition?: ITransition): void {\n        const data = t.__, originPoint = data.origin && L.getInnerOrigin(t, data.origin)\n        const layout = getLayout(transform, originPoint, data.around && L.getInnerOrigin(t, data.around))\n\n        if (L.hasOffset(t)) {\n            layout.x -= data.offsetX\n            layout.y -= data.offsetY\n        }\n\n        if (resize) {\n            const scaleX = layout.scaleX / t.scaleX, scaleY = layout.scaleY / t.scaleY\n            delete layout.scaleX, delete layout.scaleY\n\n            if (originPoint) { // fix origin: resize 方式下 boxBounds 会变化，导致 originPoint 不准确，需偏移至正确的位置\n                BoundsHelper.scale(t.boxBounds, Math.abs(scaleX), Math.abs(scaleY))\n                const changedPoint = L.getInnerOrigin(t, data.origin)\n                PointHelper.move(layout, originPoint.x - changedPoint.x, originPoint.y - changedPoint.y)\n            }\n\n            t.set(layout)\n            t.scaleResize(scaleX, scaleY, false)\n\n        } else t.set(layout, transition)\n    },\n\n    getFlipTransform(t: ILeaf, axis: IAxis): IMatrixData {\n        const m = getMatrixData()\n        const sign = axis === 'x' ? 1 : -1\n        scaleOfOuter(m, L.getLocalOrigin(t, 'center'), -1 * sign, 1 * sign)\n        return m\n    },\n\n    getLocalOrigin(t: ILeaf, origin: IPointData | IAlign): IPointData {\n        return PointHelper.tempToOuterOf(L.getInnerOrigin(t, origin), t.localTransform)\n    },\n\n    getInnerOrigin(t: ILeaf, origin: IPointData | IAlign): IPointData {\n        const innerOrigin = {} as IPointData\n        AroundHelper.toPoint(origin, t.boxBounds, innerOrigin)\n        return innerOrigin\n    },\n\n    getRelativeWorld(t: ILeaf, relative: ILeaf, temp?: boolean): IMatrixData {\n        copy(matrix, t.worldTransform)\n        divideParent(matrix, relative.scrollWorldTransform)\n        return temp ? matrix : { ...matrix }\n    },\n\n    drop(t: ILeaf, parent: ILeaf, index?: number, resize?: boolean): void {\n        t.setTransform(L.getRelativeWorld(t, parent, true), resize)\n        parent.add(t, index)\n    },\n\n    hasHighPosition(t: ILeaf): boolean {\n        return (t.origin || t.around || L.hasOffset(t)) as unknown as boolean\n    },\n\n    hasOffset(t: ILeaf): boolean {\n        return (t.offsetX || t.offsetY) as unknown as boolean\n    },\n\n    hasParent(p: ILeaf, parent: ILeaf): boolean | void {\n        if (!parent) return false\n        while (p) {\n            if (parent === p) return true\n            p = p.parent\n        }\n    },\n\n    // 简单动画操作\n\n    animateMove(t: ILeaf, move: IPointData, speed = 0.3) {\n        if (!move.x && !move.y) return\n        if (Math.abs(move.x) < 1 && Math.abs(move.y) < 1) {\n            t.move(move)\n        } else {\n            const x = move.x * speed, y = move.y * speed\n            move.x -= x, move.y -= y\n            t.move(x, y)\n            Platform.requestRender(() => L.animateMove(t, move, speed))\n        }\n    }\n\n}\n\nconst L = LeafHelper\nconst { updateAllMatrix, updateMatrix, updateAllWorldOpacity, updateAllChange, updateChange } = L\n\nfunction getTempLocal(t: ILeaf, worldPoint: IPointData): IPointData {\n    t.updateLayout() // must\n    return t.parent ? PointHelper.tempToInnerOf(worldPoint, t.parent.scrollWorldTransform) : worldPoint\n}", "import { ILeaf, IBoundsData, IRenderOptions } from '@leafer/interface'\n\n\nexport const LeafBoundsHelper = {\n\n    worldBounds(target: ILeaf): IBoundsData {\n        return target.__world\n    },\n\n    localBoxBounds(target: ILeaf): IBoundsData {\n        return target.__.eraser || target.__.visible === 0 ? null : (target.__local || target.__layout)\n    },\n\n    localStrokeBounds(target: ILeaf): IBoundsData {\n        return target.__.eraser || target.__.visible === 0 ? null : target.__layout.localStrokeBounds\n    },\n\n    localRenderBounds(target: ILeaf): IBoundsData {\n        return target.__.eraser || target.__.visible === 0 ? null : target.__layout.localRenderBounds\n    },\n\n    maskLocalBoxBounds(target: ILeaf, index: number): IBoundsData {\n        return checkMask(target, index) && target.__localBoxBounds\n    },\n\n    maskLocalStrokeBounds(target: ILeaf, index: number): IBoundsData {\n        return checkMask(target, index) && target.__layout.localStrokeBounds\n    },\n\n    maskLocalRenderBounds(target: ILeaf, index: number): IBoundsData {\n        return checkMask(target, index) && target.__layout.localRenderBounds\n    },\n\n    excludeRenderBounds(child: ILeaf, options: IRenderOptions): boolean {\n        if (options.bounds && !options.bounds.hit(child.__world, options.matrix)) return true\n        if (options.hideBounds && options.hideBounds.includes(child.__world, options.matrix)) return true\n        return false\n    }\n\n}\n\n\nlet findMask: number\n\nfunction checkMask(target: ILeaf, index: number): boolean {\n    if (!index) findMask = 0\n    if (target.__.mask) findMask = 1\n    return findMask < 0 ? null : (findMask && (findMask = -1), true) // 第一个 mask 元素之后的元素 bounds 可以忽略，返回 null\n}", "import { ILeaf, ILeafLevelList, ILeafList, IMatrixWithBoundsData, IMatrixWithBoundsScaleData } from '@leafer/interface'\nimport { isUndefined } from '@leafer/data'\nimport { LeafHelper } from './LeafHelper'\n\nconst { updateBounds } = LeafHelper\n\nexport const BranchHelper = {\n\n    sort(a: ILeaf, b: ILeaf): number {\n        return (a.__.zIndex === b.__.zIndex) ? (a.__tempNumber - b.__tempNumber) : (a.__.zIndex - b.__.zIndex)\n    },\n\n    // push\n\n    pushAllChildBranch(branch: ILeaf, leafList: ILeafList | ILeafLevelList): void {\n        branch.__tempNumber = 1   // 标识需要更新子Leaf元素的WorldBounds分支 Layouter需使用\n\n        if (branch.__.__childBranchNumber) {\n            const { children } = branch\n            for (let i = 0, len = children.length; i < len; i++) {\n                branch = children[i]\n                if (branch.isBranch) {\n                    branch.__tempNumber = 1\n                    leafList.add(branch)\n                    pushAllChildBranch(branch, leafList)\n                }\n            }\n        }\n    },\n\n    pushAllParent(leaf: ILeaf, leafList: ILeafList | ILeafLevelList): void {\n        const { keys } = (leafList as ILeafList)\n        if (keys) {\n            while (leaf.parent) {\n                if (isUndefined(keys[leaf.parent.innerId])) {\n                    leafList.add(leaf.parent)\n                    leaf = leaf.parent\n                } else {\n                    break\n                }\n            }\n        } else {\n            while (leaf.parent) {\n                leafList.add(leaf.parent)\n                leaf = leaf.parent\n            }\n        }\n    },\n\n    pushAllBranchStack(branch: ILeaf, pushList: ILeaf[]): void {\n        let start = pushList.length\n        const { children } = branch\n        for (let i = 0, len = children.length; i < len; i++) {\n            if (children[i].isBranch) {\n                pushList.push(children[i])\n            }\n        }\n\n        // 找子级\n        for (let i = start, len = pushList.length; i < len; i++) {\n            pushAllBranchStack(pushList[i], pushList)\n        }\n    },\n\n    updateBounds(branch: ILeaf, exclude?: ILeaf): void {\n        const branchStack: ILeaf[] = [branch]\n        pushAllBranchStack(branch, branchStack)\n        updateBoundsByBranchStack(branchStack, exclude)\n    },\n\n    updateBoundsByBranchStack(branchStack: ILeaf[], exclude?: ILeaf): void {\n        let branch: ILeaf, children: ILeaf[]\n        for (let i = branchStack.length - 1; i > -1; i--) {\n            branch = branchStack[i]\n            children = branch.children\n            for (let j = 0, len = children.length; j < len; j++) {\n                updateBounds(children[j])\n            }\n            if (exclude && exclude === branch) continue\n            updateBounds(branch)\n        }\n    },\n\n    move(branch: ILeaf, x: number, y: number): void {\n        let w: IMatrixWithBoundsData\n        const { children } = branch\n        for (let i = 0, len = children.length; i < len; i++) {\n            branch = children[i]\n            w = branch.__world\n\n            w.e += x\n            w.f += y\n            w.x += x\n            w.y += y\n\n            if (branch.isBranch) move(branch, x, y)\n        }\n    },\n\n    scale(branch: ILeaf, x: number, y: number, scaleX: number, scaleY: number, a: number, b: number): void {\n        let w: IMatrixWithBoundsScaleData\n        const { children } = branch\n        const changeScaleX = scaleX - 1\n        const changeScaleY = scaleY - 1\n\n        for (let i = 0, len = children.length; i < len; i++) {\n            branch = children[i]\n            w = branch.__world\n\n            w.a *= scaleX\n            w.d *= scaleY\n\n            if (w.b || w.c) {\n                w.b *= scaleX\n                w.c *= scaleY\n            }\n\n            if (w.e === w.x && w.f === w.y) {\n                w.x = w.e += (w.e - a) * changeScaleX + x\n                w.y = w.f += (w.f - b) * changeScaleY + y\n            } else {\n                w.e += (w.e - a) * changeScaleX + x\n                w.f += (w.f - b) * changeScaleY + y\n\n                w.x += (w.x - a) * changeScaleX + x\n                w.y += (w.y - b) * changeScaleY + y\n            }\n\n            w.width *= scaleX\n            w.height *= scaleY\n\n            w.scaleX *= scaleX\n            w.scaleY *= scaleY\n\n            if (branch.isBranch) scale(branch, x, y, scaleX, scaleY, a, b)\n        }\n    }\n}\n\nconst { pushAllChildBranch, pushAllBranchStack, updateBoundsByBranchStack, move, scale } = BranchHelper", "import { IFunction } from '@leafer/interface'\n\nexport const WaitHelper = {\n    run(wait: IFunction[]): void {\n        if (wait && wait.length) {\n            const len = wait.length\n            for (let i = 0; i < len; i++) { wait[i]() }\n            wait.length === len ? wait.length = 0 : wait.splice(0, len)\n        }\n    }\n}", "import { ILeaf, ILeafLayout, ILocationType, IBoundsType, IBoundsData, IMatrixData, ILayoutBoundsData, IPointData } from '@leafer/interface'\nimport { Bounds, BoundsHelper, MatrixHelper, PointHelper } from '@leafer/math'\nimport { isUndefined } from '@leafer/data'\nimport { LeafHelper } from '@leafer/helper'\nimport { Platform } from '@leafer/platform'\n\n\nconst { getRelativeWorld, updateBounds } = LeafHelper\nconst { toOuterOf, getPoints, copy } = BoundsHelper\nconst localContent = '_localContentBounds'\nconst worldContent = '_worldContentBounds', worldBox = '_worldBoxBounds', worldStroke = '_worldStrokeBounds'\n\nexport class LeafLayout implements ILeafLayout {\n\n    public leaf: ILeaf\n\n    public proxyZoom: boolean\n\n    // inner\n\n    public get contentBounds(): IBoundsData { return this._contentBounds || this.boxBounds }\n    public set contentBounds(bounds: IBoundsData) { this._contentBounds = bounds }\n    public boxBounds: IBoundsData\n    public get strokeBounds(): IBoundsData { return this._strokeBounds || this.boxBounds }\n    public get renderBounds(): IBoundsData { return this._renderBounds || this.boxBounds }\n    public set renderBounds(bounds: IBoundsData) { this._renderBounds = bounds }\n\n    public _contentBounds: IBoundsData\n    public _strokeBounds: IBoundsData\n    public _renderBounds: IBoundsData\n\n    // local\n\n    public get localContentBounds(): IBoundsData { toOuterOf(this.contentBounds, this.leaf.__localMatrix, this[localContent] || (this[localContent] = {} as IBoundsData)); return this[localContent] }\n    // localBoxBounds: IBoundsData // use leaf.__localBoxBounds\n    public get localStrokeBounds(): IBoundsData { return this._localStrokeBounds || this }\n    public get localRenderBounds(): IBoundsData { return this._localRenderBounds || this }\n\n    protected _localContentBounds?: IBoundsData\n    protected _localStrokeBounds?: IBoundsData\n    protected _localRenderBounds?: IBoundsData\n\n    // world\n\n    public get worldContentBounds(): IBoundsData { toOuterOf(this.contentBounds, this.leaf.__world, this[worldContent] || (this[worldContent] = {} as IBoundsData)); return this[worldContent] }\n    public get worldBoxBounds(): IBoundsData { toOuterOf(this.boxBounds, this.leaf.__world, this[worldBox] || (this[worldBox] = {} as IBoundsData)); return this[worldBox] }\n    public get worldStrokeBounds(): IBoundsData { toOuterOf(this.strokeBounds, this.leaf.__world, this[worldStroke] || (this[worldStroke] = {} as IBoundsData)); return this[worldStroke] }\n    // worldRenderBounds: IBoundsData // use leaf.__world\n\n    protected _worldContentBounds: IBoundsData\n    protected _worldBoxBounds: IBoundsData\n    protected _worldStrokeBounds: IBoundsData\n\n    // state\n\n    public resized: 'scale' | 'inner' | 'local'\n    public waitAutoLayout: boolean\n\n    // matrix changed\n    public matrixChanged: boolean\n    public scaleChanged: boolean\n    public rotationChanged: boolean\n\n    // bounds\n    public boundsChanged: boolean\n\n    public boxChanged: boolean\n    public strokeChanged: boolean\n    public renderChanged: boolean\n\n    public localBoxChanged: boolean\n\n    // face\n    public surfaceChanged: boolean\n    public opacityChanged: boolean\n\n    public hitCanvasChanged: boolean\n\n    public childrenSortChanged?: boolean\n    public stateStyleChanged?: boolean\n\n    // keep state\n    public affectScaleOrRotation: boolean\n    public affectRotation: boolean\n    public affectChildrenSort?: boolean\n\n    public strokeSpread: number\n    public strokeBoxSpread: number\n    public renderSpread: number\n    public renderShapeSpread: number\n\n    // temp local\n    public get a() { return 1 }\n    public get b() { return 0 }\n    public get c() { return 0 }\n    public get d() { return 1 }\n    public get e() { return this.leaf.__.x }\n    public get f() { return this.leaf.__.y }\n    public get x() { return this.e + this.boxBounds.x }\n    public get y() { return this.f + this.boxBounds.y }\n    public get width() { return this.boxBounds.width }\n    public get height() { return this.boxBounds.height }\n\n\n    constructor(leaf: ILeaf) {\n        this.leaf = leaf\n        if (this.leaf.__local) this._localRenderBounds = this._localStrokeBounds = this.leaf.__local\n        if (leaf.__world) {\n            this.boxBounds = { x: 0, y: 0, width: 0, height: 0 }\n            this.boxChange()\n            this.matrixChange()\n        }\n    }\n\n    public createLocal(): void {\n        const local = this.leaf.__local = { a: 1, b: 0, c: 0, d: 1, e: 0, f: 0, x: 0, y: 0, width: 0, height: 0 }\n        if (!this._localStrokeBounds) this._localStrokeBounds = local\n        if (!this._localRenderBounds) this._localRenderBounds = local\n    }\n\n    public update(): void {\n        const { leaf } = this, { leafer } = leaf\n        if (leaf.isApp) return updateBounds(leaf)\n        if (leafer) {\n            if (leafer.ready) leafer.watcher.changed && leafer.layouter.layout()\n            else leafer.start()\n        } else {\n            let root = leaf\n            while (root.parent && !root.parent.leafer) { root = root.parent }\n            const r = root as any\n            if (r.__fullLayouting) return // fix: 循环\n            r.__fullLayouting = true\n            Platform.layout(r)\n            delete r.__fullLayouting\n        }\n    }\n\n    public getTransform(relative: ILocationType | ILeaf = 'world'): IMatrixData {\n        this.update()\n        const { leaf } = this\n        switch (relative) {\n            case 'world':\n                return leaf.__world\n            case 'local':\n                return leaf.__localMatrix\n            case 'inner':\n                return MatrixHelper.defaultMatrix\n            case 'page':\n                relative = leaf.zoomLayer\n            default:\n                return getRelativeWorld(leaf, relative)\n        }\n    }\n\n    public getBounds(type?: IBoundsType, relative: ILocationType | ILeaf = 'world'): IBoundsData {\n        this.update()\n        switch (relative) {\n            case 'world':\n                return this.getWorldBounds(type)\n            case 'local':\n                return this.getLocalBounds(type)\n            case 'inner':\n                return this.getInnerBounds(type)\n            case 'page':\n                relative = this.leaf.zoomLayer\n            default:\n                return new Bounds(this.getInnerBounds(type)).toOuterOf(this.getTransform(relative))\n        }\n    }\n\n    public getInnerBounds(type: IBoundsType = 'box'): IBoundsData {\n        switch (type) {\n            case 'render':\n                return this.renderBounds\n            case 'content':\n                if (this.contentBounds) return this.contentBounds\n            case 'box':\n                return this.boxBounds\n            case 'stroke':\n                return this.strokeBounds\n        }\n    }\n\n    public getLocalBounds(type: IBoundsType = 'box'): IBoundsData {\n        switch (type) {\n            case 'render':\n                return this.localRenderBounds\n            case 'stroke':\n                return this.localStrokeBounds\n            case 'content':\n                if (this.contentBounds) return this.localContentBounds\n            case 'box':\n                return this.leaf.__localBoxBounds\n        }\n    }\n\n    public getWorldBounds(type: IBoundsType = 'box'): IBoundsData {\n        switch (type) {\n            case 'render':\n                return this.leaf.__world\n            case 'stroke':\n                return this.worldStrokeBounds\n            case 'content':\n                if (this.contentBounds) return this.worldContentBounds\n            case 'box':\n                return this.worldBoxBounds\n        }\n    }\n\n    public getLayoutBounds(type?: IBoundsType, relative: ILocationType | ILeaf = 'world', unscale?: boolean): ILayoutBoundsData {\n        const { leaf } = this\n        let point: IPointData, matrix: IMatrixData, layoutBounds: ILayoutBoundsData, bounds: IBoundsData = this.getInnerBounds(type)\n\n        switch (relative) {\n            case 'world':\n                point = leaf.getWorldPoint(bounds)\n                matrix = leaf.__world\n                break\n            case 'local':\n                const { scaleX, scaleY, rotation, skewX, skewY } = leaf.__\n                layoutBounds = { scaleX, scaleY, rotation, skewX, skewY } as ILayoutBoundsData // 更精准，务必保留\n                point = leaf.getLocalPointByInner(bounds)\n                break\n            case 'inner':\n                point = bounds\n                matrix = MatrixHelper.defaultMatrix\n                break\n            case 'page':\n                relative = leaf.zoomLayer\n            default:\n                point = leaf.getWorldPoint(bounds, relative)\n                matrix = getRelativeWorld(leaf, relative, true)\n        }\n\n        if (!layoutBounds) layoutBounds = MatrixHelper.getLayout(matrix) as ILayoutBoundsData\n        copy(layoutBounds, bounds)\n        PointHelper.copy(layoutBounds, point)\n\n        if (unscale) {\n            const { scaleX, scaleY } = layoutBounds\n            const uScaleX = Math.abs(scaleX)\n            const uScaleY = Math.abs(scaleY)\n            if (uScaleX !== 1 || uScaleY !== 1) {\n                layoutBounds.scaleX /= uScaleX\n                layoutBounds.scaleY /= uScaleY\n                layoutBounds.width *= uScaleX\n                layoutBounds.height *= uScaleY\n            }\n        }\n\n        return layoutBounds\n    }\n\n    public getLayoutPoints(type?: IBoundsType, relative: ILocationType | ILeaf = 'world'): IPointData[] {\n        const { leaf } = this\n        const points = getPoints(this.getInnerBounds(type))\n        let relativeLeaf: ILeaf\n        switch (relative) {\n            case 'world':\n                relativeLeaf = null\n                break\n            case 'local':\n                relativeLeaf = leaf.parent\n                break\n            case 'inner':\n                break\n            case 'page':\n                relative = leaf.zoomLayer\n            default:\n                relativeLeaf = relative\n        }\n        if (!isUndefined(relativeLeaf)) points.forEach(point => leaf.innerToWorld(point, null, false, relativeLeaf))\n        return points\n    }\n\n    // 独立 / 引用 boxBounds\n\n    public shrinkContent(): void {\n        const { x, y, width, height } = this.boxBounds\n        this._contentBounds = { x, y, width, height }\n    }\n\n    public spreadStroke(): void {\n        const { x, y, width, height } = this.strokeBounds\n        this._strokeBounds = { x, y, width, height }\n        this._localStrokeBounds = { x, y, width, height }\n        if (!this.renderSpread) this.spreadRenderCancel()\n    }\n    public spreadRender(): void {\n        const { x, y, width, height } = this.renderBounds\n        this._renderBounds = { x, y, width, height }\n        this._localRenderBounds = { x, y, width, height }\n    }\n\n    public shrinkContentCancel(): void {\n        this._contentBounds = undefined\n    }\n\n    public spreadStrokeCancel(): void {\n        const same = this.renderBounds === this.strokeBounds\n        this._strokeBounds = this.boxBounds\n        this._localStrokeBounds = this.leaf.__localBoxBounds\n        if (same) this.spreadRenderCancel()\n    }\n    public spreadRenderCancel(): void {\n        this._renderBounds = this._strokeBounds\n        this._localRenderBounds = this._localStrokeBounds\n    }\n\n\n    // bounds\n\n    public boxChange(): void {\n        this.boxChanged = true\n        this.localBoxChanged ? (this.boundsChanged || (this.boundsChanged = true)) : this.localBoxChange() // fix: boundsChanged未更新的问题\n        this.hitCanvasChanged = true\n    }\n\n    public localBoxChange(): void {\n        this.localBoxChanged = true\n        this.boundsChanged = true\n    }\n\n    public strokeChange(): void {\n        this.strokeChanged = true\n        this.strokeSpread || (this.strokeSpread = 1)\n        this.boundsChanged = true\n        this.hitCanvasChanged = true\n    }\n\n    public renderChange(): void {\n        this.renderChanged = true\n        this.renderSpread || (this.renderSpread = 1)\n        this.boundsChanged = true\n    }\n\n\n    // matrix\n\n    public scaleChange(): void {\n        this.scaleChanged = true\n        this._scaleOrRotationChange()\n    }\n\n    public rotationChange(): void {\n        this.rotationChanged = true\n        this.affectRotation = true\n        this._scaleOrRotationChange()\n    }\n\n    protected _scaleOrRotationChange() {\n        this.affectScaleOrRotation = true\n        this.matrixChange()\n        if (!this.leaf.__local) this.createLocal()\n    }\n\n    public matrixChange(): void {\n        this.matrixChanged = true\n        this.localBoxChanged ? (this.boundsChanged || (this.boundsChanged = true)) : this.localBoxChange() // fix: boundsChanged未更新的问题\n    }\n\n\n    // face\n\n    public surfaceChange(): void {\n        this.surfaceChanged = true\n    }\n\n    public opacityChange(): void {\n        this.opacityChanged = true\n        this.surfaceChanged || this.surfaceChange()\n    }\n\n    public childrenSortChange(): void {\n        if (!this.childrenSortChanged) {\n            this.childrenSortChanged = this.affectChildrenSort = true\n            this.leaf.forceUpdate('surface')\n        }\n    }\n\n    public destroy(): void { }\n\n}", "import { IEvent, IEventTarget, IObject } from '@leafer/interface'\nimport { Platform } from '@leafer/platform'\n\n\nexport class Event implements IEvent {\n\n    readonly origin: IObject\n\n    readonly type: string\n    readonly target: IEventTarget\n    readonly current: IEventTarget\n\n    readonly bubbles: boolean = false\n    readonly phase: number\n\n    public isStopDefault: boolean\n    public isStop: boolean\n    public isStopNow: boolean\n\n    constructor(type: string, target?: IEventTarget) {\n        this.type = type\n        if (target) this.target = target\n    }\n\n    public stopDefault(): void {\n        this.isStopDefault = true\n        if (this.origin) Platform.event.stopDefault(this.origin)\n    }\n\n    public stopNow(): void {\n        this.isStopNow = true\n        this.isStop = true\n        if (this.origin) Platform.event.stopNow(this.origin)\n    }\n\n    public stop(): void {\n        this.isStop = true\n        if (this.origin) Platform.event.stop(this.origin)\n    }\n}", "import { IChildEvent, ILeaf } from '@leafer/interface'\n\nimport { Event } from './Event'\n\n\nexport class ChildEvent extends Event implements IChildEvent {\n\n    static ADD = 'child.add'\n    static REMOVE = 'child.remove'\n\n    static CREATED = 'created'\n    static MOUNTED = 'mounted'\n    static UNMOUNTED = 'unmounted'\n    static DESTROY = 'destroy'\n\n    readonly parent?: ILeaf\n    readonly child?: ILeaf\n\n    constructor(type: string, child?: ILeaf, parent?: ILeaf) {\n        super(type, child)\n        this.parent = parent\n        this.child = child\n    }\n\n}", "import { IPropertyEvent, IEventTarget, IStringMap } from '@leafer/interface'\n\nimport { Event } from './Event'\n\n\nconst SCROLL = 'property.scroll'\n\nexport class PropertyEvent extends Event implements IPropertyEvent {\n\n    static CHANGE = 'property.change'\n    static LEAFER_CHANGE = 'property.leafer_change'\n\n    static SCROLL = SCROLL\n\n    readonly attrName: string\n    readonly oldValue: unknown\n    readonly newValue: unknown\n\n    constructor(type: string, target: IEventTarget, attrName: string, oldValue: unknown, newValue: unknown) {\n        super(type, target)\n        this.attrName = attrName\n        this.oldValue = oldValue\n        this.newValue = newValue\n    }\n\n}\n\n// 额外派发的属性事件\nexport const extraPropertyEventMap: IStringMap = {\n    scrollX: SCROLL,\n    scrollY: SCROLL\n}", "import { IImageEvent, IObject, ILeaferImage } from '@leafer/interface'\n\nimport { Event } from './Event'\n\nexport class ImageEvent extends Event implements IImageEvent {\n\n    static LOAD = 'image.load'\n    static LOADED = 'image.loaded'\n    static ERROR = 'image.error'\n\n    readonly image: ILeaferImage\n    readonly error: string | IObject\n\n    readonly attrName: string\n    readonly attrValue: IObject\n\n    constructor(type: string, data: IImageEvent) {\n        super(type)\n        Object.assign(this, data)\n    }\n\n}", "import { IBoundsEvent, IEventTarget, ILeaf, IObject } from '@leafer/interface'\n\nimport { Event } from './Event'\n\n\nexport class BoundsEvent extends Event implements IBoundsEvent {\n\n    static RESIZE = 'bounds.resize'\n\n    static INNER = 'bounds.inner'\n\n    static LOCAL = 'bounds.local'\n\n    static WORLD = 'bounds.world'\n\n\n    static checkHas(leaf: IEventTarget, type: string, mode: 'on' | 'off') {\n        if (mode === 'on') {\n            type === WORLD ? leaf.__hasWorldEvent = true : leaf.__hasLocalEvent = true\n        } else {\n            leaf.__hasLocalEvent = leaf.hasEvent(RESIZE) || leaf.hasEvent(INNER) || leaf.hasEvent(LOCAL)\n            leaf.__hasWorldEvent = leaf.hasEvent(WORLD)\n        }\n    }\n\n    static emitLocal(leaf: ILeaf) {\n        if (leaf.leaferIsReady) {\n            const { resized } = leaf.__layout\n            if (resized !== 'local') {\n                leaf.emit(RESIZE, leaf) //  inner / scale\n                if (resized === 'inner') leaf.emit(INNER, leaf)\n            }\n            leaf.emit(LOCAL, leaf)\n        }\n    }\n\n    static emitWorld(leaf: ILeaf) {\n        if (leaf.leaferIsReady) leaf.emit(WORLD, this)\n    }\n\n}\n\nconst { RESIZE, INNER, LOCAL, WORLD } = BoundsEvent\n\n\nexport const boundsEventMap: IObject = {};\n\n[RESIZE, INNER, LOCAL, WORLD].forEach(key => boundsEventMap[key] = 1)", "import { ILeaf, INumberMap, IResizeEvent, IScreenSizeData } from '@leafer/interface'\nimport { isObject, isUndefined } from '@leafer/data'\n\nimport { Event } from './Event'\n\n\nexport class ResizeEvent extends Event implements IResizeEvent {\n\n    static RESIZE: string = 'resize'\n\n    static resizingKeys: INumberMap // resize编辑中的元素 LeafList 键表\n\n    readonly width: number\n    readonly height: number\n    readonly pixelRatio: number\n\n    public get bigger(): boolean {\n        if (!this.old) return true\n        const { width, height } = this.old\n        return this.width >= width && this.height >= height\n    }\n\n    public get smaller(): boolean {\n        return !this.bigger\n    }\n\n    public get samePixelRatio(): boolean {\n        if (!this.old) return true\n        return this.pixelRatio === this.old.pixelRatio\n    }\n\n    readonly old: IScreenSizeData\n\n    constructor(size: IScreenSizeData | string, oldSize?: IScreenSizeData) {\n        if (isObject(size)) {\n            super(ResizeEvent.RESIZE)\n            Object.assign(this, size)\n        } else {\n            super(size)\n        }\n        this.old = oldSize\n    }\n\n    static isResizing(leaf: ILeaf): boolean {\n        return this.resizingKeys && !isUndefined(this.resizingKeys[leaf.innerId])\n    }\n\n}", "import { IWatchEvent, IWatchEventData } from '@leafer/interface'\n\nimport { Event } from './Event'\n\n\nexport class WatchEvent extends Event implements IWatchEvent {\n\n    static REQUEST = 'watch.request'\n    static DATA = 'watch.data'\n\n    readonly data: IWatchEventData\n\n    constructor(type: string, data?: IWatchEventData) {\n        super(type)\n        this.data = data\n    }\n\n}", "import { ILayoutEvent, ILayoutBlockData } from '@leafer/interface'\n\nimport { Event } from './Event'\n\n\nexport class LayoutEvent extends Event implements ILayoutEvent {\n\n    static REQUEST = 'layout.request'\n\n    static START = 'layout.start'\n\n    static BEFORE = 'layout.before'\n    static LAYOUT = 'layout'\n    static AFTER = 'layout.after'\n\n    static AGAIN = 'layout.again'\n\n    static END = 'layout.end'\n\n    readonly data: ILayoutBlockData[]\n    readonly times: number\n\n    constructor(type: string, data?: ILayoutBlockData[], times?: number) {\n        super(type)\n        if (data) {\n            this.data = data\n            this.times = times\n        }\n\n    }\n\n}", "import { IBounds, IRenderEvent, IRenderOptions } from '@leafer/interface'\n\nimport { Event } from './Event'\n\n\nexport class RenderEvent extends Event implements IRenderEvent {\n\n    static REQUEST = 'render.request'\n\n    static CHILD_START = 'render.child_start' // app 专用\n    static CHILD_END = 'render.child_end'\n\n    static START = 'render.start'\n\n    static BEFORE = 'render.before'\n    static RENDER = 'render'\n    static AFTER = 'render.after'\n\n    static AGAIN = 'render.again'\n\n    static END = 'render.end'\n\n    static NEXT = 'render.next'\n\n    readonly renderBounds: IBounds\n    readonly renderOptions: IRenderOptions\n    readonly times: number\n\n    constructor(type: string, times?: number, bounds?: IBounds, options?: IRenderOptions) {\n        super(type)\n        if (times) this.times = times\n        if (bounds) {\n            this.renderBounds = bounds\n            this.renderOptions = options\n        }\n    }\n\n}", "import { ILeaferEvent, IStringMap } from '@leafer/interface'\n\nimport { Event } from './Event'\n\n\nexport class LeaferEvent extends Event implements ILeaferEvent {\n\n    static START = 'leafer.start'\n\n    static BEFORE_READY = 'leafer.before_ready'\n    static READY = 'leafer.ready'\n    static AFTER_READY = 'leafer.after_ready'\n\n    static VIEW_READY = 'leafer.view_ready'\n\n    static VIEW_COMPLETED = 'leafer.view_completed'\n\n    static STOP = 'leafer.stop'\n    static RESTART = 'leafer.restart'\n\n    static END = 'leafer.end'\n\n    static UPDATE_MODE = 'leafer.update_mode'\n\n    // 变换操作\n    static TRANSFORM = 'leafer.transform'\n    static MOVE = 'leafer.move'\n    static SCALE = 'leafer.scale'\n    static ROTATE = 'leafer.rotate'\n    static SKEW = 'leafer.skew'\n}\n\n\nconst { MOVE, SCALE, ROTATE, SKEW } = LeaferEvent\n\nexport const leaferTransformAttrMap: IStringMap = {\n    x: MOVE,\n    y: MOVE,\n    scaleX: SCALE,\n    scaleY: SCALE,\n    rotation: ROTATE,\n    skewX: SKEW,\n    skewY: SKEW\n}", "import { IEventListener, IEventListenerMap, IEventListenerItem, IEventListenerId, IEvent, IObject, IEventTarget, IEventOption, IEventer, IEventParamsMap, InnerId, IEventParams, IFunction } from '@leafer/interface'\nimport { EventCreator } from '@leafer/platform'\nimport { isArray, isObject, isString, isUndefined } from '@leafer/data'\n\nimport { BoundsEvent, boundsEventMap } from './BoundsEvent'\n\n\nconst empty = {}\n\n\nexport class Eventer implements IEventer {\n\n    public readonly innerId: InnerId\n\n    public __captureMap?: IEventListenerMap\n\n    public __bubbleMap?: IEventListenerMap\n\n    public __hasLocalEvent?: boolean\n    public __hasWorldEvent?: boolean\n\n    public syncEventer?: IEventer // 同步触发一样事件的元素\n\n    public set event(map: IEventParamsMap) { this.on(map) }\n\n\n    public on(type: string | string[] | IEventParams[] | IEventParamsMap, listener?: IEventListener, options?: IEventOption): void {\n\n        if (!listener) {\n            let event: IFunction | [IFunction, IEventOption]\n            if (isArray(type)) (type as IEventParams[]).forEach(item => this.on(item[0], item[1], item[2]))\n            else for (let key in type as IEventParamsMap) isArray(event = (type as IEventParamsMap)[key]) ? this.on(key, event[0], event[1]) : this.on(key, event)\n            return\n        }\n\n        let capture: boolean, once: boolean\n        if (options) {\n            if (options === 'once') {\n                once = true\n            } else if (typeof options === 'boolean') {\n                capture = options\n            } else {\n                capture = options.capture\n                once = options.once\n            }\n        }\n\n        let events: IEventListenerItem[]\n        const map = __getListenerMap(this, capture, true)\n        const typeList = isString(type) ? type.split(' ') : type as string[]\n        const item = once ? { listener, once } : { listener }\n\n        typeList.forEach(type => {\n            if (type) {\n                events = map[type]\n                if (events) {\n                    if (events.findIndex(item => item.listener === listener) === -1) events.push(item)\n                } else {\n                    map[type] = [item]\n                }\n\n                if (boundsEventMap[type]) BoundsEvent.checkHas(this, type, 'on')\n            }\n        })\n    }\n\n    public off(type?: string | string[], listener?: IEventListener, options?: IEventOption): void {\n        if (type) {\n\n            const typeList = isString(type) ? type.split(' ') : type\n\n            if (listener) {\n\n                let capture: boolean\n                if (options) capture = typeof options === 'boolean' ? options : (options === 'once' ? false : options.capture)\n\n                let events: IEventListenerItem[], index: number\n                const map = __getListenerMap(this, capture)\n\n                typeList.forEach(type => {\n                    if (type) {\n                        events = map[type]\n                        if (events) {\n                            index = events.findIndex(item => item.listener === listener)\n                            if (index > -1) events.splice(index, 1)\n                            if (!events.length) delete map[type]\n                            if (boundsEventMap[type]) BoundsEvent.checkHas(this, type, 'off')\n                        }\n                    }\n                })\n\n            } else {\n\n                // off type\n                const { __bubbleMap: b, __captureMap: c } = this\n                typeList.forEach(type => {\n                    if (b) delete b[type]\n                    if (c) delete c[type]\n                })\n\n            }\n\n        } else {\n\n            this.__bubbleMap = this.__captureMap = undefined  // off all\n\n        }\n\n    }\n\n    public on_(type: string | string[] | IEventParams[], listener?: IEventListener, bind?: IObject, options?: IEventOption): IEventListenerId {\n        if (!listener) isArray(type) && (type as IEventParams[]).forEach(item => this.on(item[0], item[2] ? item[1] = item[1].bind(item[2]) : item[1], item[3]))\n        else this.on(type, bind ? listener = listener.bind(bind) : listener, options)\n        return { type, current: this as any, listener, options }\n    }\n\n    public off_(id: IEventListenerId | IEventListenerId[]): void {\n        if (!id) return\n        const list = isArray(id) ? id : [id]\n        list.forEach(item => {\n            if (item) {\n                if (!item.listener) isArray(item.type) && (item.type as IEventParams[]).forEach(v => item.current.off(v[0], v[1], v[3]))\n                else item.current.off(item.type as string | string[], item.listener, item.options)\n            }\n        })\n        list.length = 0\n    }\n\n    public once(type: string | string[] | IEventParams[], listener?: IEventListener, captureOrBind?: boolean | IObject, capture?: boolean): void {\n        if (!listener) return isArray(type) && (type as IEventParams[]).forEach(item => this.once(item[0], item[1], item[2], item[3]))\n        if (isObject(captureOrBind)) listener = listener.bind(captureOrBind)\n        else capture = captureOrBind\n        this.on(type, listener, { once: true, capture })\n    }\n\n    public emit(type: string, event?: IEvent | IObject, capture?: boolean): void {\n        if (!event && EventCreator.has(type)) event = EventCreator.get(type, { type, target: this, current: this } as IEvent)\n\n        const map = __getListenerMap(this, capture)\n        const list = map[type]\n        if (list) {\n            let item: IEventListenerItem\n            for (let i = 0, len = list.length; i < len; i++) {\n                if (item = list[i]) { // 防止 list 变化造成的空值\n                    item.listener(event)\n                    if (item.once) {\n                        this.off(type, item.listener, capture)\n                        i--, len--\n                    }\n                    if (event && event.isStopNow) break\n                }\n            }\n        }\n\n        this.syncEventer && this.syncEventer.emitEvent(event, capture)\n    }\n\n    public emitEvent(event: IEvent, capture?: boolean): void {\n        event.current = this\n        this.emit(event.type, event, capture)\n    }\n\n    public hasEvent(type: string, capture?: boolean): boolean {\n        if (this.syncEventer && this.syncEventer.hasEvent(type, capture)) return true\n\n        const { __bubbleMap: b, __captureMap: c } = this\n        const hasB = b && b[type], hasC = c && c[type]\n        return !!(isUndefined(capture) ? (hasB || hasC) : (capture ? hasC : hasB))\n    }\n\n    public destroy(): void {\n        this.__captureMap = this.__bubbleMap = this.syncEventer = null\n    }\n}\n\n\nfunction __getListenerMap(eventer: IEventTarget, capture?: boolean, create?: boolean): IEventListenerMap {\n    if (capture) {\n\n        const { __captureMap: c } = eventer\n        if (c) {\n            return c\n        } else {\n            return create ? eventer.__captureMap = {} : empty\n        }\n\n    } else {\n\n        const { __bubbleMap: b } = eventer\n        if (b) {\n            return b\n        } else {\n            return create ? eventer.__bubbleMap = {} : empty\n        }\n\n    }\n}", "import { ILeafEventerModule } from '@leafer/interface'\nimport { Eventer } from '@leafer/event'\n\nconst { on, on_, off, off_, once, emit, emitEvent, hasEvent, destroy } = Eventer.prototype\n\nexport const LeafEventer: ILeafEventerModule = { on, on_, off, off_, once, emit, emitEvent, hasEvent, destroyEventer: destroy }", "import { ILeafDataProxyModule, IObject, IValue } from '@leafer/interface'\nimport { PropertyEvent, extraPropertyEventMap, LeaferEvent, leaferTransformAttrMap } from '@leafer/event'\nimport { isObject, isFinite, isUndefined } from '@leafer/data'\nimport { Debug } from '@leafer/debug'\n\n\nconst debug = Debug.get('setAttr')\n\nexport const LeafDataProxy: ILeafDataProxyModule = {\n\n    __setAttr(name: string, newValue: IValue, checkFiniteNumber?: boolean): boolean {\n        if (this.leaferIsCreated) {\n\n            const oldValue = this.__.__getInput(name)\n\n            if (checkFiniteNumber && !isFinite(newValue) && !isUndefined(newValue)) { // 警告 NaN、Infinity、-Infinity、null、非有效数字\n                debug.warn(this.innerName, name, newValue)\n                newValue = undefined // must\n            }\n\n            if (isObject(newValue) || oldValue !== newValue) {\n\n                this.__realSetAttr(name, newValue)\n\n                if (this.isLeafer) {\n                    this.emitEvent(new PropertyEvent(PropertyEvent.LEAFER_CHANGE, this, name, oldValue, newValue))\n\n                    const transformEventName = leaferTransformAttrMap[name]\n                    if (transformEventName) {\n                        this.emitEvent(new LeaferEvent(transformEventName, this))\n                        this.emitEvent(new LeaferEvent(LeaferEvent.TRANSFORM, this))\n                    }\n                }\n\n                this.emitPropertyEvent(PropertyEvent.CHANGE, name, oldValue, newValue)\n\n                const extraPropertyEvent = extraPropertyEventMap[name]\n                if (extraPropertyEvent) this.emitPropertyEvent(extraPropertyEvent, name, oldValue, newValue)\n\n                return true\n            } else {\n                return false\n            }\n\n        } else {\n\n            this.__realSetAttr(name, newValue)\n\n            return true\n\n        }\n    },\n\n    emitPropertyEvent(type: string, name: string, oldValue: unknown, newValue: unknown): void {\n        const event = new PropertyEvent(type, this, name, oldValue, newValue)\n        this.isLeafer || (this.hasEvent(type) && this.emitEvent(event))\n        this.leafer.emitEvent(event)\n    },\n\n    __realSetAttr(name: string, newValue: IValue): void {\n        const data = this.__ as IObject\n        data[name] = newValue\n        if (this.__proxyData) this.setProxyAttr(name, newValue)\n        if (data.normalStyle) this.lockNormalStyle || isUndefined(data.normalStyle[name]) || (data.normalStyle[name] = newValue)\n    },\n\n\n    __getAttr(name: string): IValue {\n        if (this.__proxyData) return this.getProxyAttr(name)\n        return this.__.__get(name)\n    }\n}", "import { ILeafMatrixModule, ILayoutData } from '@leafer/interface'\nimport { AroundHelper, MatrixHelper } from '@leafer/math'\n\n\nconst { setLayout, multiplyParent, translateInner, defaultWorld } = MatrixHelper\nconst { toPoint, tempPoint } = AroundHelper\n\nexport const LeafMatrix: ILeafMatrixModule = {\n\n    __updateWorldMatrix(): void {\n\n        const { parent, __layout, __world, __scrollWorld, __ } = this\n        multiplyParent(this.__local || __layout, parent ? (parent.__scrollWorld || parent.__world) : defaultWorld, __world, !!__layout.affectScaleOrRotation, __ as ILayoutData)\n\n        if (__scrollWorld) translateInner(Object.assign(__scrollWorld, __world), __.scrollX, __.scrollY)\n    },\n\n    __updateLocalMatrix(): void {\n\n        if (this.__local) {\n\n            const layout = this.__layout, local = this.__local, data = this.__\n\n            if (layout.affectScaleOrRotation) {\n\n                if ((layout.scaleChanged && (layout.resized || (layout.resized = 'scale'))) || layout.rotationChanged) {\n                    setLayout(local, data as ILayoutData, null, null, layout.affectRotation)\n                    layout.scaleChanged = layout.rotationChanged = undefined\n                }\n\n            }\n\n            local.e = data.x + data.offsetX\n            local.f = data.y + data.offsetY\n\n            if (data.around || data.origin) {\n                toPoint(data.around || data.origin, layout.boxBounds, tempPoint)\n                translateInner(local, -tempPoint.x, -tempPoint.y, !data.around)\n            }\n\n        }\n\n        this.__layout.matrixChanged = undefined\n\n    }\n\n}\n\n\n", "import { ILeafBoundsModule, IBoundsData } from '@leafer/interface'\nimport { BoundsHelper } from '@leafer/math'\nimport { PathBounds } from '@leafer/path'\nimport { BranchHelper, LeafHelper } from '@leafer/helper'\nimport { BoundsEvent } from '@leafer/event'\nimport { isNumber } from '@leafer/data'\n\n\nconst { updateMatrix, updateAllMatrix } = LeafHelper\nconst { updateBounds } = BranchHelper\nconst { toOuterOf, copyAndSpread, copy } = BoundsHelper\nconst { toBounds } = PathBounds\n\nexport const LeafBounds: ILeafBoundsModule = {\n\n    __updateWorldBounds(): void {\n\n        const { __layout, __world } = this\n        toOuterOf(__layout.renderBounds, __world, __world)\n\n        if (__layout.resized) {\n            if (__layout.resized === 'inner') this.__onUpdateSize() // scale变化不用更新\n            if (this.__hasLocalEvent) BoundsEvent.emitLocal(this)\n            __layout.resized = undefined\n        }\n\n        if (this.__hasWorldEvent) BoundsEvent.emitWorld(this)\n\n    },\n\n    __updateLocalBounds(): void {\n\n        const layout = this.__layout\n\n        if (layout.boxChanged) {\n\n            if (!this.__.__pathInputed) this.__updatePath()\n            this.__updateRenderPath()\n\n            this.__updateBoxBounds()\n            layout.resized = 'inner'\n        }\n\n\n        if (layout.localBoxChanged) { // position change\n\n            if (this.__local) this.__updateLocalBoxBounds()\n            layout.localBoxChanged = undefined\n\n            if (layout.strokeSpread) layout.strokeChanged = true\n            if (layout.renderSpread) layout.renderChanged = true\n            if (this.parent) this.parent.__layout.boxChange()\n        }\n\n\n        layout.boxChanged = undefined // must after updateLocalBoxBounds()\n\n\n        if (layout.strokeChanged) {\n\n            layout.strokeSpread = this.__updateStrokeSpread()\n\n            if (layout.strokeSpread) {\n\n                if (layout.strokeBounds === layout.boxBounds) layout.spreadStroke()\n\n                this.__updateStrokeBounds()\n                this.__updateLocalStrokeBounds()\n\n            } else {\n                layout.spreadStrokeCancel()\n            }\n\n            layout.strokeChanged = undefined\n            if (layout.renderSpread || layout.strokeSpread !== layout.strokeBoxSpread) layout.renderChanged = true\n\n            if (this.parent) this.parent.__layout.strokeChange()\n            layout.resized = 'inner'\n        }\n\n\n        if (layout.renderChanged) {\n\n            layout.renderSpread = this.__updateRenderSpread()\n\n            if (layout.renderSpread) {\n\n                if (layout.renderBounds === layout.boxBounds || layout.renderBounds === layout.strokeBounds) layout.spreadRender()\n\n                this.__updateRenderBounds()\n                this.__updateLocalRenderBounds()\n\n            } else {\n                layout.spreadRenderCancel()\n            }\n\n            layout.renderChanged = undefined\n\n            if (this.parent) this.parent.__layout.renderChange()\n        }\n\n        layout.resized || (layout.resized = 'local')\n        layout.boundsChanged = undefined\n\n    },\n\n    __updateLocalBoxBounds(): void {\n        if (this.__hasMotionPath) this.__updateMotionPath()\n        if (this.__hasAutoLayout) this.__updateAutoLayout() //  origin / around / flow\n        toOuterOf(this.__layout.boxBounds, this.__local, this.__local)\n    },\n\n    __updateLocalStrokeBounds(): void {\n        toOuterOf(this.__layout.strokeBounds, this.__localMatrix, this.__layout.localStrokeBounds)\n    },\n\n    __updateLocalRenderBounds(): void {\n        toOuterOf(this.__layout.renderBounds, this.__localMatrix, this.__layout.localRenderBounds)\n    },\n\n\n    __updateBoxBounds(_secondLayout?: boolean, _bounds?: IBoundsData): void {\n        const b = this.__layout.boxBounds\n        const data = this.__\n        if (data.__usePathBox) {\n            toBounds(data.path, b)\n        } else {\n            b.x = 0\n            b.y = 0\n            b.width = data.width\n            b.height = data.height\n        }\n    },\n\n\n    __updateAutoLayout(): void {\n        this.__layout.matrixChanged = true\n        if (this.isBranch) {\n\n            this.__extraUpdate()\n\n            if (this.__.flow) {\n\n                if (this.__layout.boxChanged) this.__updateFlowLayout()\n\n                updateAllMatrix(this)\n                updateBounds(this, this)\n\n                if (this.__.__autoSide) this.__updateBoxBounds(true)\n\n            } else {\n\n                updateAllMatrix(this)\n                updateBounds(this, this)\n\n            }\n\n        } else {\n            updateMatrix(this)\n        }\n    },\n\n    __updateNaturalSize(): void {\n        const { __: data, __layout: layout } = this\n        data.__naturalWidth = layout.boxBounds.width\n        data.__naturalHeight = layout.boxBounds.height\n    },\n\n    __updateStrokeBounds(_bounds?: IBoundsData): void {\n        const layout = this.__layout\n        copyAndSpread(layout.strokeBounds, layout.boxBounds, layout.strokeBoxSpread)\n    },\n\n    __updateRenderBounds(_bounds?: IBoundsData): void {\n        const layout = this.__layout, { renderSpread } = layout\n        isNumber(renderSpread) && renderSpread <= 0 ? copy(layout.renderBounds, layout.strokeBounds) : copyAndSpread(layout.renderBounds, layout.boxBounds, renderSpread) // Box use -1\n    }\n\n}", "import { ILeaferCanvas, IRenderOptions, ILeafRenderModule } from '@leafer/interface'\nimport { LeafHelper } from '@leafer/helper'\nimport { Debug } from '@leafer/debug'\n\n\nexport const LeafRender: ILeafRenderModule = {\n\n    __render(canvas: ILeaferCanvas, options: IRenderOptions): void {\n\n        if (options.shape) return this.__renderShape(canvas, options)\n        if (options.cellList && !options.cellList.has(this)) return\n\n        if (this.__worldOpacity) {\n\n            const data = this.__\n\n            if (data.bright && !options.topRendering) return options.topList.add(this)\n\n            canvas.setWorld(this.__nowWorld = this.__getNowWorld(options))\n            canvas.opacity = options.dimOpacity && !data.dimskip ? data.opacity * options.dimOpacity : data.opacity\n\n            if (this.__.__single) {\n\n                if (data.eraser === 'path') return this.__renderEraser(canvas, options)\n\n                const tempCanvas = canvas.getSameCanvas(true, true)\n                this.__draw(tempCanvas, options, canvas)\n\n                LeafHelper.copyCanvasByWorld(this, canvas, tempCanvas, this.__nowWorld, data.__blendMode, true)\n\n                tempCanvas.recycle(this.__nowWorld)\n\n            } else {\n\n                this.__draw(canvas, options)\n\n            }\n\n            if (Debug.showBounds) Debug.drawBounds(this, canvas, options)\n\n        }\n    },\n\n    __renderShape(canvas: ILeaferCanvas, options: IRenderOptions): void {\n        if (this.__worldOpacity) {\n            canvas.setWorld(this.__nowWorld = this.__getNowWorld(options))\n\n            this.__drawShape(canvas, options)\n        }\n    },\n\n    __clip(canvas: ILeaferCanvas, options: IRenderOptions): void {\n        if (this.__worldOpacity) {\n            canvas.setWorld(this.__nowWorld = this.__getNowWorld(options))\n            this.__drawRenderPath(canvas)\n            canvas.clipUI(this)\n        }\n    },\n\n    __updateWorldOpacity(): void {\n        this.__worldOpacity = this.__.visible ? (this.parent ? this.parent.__worldOpacity * this.__.opacity : this.__.opacity) : 0\n        if (this.__layout.opacityChanged) this.__layout.opacityChanged = false\n    }\n\n}", "import { ILeaferCanvas, IRenderOptions, IBranchRenderModule } from '@leafer/interface'\nimport { BoundsHelper } from '@leafer/math'\nimport { LeafBoundsHelper } from '@leafer/helper'\n\n\nconst { excludeRenderBounds } = LeafBoundsHelper, { hasSize } = BoundsHelper\n\nexport const BranchRender: IBranchRenderModule = {\n\n    __updateChange(): void {\n        const { __layout: layout } = this\n        if (layout.childrenSortChanged) {\n            this.__updateSortChildren()\n            layout.childrenSortChanged = false\n        }\n\n        this.__.__checkSingle()\n    },\n\n\n    __render(canvas: ILeaferCanvas, options: IRenderOptions): void {\n\n        const nowWorld = this.__nowWorld = this.__getNowWorld(options)\n\n        if (this.__worldOpacity && hasSize(nowWorld)) { // 无宽高时渲染 mask 会有问题\n\n            const data = this.__\n\n            if (data.__useDim) {\n                if (data.dim) options.dimOpacity = data.dim === true ? 0.2 : data.dim\n                else if (data.bright && !options.topRendering) return options.topList.add(this)\n                else if (data.dimskip) options.dimOpacity && (options.dimOpacity = 0)\n            }\n\n            if (data.__single && !this.isBranchLeaf) { // Frame / Box 不能走 single 逻辑渲染组，需用 drawAfterFill 渲染成一个整体， 关联设置 BoxData.__drawAfterFill\n\n                if (data.eraser === 'path') return this.__renderEraser(canvas, options)\n\n                const tempCanvas = canvas.getSameCanvas(false, true)\n\n                this.__renderBranch(tempCanvas, options)\n\n                canvas.opacity = options.dimOpacity ? data.opacity * options.dimOpacity : data.opacity\n                canvas.copyWorldByReset(tempCanvas, nowWorld, nowWorld, data.__blendMode, true)\n\n                tempCanvas.recycle(nowWorld)\n\n            } else {\n\n                this.__renderBranch(canvas, options)\n\n            }\n\n        }\n\n    },\n\n    __renderBranch(canvas: ILeaferCanvas, options: IRenderOptions): void {\n        if (this.__hasMask) {\n\n            this.__renderMask(canvas, options)\n\n        } else {\n\n            const { children } = this\n            for (let i = 0, len = children.length; i < len; i++) {\n                excludeRenderBounds(children[i], options) || children[i].__render(canvas, options)\n            }\n\n        }\n    },\n\n\n    __clip(canvas: ILeaferCanvas, options: IRenderOptions): void {\n        if (this.__worldOpacity) {\n            const { children } = this\n            for (let i = 0, len = children.length; i < len; i++) {\n                excludeRenderBounds(children[i], options) || children[i].__clip(canvas, options)\n            }\n        }\n    }\n}", "import { ILeaferBase, ILeaf, ILeafInputData, ILeafData, ILeaferCanvas, IRenderOptions, IBoundsType, ILocationType, IMatrixWithBoundsData, ILayoutBoundsData, IValue, ILeafLayout, InnerId, IHitCanvas, IRadiusPointData, IEventListenerMap, IEventListener, IEventListenerId, IEvent, IObject, IFunction, IPointData, IBoundsData, IBranch, IFindMethod, IMatrixData, IAttrDecorator, IMatrixWithBoundsScaleData, IMatrixWithScaleData, IAlign, IJSONOptions, IEventParamsMap, IEventOption, IAxis, IMotionPathData, IUnitData, IRotationPointData, ITransition, IValueFunction, IEventParams, IScaleData, IScaleFixed, IFourNumber } from '@leafer/interface'\nimport { BoundsHelper, IncrementId, MatrixHelper, PointHelper } from '@leafer/math'\nimport { LeafData, isUndefined, DataHelper } from '@leafer/data'\nimport { LeafLayout } from '@leafer/layout'\nimport { LeafDataProxy, LeafMatrix, LeafBounds, LeafEventer, LeafRender } from '@leafer/display-module'\nimport { boundsType, useModule, defineDataProcessor } from '@leafer/decorator'\nimport { LeafHelper } from '@leafer/helper'\nimport { ChildEvent } from '@leafer/event'\nimport { ImageManager } from '@leafer/image'\nimport { Plugin } from '@leafer/debug'\n\n\nconst tempScaleData = {} as IScaleData\nconst { LEAF, create } = IncrementId\nconst { stintSet } = DataHelper\nconst { toInnerPoint, toOuterPoint, multiplyParent } = MatrixHelper\nconst { toOuterOf } = BoundsHelper\nconst { copy, move } = PointHelper\nconst { moveLocal, zoomOfLocal, rotateOfLocal, skewOfLocal, moveWorld, zoomOfWorld, rotateOfWorld, skewOfWorld, transform, transformWorld, setTransform, getFlipTransform, getLocalOrigin, getRelativeWorld, drop } = LeafHelper\n\n@useModule(LeafDataProxy)\n@useModule(LeafMatrix)\n@useModule(LeafBounds)\n@useModule(LeafEventer)\n@useModule(LeafRender)\nexport class Leaf<TInputData = ILeafInputData> implements ILeaf {\n\n    public get tag(): string { return this.__tag }\n    public set tag(_value: string) { }\n\n    public get __tag(): string { return 'Leaf' }\n\n    public readonly innerId: InnerId  // 内部唯一标识\n    public get innerName(): string { return this.__.name || this.tag + this.innerId }\n\n    public get __DataProcessor() { return LeafData }\n    public get __LayoutProcessor() { return LeafLayout }\n\n    public leafer?: ILeaferBase\n    public parent?: ILeaf\n\n    public get leaferIsCreated(): boolean { return this.leafer && this.leafer.created }\n    public get leaferIsReady(): boolean { return this.leafer && this.leafer.ready }\n\n    public get isLeafer(): boolean { return false }\n    public get isBranch(): boolean { return false }\n    public get isBranchLeaf(): boolean { return false }\n\n    public syncEventer?: ILeaf // 同步触发一样事件的元素\n    public lockNormalStyle?: boolean\n\n    public __: ILeafData\n    public __layout: ILeafLayout\n\n    public __world: IMatrixWithBoundsScaleData\n    public __local?: IMatrixWithBoundsData // and localStrokeBounds? localRenderBounds?\n\n    public __nowWorld?: IMatrixWithBoundsScaleData // use __world or __cameraWorld render\n    public __cameraWorld?: IMatrixWithBoundsScaleData // use camera matrix render  \n\n    public get __localMatrix(): IMatrixData { return this.__local || this.__layout }\n    public get __localBoxBounds(): IBoundsData { return this.__local || this.__layout }\n\n    public __worldOpacity: number\n\n    // now transform\n    public get worldTransform(): IMatrixWithScaleData { return this.__layout.getTransform('world') as IMatrixWithScaleData }\n    public get localTransform(): IMatrixData { return this.__layout.getTransform('local') }\n\n    public __scrollWorld?: IMatrixWithBoundsScaleData\n    public get scrollWorldTransform(): IMatrixWithScaleData { this.updateLayout(); return this.__scrollWorld || this.__world }\n\n    // now bounds\n    public get boxBounds(): IBoundsData { return this.getBounds('box', 'inner') }\n    public get renderBounds(): IBoundsData { return this.getBounds('render', 'inner') }\n    public get worldBoxBounds(): IBoundsData { return this.getBounds('box') }\n    public get worldStrokeBounds(): IBoundsData { return this.getBounds('stroke') }\n    public get worldRenderBounds(): IBoundsData { return this.getBounds('render') }\n\n    // now opacity\n    public get worldOpacity(): number { this.updateLayout(); return this.__worldOpacity }\n\n    public __level: number // layer level  0 -> branch -> branch -> deep\n    public __tempNumber: number // temp sort\n\n    public get __worldFlipped(): boolean { return this.__world.scaleX < 0 || this.__world.scaleY < 0 }\n\n    public __hasAutoLayout?: boolean\n    public __hasMask?: boolean\n    public __hasEraser?: boolean\n    public __hitCanvas?: IHitCanvas\n\n    public get __onlyHitMask(): boolean { return this.__hasMask && !this.__.hitChildren }\n    public get __ignoreHitWorld(): boolean { return (this.__hasMask || this.__hasEraser) && this.__.hitChildren }\n    public get __inLazyBounds(): boolean { return this.leaferIsCreated && this.leafer.lazyBounds.hit(this.__world) }\n\n    public get pathInputed(): boolean { return this.__.__pathInputed as unknown as boolean }\n\n    // event\n    public set event(map: IEventParamsMap) { this.on(map) }\n\n    public __captureMap?: IEventListenerMap\n    public __bubbleMap?: IEventListenerMap\n\n    public __hasLocalEvent?: boolean\n    public __hasWorldEvent?: boolean\n\n    // branch \n    public children?: ILeaf[]\n    public topChildren?: ILeaf[]\n\n    public destroyed: boolean\n\n\n    constructor(data?: TInputData) {\n        this.innerId = create(LEAF)\n        this.reset(data)\n        if (this.__bubbleMap) this.__emitLifeEvent(ChildEvent.CREATED)\n    }\n\n\n    public reset(data?: ILeafInputData): void {\n        if (this.leafer) this.leafer.forceRender(this.__world) // fix: add old bounds rendering\n\n        if (data as any !== 0) {  // 设为 0 时可用于 text boxStyle 节省开销\n            this.__world = { a: 1, b: 0, c: 0, d: 1, e: 0, f: 0, x: 0, y: 0, width: 0, height: 0, scaleX: 1, scaleY: 1 }\n            if (data !== null) this.__local = { a: 1, b: 0, c: 0, d: 1, e: 0, f: 0, x: 0, y: 0, width: 0, height: 0 }\n        }\n\n        this.__worldOpacity = 1\n\n        this.__ = new this.__DataProcessor(this)\n        this.__layout = new this.__LayoutProcessor(this)\n\n        if (this.__level) this.resetCustom()\n        if (data) {\n            if ((data as ILeaf).__) data = (data as ILeaf).toJSON()\n            data.children ? this.set(data) : Object.assign(this, data)\n        }\n    }\n\n    public resetCustom(): void {\n        this.__hasMask = this.__hasEraser = null\n        this.forceUpdate()\n    }\n\n\n    public waitParent(item: IFunction, bind?: IObject): void {\n        if (bind) item = item.bind(bind)\n        this.parent ? item() : this.on(ChildEvent.ADD, item, 'once')\n    }\n\n    public waitLeafer(item: IFunction, bind?: IObject): void {\n        if (bind) item = item.bind(bind)\n        this.leafer ? item() : this.on(ChildEvent.MOUNTED, item, 'once')\n    }\n\n    public nextRender(item: IFunction, bind?: IObject, off?: 'off'): void {\n        this.leafer ? this.leafer.nextRender(item, bind, off) : this.waitLeafer(() => this.leafer.nextRender(item, bind, off))\n    }\n\n    public removeNextRender(item: IFunction): void {\n        this.nextRender(item, null, 'off')\n    }\n\n    public __bindLeafer(leafer: ILeaferBase | null): void {\n        if (this.isLeafer && leafer !== null) leafer = this as unknown as ILeaferBase\n\n        if (this.leafer && !leafer) this.leafer.leafs--\n\n        this.leafer = leafer\n\n        if (leafer) {\n            leafer.leafs++\n            this.__level = this.parent ? this.parent.__level + 1 : 1\n            if ((this as ILeaf).animation) this.__runAnimation('in')\n            if (this.__bubbleMap) this.__emitLifeEvent(ChildEvent.MOUNTED)\n        } else {\n            this.__emitLifeEvent(ChildEvent.UNMOUNTED)\n        }\n\n        if (this.isBranch) {\n            const { children } = this\n            for (let i = 0, len = children.length; i < len; i++) {\n                children[i].__bindLeafer(leafer)\n            }\n        }\n    }\n\n    // data\n\n    public set(_data: IObject, _isTemp?: boolean): void { }\n\n    public get<K extends keyof this>(_name?: K | K[] | ILeafInputData): ILeafInputData | this[K] { return undefined }\n\n    public setAttr(name: string, value: any): void { (this as IObject)[name] = value }\n    public getAttr(name: string): any { return (this as IObject)[name] }\n\n    public getComputedAttr(name: string): any { return (this.__ as IObject)[name] }\n\n    public toJSON(options?: IJSONOptions): IObject {\n        if (options) this.__layout.update()\n        return this.__.__getInputData(null, options)\n    }\n\n    public toString(options?: IJSONOptions): string {\n        return JSON.stringify(this.toJSON(options))\n    }\n\n    public toSVG(): string { return undefined }\n\n    public __SVG(_data: IObject): void { }\n\n    public toHTML(): string { return undefined }\n\n    // LeafDataProxy rewrite\n\n    public __setAttr(_attrName: string, _newValue: IValue): boolean { return true }\n\n    public __getAttr(_attrName: string): IValue { return undefined }\n\n    public setProxyAttr(_attrName: string, _newValue: IValue): void { }\n\n    public getProxyAttr(_attrName: string): IValue { return undefined }\n\n    // ---\n\n\n    // find\n\n    public find(_condition: number | string | IFindMethod, _options?: any): ILeaf[] { return undefined }\n\n    public findTag(_tag: string | string[]): ILeaf[] { return undefined }\n\n    public findOne(_condition: number | string | IFindMethod, _options?: any): ILeaf | undefined { return undefined }\n\n    public findId(_id: number | string): ILeaf | undefined { return undefined }\n\n    // ---\n\n\n    // @leafer-in/state rewrite\n\n    public focus(_value?: boolean): void { }\n\n    public updateState(): void { }\n\n    // ---\n\n\n    public updateLayout(): void {\n        this.__layout.update()\n    }\n\n    public forceUpdate(attrName?: string): void {\n        if (isUndefined(attrName)) attrName = 'width'\n        else if (attrName === 'surface') attrName = 'blendMode'\n        const value = this.__.__getInput(attrName);\n        (this.__ as any)[attrName] = isUndefined(value) ? null : undefined;\n        (this as any)[attrName] = value\n    }\n\n    public forceRender(_bounds?: IBoundsData, _sync?: boolean): void {\n        this.forceUpdate('surface')\n    }\n\n    public __extraUpdate(): void {\n        if (this.leaferIsReady) this.leafer.layouter.addExtra(this) // add part 额外更新元素\n    }\n\n    // LeafMatrix rewrite\n\n    public __updateWorldMatrix(): void { }\n\n    public __updateLocalMatrix(): void { }\n\n    // ---\n\n    // LeafBounds rewrite\n\n    public __updateWorldBounds(): void { }\n\n    public __updateLocalBounds(): void { }\n\n\n    public __updateLocalBoxBounds(): void { }\n\n    public __updateLocalStrokeBounds(): void { }\n\n    public __updateLocalRenderBounds(): void { }\n\n    // box\n\n    public __updateBoxBounds(_secondLayout?: boolean, _bounds?: IBoundsData): void { }\n\n    public __updateContentBounds(): void { }\n\n    public __updateStrokeBounds(_bounds?: IBoundsData): void { }\n\n    public __updateRenderBounds(_bounds?: IBoundsData): void { }\n\n\n    public __updateAutoLayout(): void { }\n\n    public __updateFlowLayout(): void { }\n\n    public __updateNaturalSize(): void { }\n\n\n    public __updateStrokeSpread(): IFourNumber { return 0 }\n\n    public __updateRenderSpread(): IFourNumber { return 0 }\n\n    public __onUpdateSize(): void { }\n\n    // ---\n\n\n    public __updateEraser(value?: boolean): void {\n        this.__hasEraser = value ? true : this.children.some(item => item.__.eraser)\n    }\n\n    public __renderEraser(canvas: ILeaferCanvas, options: IRenderOptions): void {  // path eraser\n        canvas.save()\n        this.__clip(canvas, options)\n        const { renderBounds: r } = this.__layout\n        canvas.clearRect(r.x, r.y, r.width, r.height)\n        canvas.restore()\n    }\n\n    public __updateMask(_value?: boolean): void {\n        this.__hasMask = this.children.some(item => item.__.mask && item.__.visible && item.__.opacity)\n    }\n\n    // LeafMask rewrite\n\n    public __renderMask(_canvas: ILeaferCanvas, _options: IRenderOptions): void { }\n\n\n    // ---\n\n\n    // convert\n\n    public __getNowWorld(options: IRenderOptions): IMatrixWithBoundsScaleData {\n        if (options.matrix) {\n            if (!this.__cameraWorld) this.__cameraWorld = {} as IMatrixWithBoundsScaleData\n            const cameraWorld = this.__cameraWorld, world = this.__world\n            multiplyParent(world, options.matrix, cameraWorld, undefined, world)\n            toOuterOf(this.__layout.renderBounds, cameraWorld, cameraWorld)\n            stintSet(cameraWorld, 'half', world.half)\n            stintSet(cameraWorld, 'ignorePixelSnap', world.ignorePixelSnap)\n            return cameraWorld\n        } else {\n            return this.__world\n        }\n    }\n\n    public getClampRenderScale(): number {\n        let { scaleX } = this.__nowWorld || this.__world\n        if (scaleX < 0) scaleX = -scaleX\n        return scaleX > 1 ? scaleX : 1\n    }\n\n    public getRenderScaleData(abs?: boolean, scaleFixed?: IScaleFixed): IScaleData {\n        let { scaleX, scaleY } = ImageManager.patternLocked ? this.__world : this.__nowWorld\n        if (abs) scaleX < 0 && (scaleX = -scaleX), scaleY < 0 && (scaleY = -scaleY)\n        if (scaleFixed === true || (scaleFixed === 'zoom-in' && scaleX > 1 && scaleY > 1)) scaleX = scaleY = 1\n        tempScaleData.scaleX = scaleX\n        tempScaleData.scaleY = scaleY\n        return tempScaleData\n    }\n\n    public getTransform(relative?: ILocationType | ILeaf): IMatrixData {\n        return this.__layout.getTransform(relative || 'local')\n    }\n\n\n    public getBounds(type?: IBoundsType, relative?: ILocationType | ILeaf): IBoundsData {\n        return this.__layout.getBounds(type, relative)\n    }\n\n    public getLayoutBounds(type?: IBoundsType, relative?: ILocationType | ILeaf, unscale?: boolean): ILayoutBoundsData {\n        return this.__layout.getLayoutBounds(type, relative, unscale)\n    }\n\n    public getLayoutPoints(type?: IBoundsType, relative?: ILocationType | ILeaf): IPointData[] {\n        return this.__layout.getLayoutPoints(type, relative)\n    }\n\n\n    public getWorldBounds(inner: IBoundsData, relative?: ILeaf, change?: boolean): IBoundsData {\n        const matrix = relative ? getRelativeWorld(this, relative) : this.worldTransform\n        const to = change ? inner : {} as IBoundsData\n        toOuterOf(inner, matrix, to)\n        return to\n    }\n\n\n    public worldToLocal(world: IPointData, to?: IPointData, distance?: boolean, relative?: ILeaf): void {\n        if (this.parent) {\n            this.parent.worldToInner(world, to, distance, relative)\n        } else {\n            if (to) copy(to, world)\n        }\n    }\n\n    public localToWorld(local: IPointData, to?: IPointData, distance?: boolean, relative?: ILeaf): void {\n        if (this.parent) {\n            this.parent.innerToWorld(local, to, distance, relative)\n        } else {\n            if (to) copy(to, local)\n        }\n    }\n\n    public worldToInner(world: IPointData, to?: IPointData, distance?: boolean, relative?: ILeaf): void {\n        if (relative) {\n            relative.innerToWorld(world, to, distance)\n            world = to ? to : world\n        }\n        toInnerPoint(this.scrollWorldTransform, world, to, distance)\n    }\n\n    public innerToWorld(inner: IPointData, to?: IPointData, distance?: boolean, relative?: ILeaf): void {\n        toOuterPoint(this.scrollWorldTransform, inner, to, distance)\n        if (relative) relative.worldToInner(to ? to : inner, null, distance)\n    }\n\n    // simple\n\n    public getBoxPoint(world: IPointData, relative?: ILeaf, distance?: boolean, change?: boolean): IPointData {\n        return this.getBoxPointByInner(this.getInnerPoint(world, relative, distance, change), null, null, true)\n    }\n\n    public getBoxPointByInner(inner: IPointData, _relative?: ILeaf, _distance?: boolean, change?: boolean): IPointData {\n        const point = change ? inner : { ...inner } as IPointData, { x, y } = this.boxBounds\n        move(point, -x, -y)\n        return point\n    }\n\n    public getInnerPoint(world: IPointData, relative?: ILeaf, distance?: boolean, change?: boolean): IPointData {\n        const point = change ? world : {} as IPointData\n        this.worldToInner(world, point, distance, relative)\n        return point\n    }\n\n    public getInnerPointByBox(box: IPointData, _relative?: ILeaf, _distance?: boolean, change?: boolean): IPointData {\n        const point = change ? box : { ...box } as IPointData, { x, y } = this.boxBounds\n        move(point, x, y)\n        return point\n    }\n\n    public getInnerPointByLocal(local: IPointData, _relative?: ILeaf, distance?: boolean, change?: boolean): IPointData {\n        return this.getInnerPoint(local, this.parent, distance, change)\n    }\n\n    public getLocalPoint(world: IPointData, relative?: ILeaf, distance?: boolean, change?: boolean): IPointData {\n        const point = change ? world : {} as IPointData\n        this.worldToLocal(world, point, distance, relative)\n        return point\n    }\n\n    public getLocalPointByInner(inner: IPointData, _relative?: ILeaf, distance?: boolean, change?: boolean): IPointData {\n        return this.getWorldPoint(inner, this.parent, distance, change)\n    }\n\n    public getPagePoint(world: IPointData, relative?: ILeaf, distance?: boolean, change?: boolean): IPointData {\n        const layer = this.leafer ? this.leafer.zoomLayer : this\n        return layer.getInnerPoint(world, relative, distance, change)\n    }\n\n    public getWorldPoint(inner: IPointData, relative?: ILeaf, distance?: boolean, change?: boolean): IPointData {\n        const point = change ? inner : {} as IPointData\n        this.innerToWorld(inner, point, distance, relative)\n        return point\n    }\n\n    public getWorldPointByBox(box: IPointData, relative?: ILeaf, distance?: boolean, change?: boolean): IPointData {\n        return this.getWorldPoint(this.getInnerPointByBox(box, null, null, change), relative, distance, true)\n    }\n\n    public getWorldPointByLocal(local: IPointData, relative?: ILeaf, distance?: boolean, change?: boolean): IPointData {\n        const point = change ? local : {} as IPointData\n        this.localToWorld(local, point, distance, relative)\n        return point\n    }\n\n    public getWorldPointByPage(page: IPointData, relative?: ILeaf, distance?: boolean, change?: boolean): IPointData {\n        const layer = this.leafer ? this.leafer.zoomLayer : this\n        return layer.getWorldPoint(page, relative, distance, change)\n    }\n\n\n    // transform \n\n    public setTransform(matrix: IMatrixData, resize?: boolean, transition?: ITransition): void {\n        setTransform(this, matrix, resize, transition)\n    }\n\n    public transform(matrix: IMatrixData, resize?: boolean, transition?: ITransition): void {\n        transform(this, matrix, resize, transition)\n    }\n\n    public move(x: number | IPointData, y?: number, transition?: ITransition): void {\n        moveLocal(this, x, y, transition)\n    }\n\n\n    public moveInner(x: number | IPointData, y?: number, transition?: ITransition): void {\n        moveWorld(this, x, y, true, transition)\n    }\n\n    public scaleOf(origin: IPointData | IAlign, scaleX: number, scaleY?: number | ITransition, resize?: boolean, transition?: ITransition): void {\n        zoomOfLocal(this, getLocalOrigin(this, origin), scaleX, scaleY, resize, transition)\n    }\n\n    public rotateOf(origin: IPointData | IAlign, rotation: number, transition?: ITransition): void {\n        rotateOfLocal(this, getLocalOrigin(this, origin), rotation, transition)\n    }\n\n    public skewOf(origin: IPointData | IAlign, skewX: number, skewY?: number, resize?: boolean, transition?: ITransition): void {\n        skewOfLocal(this, getLocalOrigin(this, origin), skewX, skewY, resize, transition)\n    }\n\n\n    public transformWorld(worldTransform?: IMatrixData, resize?: boolean, transition?: ITransition): void {\n        transformWorld(this, worldTransform, resize, transition)\n    }\n\n    public moveWorld(x: number | IPointData, y?: number, transition?: ITransition): void {\n        moveWorld(this, x, y, false, transition)\n    }\n\n    public scaleOfWorld(worldOrigin: IPointData, scaleX: number, scaleY?: number | ITransition, resize?: boolean, transition?: ITransition): void {\n        zoomOfWorld(this, worldOrigin, scaleX, scaleY, resize, transition)\n    }\n\n    public rotateOfWorld(worldOrigin: IPointData, rotation: number): void {\n        rotateOfWorld(this, worldOrigin, rotation)\n    }\n\n    public skewOfWorld(worldOrigin: IPointData, skewX: number, skewY?: number, resize?: boolean, transition?: ITransition): void {\n        skewOfWorld(this, worldOrigin, skewX, skewY, resize, transition)\n    }\n\n    public flip(axis: IAxis, transition?: ITransition): void {\n        transform(this, getFlipTransform(this, axis), false, transition)\n    }\n\n\n    // @leafer-in/resize rewrite\n\n    public scaleResize(scaleX: number, scaleY = scaleX, _noResize?: boolean): void {\n        (this as ILeaf).scaleX *= scaleX;\n        (this as ILeaf).scaleY *= scaleY\n    }\n\n    public __scaleResize(_scaleX: number, _scaleY: number): void { }\n\n\n    public resizeWidth(_width: number): void { }\n\n    public resizeHeight(_height: number): void { }\n\n\n    // @leafer-ui/hit LeafHit rewrite\n\n    public hit(_world: IPointData, _hitRadius?: number): boolean { return true }\n\n    public __hitWorld(_point: IRadiusPointData, _forceHitFill?: boolean): boolean { return true }\n\n    public __hit(_local: IRadiusPointData, _forceHitFill?: boolean): boolean { return true }\n\n    public __hitFill(_inner: IRadiusPointData): boolean { return true }\n\n    public __hitStroke(_inner: IRadiusPointData, _strokeWidth: number): boolean { return true }\n\n    public __hitPixel(_inner: IRadiusPointData): boolean { return true }\n\n    public __drawHitPath(_canvas: ILeaferCanvas): void { }\n\n    public __updateHitCanvas(): void { }\n\n    // ---\n\n\n    // LeafRender rewrite\n\n    public __render(_canvas: ILeaferCanvas, _options: IRenderOptions): void { }\n\n    public __drawFast(_canvas: ILeaferCanvas, _options: IRenderOptions): void { }\n\n    public __draw(_canvas: ILeaferCanvas, _options: IRenderOptions, _originCanvas?: ILeaferCanvas): void { }\n\n\n    public __clip(_canvas: ILeaferCanvas, _options: IRenderOptions): void { }\n\n    public __renderShape(_canvas: ILeaferCanvas, _options: IRenderOptions): void { }\n\n    public __drawShape(_canvas: ILeaferCanvas, _options: IRenderOptions): void { }\n\n\n    public __updateWorldOpacity(): void { }\n\n    public __updateChange(): void { }\n\n    // ---\n\n\n    // path\n\n    public __drawPath(_canvas: ILeaferCanvas): void { }\n\n    public __drawRenderPath(_canvas: ILeaferCanvas): void { }\n\n    public __updatePath(): void { }\n\n    public __updateRenderPath(): void { }\n\n    // ---\n\n\n    // @leafer-in/motion-path rewrite\n\n    public getMotionPathData(): IMotionPathData {\n        return Plugin.need('path')\n    }\n\n    public getMotionPoint(_motionDistance: number | IUnitData): IRotationPointData {\n        return Plugin.need('path')\n    }\n\n    public getMotionTotal(): number {\n        return 0\n    }\n\n    public __updateMotionPath(): void { }\n\n    // ---\n\n\n    // @leafer-in/animate rewrite\n    public __runAnimation(_type: 'in' | 'out', _complete?: IFunction): void { }\n\n\n    // Branch rewrite\n\n    public __updateSortChildren(): void { }\n\n    public add(_child: ILeaf | ILeaf[] | ILeafInputData | ILeafInputData[], _index?: number): void { }\n\n    public remove(_child?: ILeaf | number | string | IFindMethod, destroy?: boolean): void {\n        if (this.parent) this.parent.remove(this, destroy)\n    }\n\n    public dropTo(parent: ILeaf, index?: number, resize?: boolean): void {\n        drop(this, parent, index, resize)\n    }\n\n    // ---\n\n\n    // LeafEventer rewrite\n\n    public on(_type: string | string[] | IEventParams[] | IEventParamsMap, _listener?: IEventListener, _options?: IEventOption): void { }\n\n    public off(_type?: string | string[], _listener?: IEventListener, _options?: IEventOption): void { }\n\n    public on_(_type: string | string[] | IEventParams[], _listener?: IEventListener, _bind?: IObject, _options?: IEventOption): IEventListenerId { return undefined }\n\n    public off_(_id: IEventListenerId | IEventListenerId[]): void { }\n\n    public once(_type: string | string[] | IEventParams[], _listener?: IEventListener, _captureOrBind?: boolean | IObject, _capture?: boolean): void { }\n\n    public emit(_type: string, _event?: IEvent | IObject, _capture?: boolean): void { }\n\n    public emitEvent(_event?: IEvent, _capture?: boolean): void { }\n\n    public hasEvent(_type: string, _capture?: boolean): boolean { return false }\n\n    // ---\n\n    static changeAttr(attrName: string, defaultValue: IValue | IValueFunction, fn?: IAttrDecorator): void {\n        fn ? this.addAttr(attrName, defaultValue, fn) : defineDataProcessor(this.prototype, attrName, defaultValue)\n    }\n\n    static addAttr(attrName: string, defaultValue: IValue | IValueFunction, fn?: IAttrDecorator, helpValue?: IValue): void {\n        if (!fn) fn = boundsType\n        fn(defaultValue, helpValue)(this.prototype, attrName)\n    }\n\n\n    public __emitLifeEvent(type: string): void {\n        if (this.hasEvent(type)) this.emitEvent(new ChildEvent(type, this, this.parent))\n    }\n\n\n    public destroy(): void {\n        if (!this.destroyed) {\n            if (this.parent) this.remove()\n            if (this.children) (this as unknown as IBranch).clear()\n\n            this.__emitLifeEvent(ChildEvent.DESTROY)\n\n            this.__.destroy()\n            this.__layout.destroy();\n\n            (this as ILeaf).destroyEventer()\n            this.destroyed = true\n        }\n    }\n\n}\n", "import { IBoundsData, IFourNumber, ILeaf } from '@leafer/interface'\nimport { ChildEvent } from '@leafer/event'\nimport { BoundsHelper } from '@leafer/math'\nimport { BranchHelper, LeafBoundsHelper } from '@leafer/helper'\nimport { useModule } from '@leafer/decorator'\nimport { BranchRender } from '@leafer/display-module'\nimport { UICreator } from '@leafer/platform'\nimport { isArray, isUndefined } from '@leafer/data'\nimport { Debug } from '@leafer/debug'\n\nimport { Leaf } from './Leaf'\n\n\nconst { setListWithFn } = BoundsHelper\nconst { sort } = BranchHelper\nconst { localBoxBounds, localStrokeBounds, localRenderBounds, maskLocalBoxBounds, maskLocalStrokeBounds, maskLocalRenderBounds } = LeafBoundsHelper\nconst debug = new Debug('Branch')\n\n@useModule(BranchRender)\nexport class Branch extends Leaf { // tip: rewrited Group\n\n    // overwrite\n\n    public __updateStrokeSpread(): IFourNumber {\n        const { children } = this\n        for (let i = 0, len = children.length; i < len; i++) {\n            if (children[i].__layout.strokeSpread) return 1\n        }\n        return 0\n    }\n\n    public __updateRenderSpread(): IFourNumber {\n        const { children } = this\n        for (let i = 0, len = children.length; i < len; i++) {\n            if (children[i].__layout.renderSpread) return 1\n        }\n        return 0\n    }\n\n    public __updateBoxBounds(_secondLayout?: boolean, bounds?: IBoundsData): void {\n        setListWithFn(bounds || this.__layout.boxBounds, this.children, this.__hasMask ? maskLocalBoxBounds : localBoxBounds)\n    }\n\n    public __updateStrokeBounds(bounds?: IBoundsData): void {\n        setListWithFn(bounds || this.__layout.strokeBounds, this.children, this.__hasMask ? maskLocalStrokeBounds : localStrokeBounds)\n    }\n\n    public __updateRenderBounds(bounds?: IBoundsData): void {\n        setListWithFn(bounds || this.__layout.renderBounds, this.children, this.__hasMask ? maskLocalRenderBounds : localRenderBounds)\n    }\n\n\n    // own\n\n    public __updateSortChildren(): void {\n        let affectSort: boolean\n        const { children } = this\n        if (children.length > 1) {\n            for (let i = 0, len = children.length; i < len; i++) {\n                children[i].__tempNumber = i\n                if (children[i].__.zIndex) affectSort = true\n            }\n            children.sort(sort)\n            this.__layout.affectChildrenSort = affectSort\n        }\n    }\n\n    public add(child: ILeaf, index?: number): void {\n        if (child === this || child.destroyed) return debug.warn('add self or destroyed')\n\n        const noIndex = isUndefined(index)\n        if (!child.__) {\n            if (isArray(child)) return child.forEach(item => { this.add(item, index); noIndex || index++ }) // add []\n            else child = UICreator.get(child.tag, child) // add JSON\n        }\n\n        if (child.parent) child.parent.remove(child)\n        child.parent = this\n\n        noIndex ? this.children.push(child) : this.children.splice(index, 0, child)\n        if (child.isBranch) this.__.__childBranchNumber = (this.__.__childBranchNumber || 0) + 1\n\n        const childLayout = child.__layout\n        childLayout.boxChanged || childLayout.boxChange() // layouted(removed), need update\n        childLayout.matrixChanged || childLayout.matrixChange() // layouted(removed), need update\n\n        if (child.__bubbleMap) child.__emitLifeEvent(ChildEvent.ADD)\n\n        if (this.leafer) {\n            child.__bindLeafer(this.leafer)\n            if (this.leafer.created) this.__emitChildEvent(ChildEvent.ADD, child)\n        }\n\n        this.__layout.affectChildrenSort && this.__layout.childrenSortChange()\n    }\n\n    public addMany(...children: ILeaf[]): void { this.add(children as any) }\n\n    public remove(child?: ILeaf, destroy?: boolean): void {\n        if (child) {\n\n            if (child.__) {\n\n                if ((child as ILeaf).animationOut) child.__runAnimation('out', () => this.__remove(child, destroy))\n                else this.__remove(child, destroy)\n\n            } else this.find(child as any).forEach(item => this.remove(item, destroy)) // \n\n        } else if (isUndefined(child)) {\n            super.remove(null, destroy)\n        }\n    }\n\n    public removeAll(destroy?: boolean): void {\n        const { children } = this\n        if (children.length) {\n            this.children = []\n            this.__preRemove()\n            this.__.__childBranchNumber = 0\n            children.forEach(child => {\n                this.__realRemoveChild(child)\n                if (destroy) child.destroy()\n            })\n        }\n    }\n\n    public clear(): void {\n        this.removeAll(true)\n    }\n\n    protected __remove(child?: ILeaf, destroy?: boolean): void {\n        const index = this.children.indexOf(child)\n        if (index > -1) {\n            this.children.splice(index, 1)\n            if (child.isBranch) this.__.__childBranchNumber = (this.__.__childBranchNumber || 1) - 1\n            this.__preRemove()\n            this.__realRemoveChild(child)\n            if (destroy) child.destroy()\n        }\n    }\n\n    protected __preRemove(): void {\n        if (this.__hasMask) this.__updateMask()\n        if (this.__hasEraser) this.__updateEraser()\n        this.__layout.boxChange()\n        this.__layout.affectChildrenSort && this.__layout.childrenSortChange()\n    }\n\n    protected __realRemoveChild(child: ILeaf): void {\n        child.__emitLifeEvent(ChildEvent.REMOVE)\n        child.parent = null\n        if (this.leafer) {\n            child.__bindLeafer(null)\n            if (this.leafer.created) {\n                this.__emitChildEvent(ChildEvent.REMOVE, child)\n                if (this.leafer.hitCanvasManager) this.leafer.hitCanvasManager.clear()\n            }\n        }\n    }\n\n    protected __emitChildEvent(type: string, child: ILeaf): void {\n        const event = new ChildEvent(type, child, this)\n        if (this.hasEvent(type) && !this.isLeafer) this.emitEvent(event)\n        this.leafer.emitEvent(event)\n    }\n\n}", "import { ILeaf, ILeafList, ILeafListItemCallback, INumberMap } from '@leafer/interface'\nimport { isArray, isUndefined } from '@leafer/data'\n\nexport class LeafList implements ILeafList {\n\n    public list: ILeaf[]\n    public keys: INumberMap\n\n    public get length(): number { return this.list.length }\n\n    constructor(item?: ILeaf | ILeaf[]) {\n        this.reset()\n        if (item) isArray(item) ? this.addList(item) : this.add(item)\n    }\n\n    public has(leaf: ILeaf): boolean {\n        return leaf && !isUndefined(this.keys[leaf.innerId])\n    }\n\n    public indexAt(index: number): ILeaf {\n        return this.list[index]\n    }\n\n    public indexOf(leaf: ILeaf): number {\n        const index = this.keys[leaf.innerId]\n        return isUndefined(index) ? -1 : index\n    }\n\n\n    public add(leaf: ILeaf): void {\n        const { list, keys } = this\n        if (isUndefined(keys[leaf.innerId])) {\n            list.push(leaf)\n            keys[leaf.innerId] = list.length - 1\n        }\n    }\n\n    public addAt(leaf: ILeaf, index = 0): void {\n        const { keys } = this\n        if (isUndefined(keys[leaf.innerId])) {\n            const { list } = this\n            for (let i = index, len = list.length; i < len; i++)  keys[list[i].innerId]++\n            if (index === 0) {\n                list.unshift(leaf)\n            } else {\n                if (index > list.length) index = list.length\n                list.splice(index, 0, leaf)\n            }\n            keys[leaf.innerId] = index\n        }\n    }\n\n    public addList(list: ILeaf[]): void {\n        for (let i = 0; i < list.length; i++) this.add(list[i])\n    }\n\n\n    public remove(leaf: ILeaf): void {\n        const { list } = this\n        let findIndex: number\n        for (let i = 0, len = list.length; i < len; i++) {\n            if (!isUndefined(findIndex)) {\n                this.keys[list[i].innerId] = i - 1 // update rest keys\n            } else if (list[i].innerId === leaf.innerId) {\n                findIndex = i\n                delete this.keys[leaf.innerId]\n            }\n        }\n\n        if (!isUndefined(findIndex)) list.splice(findIndex, 1)\n    }\n\n\n    public sort(reverse?: boolean): void {\n        const { list } = this\n        if (reverse) {\n            list.sort((a, b) => b.__level - a.__level) // 倒序\n        } else {\n            list.sort((a, b) => a.__level - b.__level) // 顺序\n        }\n    }\n\n    public forEach(itemCallback: ILeafListItemCallback): void {\n        this.list.forEach(itemCallback)\n    }\n\n    public clone(): ILeafList {\n        const list = new LeafList()\n        list.list = [...this.list]\n        list.keys = { ...this.keys }\n        return list\n    }\n\n\n    public update(): void {\n        this.keys = {}\n        const { list, keys } = this\n        for (let i = 0, len = list.length; i < len; i++)    keys[list[i].innerId] = i\n    }\n\n    public reset(): void {\n        this.list = []\n        this.keys = {}\n    }\n\n    public destroy(): void {\n        this.reset()\n    }\n}\n", "import { ILeaf, ILeafArrayMap, ILeafLevelList, ILeafListItemCallback, INumberMap } from '@leafer/interface'\nimport { isArray, isUndefined } from '@leafer/data'\n\nexport class LeafLevelList implements ILeafLevelList {\n\n    public levelMap: ILeafArrayMap\n    public keys: INumberMap\n    public levels: number[]\n\n    public get length(): number { return this._length }\n    private _length = 0\n\n    constructor(item?: ILeaf | ILeaf[]) {\n        this.reset()\n        if (item) isArray(item) ? this.addList(item) : this.add(item)\n    }\n\n    public has(leaf: ILeaf): boolean {\n        return !isUndefined(this.keys[leaf.innerId])\n    }\n\n    public without(leaf: ILeaf): boolean {\n        return isUndefined(this.keys[leaf.innerId])\n    }\n\n    public sort(reverse?: boolean): void {\n        const { levels } = this\n        if (reverse) {\n            levels.sort((a, b) => b - a) // 倒序\n        } else {\n            levels.sort((a, b) => a - b) // 顺序\n        }\n    }\n\n    public addList(list: ILeaf[]): void {\n        list.forEach(leaf => { this.add(leaf) })\n    }\n\n    public add(leaf: ILeaf): void {\n        const { keys, levelMap } = this\n        if (!keys[leaf.innerId]) {\n            keys[leaf.innerId] = 1\n            if (!levelMap[leaf.__level]) {\n                levelMap[leaf.__level] = [leaf]\n                this.levels.push(leaf.__level)\n            } else {\n                levelMap[leaf.__level].push(leaf)\n            }\n            this._length++\n        }\n    }\n\n    public forEach(itemCallback: ILeafListItemCallback): void {\n        let list: ILeaf[]\n        this.levels.forEach(level => {\n            list = this.levelMap[level]\n            for (let i = 0, len = list.length; i < len; i++) {\n                itemCallback(list[i])\n            }\n        })\n    }\n\n    public reset(): void {\n        this.levelMap = {}\n        this.keys = {}\n        this.levels = []\n        this._length = 0\n    }\n\n    public destroy(): void {\n        this.levelMap = null\n    }\n\n}", "export * from '@leafer/canvas'\nexport * from '@leafer/image'\n\nexport * from '@leafer/data'\nexport * from '@leafer/debug'\nexport * from '@leafer/decorator'\nexport * from '@leafer/display'\nexport * from '@leafer/display-module'\n\nexport * from '@leafer/event'\n\nexport * from '@leafer/file'\nexport * from '@leafer/helper'\nexport * from '@leafer/layout'\nexport * from '@leafer/list'\nexport * from '@leafer/math'\n\nexport * from '@leafer/path'\nexport * from '@leafer/platform'\n\nexport * from '@leafer/task'\n\nexport const version = \"2.0.0\"", "/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\r\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\r\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\r\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\r\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\r\n    var _, done = false;\r\n    for (var i = decorators.length - 1; i >= 0; i--) {\r\n        var context = {};\r\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\r\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\r\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\r\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\r\n        if (kind === \"accessor\") {\r\n            if (result === void 0) continue;\r\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\r\n            if (_ = accept(result.get)) descriptor.get = _;\r\n            if (_ = accept(result.set)) descriptor.set = _;\r\n            if (_ = accept(result.init)) initializers.unshift(_);\r\n        }\r\n        else if (_ = accept(result)) {\r\n            if (kind === \"field\") initializers.unshift(_);\r\n            else descriptor[key] = _;\r\n        }\r\n    }\r\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\r\n    done = true;\r\n};\r\n\r\nexport function __runInitializers(thisArg, initializers, value) {\r\n    var useValue = arguments.length > 2;\r\n    for (var i = 0; i < initializers.length; i++) {\r\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\r\n    }\r\n    return useValue ? value : void 0;\r\n};\r\n\r\nexport function __propKey(x) {\r\n    return typeof x === \"symbol\" ? x : \"\".concat(x);\r\n};\r\n\r\nexport function __setFunctionName(f, name, prefix) {\r\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\r\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\r\n};\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\r\n    return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\r\n    function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nvar ownKeys = function(o) {\r\n    ownKeys = Object.getOwnPropertyNames || function (o) {\r\n        var ar = [];\r\n        for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\r\n        return ar;\r\n    };\r\n    return ownKeys(o);\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n\r\nexport function __addDisposableResource(env, value, async) {\r\n    if (value !== null && value !== void 0) {\r\n        if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\r\n        var dispose, inner;\r\n        if (async) {\r\n            if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\r\n            dispose = value[Symbol.asyncDispose];\r\n        }\r\n        if (dispose === void 0) {\r\n            if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\r\n            dispose = value[Symbol.dispose];\r\n            if (async) inner = dispose;\r\n        }\r\n        if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\r\n        if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\r\n        env.stack.push({ value: value, dispose: dispose, async: async });\r\n    }\r\n    else if (async) {\r\n        env.stack.push({ async: true });\r\n    }\r\n    return value;\r\n\r\n}\r\n\r\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\r\n\r\nexport function __disposeResources(env) {\r\n    function fail(e) {\r\n        env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\r\n        env.hasError = true;\r\n    }\r\n    var r, s = 0;\r\n    function next() {\r\n        while (r = env.stack.pop()) {\r\n            try {\r\n                if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\r\n                if (r.dispose) {\r\n                    var result = r.dispose.call(r.value);\r\n                    if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\r\n                }\r\n                else s |= 1;\r\n            }\r\n            catch (e) {\r\n                fail(e);\r\n            }\r\n        }\r\n        if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\r\n        if (env.hasError) throw env.error;\r\n    }\r\n    return next();\r\n}\r\n\r\nexport function __rewriteRelativeImportExtension(path, preserveJsx) {\r\n    if (typeof path === \"string\" && /^\\.\\.?\\//.test(path)) {\r\n        return path.replace(/\\.(tsx)$|((?:\\.d)?)((?:\\.[^./]+?)?)\\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {\r\n            return tsx ? preserveJsx ? \".jsx\" : \".js\" : d && (!ext || !cm) ? m : (d + ext + \".\" + cm.toLowerCase() + \"js\");\r\n        });\r\n    }\r\n    return path;\r\n}\r\n\r\nexport default {\r\n    __extends: __extends,\r\n    __assign: __assign,\r\n    __rest: __rest,\r\n    __decorate: __decorate,\r\n    __param: __param,\r\n    __esDecorate: __esDecorate,\r\n    __runInitializers: __runInitializers,\r\n    __propKey: __propKey,\r\n    __setFunctionName: __setFunctionName,\r\n    __metadata: __metadata,\r\n    __awaiter: __awaiter,\r\n    __generator: __generator,\r\n    __createBinding: __createBinding,\r\n    __exportStar: __exportStar,\r\n    __values: __values,\r\n    __read: __read,\r\n    __spread: __spread,\r\n    __spreadArrays: __spreadArrays,\r\n    __spreadArray: __spreadArray,\r\n    __await: __await,\r\n    __asyncGenerator: __asyncGenerator,\r\n    __asyncDelegator: __asyncDelegator,\r\n    __asyncValues: __asyncValues,\r\n    __makeTemplateObject: __makeTemplateObject,\r\n    __importStar: __importStar,\r\n    __importDefault: __importDefault,\r\n    __classPrivateFieldGet: __classPrivateFieldGet,\r\n    __classPrivateFieldSet: __classPrivateFieldSet,\r\n    __classPrivateFieldIn: __classPrivateFieldIn,\r\n    __addDisposableResource: __addDisposableResource,\r\n    __disposeResources: __disposeResources,\r\n    __rewriteRelativeImportExtension: __rewriteRelativeImportExtension,\r\n};\r\n", "import { IValue, IObject } from '@leafer/interface'\nimport { defineKey, decorateLeafAttr, attr, createDescriptor } from '@leafer/core'\n\nimport { ICanvas, IUI, IApp } from '@leafer-ui/interface'\n\n\nexport function effectType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            this.__setAttr(key, value)\n            if (value) (this as IUI).__.__useEffect = true\n            this.__layout.renderChanged || this.__layout.renderChange()\n        }\n    }))\n}\n\nexport function resizeType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            this.__setAttr(key, value)\n            this.__layout.boxChanged || this.__layout.boxChange();\n            (this as ICanvas).__updateSize()\n        }\n    }))\n}\n\nexport function zoomLayerType() {\n    return (target: IUI, key: string) => {\n        const privateKey = '_' + key\n        defineKey(target, key, {\n            set(value: IUI) { if (this.isLeafer) (this as IObject)[privateKey] = value },\n            get() {\n                return this.isApp\n                    ? (this as IApp).tree.zoomLayer\n                    : (this.isLeafer ? ((this as IObject)[privateKey] || this) : this.leafer && this.leafer.zoomLayer)\n            }\n        })\n    }\n}\n\nexport function createAttr(defaultValue?: IValue) {\n    return (target: IUI, key: string) => {\n        defineKey(target, key, createDescriptor(key, defaultValue))\n    }\n}", "// Implemented in partner\nimport { IPaintModule, IPaintImageModule, IPaintGradientModule, IEffectModule, ITextConvertModule, IExportModule, IColorConvertModule, IPathArrowModule, IStateModule, ITransitionModule, ITransitionFunction, IFilterModule } from \"@leafer-ui/interface\"\nimport { Plugin, UnitConvertHelper } from '@leafer/core'\nimport { hasTransparent } from './color'\n\n\nexport const TextConvert = {} as ITextConvertModule\n\nexport const ColorConvert = {\n    hasTransparent\n} as IColorConvertModule\n\nexport const UnitConvert = UnitConvertHelper\n\nexport const PathArrow = {} as IPathArrowModule\n\n\nexport const Paint = {} as IPaintModule\n\nexport const PaintImage = {} as IPaintImageModule\n\nexport const PaintGradient = {} as IPaintGradientModule\n\nexport const Effect = {} as IEffectModule\n\nexport const Filter = {\n    apply(): void { Plugin.need('filter') }\n} as unknown as IFilterModule\n\nexport const Export = {} as IExportModule\n\nexport const State = {\n    setStyleName(): void { return Plugin.need('state') },\n    set(): void { return Plugin.need('state') }\n} as unknown as IStateModule\n\nexport const Transition = {\n    list: {},\n    register(attrName: string, fn: ITransitionFunction): void { Transition.list[attrName] = fn },\n    get(attrName: string): ITransitionFunction { return Transition.list[attrName] }\n} as ITransitionModule", "export function hasTransparent(color?: string): boolean {\n\n    if (!color || color.length === 7 || color.length === 4) return false\n    if (color === 'transparent') return true  // transparent keyword\n\n    const first = color[0]\n\n    if (first === '#') {\n\n        // hex\n        switch (color.length) {\n            case 5: return color[4] !== 'f' && color[4] !== 'F' // #RGBA\n            case 9: return (color[7] !== 'f' && color[7] !== 'F') || (color[8] !== 'f' && color[8] !== 'F') // #RRGGBBAA\n        }\n\n    } else if (first === 'r' || first === 'h') {\n\n        // rgba(...) or hsla(...)\n        if (color[3] === 'a') {\n            const i = color.lastIndexOf(',')\n            if (i > -1) return parseFloat(color.slice(i + 1)) < 1\n        }\n\n    }\n\n    return false\n\n}", "import { INumber, IValue, IBoolean, IPathCommandData, IPathString, IPointData, IPathCommandObject, IObject, IFilter, IPathCommandNode } from '@leafer/interface'\nimport { PathConvert, DataHelper, LeafData, Debug, isArray, isObject, isString, isUndefined } from '@leafer/core'\n\nimport { IUI, IUIData, ILeafPaint, IStrokeComputedStyle } from '@leafer-ui/interface'\nimport { Paint, PaintImage, ColorConvert } from '@leafer-ui/external'\n\n\nconst { parse, objectToCanvasData } = PathConvert\nconst { stintSet } = DataHelper, { hasTransparent } = ColorConvert\nconst emptyPaint: ILeafPaint = { originPaint: {} as any }\nconst debug = Debug.get('UIData')\nexport class UIData extends LeafData implements IUIData {\n\n    declare public __leaf: IUI\n\n    public get scale(): INumber | IPointData { const { scaleX, scaleY } = this as IUIData; return scaleX !== scaleY ? { x: scaleX, y: scaleY } : scaleX }\n\n    public __blendLayer?: boolean // 非元素属性必须以两个下划线开头\n\n    public __isFills?: boolean\n    public __isStrokes?: boolean\n\n    public get __strokeWidth(): number { return this.__getRealStrokeWidth() }\n\n    public get __maxStrokeWidth(): number { const t = this as IUIData; return t.__hasMultiStrokeStyle ? Math.max(t.__hasMultiStrokeStyle, t.strokeWidth) : t.strokeWidth }\n\n    public __hasMultiStrokeStyle?: number // 是否存在多个不同的描述样式（同时存储多个描边样式中的最大宽度用于运算）\n\n    public get __hasMultiPaint(): boolean { const t = this as IUIData; return (t.fill && this.__useStroke) || (t.__isFills && t.fill.length > 1) || (t.__isStrokes && t.stroke.length > 1) || t.__useEffect } // fix: opacity\n\n    public __isAlphaPixelFill?: boolean // png / svg / webp\n    public __isAlphaPixelStroke?: boolean\n\n    public __isTransparentFill?: boolean  // 半透明的 \n    public __isTransparentStroke?: boolean\n\n    public get __clipAfterFill(): boolean { const t = this as IUIData; return (t.cornerRadius || t.innerShadow || t.__pathInputed) as unknown as boolean } // 用于 (Box | Canvas | Robot) __drawAfterFill() 时裁剪内容\n    public get __hasSurface(): boolean { const t = this as IUIData; return (t.fill || t.stroke) as unknown as boolean }\n\n    public __needComputePaint: boolean\n\n    protected _visible?: IBoolean\n\n    protected _width?: INumber\n    protected _height?: INumber\n\n    protected _fill?: IValue\n    protected _stroke?: IValue\n\n    protected _path: IPathCommandData\n\n    protected _shadow?: IValue\n    protected _innerShadow?: IValue\n\n    public get __autoWidth() { return !this._width }\n    public get __autoHeight() { return !this._height }\n    public get __autoSide() { return !this._width || !this._height }\n    public get __autoSize() { return !this._width && !this._height }\n\n\n    protected setVisible(value: IBoolean) {\n        this._visible = value\n\n        const { leafer } = this.__leaf\n        if (leafer) leafer.watcher.hasVisible = true\n    }\n\n    protected setWidth(value: INumber) {\n        if (value < 0) {\n            this._width = -value\n            this.__leaf.scaleX *= -1\n            debug.warn('width < 0, instead -scaleX ', this)\n        } else this._width = value\n    }\n\n    protected setHeight(value: INumber) {\n        if (value < 0) {\n            this._height = -value\n            this.__leaf.scaleY *= -1\n            debug.warn('height < 0, instead -scaleY', this)\n        } else this._height = value\n    }\n\n\n    protected setFill(value: IValue) {\n        if (this.__naturalWidth) this.__removeNaturalSize()\n        if (isString(value) || !value) {\n            stintSet(this, '__isTransparentFill', hasTransparent(value as string))\n            this.__isFills && this.__removePaint('fill', true)\n            this._fill = value\n        } else if (isObject(value)) {\n            this.__setPaint('fill', value)\n        }\n    }\n\n    protected setStroke(value: IValue) {\n        if (isString(value) || !value) {\n            stintSet(this, '__isTransparentStroke', hasTransparent(value as string))\n            this.__isStrokes && this.__removePaint('stroke', true)\n            this._stroke = value\n        } else if (isObject(value)) {\n            this.__setPaint('stroke', value)\n        }\n    }\n\n\n    protected setPath(value: IPathCommandData | IPathCommandNode[] | IPathCommandObject[] | IPathString) {\n        const isStr = isString(value)\n        if (isStr || (value && isObject(value[0]))) {\n            this.__setInput('path', value)\n            this._path = isStr ? parse(value) : objectToCanvasData(value as IPathCommandObject[])\n        } else {\n            if (this.__input) this.__removeInput('path')\n            this._path = value as IPathCommandData\n        }\n    }\n\n\n    protected setShadow(value: IValue) {\n        setArray(this, 'shadow', value)\n    }\n\n    protected setInnerShadow(value: IValue) {\n        setArray(this, 'innerShadow', value)\n    }\n\n    protected setFilter(value: IValue) {\n        setArray(this, 'filter', value)\n    }\n\n\n    // custom\n\n    public __computePaint(): void {\n        const { fill, stroke } = this.__input\n        if (fill) Paint.compute('fill', this.__leaf)\n        if (stroke) Paint.compute('stroke', this.__leaf)\n        this.__needComputePaint = undefined\n    }\n\n\n    public __getRealStrokeWidth(childStyle?: IStrokeComputedStyle): number {\n        let { strokeWidth, strokeWidthFixed } = this as IUIData\n        if (childStyle) {\n            if (childStyle.strokeWidth) strokeWidth = childStyle.strokeWidth\n            if (!isUndefined(childStyle.strokeWidthFixed)) strokeWidthFixed = childStyle.strokeWidthFixed\n        }\n        if (strokeWidthFixed) {\n            const scale = this.__leaf.getClampRenderScale()\n            return scale > 1 ? strokeWidth / scale : strokeWidth\n        } else return strokeWidth\n    }\n\n\n    public __setPaint(attrName: 'fill' | 'stroke', value: IValue): void {\n        this.__setInput(attrName, value)\n        const layout = this.__leaf.__layout\n        layout.boxChanged || layout.boxChange()\n        if (isArray(value) && !value.length) {\n            this.__removePaint(attrName)\n        } else {\n            if (attrName === 'fill') this.__isFills = true, this._fill || (this._fill = emptyPaint)\n            else this.__isStrokes = true, this._stroke || (this._stroke = emptyPaint)\n        }\n    }\n\n    public __removePaint(attrName: 'fill' | 'stroke', removeInput?: boolean): void {\n        if (removeInput) this.__removeInput(attrName)\n        PaintImage.recycleImage(attrName, this)\n        if (attrName === 'fill') {\n            stintSet(this, '__isAlphaPixelFill', undefined)\n            this._fill = this.__isFills = undefined\n        } else {\n            stintSet(this, '__isAlphaPixelStroke', undefined)\n            stintSet(this, '__hasMultiStrokeStyle', undefined)\n            this._stroke = this.__isStrokes = undefined\n        }\n    }\n}\n\n\nfunction setArray(data: IUIData, key: string, value: IValue) {\n    data.__setInput(key, value)\n    if (isArray(value)) {\n        if (value.some((item: IFilter) => item.visible === false)) value = value.filter((item: IFilter) => item.visible !== false)\n        value.length || (value = undefined)\n    } else value = value && (value as IFilter).visible !== false ? [value] : undefined;\n    (data as IObject)['_' + key] = value\n}\n", "import { IGroupData } from '@leafer-ui/interface'\n\nimport { UIData } from \"./UIData\"\n\n\nexport class GroupData extends UIData implements IGroupData {\n\n}\n", "import { IBox, IBoxData } from '@leafer-ui/interface'\n\nimport { GroupData } from \"./GroupData\"\n\n\nexport class BoxData extends GroupData implements IBoxData {\n\n    public get __boxStroke(): boolean { return !(this as IBoxData).__pathInputed }\n\n    // 当成整体处理\n    public get __drawAfterFill(): boolean { const t = this as IBoxData; return t.__single || t.__clipAfterFill }\n\n    public get __clipAfterFill(): boolean { const t = this as IBoxData; return t.overflow !== 'show' && t.__leaf.children.length && ((t.__leaf as IBox).isOverflow || super.__clipAfterFill) as unknown as boolean }\n\n}\n", "import { canvasSizeAttrs } from '@leafer/core'\n\nimport { ILeaferData, IObject, IJSONOptions } from '@leafer-ui/interface'\n\nimport { GroupData } from './GroupData'\n\nexport class LeaferData extends GroupData implements ILeaferData {\n\n    public __getInputData(names?: string[] | IObject, options?: IJSONOptions): IObject {\n        const data = super.__getInputData(names, options)\n        canvasSizeAttrs.forEach(key => delete (data as IObject)[key])\n        return data\n    }\n}\n", "import { IFrameData } from '@leafer-ui/interface'\n\nimport { BoxData } from './BoxData'\n\n\nexport class FrameData extends BoxData implements IFrameData {\n\n}\n", "import { ILineData } from \"@leafer-ui/interface\"\n\nimport { UIData } from \"./UIData\"\n\n\nexport class LineData extends UIData implements ILineData {\n\n    public get __usePathBox(): boolean {\n        return ((this as ILineData).points || (this as ILineData).__pathInputed) as any as boolean\n    }\n\n}\n", "import { IRectData } from \"@leafer-ui/interface\"\n\nimport { UIData } from \"./UIData\"\n\n\nexport class RectData extends UIData implements IRectData {\n    get __boxStroke(): boolean { return !(this as IRectData).__pathInputed }\n}", "import { IEllipseData } from '@leafer-ui/interface'\n\nimport { UIData } from \"./UIData\"\n\n\nexport class EllipseData extends UIData implements IEllipseData {\n    get __boxStroke(): boolean { return !(this as IEllipseData).__pathInputed }\n}", "import { IPolygonData } from '@leafer-ui/interface'\n\nimport { LineData } from './LineData'\n\n\nexport class PolygonData extends LineData implements IPolygonData {\n\n}", "import { IStarData } from '@leafer-ui/interface'\n\nimport { UIData } from \"./UIData\"\n\n\nexport class StarData extends UIData implements IStarData {\n\n}", "import { IPathData } from '@leafer-ui/interface'\n\nimport { UIData } from \"./UIData\"\n\n\nexport class PathData extends UIData implements IPathData {\n    public get __pathInputed(): number { return 2 }\n}", "import { IPenData } from '@leafer-ui/interface'\n\nimport { GroupData } from './GroupData'\n\n\nexport class PenData extends GroupData implements IPenData {\n\n}\n", "import { IJSONOptions } from '@leafer/interface'\nimport { UICreator, isString } from '@leafer/core'\n\nimport { IFontWeight, ITextData, IUI, IText, IObject, IBackgroundBoxStyle, IFontWeightNumer, ITextInputData } from '@leafer-ui/interface'\n\nimport { UIData } from \"./UIData\"\n\n\n\nconst fontWeightMap = {\n    'thin': 100,\n    'extra-light': 200,\n    'light': 300,\n    'normal': 400,\n    'medium': 500,\n    'semi-bold': 600,\n    'bold': 700,\n    'extra-bold': 800,\n    'black': 900\n}\n\nexport class TextData extends UIData implements ITextData {\n\n    public get __useNaturalRatio() { return false }\n\n    protected _fontWeight?: number\n    protected _boxStyle?: IBackgroundBoxStyle\n\n    setFontWeight(value: IFontWeight): void {\n        if (isString(value)) {\n            this.__setInput('fontWeight', value)\n            value = fontWeightMap[value] as IFontWeightNumer || 400\n        } else if (this.__input) this.__removeInput('fontWeight')\n        this._fontWeight = value\n    }\n\n    setBoxStyle(value: IUI) {\n        let t = this.__leaf as IText, box = t.__box\n\n        if (value) {\n\n            const { boxStyle } = this as ITextData\n            if (box) for (let key in boxStyle) (box as IObject)[key] = undefined\n            else box = t.__box = UICreator.get('Rect', 0 as any) as IUI // 传递 0 可以优化内存占用\n\n            const layout = t.__layout, boxLayout = box.__layout\n            if (!boxStyle) box.parent = t as any, box.__world = t.__world, boxLayout.boxBounds = layout.boxBounds\n\n            box.set(value)\n            if (boxLayout.strokeChanged) layout.strokeChange()\n\n        } else if (box) {\n            t.__box = box.parent = null\n            box.destroy()\n        }\n\n        this._boxStyle = value\n\n    }\n\n    public __getInputData(names?: string[] | IObject, options?: IJSONOptions): IObject {\n        const data: ITextInputData = super.__getInputData(names, options)\n        if (data.textEditing) delete data.textEditing\n        return data\n    }\n\n}", "import { IImageData, IImageInputData, IImage, IObject, IJSONOptions } from '@leafer-ui/interface'\n\nimport { RectData } from './RectData'\n\n\nexport class ImageData extends RectData implements IImageData {\n\n    declare public __leaf: IImage\n\n    protected _url: string\n\n    protected setUrl(value: string) {\n        this.__setImageFill(value)\n        this._url = value\n    }\n\n    public __setImageFill(value: string): void {\n        (this as IImageInputData).fill = value ? { type: 'image', mode: 'stretch', url: value } : undefined\n    }\n\n    public __getData(): IObject {\n        const data: IImageInputData = super.__getData()\n        if (data.url) delete data.fill\n        return data\n    }\n\n    public __getInputData(names?: string[] | IObject, options?: IJSONOptions): IObject {\n        const data: IImageInputData = super.__getInputData(names, options)\n        if (data.url) delete data.fill\n        return data\n    }\n}", "import { ICanvas, ICanvasData, ICanvasInputData, IObject, IJSONOptions } from '@leafer-ui/interface'\n\nimport { RectData } from './RectData'\n\n\nexport class CanvasData extends RectData implements ICanvasData {\n\n    public get __isCanvas(): boolean { return true }\n    public get __drawAfterFill(): boolean { return true }\n\n    public __getInputData(names?: string[] | IObject, options?: IJSONOptions): IObject {\n        const data: ICanvasInputData = super.__getInputData(names, options)\n        data.url = (this.__leaf as ICanvas).canvas.toDataURL('image/png') as string\n        return data\n    }\n}", "import { IFourNumber } from '@leafer/interface'\nimport { FourNumberHelper } from '@leafer/core'\n\nimport { IUIBoundsModule } from \"@leafer-ui/interface\"\nimport { Effect, Filter } from '@leafer-ui/external'\n\n\nconst { max, add } = FourNumberHelper\n\nexport const UIBounds: IUIBoundsModule = {\n\n    __updateStrokeSpread(): IFourNumber {\n        let spread: IFourNumber = 0, boxSpread = 0\n        const data = this.__, { strokeAlign, __maxStrokeWidth: strokeWidth } = data, box = this.__box\n\n        if ((data.stroke || data.hitStroke === 'all') && strokeWidth && strokeAlign !== 'inside') {\n            boxSpread = spread = strokeAlign === 'center' ? strokeWidth / 2 : strokeWidth\n\n            if (!data.__boxStroke) {\n                const miterLimitAddWidth = data.__isLinePath ? 0 : 10 * spread  // =  Math.sin((miterLimit = 10) * OneRadian / 2) * Math.sqrt(strokeWidth) - width 后期需继续精确优化\n                const storkeCapAddWidth = data.strokeCap === 'none' ? 0 : strokeWidth\n                spread += Math.max(miterLimitAddWidth, storkeCapAddWidth)\n            }\n        }\n\n        if (data.__useArrow) spread += strokeWidth * 5 // 后期需要精细化\n\n        if (box) {\n            spread = max(spread, box.__layout.strokeSpread = box.__updateStrokeSpread())\n            boxSpread = Math.max(boxSpread, box.__layout.strokeBoxSpread)\n        }\n\n        this.__layout.strokeBoxSpread = boxSpread\n\n        return spread\n    },\n\n    __updateRenderSpread(): IFourNumber {\n        let spread: IFourNumber = 0\n        const { shadow, innerShadow, blur, backgroundBlur, filter, renderSpread } = this.__, { strokeSpread } = this.__layout, box = this.__box\n\n        if (shadow) spread = Effect.getShadowRenderSpread(this, shadow)\n\n        if (blur) spread = max(spread, blur)\n\n        if (filter) spread = add(spread, Filter.getSpread(filter))\n\n        if (renderSpread) spread = add(spread, renderSpread)\n\n        if (strokeSpread) spread = add(spread, strokeSpread)\n\n\n        let shapeSpread = spread\n\n        if (innerShadow) shapeSpread = max(shapeSpread, Effect.getInnerShadowSpread(this, innerShadow))\n\n        if (backgroundBlur) shapeSpread = max(shapeSpread, backgroundBlur)\n\n        this.__layout.renderShapeSpread = shapeSpread\n\n        return box ? max(box.__updateRenderSpread(), spread) : spread\n    }\n\n}", "import { ILeaferCanvas, IRenderOptions } from '@leafer/interface'\nimport { DataHelper, isArray } from '@leafer/core'\n\nimport { IUIRenderModule, ILeafPaint, ILeafStrokePaint, IUI } from '@leafer-ui/interface'\nimport { Paint, Effect, Filter, ColorConvert } from '@leafer-ui/external'\n\nconst { stintSet } = DataHelper\n\nexport const UIRender: IUIRenderModule = {\n\n    __updateChange(): void {\n        const data = this.__\n\n        if (data.__useStroke) {\n            const useStroke = data.__useStroke = !!(data.stroke && data.strokeWidth)\n            stintSet(this.__world, 'half', useStroke && data.strokeAlign === 'center' && data.strokeWidth % 2)  // 是否存在半逻辑像素渲染（奇数线宽的居中线条），可以半像素为起点绘制，防止模糊\n            stintSet(data, '__fillAfterStroke', useStroke && data.strokeAlign === 'outside' && data.fill && !data.__isTransparentFill)\n        }\n\n        if (data.__useEffect) {\n            const { shadow, fill, stroke } = data, otherEffect = data.innerShadow || data.blur || data.backgroundBlur || data.filter\n            stintSet(data, '__isFastShadow', shadow && !otherEffect && shadow.length < 2 && !shadow[0].spread && !Effect.isTransformShadow(shadow[0]) && fill && !data.__isTransparentFill && !(isArray(fill) && fill.length > 1) && (this.useFastShadow || !stroke || (stroke && data.strokeAlign === 'inside'))) // 高性能阴影条件， @leafer-ui/image check.ts 中的 allowDraw 逻辑需与此处关联\n            data.__useEffect = !!(shadow || otherEffect)\n        }\n\n        data.__checkSingle()\n\n        stintSet(data, '__complex', (data.__isFills || data.__isStrokes || data.cornerRadius || data.__useEffect) as boolean)\n    },\n\n    __drawFast(canvas: ILeaferCanvas, options: IRenderOptions): void {\n        drawFast(this, canvas, options)\n    },\n\n    __draw(canvas: ILeaferCanvas, options: IRenderOptions, originCanvas?: ILeaferCanvas): void {\n        const data = this.__\n\n        if (data.__complex) {\n\n            if (data.__needComputePaint) data.__computePaint()\n\n            const { fill, stroke, __drawAfterFill, __fillAfterStroke, __isFastShadow } = data\n\n            this.__drawRenderPath(canvas)\n\n            if (data.__useEffect && !__isFastShadow) {\n\n                const shape = Paint.shape(this, canvas, options)\n                this.__nowWorld = this.__getNowWorld(options) // restore\n\n                const { shadow, innerShadow, filter } = data\n\n                if (shadow) Effect.shadow(this, canvas, shape)\n\n                if (__fillAfterStroke) data.__isStrokes ? Paint.strokes(stroke as ILeafStrokePaint[], this, canvas, options) : Paint.stroke(stroke as string, this, canvas, options)\n\n                if (fill) data.__isFills ? Paint.fills(fill as ILeafPaint[], this, canvas, options) : Paint.fill(fill as string, this, canvas, options)\n\n                if (__drawAfterFill) this.__drawAfterFill(canvas, options)\n\n                if (innerShadow) Effect.innerShadow(this, canvas, shape)\n\n                if (stroke && !__fillAfterStroke) data.__isStrokes ? Paint.strokes(stroke as ILeafStrokePaint[], this, canvas, options) : Paint.stroke(stroke as string, this, canvas, options)\n\n                if (filter) Filter.apply(filter, this, this.__nowWorld, canvas, originCanvas, shape)\n\n                if (shape.worldCanvas) shape.worldCanvas.recycle()\n                shape.canvas.recycle()\n\n            } else {\n\n                if (__fillAfterStroke) data.__isStrokes ? Paint.strokes(stroke as ILeafStrokePaint[], this, canvas, options) : Paint.stroke(stroke as string, this, canvas, options)\n\n                if (__isFastShadow) {\n                    const shadow = data.shadow[0], { scaleX, scaleY } = this.getRenderScaleData(true, shadow.scaleFixed)\n                    canvas.save(), canvas.setWorldShadow(shadow.x * scaleX, shadow.y * scaleY, shadow.blur * scaleX, ColorConvert.string(shadow.color))\n                }\n\n                if (fill) data.__isFills ? Paint.fills(fill as ILeafPaint[], this, canvas, options) : Paint.fill(fill as string, this, canvas, options)\n\n                if (__isFastShadow) canvas.restore()\n\n                if (__drawAfterFill) this.__drawAfterFill(canvas, options)\n\n                if (stroke && !__fillAfterStroke) data.__isStrokes ? Paint.strokes(stroke as ILeafStrokePaint[], this, canvas, options) : Paint.stroke(stroke as string, this, canvas, options)\n\n            }\n\n        } else {\n\n            if (data.__pathForRender) drawFast(this, canvas, options)\n            else this.__drawFast(canvas, options)\n\n        }\n    },\n\n    __drawShape(canvas: ILeaferCanvas, options: IRenderOptions): void {\n        this.__drawRenderPath(canvas)\n\n        const data = this.__, { fill, stroke } = data\n\n        if (fill && !options.ignoreFill) data.__isAlphaPixelFill ? Paint.fills(fill as ILeafPaint[], this, canvas, options) : Paint.fill('#000000', this, canvas, options)\n        if (data.__isCanvas) this.__drawAfterFill(canvas, options)\n        if (stroke && !options.ignoreStroke) data.__isAlphaPixelStroke ? Paint.strokes(stroke as ILeafStrokePaint[], this, canvas, options) : Paint.stroke('#000000', this, canvas, options)\n    },\n\n    __drawAfterFill(canvas: ILeaferCanvas, options: IRenderOptions): void {\n        if (this.__.__clipAfterFill) {\n            canvas.save()\n            canvas.clipUI(this)\n            this.__drawContent(canvas, options)\n            canvas.restore()\n        } else this.__drawContent(canvas, options)\n    }\n\n}\n\n\nfunction drawFast(ui: IUI, canvas: ILeaferCanvas, options: IRenderOptions): void {\n    const { fill, stroke, __drawAfterFill, __fillAfterStroke } = ui.__\n\n    ui.__drawRenderPath(canvas)\n\n    if (__fillAfterStroke) Paint.stroke(stroke as string, ui, canvas, options)\n\n    if (fill) Paint.fill(fill as string, ui, canvas, options)\n    if (__drawAfterFill) ui.__drawAfterFill(canvas, options)\n\n    if (stroke && !__fillAfterStroke) Paint.stroke(stroke as string, ui, canvas, options)\n}", "import { ILeaferCanvas, IRenderOptions } from '@leafer/interface'\n\nimport { IRectRenderModule } from '@leafer-ui/interface'\n\n\nexport const RectRender: IRectRenderModule = {\n\n    __drawFast(canvas: ILeaferCanvas, options: IRenderOptions): void {\n\n        let { x, y, width, height } = this.__layout.boxBounds\n        const { fill, stroke, __drawAfterFill } = this.__\n\n        if (fill) {\n            canvas.fillStyle = fill\n            canvas.fillRect(x, y, width, height)\n        }\n\n        if (__drawAfterFill) this.__drawAfterFill(canvas, options)\n\n        if (stroke) {\n\n            const { strokeAlign, __strokeWidth: strokeWidth } = this.__\n            if (!strokeWidth) return\n\n            canvas.setStroke(stroke, strokeWidth, this.__)\n            const half = strokeWidth / 2\n\n            switch (strokeAlign) {\n                case 'center':\n                    canvas.strokeRect(0, 0, width, height)\n                    break\n                case 'inside':\n                    width -= strokeWidth, height -= strokeWidth\n                    if (width < 0 || height < 0) {\n                        canvas.save()\n                        this.__clip(canvas, options)\n                        canvas.strokeRect(x + half, y + half, width, height)\n                        canvas.restore()\n                    } else canvas.strokeRect(x + half, y + half, width, height)\n                    break\n                case 'outside':\n                    canvas.strokeRect(x - half, y - half, width + strokeWidth, height + strokeWidth)\n                    break\n            }\n\n        }\n\n    }\n}\n", "import { ILeaferCanvas, IRenderOptions, IPathDrawer, IPathCommandData, IHitType, INumber, IBoolean, IString, IPathString, IExportFileType, IPointData, ICursorType, IMaskType, IEraserType, IWindingRule, IPathCreator, IFourNumber, IBoundsData, IFlowType, IGap, IFlowWrap, IAxis, IConstraint, IAutoBoxData, IFlowBoxType, IPointGap, IFlowAlign, IFlowAxisAlign, IFindCondition, IAutoSize, IRangeSize, IAlign, IUnitPointData, IObject, IScaleData, IUnitData, IPathCommandObject, ITransition, IFilter, IScaleFixed, IDragBoundsType, IPathCommandNode } from '@leafer/interface'\nimport { Leaf, PathDrawer, surfaceType, dimType, dataType, positionType, scrollType, boundsType, pathType, scaleType, rotationType, opacityType, visibleType, sortType, maskType, dataProcessor, registerUI, useModule, rewrite, rewriteAble, UICreator, PathCorner, hitType, strokeType, PathConvert, eraserType, cursorType, autoLayoutType, pen, naturalBoundsType, pathInputType, MathHelper, Plugin, DataHelper, affectRenderBoundsType, isString, isNumber } from '@leafer/core'\n\nimport { IUI, IShadowEffect, IBlurEffect, IStrokeAlign, IStrokeJoin, IStrokeCap, IBlendMode, IDashPatternString, IShadowString, IGrayscaleEffect, IUIData, IGroup, IStrokeWidthString, ICornerRadiusString, IUIInputData, IExportOptions, IExportResult, IFill, IStroke, IArrowStyle, IFindUIMethod, ILeafer, IEditorConfig, IEditorConfigFunction, IEditToolFunction, IKeyframe, IAnimation, IAnimate, IStates, IStateName, IAnimateType, IStateStyle, IColorString, IAnimateList, ILeafPaint } from '@leafer-ui/interface'\nimport { effectType, zoomLayerType } from '@leafer-ui/decorator'\n\nimport { UIData } from '@leafer-ui/data'\nimport { UIBounds, UIRender } from '@leafer-ui/display-module'\n\nimport { Export, Paint, PathArrow } from '@leafer-ui/external'\n\n\n@useModule(UIBounds)\n@useModule(UIRender)\n@rewriteAble()\nexport class UI<TInputData = IUIInputData> extends Leaf<TInputData> implements IUI { // tip: rewrited Box\n\n    @dataProcessor(UIData)\n    declare public __: IUIData\n\n    declare public proxyData?: IUIInputData // need rewrite getter\n    declare public __proxyData?: IUIInputData\n\n    public get app(): ILeafer { return this.leafer && this.leafer.app }\n\n    declare public leafer?: ILeafer\n    declare public parent?: IGroup\n\n    @zoomLayerType()\n    public zoomLayer: IGroup\n\n    public get isFrame(): boolean { return false }\n\n    declare public children?: IUI[]\n\n    // ---\n\n    // id\n    @dataType('')\n    public id?: IString\n\n    @dataType('')\n    public name?: IString\n\n    @dataType('')\n    public className?: IString\n\n\n    // layer\n    @surfaceType('pass-through')\n    public blendMode?: IBlendMode\n\n    @opacityType(1)\n    public opacity?: INumber\n\n    @visibleType(true)\n    public visible?: IBoolean | 0\n\n\n    @surfaceType(false)\n    public locked?: IBoolean\n\n\n    // @leafer-in/bright will rewrite\n\n    @dimType(false)\n    public dim?: IBoolean | INumber // 是否弱化内容，可设置具体透明度\n\n    @dimType(false)\n    public dimskip?: IBoolean // 跳过弱化，突出显示内容，不受dim影响\n\n    public bright?: IBoolean // 突出显示内容，并置顶渲染，不受dim影响\n\n\n    @sortType(0)\n    public zIndex?: INumber\n\n\n    @maskType(false)\n    public mask?: IBoolean | IMaskType\n\n    @eraserType(false)\n    public eraser?: IBoolean | IEraserType\n\n\n    // position\n    @positionType(0, true)\n    public x?: INumber\n\n    @positionType(0, true)\n    public y?: INumber\n\n    // size\n    @boundsType(100, true)\n    public width?: INumber\n\n    @boundsType(100, true)\n    public height?: INumber\n\n    // scale\n    @scaleType(1, true)\n    public scaleX?: INumber\n\n    @scaleType(1, true)\n    public scaleY?: INumber\n\n    // @leafer-in/scale-fixed will rewrite\n    public scaleFixed?: IScaleFixed\n\n    // rotate\n    @rotationType(0, true)\n    public rotation?: INumber\n\n    // skew\n    @rotationType(0, true)\n    public skewX?: INumber\n\n    @rotationType(0, true)\n    public skewY?: INumber\n\n\n    // offset\n    @positionType(0, true)\n    public offsetX?: INumber\n\n    @positionType(0, true)\n    public offsetY?: INumber\n\n    // scroll\n    @scrollType(0, true)\n    public scrollX?: INumber\n\n    @scrollType(0, true)\n    public scrollY?: INumber\n\n\n    // center\n    @autoLayoutType()\n    public origin?: IAlign | IUnitPointData\n\n    @autoLayoutType()\n    public around?: IAlign | IUnitPointData\n\n\n    // image\n    @dataType(false)\n    public lazy?: IBoolean  // load image / compute paint\n\n    @naturalBoundsType(1)\n    public pixelRatio?: INumber\n\n\n    @affectRenderBoundsType(0)\n    public renderSpread?: IFourNumber // 强行扩大渲染边界\n\n\n    // path\n    @pathInputType()\n    public path?: IPathCommandData | IPathCommandNode[] | IPathCommandObject[] | IPathString\n\n    @pathType()\n    public windingRule?: IWindingRule\n\n    @pathType(true)\n    public closed?: boolean\n\n\n    // @leafer-in/flow rewrite\n    public flow?: IFlowType\n\n    @boundsType(0)\n    public padding?: IFourNumber\n\n    public gap?: IGap | IPointGap\n\n    public flowAlign?: IFlowAlign | IFlowAxisAlign\n\n    public flowWrap?: IFlowWrap\n\n\n    public itemBox?: IFlowBoxType\n\n    public inFlow?: IBoolean\n\n\n    public autoWidth?: IAutoSize\n\n    public autoHeight?: IAutoSize\n\n    @boundsType(false)\n    public lockRatio?: IBoolean\n\n    public autoBox?: IAutoBoxData | IConstraint\n\n    @boundsType()\n    public widthRange?: IRangeSize\n\n    @boundsType()\n    public heightRange?: IRangeSize\n\n\n    // drag\n    @dataType(false)\n    public draggable?: IBoolean | IAxis\n\n    @dataType()\n    public dragBounds?: IBoundsData | 'parent'\n\n    @dataType('auto')\n    dragBoundsType?: IDragBoundsType\n\n\n    @dataType(false)\n    public editable?: IBoolean\n\n\n    // hit\n    @hitType(true)\n    public hittable?: IBoolean\n\n    @hitType('path')\n    public hitFill?: IHitType\n\n    @strokeType('path')\n    public hitStroke?: IHitType\n\n    @hitType(false)\n    public hitBox?: IBoolean\n\n    @hitType(true)\n    public hitChildren?: IBoolean\n\n    @hitType(true)\n    public hitSelf?: IBoolean\n\n    @hitType()\n    public hitRadius?: INumber\n\n    @cursorType('')\n    public cursor?: ICursorType | ICursorType[]\n\n    // ---\n\n\n    // fill\n\n    @surfaceType()\n    public fill?: IFill\n\n    // stroke\n\n    @strokeType(undefined, true)\n    public stroke?: IStroke\n\n    @strokeType('inside')\n    public strokeAlign?: IStrokeAlign\n\n    @strokeType(1, true)\n    public strokeWidth?: IFourNumber | IStrokeWidthString\n\n    @strokeType(false)\n    public strokeWidthFixed?: IScaleFixed\n\n    @strokeType('none')\n    public strokeCap?: IStrokeCap\n\n    @strokeType('miter')\n    public strokeJoin?: IStrokeJoin\n\n    @strokeType()\n    public dashPattern?: INumber[] | IDashPatternString\n\n    @strokeType(0)\n    public dashOffset?: INumber\n\n    @strokeType(10)\n    public miterLimit?: INumber\n\n\n    // @leafer-in/arrow rewrite\n\n    public startArrow?: IArrowStyle\n\n    public endArrow?: IArrowStyle\n\n    // corner\n\n    @pathType(0)\n    public cornerRadius?: IFourNumber | ICornerRadiusString\n\n    @pathType()\n    public cornerSmoothing?: INumber\n\n    // effect\n\n    @effectType()\n    public shadow?: IShadowEffect | IShadowEffect[] | IShadowString\n\n    @effectType()\n    public innerShadow?: IShadowEffect | IShadowEffect[] | IShadowString\n\n    @effectType()\n    public blur?: INumber | IBlurEffect\n\n    @effectType()\n    public backgroundBlur?: INumber | IBlurEffect\n\n    @effectType()\n    public grayscale?: INumber | IGrayscaleEffect\n\n    @effectType()\n    public filter?: IFilter | IFilter[]\n\n\n    // @leafer-in/animate rewrite\n\n    public animation?: IAnimation | IAnimation[]\n\n    public animationOut?: IAnimation | IAnimation[]\n\n\n    public transition?: ITransition\n\n    public transitionOut?: ITransition\n\n\n    // @leafer-in/motion-path rewrite\n\n    public motionPath?: boolean\n\n    public motionPrecision?: INumber\n\n\n    public motion?: INumber | IUnitData\n\n    public motionRotation?: INumber | IBoolean\n\n\n    // @leafer-in/state rewrite\n\n    public states?: IStates\n\n    public state?: IStateName\n\n\n    public selected?: IBoolean\n\n    public disabled?: IBoolean\n\n\n    public normalStyle?: IStateStyle\n\n    public hoverStyle?: IStateStyle\n\n    public pressStyle?: IStateStyle\n\n    public focusStyle?: IStateStyle\n\n    public selectedStyle?: IStateStyle\n\n    public disabledStyle?: IStateStyle\n\n\n    public placeholderStyle?: IStateStyle\n\n    @surfaceType()\n    public placeholderColor?: IColorString\n\n    @dataType(100)\n    public placeholderDelay?: INumber\n\n\n    public button?: IBoolean\n\n\n    //  @leafer-in/editor rewrite\n\n    public editConfig: IEditorConfig\n\n    public editOuter: string\n\n    public editInner: string\n\n\n    // 预留给用户使用的数据对象\n    @dataType({})\n    public data: IObject\n\n\n    public set scale(value: INumber | IPointData) { MathHelper.assignScale(this as IScaleData, value) }\n    public get scale(): INumber | IPointData { return this.__.scale }\n\n    public get isAutoWidth(): boolean { const t = this.__; return t.__autoWidth || t.autoWidth as boolean }\n    public get isAutoHeight(): boolean { const t = this.__; return t.__autoHeight || t.autoHeight as boolean }\n\n    public useFastShadow?: boolean // 将忽略 stroke 产生的阴影，只对单个 fill 有效\n\n    public __box?: IUI // 背景box, 一般用于文本背景框\n    public __animate?: IAnimate | IAnimateList\n\n    public get pen(): IPathCreator {\n        const { path } = this.__\n        pen.set(this.path = path || [])\n        if (!path) this.__drawPathByBox(pen)\n        return pen\n    }\n\n\n    // data\n\n    @rewrite(Leaf.prototype.reset)\n    public reset(_data?: IUIInputData): void { }\n\n\n    // @leafer-in/animate and @leafer-in/state will rewrite\n\n    public set(data: IUIInputData, _transition?: ITransition | 'temp'): void {\n        if (data) Object.assign(this, data)\n    }\n\n    public get<K extends keyof this>(name?: K | K[] | IUIInputData): IUIInputData | this[K] {\n        return isString(name) ? this.__.__getInput(name) : this.__.__getInputData(name as string[] | undefined)\n    }\n\n    public createProxyData(): IUIInputData { return undefined }\n\n\n    // hit rewrite\n\n    public find(_condition: number | string | IFindCondition | IFindUIMethod, _options?: any): IUI[] { return Plugin.need('find') }\n\n    public findTag(tag: string | string[]): IUI[] { return this.find({ tag }) }\n\n    public findOne(_condition: number | string | IFindCondition | IFindUIMethod, _options?: any): IUI | undefined { return Plugin.need('find') }\n\n    public findId(id: number | string): IUI | undefined { return this.findOne({ id }) }\n\n\n    // path\n\n    public getPath(curve?: boolean, pathForRender?: boolean): IPathCommandData {\n        this.__layout.update()\n        let path = pathForRender ? this.__.__pathForRender : this.__.path\n        if (!path) pen.set(path = []), this.__drawPathByBox(pen, !pathForRender)\n        return curve ? PathConvert.toCanvasData(path, true) : path\n    }\n\n    public getPathString(curve?: boolean, pathForRender?: boolean, floatLength?: number): IPathString {\n        return PathConvert.stringify(this.getPath(curve, pathForRender), floatLength)\n    }\n\n\n    public load(): void {\n        this.__.__computePaint() // 手动加载图片\n    }\n\n    public __onUpdateSize(): void {\n        if (this.__.__input) {\n            const data = this.__;\n            (data.lazy && !this.__inLazyBounds && !Export.running) ? data.__needComputePaint = true : data.__computePaint()\n        }\n    }\n\n    public __updateRenderPath(): void {\n        const data = this.__\n        if (data.path) {\n            data.__pathForRender = data.cornerRadius ? PathCorner.smooth(data.path, data.cornerRadius, data.cornerSmoothing) : data.path\n            if (data.__useArrow) PathArrow.addArrows(this)\n        } else data.__pathForRender && (data.__pathForRender = undefined)\n    }\n\n    public __drawRenderPath(canvas: ILeaferCanvas): void {\n        canvas.beginPath()\n        this.__drawPathByData(canvas, this.__.__pathForRender)\n    }\n\n    public __drawPath(canvas: ILeaferCanvas): void {\n        canvas.beginPath()\n        this.__drawPathByData(canvas, this.__.path, true)\n    }\n\n    public __drawPathByData(drawer: IPathDrawer, data: IPathCommandData, ignoreCornerRadius?: boolean): void {\n        data ? PathDrawer.drawPathByData(drawer, data) : this.__drawPathByBox(drawer, ignoreCornerRadius)\n    }\n\n    public __drawPathByBox(drawer: IPathDrawer, ignoreCornerRadius?: boolean): void {\n        const { x, y, width, height } = this.__layout.boxBounds\n        if (this.__.cornerRadius && !ignoreCornerRadius) {\n            const { cornerRadius } = this.__\n            drawer.roundRect(x, y, width, height, isNumber(cornerRadius) ? [cornerRadius] : cornerRadius) // 修复微信浏览器bug, 后续需进一步优化\n        } else drawer.rect(x, y, width, height)\n        drawer.closePath()\n    }\n\n    public drawImagePlaceholder(_paint: ILeafPaint, canvas: ILeaferCanvas, renderOptions: IRenderOptions): void {\n        Paint.fill(this.__.placeholderColor, this, canvas, renderOptions)  // 图片占位符\n    }\n\n    // @leafer-in/animate rewrite\n\n    public animate(keyframe?: IUIInputData | IKeyframe[] | IAnimation | IAnimation[], _options?: ITransition, _type?: IAnimateType, _isTemp?: boolean): IAnimate {\n        this.set(keyframe as IUIInputData)\n        return Plugin.need('animate')\n    }\n\n    public killAnimate(_type?: IAnimateType, _nextStyle?: IUIInputData): void { }\n\n\n    // create\n\n    // @leafer-in/export will rewrite\n    public export(_filename: IExportFileType | string, _options?: IExportOptions | number | boolean): Promise<IExportResult> {\n        return Plugin.need('export')\n    }\n\n    public syncExport(_filename: IExportFileType | string, _options?: IExportOptions | number | boolean): IExportResult {\n        return Plugin.need('export')\n    }\n\n    public clone(data?: IUIInputData): this {\n        const json = DataHelper.clone(this.toJSON())\n        if (data) Object.assign(json, data)\n        return UI.one(json) as this\n    }\n\n    // this 参数定义，在编译的时候会移除\n    static one<T extends UI>(this: new (...args: any[]) => T, data: IUIInputData, x?: number, y?: number, width?: number, height?: number): T {\n        return UICreator.get(data.tag || this.prototype.__tag, data, x, y, width, height) as T\n    }\n\n    static registerUI(): void {\n        registerUI()(this)\n    }\n\n    static registerData(data: IUIData): void {\n        dataProcessor(data)(this.prototype)\n    }\n\n\n    // @leafer-in/editor rewrite\n\n    static setEditConfig(_config: IEditorConfig | IEditorConfigFunction): void { }\n\n    static setEditOuter(_toolName: string | IEditToolFunction): void { }\n\n    static setEditInner(_editorName: string | IEditToolFunction): void { }\n\n\n    public destroy(): void {\n        this.fill = this.stroke = null\n        if (this.__animate) this.killAnimate()\n        super.destroy()\n    }\n\n}\n", "import { IJSONOptions, IPickOptions, IPickResult, IPointData, INumber, ITransition } from '@leafer/interface'\nimport { Branch, useModule, dataProcessor, registerUI, boundsType } from '@leafer/core'\n\nimport { IGroup, IGroupData, IGroupInputData, IUI, IUIInputData, IUIJSONData, IFindCondition, IFindUIMethod } from '@leafer-ui/interface'\nimport { GroupData } from '@leafer-ui/data'\n\nimport { UI } from './UI'\n\n\n@useModule(Branch)\n@registerUI()\nexport class Group<TInputData = IGroupInputData> extends UI<TInputData> implements IGroup {   // tip: rewrited Box\n\n    public get __tag() { return 'Group' }\n\n    public get isBranch(): boolean { return true }\n\n    @dataProcessor(GroupData)\n    declare public __: IGroupData\n\n    // size\n    @boundsType(0)\n    declare public width?: INumber\n\n    @boundsType(0)\n    declare public height?: INumber\n\n    declare public children: IUI[]\n\n    declare public topChildren?: IUI[]\n\n    public childlessJSON?: boolean\n\n\n    public reset(data?: IGroupInputData): void {\n        this.__setBranch()\n        super.reset(data)\n    }\n\n    public __setBranch(): void {\n        if (!this.children) this.children = []\n    }\n\n\n    // data\n\n    override set(data: IUIInputData, transition?: ITransition | 'temp'): void {\n        if (data) {\n            if (data.children) {\n                const { children } = data\n\n                delete data.children\n                this.children ? this.clear() : this.__setBranch()\n\n                super.set(data, transition)\n\n                children.forEach(child => this.add(child))\n                data.children = children\n\n            } else super.set(data, transition)\n        }\n    }\n\n    override toJSON(options?: IJSONOptions): IUIJSONData {\n        const data = super.toJSON(options)\n        if (!this.childlessJSON) data.children = this.children.map(child => child.toJSON(options))\n        return data\n    }\n\n\n    // hit rewrite\n\n    public pick(_hitPoint: IPointData, _options?: IPickOptions): IPickResult { return undefined }\n\n\n    // add\n\n    public addAt(child: IUI | IUI[] | IUIInputData | IUIInputData[], index: number): void {\n        this.add(child, index)\n    }\n\n    public addAfter(child: IUI | IUI[] | IUIInputData | IUIInputData[], after: IUI): void {\n        this.add(child, this.children.indexOf(after) + 1)\n    }\n\n    public addBefore(child: IUI | IUI[] | IUIInputData | IUIInputData[], before: IUI): void {\n        this.add(child, this.children.indexOf(before))\n    }\n\n    // Branch rewrite\n\n    public add(_child: IUI | IUI[] | IUIInputData | IUIInputData[], _index?: number): void { }\n\n    public addMany(..._children: IUI[] | IUIInputData[]): void { }\n\n    public remove(_child?: IUI | number | string | IFindCondition | IFindUIMethod, _destroy?: boolean): void { }\n\n    public removeAll(_destroy?: boolean): void { }\n\n    public clear(): void { }\n\n}", "import { ILeaferCanvas, IRenderer, ILayouter, ISelector, IWatcher, IInteraction, ILeaferConfig, ICanvasManager, IHitCanvasManager, IAutoBounds, IScreenSizeData, IResizeEvent, IEventListenerId, ITimer, IValue, IObject, IControl, IPointData, ILeaferType, ICursorType, IBoundsData, INumber, IZoomType, IZoomOptions, IFourNumber, IBounds, IClientPointData, ITransition, ICanvasSizeAttr, ILeaferMode } from '@leafer/interface'\nimport { AutoBounds, LayoutEvent, ResizeEvent, LeaferEvent, CanvasManager, ImageManager, Resource, DataHelper, Creator, Run, Debug, RenderEvent, registerUI, boundsType, canvasSizeAttrs, dataProcessor, WaitHelper, WatchEvent, Bounds, LeafList, Plugin, getBoundsData, dataType } from '@leafer/core'\n\nimport { ILeaferInputData, ILeaferData, IFunction, IUIInputData, ILeafer, IApp, IEditorBase } from '@leafer-ui/interface'\nimport { LeaferData } from '@leafer-ui/data'\n\nimport { Group } from './Group'\n\n\nconst debug = Debug.get('Leafer')\n\n@registerUI()\nexport class Leafer extends Group implements ILeafer {\n\n    static list = new LeafList() // 所有leafer实例\n\n\n    public get __tag() { return 'Leafer' }\n\n    @dataProcessor(LeaferData)\n    declare public __: ILeaferData\n\n    @boundsType()\n    declare public pixelRatio?: INumber\n\n    @dataType('normal')\n    public mode: ILeaferMode\n\n    public get isApp(): boolean { return false }\n    public get app(): ILeafer { return this.parent || this }\n\n    public get isLeafer(): boolean { return true }\n\n    public parentApp?: IApp\n    declare public parent?: IApp\n\n    public running: boolean\n    public created: boolean\n    public ready: boolean\n    public viewReady: boolean\n    public viewCompleted: boolean\n    public get imageReady(): boolean { return this.viewReady && Resource.isComplete }\n    public get layoutLocked() { return !this.layouter.running }\n\n    public transforming: boolean\n\n    public get view(): unknown { return this.canvas && this.canvas.view }\n\n    //  manager\n    public canvas: ILeaferCanvas\n    public renderer: IRenderer\n\n    public watcher: IWatcher\n    public layouter: ILayouter\n\n    public selector?: ISelector\n    public interaction?: IInteraction\n\n    public canvasManager: ICanvasManager\n    public hitCanvasManager?: IHitCanvasManager\n\n    // plugin\n    public editor: IEditorBase\n\n    public userConfig: ILeaferConfig\n    public config: ILeaferConfig = {\n        start: true,\n        hittable: true,\n        smooth: true,\n        lazySpeard: 100,\n        // maxFPS: 120, // 最大的运行帧率\n        // pixelSnap: false // 是否对齐像素，避免图片存在浮点坐标导致模糊\n    }\n\n    public autoLayout?: IAutoBounds\n    public lazyBounds: IBounds\n\n    public get FPS(): number { return this.renderer ? this.renderer.FPS : 60 }\n    public get cursorPoint(): IPointData { return (this.interaction && this.interaction.hoverData) || { x: this.width / 2, y: this.height / 2 } }\n    public get clientBounds(): IBoundsData { return (this.canvas && this.canvas.getClientBounds(true)) || getBoundsData() }\n    public leafs = 0\n\n    public __eventIds: IEventListenerId[] = []\n    protected __startTimer: ITimer\n    protected __controllers: IControl[] = []\n\n    protected __initWait: IFunction[] // assign in waitInit()\n    protected __readyWait: IFunction[] = []\n    protected __viewReadyWait: IFunction[] = []\n    protected __viewCompletedWait: IFunction[] = []\n    public __nextRenderWait: IFunction[] = []\n\n    constructor(userConfig?: ILeaferConfig, data?: ILeaferInputData) {\n        super(data)\n        this.userConfig = userConfig\n        if (userConfig && (userConfig.view || userConfig.width)) this.init(userConfig)\n        Leafer.list.add(this)\n    }\n\n    public init(userConfig?: ILeaferConfig, parentApp?: IApp): void {\n        if (this.canvas) return\n\n        let start: boolean\n        const { config } = this\n\n        this.__setLeafer(this)\n\n        if (parentApp) {\n            this.parentApp = parentApp\n            this.__bindApp(parentApp)\n            start = parentApp.running\n        }\n\n        if (userConfig) {\n            this.parent = parentApp\n            this.initType(userConfig.type) // LeaferType\n            this.parent = undefined\n            DataHelper.assign(config, userConfig)\n        }\n\n        // render / layout\n        const canvas = this.canvas = Creator.canvas(config)\n        this.__controllers.push(\n            this.renderer = Creator.renderer(this, canvas, config),\n            this.watcher = Creator.watcher(this, config),\n            this.layouter = Creator.layouter(this, config)\n        )\n\n        if (this.isApp) this.__setApp()\n        this.__checkAutoLayout()\n\n        // interaction / manager\n        if (!parentApp) {\n            this.selector = Creator.selector(this)\n            this.interaction = Creator.interaction(this, canvas, this.selector, config)\n\n            if (this.interaction) {\n                this.__controllers.unshift(this.interaction)\n                this.hitCanvasManager = Creator.hitCanvasManager()\n            }\n\n            this.canvasManager = new CanvasManager()\n\n            start = config.start\n        }\n\n        this.hittable = config.hittable\n        this.fill = config.fill\n        this.canvasManager.add(canvas)\n\n\n        this.__listenEvents()\n\n        if (start) this.__startTimer = setTimeout(this.start.bind(this))\n\n        WaitHelper.run(this.__initWait)\n        this.onInit() // can rewrite init event\n    }\n\n    public onInit(): void { }\n\n    public initType(_type: ILeaferType): void { } // rewrite in @leafer-ui/viewport\n\n    public set(data: IUIInputData, transition?: ITransition | 'temp'): void {\n        this.waitInit(() => { super.set(data, transition) })\n    }\n\n    public start(): void {\n        clearTimeout(this.__startTimer)\n        if (!this.running && this.canvas) {\n            this.running = true\n            this.ready ? this.emitLeafer(LeaferEvent.RESTART) : this.emitLeafer(LeaferEvent.START)\n            this.__controllers.forEach(item => item.start())\n            if (!this.isApp) this.renderer.render()\n        }\n    }\n\n    public stop(): void {\n        clearTimeout(this.__startTimer)\n        if (this.running && this.canvas) {\n            this.__controllers.forEach(item => item.stop())\n            this.running = false\n            this.emitLeafer(LeaferEvent.STOP)\n        }\n    }\n\n    public unlockLayout(): void {\n        this.layouter.start()\n        this.updateLayout()\n    }\n\n    public lockLayout(): void {\n        this.updateLayout()\n        this.layouter.stop()\n    }\n\n    public resize(size: IScreenSizeData): void {\n        const data = DataHelper.copyAttrs({}, size, canvasSizeAttrs)\n        Object.keys(data).forEach(key => (this as any)[key] = data[key])\n    }\n\n    override forceRender(bounds?: IBoundsData, sync?: boolean): void {\n        const { renderer } = this\n        if (renderer) {\n            renderer.addBlock(bounds ? new Bounds(bounds) : this.canvas.bounds)\n            if (this.viewReady) sync ? renderer.render() : renderer.update()\n        }\n    }\n\n    public requestRender(change = false): void {\n        if (this.renderer) this.renderer.update(change)\n    }\n\n    public updateCursor(cursor?: ICursorType): void {\n        const i = this.interaction\n        if (i) cursor ? i.setCursor(cursor) : i.updateCursor()\n    }\n\n    public updateLazyBounds(): void {\n        this.lazyBounds = this.canvas.bounds.clone().spread(this.config.lazySpeard)\n    }\n\n    protected __doResize(size: IScreenSizeData): void {\n        const { canvas } = this\n        if (!canvas || canvas.isSameSize(size)) return\n        const old = DataHelper.copyAttrs({}, this.canvas, canvasSizeAttrs) as IScreenSizeData\n        canvas.resize(size)\n        this.updateLazyBounds()\n        this.__onResize(new ResizeEvent(size, old))\n    }\n\n    protected __onResize(event: IResizeEvent): void {\n        this.emitEvent(event)\n        DataHelper.copyAttrs(this.__, event, canvasSizeAttrs)\n        setTimeout(() => { if (this.canvasManager) this.canvasManager.clearRecycled() }, 0)\n    }\n\n    protected __setApp(): void { }\n\n    protected __bindApp(app: IApp): void {\n        this.selector = app.selector\n        this.interaction = app.interaction\n\n        this.canvasManager = app.canvasManager\n        this.hitCanvasManager = app.hitCanvasManager\n    }\n\n    public __setLeafer(leafer: ILeafer): void {\n        this.leafer = leafer\n        this.__level = 1\n    }\n\n    protected __checkAutoLayout(): void {\n        const { config, parentApp } = this\n        if (!parentApp) {\n            if (!config.width || !config.height) this.autoLayout = new AutoBounds(config)\n            this.canvas.startAutoLayout(this.autoLayout, this.__onResize.bind(this))\n        }\n    }\n\n    override __setAttr(attrName: string, newValue: IValue): boolean {\n        if (this.canvas) {\n            if (canvasSizeAttrs.includes(attrName)) {\n                // if (!newValue) debug.warn(attrName + ' is 0')\n                this.__changeCanvasSize(attrName as ICanvasSizeAttr, newValue as number)\n            } else if (attrName === 'fill') {\n                this.__changeFill(newValue as string)\n            } else if (attrName === 'hittable') {\n                if (!this.parent) this.canvas.hittable = newValue as boolean\n            } else if (attrName === 'zIndex') {\n                this.canvas.zIndex = newValue as any\n                setTimeout(() => this.parent && this.parent.__updateSortChildren())\n            } else if (attrName === 'mode') this.emit(LeaferEvent.UPDATE_MODE, { mode: newValue })\n        }\n        return super.__setAttr(attrName, newValue)\n    }\n\n    override __getAttr(attrName: string): IValue {\n        if (this.canvas && canvasSizeAttrs.includes(attrName)) return this.canvas[attrName]\n        return super.__getAttr(attrName)\n    }\n\n    protected __changeCanvasSize(attrName: ICanvasSizeAttr, newValue: number): void {\n        const { config, canvas } = this\n        const data = DataHelper.copyAttrs({}, canvas, canvasSizeAttrs)\n        data[attrName] = config[attrName] = newValue\n        config.width && config.height ? canvas.stopAutoLayout() : this.__checkAutoLayout()\n        this.__doResize(data as IScreenSizeData)\n    }\n\n    protected __changeFill(newValue: string): void {\n        this.config.fill = newValue as string\n        if (this.canvas.allowBackgroundColor) this.canvas.backgroundColor = newValue as string\n        else this.forceRender()\n    }\n\n    protected __onCreated(): void {\n        this.created = true\n    }\n\n    protected __onReady(): void {\n        this.ready = true\n        this.emitLeafer(LeaferEvent.BEFORE_READY)\n        this.emitLeafer(LeaferEvent.READY)\n        this.emitLeafer(LeaferEvent.AFTER_READY)\n        WaitHelper.run(this.__readyWait)\n    }\n\n    protected __onViewReady(): void {\n        if (this.viewReady) return\n        this.viewReady = true\n        this.emitLeafer(LeaferEvent.VIEW_READY)\n        WaitHelper.run(this.__viewReadyWait)\n    }\n\n    protected __onLayoutEnd(): void {\n        const { grow, width: fixedWidth, height: fixedHeight } = this.config\n        if (grow) {\n            let { width, height, pixelRatio } = this\n            const bounds = grow === 'box' ? this.worldBoxBounds : this.__world\n            if (!fixedWidth) width = Math.max(1, bounds.x + bounds.width)\n            if (!fixedHeight) height = Math.max(1, bounds.y + bounds.height)\n            this.__doResize({ width, height, pixelRatio })\n        }\n\n        if (!this.ready) this.__onReady()\n    }\n\n    protected __onNextRender(): void {\n        if (this.viewReady) {\n            WaitHelper.run(this.__nextRenderWait)\n\n            const { imageReady } = this\n            if (imageReady && !this.viewCompleted) this.__checkViewCompleted()\n            if (!imageReady) {\n                this.viewCompleted = false\n                this.requestRender()\n            }\n        } else this.requestRender() // fix: 小程序等需要异步获取 view 的情况\n    }\n\n    protected __checkViewCompleted(emit: boolean = true): void {\n        this.nextRender(() => {\n            if (this.imageReady) {\n                if (emit) this.emitLeafer(LeaferEvent.VIEW_COMPLETED)\n                WaitHelper.run(this.__viewCompletedWait)\n                this.viewCompleted = true\n            }\n        })\n    }\n\n    protected __onWatchData(): void {\n        if (this.watcher.childrenChanged && this.interaction) {\n            this.nextRender(() => this.interaction.updateCursor())\n        }\n    }\n\n    public waitInit(item: IFunction, bind?: IObject): void {\n        if (bind) item = item.bind(bind)\n        if (!this.__initWait) this.__initWait = [] // set() use\n        this.canvas ? item() : this.__initWait.push(item)\n    }\n\n    public waitReady(item: IFunction, bind?: IObject): void {\n        if (bind) item = item.bind(bind)\n        this.ready ? item() : this.__readyWait.push(item)\n    }\n\n    public waitViewReady(item: IFunction, bind?: IObject): void {\n        if (bind) item = item.bind(bind)\n        this.viewReady ? item() : this.__viewReadyWait.push(item)\n    }\n\n    public waitViewCompleted(item: IFunction, bind?: IObject): void {\n        if (bind) item = item.bind(bind)\n        this.__viewCompletedWait.push(item)\n        if (this.viewCompleted) this.__checkViewCompleted(false)\n        else if (!this.running) this.start()\n    }\n\n    public nextRender(item: IFunction, bind?: IObject, off?: 'off'): void {\n        if (bind) item = item.bind(bind)\n        const list = this.__nextRenderWait\n        if (off) {\n            for (let i = 0; i < list.length; i++) {\n                if (list[i] === item) { list.splice(i, 1); break }\n            }\n        } else list.push(item)\n        this.requestRender()\n    }\n\n    // need view plugin\n    public zoom(_zoomType: IZoomType, _optionsOrPadding?: IZoomOptions | IFourNumber, _scroll?: 'x' | 'y' | boolean, _transition?: ITransition): IBoundsData {\n        return Plugin.need('view')\n    }\n\n\n    // interaction window rewrite\n    public getValidMove(moveX: number, moveY: number, _checkLimit?: boolean): IPointData { return { x: moveX, y: moveY } }\n    public getValidScale(changeScale: number): number { return changeScale }\n\n\n    public getWorldPointByClient(clientPoint: IClientPointData, updateClient?: boolean): IPointData {\n        return this.interaction && this.interaction.getLocal(clientPoint, updateClient)\n    }\n\n    public getPagePointByClient(clientPoint: IClientPointData, updateClient?: boolean): IPointData {\n        return this.getPagePoint(this.getWorldPointByClient(clientPoint, updateClient))\n    }\n\n    public getClientPointByWorld(worldPoint: IPointData): IPointData {\n        const { x, y } = this.clientBounds\n        return { x: x + worldPoint.x, y: y + worldPoint.y }\n    }\n\n    public updateClientBounds(): void {\n        this.canvas && this.canvas.updateClientBounds()\n    }\n\n    // miniapp rewrite\n    public receiveEvent(_event: any): void { }\n\n    protected emitLeafer(type: string): void {\n        this.emitEvent(new LeaferEvent(type, this))\n    }\n\n    protected __listenEvents(): void {\n        const runId = Run.start('FirstCreate ' + this.innerName)\n        this.once([\n            [LeaferEvent.START, () => Run.end(runId)],\n            [LayoutEvent.START, this.updateLazyBounds, this],\n            [RenderEvent.START, this.__onCreated, this],\n            [RenderEvent.END, this.__onViewReady, this]\n        ])\n        this.__eventIds.push(\n            this.on_([\n                [WatchEvent.DATA, this.__onWatchData, this],\n                [LayoutEvent.END, this.__onLayoutEnd, this],\n                [RenderEvent.NEXT, this.__onNextRender, this]\n            ])\n        )\n    }\n\n    protected __removeListenEvents(): void {\n        this.off_(this.__eventIds)\n    }\n\n    override destroy(sync?: boolean): void {\n        const doDestory = () => {\n            if (!this.destroyed) {\n                Leafer.list.remove(this)\n                try {\n                    this.stop()\n                    this.emitLeafer(LeaferEvent.END)\n                    this.__removeListenEvents()\n\n                    this.__controllers.forEach(item => !(this.parent && item === this.interaction) && item.destroy())\n                    this.__controllers.length = 0\n\n                    if (!this.parent) {\n                        if (this.selector) this.selector.destroy()\n                        if (this.hitCanvasManager) this.hitCanvasManager.destroy()\n                        if (this.canvasManager) this.canvasManager.destroy()\n                    }\n\n                    if (this.canvas) this.canvas.destroy()\n\n                    this.config.view = this.parentApp = null\n                    if (this.userConfig) this.userConfig.view = null\n\n                    super.destroy()\n\n                    setTimeout(() => { ImageManager.clearRecycled() }, 100)\n                } catch (e) {\n                    debug.error(e)\n                }\n            }\n        }\n        sync ? doDestory() : setTimeout(doDestory)\n    }\n}\n", "import { dataProcessor, registerUI, rewriteAble, useModule } from '@leafer/core'\n\nimport { IRect, IRectInputData, IRectData } from '@leafer-ui/interface'\nimport { RectData } from '@leafer-ui/data'\nimport { RectRender } from '@leafer-ui/display-module'\n\nimport { UI } from './UI'\n\n\n@useModule(RectRender)\n@rewriteAble()\n@registerUI()\nexport class Rect<TInputData = IRectInputData> extends UI<TInputData> implements IRect { // tip: rewrited Box\n\n    public get __tag() { return 'Rect' }\n\n    @dataProcessor(RectData)\n    declare public __: IRectData\n\n}", "import { ILeaferCanvas, IRenderOptions, IBoolean, INumber, IScrollPointData, IFourNumber } from '@leafer/interface'\nimport { rewrite, rewriteAble, registerUI, BoundsHelper, dataProcessor, affectRenderBoundsType, dataType, boundsType, DataHelper, getBoundsData } from '@leafer/core'\n\nimport { IBox, IBoxData, IBoxInputData, IOverflow, IScrollConfig, IScroller } from '@leafer-ui/interface'\nimport { BoxData } from '@leafer-ui/data'\n\nimport { Group } from './Group'\nimport { Rect } from './Rect'\n\n\nconst { add, includes, scroll } = BoundsHelper\nconst rect = Rect.prototype, group = Group.prototype\n\n@rewriteAble()\n@registerUI()\nexport class Box<TInputData = IBoxInputData> extends Group<TInputData> implements IBox {\n\n    public get __tag() { return 'Box' }\n\n    public get isBranchLeaf(): boolean { return true }\n\n    @dataProcessor(BoxData)\n    declare public __: IBoxData\n\n    // size\n    @boundsType(100)\n    declare public width?: INumber\n\n    @boundsType(100)\n    declare public height?: INumber\n\n    @dataType(false)\n    public resizeChildren?: IBoolean\n\n    // @leafer-in/editor rewrite\n    public textBox?: IBoolean\n\n    @affectRenderBoundsType('show')\n    declare public overflow?: IOverflow\n\n    public isOverflow?: boolean\n\n    // scroller will rewrite\n    public scrollConfig?: IScrollConfig\n\n    public scroller?: IScroller\n    public hasScroller?: boolean\n\n    constructor(data?: TInputData) {\n        super(data)\n        this.__layout.renderChanged || this.__layout.renderChange()\n    }\n\n    @rewrite(rect.__updateStrokeSpread)\n    public __updateStrokeSpread(): IFourNumber { return 0 }\n\n    @rewrite(rect.__updateRenderSpread)\n    public __updateRectRenderSpread(): IFourNumber { return 0 }\n\n    public __updateRenderSpread(): IFourNumber { return this.__updateRectRenderSpread() || -1 }\n\n\n    @rewrite(rect.__updateBoxBounds)\n    public __updateRectBoxBounds(): void { }\n\n\n    // @leafer-in/flow will rewrite\n    public __updateBoxBounds(_secondLayout?: boolean): void {\n        if (this.children.length && !this.pathInputed) {\n\n            const data = this.__\n\n            if (data.__autoSide) {\n\n                if (data.__hasSurface) this.__extraUpdate() // Box自身存在样式，需要额外更新\n\n                super.__updateBoxBounds()\n\n                const { boxBounds } = this.__layout\n\n                if (!data.__autoSize) {\n                    if (data.__autoWidth) {\n                        boxBounds.width += boxBounds.x, boxBounds.x = 0\n                        boxBounds.height = data.height, boxBounds.y = 0\n                    } else {\n                        boxBounds.height += boxBounds.y, boxBounds.y = 0\n                        boxBounds.width = data.width, boxBounds.x = 0\n                    }\n                }\n\n                this.__updateNaturalSize()\n\n            } else this.__updateRectBoxBounds()\n\n        } else this.__updateRectBoxBounds()\n    }\n\n    @rewrite(rect.__updateStrokeBounds)\n    public __updateStrokeBounds(): void { }\n\n    public __updateRenderBounds(): void {\n        let isOverflow: boolean, isScrollMode: boolean\n\n        if (this.children.length) {\n            const data = this.__, layout = this.__layout, { renderBounds, boxBounds } = layout, { overflow } = data\n\n            const childrenRenderBounds = layout.childrenRenderBounds || (layout.childrenRenderBounds = getBoundsData())\n            super.__updateRenderBounds(childrenRenderBounds)\n\n            if (isScrollMode = overflow && overflow.includes('scroll')) {  // 检查滚动逻辑\n                add(childrenRenderBounds, boxBounds)\n                scroll(childrenRenderBounds, data as IScrollPointData)\n            }\n\n            this.__updateRectRenderBounds()\n\n            isOverflow = !includes(boxBounds, childrenRenderBounds)\n            if (isOverflow && overflow === 'show') add(renderBounds, childrenRenderBounds)\n        } else this.__updateRectRenderBounds()\n\n        DataHelper.stintSet(this, 'isOverflow', isOverflow)\n\n        this.__checkScroll(isScrollMode)\n    }\n\n    @rewrite(rect.__updateRenderBounds)\n    public __updateRectRenderBounds(): void { }\n\n\n    //  scroller will rewrite\n    public __checkScroll(_isScrollMode: boolean): void { }\n\n\n    @rewrite(rect.__updateChange)\n    public __updateRectChange(): void { }\n\n    public __updateChange(): void {\n        super.__updateChange()\n        this.__updateRectChange()\n    }\n\n\n    @rewrite(rect.__render)\n    public __renderRect(_canvas: ILeaferCanvas, _options: IRenderOptions): void { }\n\n    @rewrite(group.__render)\n    public __renderGroup(_canvas: ILeaferCanvas, _options: IRenderOptions): void { }\n\n\n    public __render(canvas: ILeaferCanvas, options: IRenderOptions): void {\n        if (this.__.__drawAfterFill) {\n            this.__renderRect(canvas, options)\n        } else {\n            this.__renderRect(canvas, options)\n            if (this.children.length) this.__renderGroup(canvas, options)\n        }\n        if (this.hasScroller) this.scroller.__render(canvas, options)\n    }\n\n    // in __drawAfterFill()\n    public __drawContent(canvas: ILeaferCanvas, options: IRenderOptions): void {\n        this.__renderGroup(canvas, options)\n\n        if (this.__.__useStroke || this.__.__useEffect) { // 还原绘制路径\n            canvas.setWorld(this.__nowWorld)\n            this.__drawRenderPath(canvas)\n        }\n    }\n\n}\n", "import { dataProcessor, registerUI, affectRenderBoundsType, surfaceType } from '@leafer/core'\n\nimport { IFrame, IFrameData, IFrameInputData, IFill, IOverflow } from '@leafer-ui/interface'\nimport { FrameData } from '@leafer-ui/data'\n\nimport { Box } from './Box'\n\n\n@registerUI()\nexport class Frame<TInputData = IFrameInputData> extends Box<TInputData> implements IFrame {\n\n    public get __tag() { return 'Frame' }\n\n    public get isFrame(): boolean { return true }\n\n    @dataProcessor(FrameData)\n    declare public __: IFrameData\n\n    @surfaceType('#FFFFFF')\n    declare public fill?: IFill\n\n    @affectRenderBoundsType('hide')\n    declare public overflow?: IOverflow\n\n}\n", "import { INumber } from '@leafer/interface'\nimport { PathCommandDataHelper, Platform, dataProcessor, pathType, registerUI } from '@leafer/core'\n\nimport { IEllipse, IEllipseInputData, IEllipseData } from '@leafer-ui/interface'\nimport { EllipseData } from '@leafer-ui/data'\n\nimport { UI } from './UI'\n\n\nconst { moveTo, closePath, ellipse } = PathCommandDataHelper\n\n@registerUI()\nexport class Ellipse<TInputData = IEllipseInputData> extends UI<TInputData> implements IEllipse {\n\n    public get __tag() { return 'Ellipse' }\n\n    @dataProcessor(EllipseData)\n    declare public __: IEllipseData\n\n    @pathType(0)\n    public innerRadius?: INumber\n\n    @pathType(0)\n    public startAngle?: INumber\n\n    @pathType(0)\n    public endAngle?: INumber\n\n\n    public __updatePath(): void {\n\n        const { width, height, innerRadius, startAngle, endAngle } = this.__\n        const rx = width / 2, ry = height / 2\n\n        const path: number[] = this.__.path = []\n        let open: boolean\n\n        if (innerRadius) {\n\n            if (startAngle || endAngle) {\n                if (innerRadius < 1) ellipse(path, rx, ry, rx * innerRadius, ry * innerRadius, 0, startAngle, endAngle, false)\n                else open = true // 画弧线时，不能闭合路径\n                ellipse(path, rx, ry, rx, ry, 0, endAngle, startAngle, true)\n            } else {\n                if (innerRadius < 1) {\n                    ellipse(path, rx, ry, rx * innerRadius, ry * innerRadius)\n                    moveTo(path, width, ry)\n                }\n                ellipse(path, rx, ry, rx, ry, 0, 360, 0, true)\n            }\n\n        } else {\n\n            if (startAngle || endAngle) {\n                moveTo(path, rx, ry)\n                ellipse(path, rx, ry, rx, ry, 0, startAngle, endAngle, false)\n            } else {\n                ellipse(path, rx, ry, rx, ry)\n            }\n\n        }\n\n        if (!open) closePath(path)\n\n        // fix node\n        if (Platform.ellipseToCurve) this.__.path = this.getPath(true)\n\n    }\n\n}", "import { INumber, IPointData } from '@leafer/interface'\nimport { PathCommandDataHelper, dataProcessor, pathType, registerUI, rewriteAble } from '@leafer/core'\n\nimport { IPolygon, IPolygonData, IPolygonInputData } from '@leafer-ui/interface'\nimport { PolygonData } from '@leafer-ui/data'\n\nimport { UI } from './UI'\n\n\nconst { sin, cos, PI } = Math\nconst { moveTo, lineTo, closePath, drawPoints } = PathCommandDataHelper\n\n@rewriteAble()\n@registerUI()\nexport class Polygon<TInputData = IPolygonInputData> extends UI<TInputData> implements IPolygon {\n\n    public get __tag() { return 'Polygon' }\n\n    @dataProcessor(PolygonData)\n    declare public __: IPolygonData\n\n    @pathType(3)\n    public sides?: INumber\n\n    @pathType()\n    public points?: number[] | IPointData[]\n\n    @pathType(0)\n    public curve?: boolean | number\n\n\n    public __updatePath(): void {\n\n        const data = this.__\n        const path: number[] = data.path = []\n\n        if (data.points) {\n\n            drawPoints(path, data.points, data.curve, true)\n\n        } else {\n\n            const { width, height, sides } = data\n            const rx = width / 2, ry = height / 2\n\n            moveTo(path, rx, 0)\n\n            for (let i = 1; i < sides; i++) {\n                lineTo(path, rx + rx * sin((i * 2 * PI) / sides), ry - ry * cos((i * 2 * PI) / sides))\n            }\n\n            closePath(path)\n\n        }\n\n    }\n\n}", "import { INumber } from '@leafer/interface'\nimport { PathCommandDataHelper, dataProcessor, pathType, registerUI } from '@leafer/core'\n\nimport { IStar, IStarData, IStarInputData } from '@leafer-ui/interface'\nimport { StarData } from '@leafer-ui/data'\n\nimport { UI } from './UI'\n\n\nconst { sin, cos, PI } = Math\nconst { moveTo, lineTo, closePath } = PathCommandDataHelper\n\n\n@registerUI()\nexport class Star<TInputData = IStarInputData> extends UI<TInputData> implements IStar {\n\n    public get __tag() { return 'Star' }\n\n    @dataProcessor(StarData)\n    declare public __: IStarData\n\n    @pathType(5)\n    public corners?: INumber\n\n    @pathType(0.382)\n    public innerRadius?: INumber\n\n\n    public __updatePath() {\n\n        const { width, height, corners, innerRadius } = this.__\n        const rx = width / 2, ry = height / 2\n\n        const path: number[] = this.__.path = []\n        moveTo(path, rx, 0)\n\n        for (let i = 1; i < corners * 2; i++) {\n            lineTo(path, rx + (i % 2 === 0 ? rx : rx * innerRadius) * sin((i * PI) / corners), ry - (i % 2 === 0 ? ry : ry * innerRadius) * cos((i * PI) / corners))\n        }\n\n        closePath(path)\n\n    }\n\n}", "import { IPointData, INumber } from '@leafer/interface'\nimport { PathCommandDataHelper, PointHelper, boundsType, pathType, affectStrokeBoundsType, dataProcessor, registerUI, getPointData } from '@leafer/core'\n\nimport { ILine, ILineData, ILineInputData, IStrokeAlign } from '@leafer-ui/interface'\nimport { LineData } from '@leafer-ui/data'\n\nimport { UI } from './UI'\n\n\nconst { moveTo, lineTo, drawPoints } = PathCommandDataHelper\nconst { rotate, getAngle, getDistance, defaultPoint } = PointHelper\n\n\n@registerUI()\nexport class Line<TInputData = ILineInputData> extends UI<TInputData> implements ILine {\n\n    public get __tag() { return 'Line' }\n\n    @dataProcessor(LineData)\n    declare public __: ILineData\n\n    @affectStrokeBoundsType('center')\n    declare public strokeAlign?: IStrokeAlign\n\n    @boundsType(0)\n    declare public height?: INumber\n\n    @pathType()\n    public points?: number[] | IPointData[]\n\n    @pathType(0)\n    public curve?: boolean | number\n\n    @pathType(false)\n    declare public closed?: boolean\n\n    public get toPoint(): IPointData {\n        const { width, rotation } = this.__\n        const to: IPointData = getPointData()\n\n        if (width) to.x = width\n        if (rotation) rotate(to, rotation)\n\n        return to\n    }\n\n    public set toPoint(value: IPointData) {\n        this.width = getDistance(defaultPoint, value)\n        this.rotation = getAngle(defaultPoint, value)\n        if (this.height) this.height = 0\n    }\n\n\n    public __updatePath(): void {\n\n        const data = this.__\n        const path: number[] = data.path = []\n\n        if (data.points) {\n\n            drawPoints(path, data.points, data.curve, data.closed)\n\n        } else {\n\n            moveTo(path, 0, 0)\n            lineTo(path, this.width, 0)\n        }\n\n    }\n\n}", "import { ILeaferImage, IString } from '@leafer/interface'\nimport { boundsType, dataProcessor, registerUI, isArray } from '@leafer/core'\n\nimport { IImage, IImageInputData, IImageData } from '@leafer-ui/interface'\nimport { ImageData } from '@leafer-ui/data'\n\nimport { Rect } from './Rect'\n\n\n@registerUI()\nexport class Image<TInputData = IImageInputData> extends Rect<TInputData> implements IImage {\n\n    public get __tag() { return 'Image' }\n\n    @dataProcessor(ImageData)\n    declare public __: IImageData\n\n    @boundsType('')\n    public url: IString\n\n    public get ready(): boolean { const { image } = this; return image && image.ready }\n\n    public get image(): ILeaferImage { const { fill } = this.__; return isArray(fill) && fill[0].image }\n\n}\n\nexport const MyImage = Image", "import { ILeaferCanvas, ILeaferCanvasConfig, INumber, IRenderOptions, IPointData, ICanvasContext2D, ICanvasContext2DSettings, IScreenSizeData } from '@leafer/interface'\nimport { Creator, ImageEvent, LeaferImage, Matrix, dataProcessor, dataType, registerUI, isNumber } from '@leafer/core'\n\nimport { ICanvas, ICanvasData, ICanvasInputData, IUI } from '@leafer-ui/interface'\nimport { CanvasData } from '@leafer-ui/data'\nimport { resizeType } from '@leafer-ui/decorator'\n\nimport { Rect } from './Rect'\n\n\n@registerUI()\nexport class Canvas<TInputData = ICanvasInputData> extends Rect<TInputData> implements ICanvas {\n\n    public get __tag() { return 'Canvas' }\n\n    @dataProcessor(CanvasData)\n    declare public __: ICanvasData\n\n    @resizeType(100)\n    declare public width?: INumber\n\n    @resizeType(100)\n    declare public height?: INumber\n\n    @resizeType(1)\n    declare public pixelRatio?: INumber\n\n    @resizeType(true)\n    public smooth?: boolean\n\n    @dataType(false)\n    public safeResize?: boolean\n\n    @resizeType()\n    public contextSettings?: ICanvasContext2DSettings\n\n    public canvas?: ILeaferCanvas\n\n    public get context(): ICanvasContext2D { return this.canvas.context }\n\n    public get ready(): boolean { return !this.url }\n\n    public url?: string // 用于临时加载canvas的base64数据，完成后会置空\n\n    constructor(data?: TInputData) {\n        super(data)\n        this.canvas = Creator.canvas(this.__ as ILeaferCanvasConfig)\n        if (data && (data as ICanvasInputData).url) this.drawImage((data as ICanvasInputData).url)\n    }\n\n    public drawImage(url: string): void {\n        new LeaferImage({ url }).load((image: LeaferImage) => {\n            this.context.drawImage(image.view, 0, 0)\n            this.url = undefined\n            this.paint()\n            this.emitEvent(new ImageEvent(ImageEvent.LOADED, { image }))\n        })\n    }\n\n    public draw(ui: IUI, offset?: IPointData, scale?: number | IPointData, rotation?: number): void {\n        const matrix = new Matrix(ui.worldTransform).invert()\n\n        const m = new Matrix()\n        if (offset) m.translate(offset.x, offset.y)\n        if (scale) isNumber(scale) ? m.scale(scale) : m.scale(scale.x, scale.y)\n        if (rotation) m.rotate(rotation)\n        matrix.multiplyParent(m)\n\n        ui.__render(this.canvas, { matrix: matrix.withScale() })\n        this.paint()\n    }\n\n    public paint(): void {\n        this.forceRender()\n    }\n\n    // in __drawAfterFill()\n    public __drawContent(canvas: ILeaferCanvas, _options: IRenderOptions): void {\n        const { width, height } = this.__, { view } = this.canvas\n        canvas.drawImage(view, 0, 0, view.width, view.height, 0, 0, width, height)\n    }\n\n    public __updateSize(): void {\n        const { canvas } = this\n        if (canvas) {\n            const { smooth, safeResize } = this.__\n            canvas.resize(this.__ as IScreenSizeData, safeResize)\n            if (canvas.smooth !== smooth) canvas.smooth = smooth\n        }\n    }\n\n    public destroy(): void {\n        if (this.canvas) {\n            this.canvas.destroy()\n            this.canvas = null\n        }\n        super.destroy()\n    }\n\n}", "import { ILeaferCanvas, IBoolean, INumber, IString, IBoundsData, IUnitData, IRenderOptions, IFourNumber } from '@leafer/interface'\nimport { BoundsHelper, boundsType, surfaceType, dataProcessor, registerUI, affectStrokeBoundsType, dataType, hitType, MathHelper, DataHelper } from '@leafer/core'\n\nimport { IFill, IText, IFontWeight, ITextCase, ITextDecoration, ITextData, ITextInputData, ITextAlign, IVerticalAlign, ITextDrawData, ITextOverflow, IStrokeAlign, IHitType, ITextWrap, IWritingMode, IBackgroundBoxStyle } from '@leafer-ui/interface'\nimport { TextData } from '@leafer-ui/data'\n\nimport { TextConvert, UnitConvert } from '@leafer-ui/external'\n\nimport { UI } from './UI'\n\n\nconst { copyAndSpread, includes, spread, setList } = BoundsHelper, { stintSet } = DataHelper\n\n@registerUI()\nexport class Text<TConstructorData = ITextInputData> extends UI<TConstructorData> implements IText {\n\n    public get __tag() { return 'Text' }\n\n    @dataProcessor(TextData)\n    declare public __: ITextData\n\n    // size\n    @boundsType(0)\n    declare public width?: INumber\n\n    @boundsType(0)\n    declare public height?: INumber\n\n    @surfaceType()\n    public boxStyle: IBackgroundBoxStyle\n\n    @dataType(false)\n    public resizeFontSize?: IBoolean\n\n    @surfaceType('#000000')\n    declare public fill?: IFill\n\n    @affectStrokeBoundsType('outside')\n    declare public strokeAlign?: IStrokeAlign\n\n    @hitType('all')\n    declare public hitFill?: IHitType\n\n    @boundsType('')\n    public text?: IString | INumber\n\n    @boundsType('')\n    public placeholder?: IString\n\n    @boundsType('caption')\n    public fontFamily?: IString\n\n    @boundsType(12)\n    public fontSize?: INumber\n\n    @boundsType('normal')\n    public fontWeight?: IFontWeight\n\n    @boundsType(false)\n    public italic?: IBoolean\n\n    @boundsType('none')\n    public textCase?: ITextCase\n\n    @boundsType('none')\n    public textDecoration?: ITextDecoration\n\n    @boundsType(0)\n    public letterSpacing?: INumber | IUnitData\n\n    @boundsType({ type: 'percent', value: 1.5 } as IUnitData)\n    public lineHeight?: INumber | IUnitData\n\n    @boundsType(0)\n    public paraIndent?: INumber\n\n    @boundsType(0)\n    public paraSpacing?: INumber\n\n    @boundsType('x')\n    public writingMode?: IWritingMode\n\n    @boundsType('left')\n    public textAlign?: ITextAlign\n\n    @boundsType('top')\n    public verticalAlign?: IVerticalAlign\n\n    @boundsType(true)\n    public autoSizeAlign?: IBoolean\n\n    @boundsType('normal')\n    public textWrap?: ITextWrap\n\n    @boundsType('show')\n    public textOverflow?: ITextOverflow\n\n    @surfaceType(false)\n    public textEditing: boolean\n\n    public isOverflow: boolean\n\n    public get textDrawData(): ITextDrawData { this.updateLayout(); return this.__.__textDrawData }\n\n\n    public __updateTextDrawData(): void {\n        const data = this.__\n        const { lineHeight, letterSpacing, fontFamily, fontSize, fontWeight, italic, textCase, textOverflow, padding, width, height } = data\n\n        data.__lineHeight = UnitConvert.number(lineHeight, fontSize)\n        data.__letterSpacing = UnitConvert.number(letterSpacing, fontSize)\n        data.__baseLine = data.__lineHeight - (data.__lineHeight - fontSize * 0.7) / 2 // 基线位置\n        data.__font = `${italic ? 'italic ' : ''}${textCase === 'small-caps' ? 'small-caps ' : ''}${fontWeight !== 'normal' ? fontWeight + ' ' : ''}${fontSize || 12}px ${fontFamily || 'caption'}`\n\n        stintSet(data, '__padding', padding && MathHelper.fourNumber(padding))\n        stintSet(data, '__clipText', textOverflow !== 'show' && !data.__autoSize)\n        stintSet(data, '__isCharMode', (width || height || data.__letterSpacing || (textCase !== 'none')) as boolean)\n\n        data.__textDrawData = TextConvert.getDrawData((data.__isPlacehold = data.placeholder && data.text === '') ? data.placeholder : data.text, this.__)\n    }\n\n    override __updateBoxBounds(): void {\n\n        const data = this.__\n        const layout = this.__layout\n        const { fontSize, italic, padding, __autoWidth: autoWidth, __autoHeight: autoHeight } = data\n\n        this.__updateTextDrawData() // layout text\n\n        const { bounds: contentBounds } = data.__textDrawData\n        const b = layout.boxBounds\n\n        layout.contentBounds = contentBounds\n\n        if (data.__lineHeight < fontSize) spread(contentBounds, fontSize / 2)\n\n        if (autoWidth || autoHeight) {\n            b.x = autoWidth ? contentBounds.x : 0\n            b.y = autoHeight ? contentBounds.y : 0\n            b.width = autoWidth ? contentBounds.width : data.width\n            b.height = autoHeight ? contentBounds.height : data.height\n\n            if (padding) {\n                const [top, right, bottom, left] = data.__padding\n                if (autoWidth) b.x -= left, b.width += (right + left)\n                if (autoHeight) b.y -= top, b.height += (bottom + top)\n            }\n            this.__updateNaturalSize()\n        } else super.__updateBoxBounds()\n\n        if (italic) b.width += fontSize * 0.16 // 倾斜会导致文本的bounds增大\n\n        DataHelper.stintSet(this, 'isOverflow', !includes(b, contentBounds))\n\n        if (this.isOverflow) setList(data.__textBoxBounds = {} as IBoundsData, [b, contentBounds]), layout.renderChanged = true\n        else data.__textBoxBounds = b\n    }\n\n    override __updateRenderSpread(): IFourNumber {\n        let spread = super.__updateRenderSpread()\n        if (!spread) spread = this.isOverflow ? 1 : 0\n        return spread\n    }\n\n    override __updateRenderBounds(): void {\n        const { renderBounds, renderSpread } = this.__layout\n        copyAndSpread(renderBounds, this.__.__textBoxBounds, renderSpread)\n        if (this.__box) this.__box.__layout.renderBounds = renderBounds\n    }\n\n    override __updateChange(): void {\n        super.__updateChange()\n        const box = this.__box\n        if (box) box.__onUpdateSize(), box.__updateChange()\n    }\n\n    override __drawRenderPath(canvas: ILeaferCanvas): void {\n        canvas.font = this.__.__font\n    }\n\n    override __draw(canvas: ILeaferCanvas, options: IRenderOptions, originCanvas?: ILeaferCanvas): void {\n        const box = this.__box\n        if (box) box.__nowWorld = this.__nowWorld, box.__draw(canvas, options, originCanvas)\n        if (this.textEditing && !options.exporting) return\n        super.__draw(canvas, options, originCanvas)\n    }\n\n    override  __drawShape(canvas: ILeaferCanvas, options: IRenderOptions): void {\n        if (options.shape) this.__box && this.__box.__drawShape(canvas, options)\n        super.__drawShape(canvas, options)\n    }\n\n    override destroy(): void {\n        if (this.boxStyle) this.boxStyle = null\n        super.destroy()\n    }\n\n}", "import { dataProcessor, affectStrokeBoundsType, registerUI } from '@leafer/core'\n\nimport { IPath, IPathData, IPathInputData, IStrokeAlign } from '@leafer-ui/interface'\nimport { PathData } from '@leafer-ui/data'\n\nimport { UI } from './UI'\n\n\n@registerUI()\nexport class Path<TInputData = IPathInputData> extends UI<TInputData> implements IPath {\n\n    public get __tag() { return 'Path' }\n\n    @dataProcessor(PathData)\n    declare public __: IPathData\n\n    @affectStrokeBoundsType('center')\n    declare public strokeAlign?: IStrokeAlign\n\n}", "import { PathCreator, dataProcessor, defineKey, registerUI, useModule } from '@leafer/core'\n\nimport { IPenData, IPenInputData, IPathInputData, IPathCommandData, IPath, IPen, IPointData } from '@leafer-ui/interface'\nimport { PenData } from '@leafer-ui/data'\n\nimport { Group } from './Group'\nimport { Path } from './Path'\n\n@useModule(PathCreator, ['set', 'path', 'paint'])\n@registerUI()\nexport class Pen<TInputData = IPenInputData> extends Group<TInputData> implements IPen {\n\n    public get __tag() { return 'Pen' }\n\n    @dataProcessor(PenData)\n    declare public __: IPenData\n\n    public pathElement: IPath\n    public pathStyle: IPathInputData\n\n    @penPathType()\n    declare public path: IPathCommandData // use __path, readonly\n\n    public __path: IPathCommandData\n\n\n    public setStyle(data: IPathInputData): Pen {\n        const path = this.pathElement = new Path(data)\n        this.pathStyle = data\n        this.__path = path.path as IPathCommandData || (path.path = [])\n        this.add(path)\n        return this\n    }\n\n    // svg and canvas\n\n    public beginPath(): Pen { return this }\n\n    public moveTo(_x: number, _y: number): Pen { return this }\n\n    public lineTo(_x: number, _y: number): Pen { return this }\n\n    public bezierCurveTo(_x1: number, _y1: number, _x2: number, _y2: number, _x: number, _y: number): Pen { return this }\n\n    public quadraticCurveTo(_x1: number, _y1: number, _x: number, _y: number): Pen { return this }\n\n    public closePath(): Pen { return this }\n\n\n    // canvas\n\n    public rect(_x: number, _y: number, _width: number, _height: number): Pen { return this }\n\n    public roundRect(_x: number, _y: number, _width: number, _height: number, _cornerRadius: number | number[]): Pen { return this }\n\n    public ellipse(_x: number, _y: number, _radiusX: number, _radiusY: number, _rotation?: number, _startAngle?: number, _endAngle?: number, _anticlockwise?: boolean): Pen { return this }\n\n    public arc(_x: number, _y: number, _radius: number, _startAngle?: number, _endAngle?: number, _anticlockwise?: boolean): Pen { return this }\n\n    public arcTo(_x1: number, _y1: number, _x2: number, _y2: number, _radius: number): Pen { return this }\n\n\n    // moveTo, then draw\n\n    public drawEllipse(_x: number, _y: number, _radiusX: number, _radiusY: number, _rotation?: number, _startAngle?: number, _endAngle?: number, _anticlockwise?: boolean): Pen { return this }\n\n    public drawArc(_x: number, _y: number, _radius: number, _startAngle?: number, _endAngle?: number, _anticlockwise?: boolean): Pen { return this }\n\n    public drawPoints(_points: number[] | IPointData[], _curve?: boolean | number, _close?: boolean): Pen { return this }\n\n    public clearPath(): Pen { return this } // = beginPath()\n\n\n    public paint(): void {\n        if (!this.pathElement.__layout.boxChanged) this.pathElement.forceUpdate('path')\n    }\n\n}\n\nfunction penPathType() {\n    return (target: IPen, key: string) => {\n        defineKey(target, key, {\n            get() { return this.__path }\n        })\n    }\n}", "/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\r\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\r\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\r\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\r\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\r\n    var _, done = false;\r\n    for (var i = decorators.length - 1; i >= 0; i--) {\r\n        var context = {};\r\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\r\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\r\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\r\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\r\n        if (kind === \"accessor\") {\r\n            if (result === void 0) continue;\r\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\r\n            if (_ = accept(result.get)) descriptor.get = _;\r\n            if (_ = accept(result.set)) descriptor.set = _;\r\n            if (_ = accept(result.init)) initializers.unshift(_);\r\n        }\r\n        else if (_ = accept(result)) {\r\n            if (kind === \"field\") initializers.unshift(_);\r\n            else descriptor[key] = _;\r\n        }\r\n    }\r\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\r\n    done = true;\r\n};\r\n\r\nexport function __runInitializers(thisArg, initializers, value) {\r\n    var useValue = arguments.length > 2;\r\n    for (var i = 0; i < initializers.length; i++) {\r\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\r\n    }\r\n    return useValue ? value : void 0;\r\n};\r\n\r\nexport function __propKey(x) {\r\n    return typeof x === \"symbol\" ? x : \"\".concat(x);\r\n};\r\n\r\nexport function __setFunctionName(f, name, prefix) {\r\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\r\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\r\n};\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\r\n    return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\r\n    function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nvar ownKeys = function(o) {\r\n    ownKeys = Object.getOwnPropertyNames || function (o) {\r\n        var ar = [];\r\n        for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\r\n        return ar;\r\n    };\r\n    return ownKeys(o);\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n\r\nexport function __addDisposableResource(env, value, async) {\r\n    if (value !== null && value !== void 0) {\r\n        if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\r\n        var dispose, inner;\r\n        if (async) {\r\n            if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\r\n            dispose = value[Symbol.asyncDispose];\r\n        }\r\n        if (dispose === void 0) {\r\n            if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\r\n            dispose = value[Symbol.dispose];\r\n            if (async) inner = dispose;\r\n        }\r\n        if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\r\n        if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\r\n        env.stack.push({ value: value, dispose: dispose, async: async });\r\n    }\r\n    else if (async) {\r\n        env.stack.push({ async: true });\r\n    }\r\n    return value;\r\n\r\n}\r\n\r\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\r\n\r\nexport function __disposeResources(env) {\r\n    function fail(e) {\r\n        env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\r\n        env.hasError = true;\r\n    }\r\n    var r, s = 0;\r\n    function next() {\r\n        while (r = env.stack.pop()) {\r\n            try {\r\n                if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\r\n                if (r.dispose) {\r\n                    var result = r.dispose.call(r.value);\r\n                    if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\r\n                }\r\n                else s |= 1;\r\n            }\r\n            catch (e) {\r\n                fail(e);\r\n            }\r\n        }\r\n        if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\r\n        if (env.hasError) throw env.error;\r\n    }\r\n    return next();\r\n}\r\n\r\nexport function __rewriteRelativeImportExtension(path, preserveJsx) {\r\n    if (typeof path === \"string\" && /^\\.\\.?\\//.test(path)) {\r\n        return path.replace(/\\.(tsx)$|((?:\\.d)?)((?:\\.[^./]+?)?)\\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {\r\n            return tsx ? preserveJsx ? \".jsx\" : \".js\" : d && (!ext || !cm) ? m : (d + ext + \".\" + cm.toLowerCase() + \"js\");\r\n        });\r\n    }\r\n    return path;\r\n}\r\n\r\nexport default {\r\n    __extends: __extends,\r\n    __assign: __assign,\r\n    __rest: __rest,\r\n    __decorate: __decorate,\r\n    __param: __param,\r\n    __esDecorate: __esDecorate,\r\n    __runInitializers: __runInitializers,\r\n    __propKey: __propKey,\r\n    __setFunctionName: __setFunctionName,\r\n    __metadata: __metadata,\r\n    __awaiter: __awaiter,\r\n    __generator: __generator,\r\n    __createBinding: __createBinding,\r\n    __exportStar: __exportStar,\r\n    __values: __values,\r\n    __read: __read,\r\n    __spread: __spread,\r\n    __spreadArrays: __spreadArrays,\r\n    __spreadArray: __spreadArray,\r\n    __await: __await,\r\n    __asyncGenerator: __asyncGenerator,\r\n    __asyncDelegator: __asyncDelegator,\r\n    __asyncValues: __asyncValues,\r\n    __makeTemplateObject: __makeTemplateObject,\r\n    __importStar: __importStar,\r\n    __importDefault: __importDefault,\r\n    __classPrivateFieldGet: __classPrivateFieldGet,\r\n    __classPrivateFieldSet: __classPrivateFieldSet,\r\n    __classPrivateFieldIn: __classPrivateFieldIn,\r\n    __addDisposableResource: __addDisposableResource,\r\n    __disposeResources: __disposeResources,\r\n    __rewriteRelativeImportExtension: __rewriteRelativeImportExtension,\r\n};\r\n", "import { ILeaferConfig, IResizeEvent, ILeaferCanvas, IRenderOptions, ILeaferBase, IBoundsData } from '@leafer/interface'\nimport { Creator, DataHelper, LayoutEvent, RenderEvent, canvasSizeAttrs, registerUI, isUndefined } from '@leafer/core'\n\nimport { IApp, IAppConfig, IAppForEachFunction, IAppInputData, ILeafer } from '@leafer-ui/interface'\n\nimport { Leafer } from '@leafer-ui/draw'\n\n\n@registerUI()\nexport class App extends Leafer implements IApp {\n\n    public get __tag() { return 'App' }\n\n    public get isApp(): boolean { return true }\n\n    declare public children: ILeafer[]\n\n    public realCanvas: boolean\n\n    public ground: ILeafer\n    public tree: ILeafer\n    public sky: ILeafer\n\n    constructor(userConfig?: IAppConfig, data?: IAppInputData) {\n        super(userConfig, data)\n    }\n\n    override init(userConfig?: IAppConfig, parentApp?: IApp): void {\n        super.init(userConfig, parentApp)\n        if (userConfig) {\n            const { ground, tree, sky, editor } = userConfig\n            if (ground) this.ground = this.addLeafer(ground)\n            if (tree || editor) this.tree = this.addLeafer(tree || { type: userConfig.type || 'design' })\n            if (sky || editor) this.sky = this.addLeafer(sky)\n            if (editor) Creator.editor(editor, this)\n        }\n    }\n\n    protected __setApp(): void {\n        const { canvas } = this\n        const { realCanvas, view } = this.config\n        if (realCanvas || view === this.canvas.view || !canvas.parentView) this.realCanvas = true\n        else canvas.unrealCanvas()\n\n        this.leafer = this\n        this.watcher.disable()\n        this.layouter.disable()\n    }\n\n    override __updateLocalBounds(): void {\n        this.forEach(leafer => leafer.updateLayout())\n        super.__updateLocalBounds()\n    }\n\n    override start(): void {\n        super.start()\n        this.forEach(leafer => leafer.start())\n    }\n\n    override stop(): void {\n        this.forEach(leafer => leafer.stop())\n        super.stop()\n    }\n\n    override unlockLayout(): void {\n        super.unlockLayout()\n        this.forEach(leafer => leafer.unlockLayout())\n    }\n\n    override lockLayout(): void {\n        super.lockLayout()\n        this.forEach(leafer => leafer.lockLayout())\n    }\n\n    override forceRender(bounds?: IBoundsData, sync?: boolean): void {\n        this.forEach(leafer => leafer.forceRender(bounds, sync))\n    }\n\n    public addLeafer(merge?: ILeaferConfig): Leafer {\n        const leafer = new Leafer(merge)\n        this.add(leafer)\n        return leafer\n    }\n\n    override add(leafer: ILeafer, index?: number): void {\n        if (!leafer.view) {\n            if (this.realCanvas && !this.canvas.bounds) { // wait miniapp select canvas\n                setTimeout(() => this.add(leafer, index), 10)\n                return\n            }\n            leafer.init(this.__getChildConfig(leafer.userConfig), this)\n        }\n\n        super.add(leafer, index)\n        if (!isUndefined(index)) leafer.canvas.childIndex = index\n        this.__listenChildEvents(leafer)\n    }\n\n    public forEach(fn: IAppForEachFunction): void {\n        this.children.forEach(fn)\n    }\n\n    protected __onCreated(): void {\n        this.created = this.children.every(child => child.created)\n    }\n\n    protected __onReady(): void {\n        if (this.children.every(child => child.ready)) super.__onReady()\n    }\n\n    protected __onViewReady(): void {\n        if (this.children.every(child => child.viewReady)) super.__onViewReady()\n    }\n\n    protected __onChildRenderEnd(e: RenderEvent): void {\n        this.renderer.addBlock(e.renderBounds)\n        if (this.viewReady) this.renderer.update()\n    }\n\n    override __render(canvas: ILeaferCanvas, options: IRenderOptions): void {\n        if (canvas.context) this.forEach(leafer => options.matrix ? leafer.__render(canvas, options) : canvas.copyWorld(leafer.canvas, options.bounds))\n    }\n\n    public __onResize(event: IResizeEvent): void {\n        this.forEach(leafer => leafer.resize(event))\n        super.__onResize(event)\n    }\n\n    public updateLayout(): void {\n        this.forEach(leafer => leafer.updateLayout())\n    }\n\n    protected __getChildConfig(userConfig?: ILeaferConfig): ILeaferConfig {\n        const config = { ...this.config }\n        config.hittable = config.realCanvas = undefined\n        if (userConfig) DataHelper.assign(config, userConfig)\n\n        // reset\n        if (this.autoLayout) DataHelper.copyAttrs(config, this, canvasSizeAttrs)\n        config.view = this.realCanvas ? undefined : this.view\n        config.fill = undefined\n        return config\n    }\n\n    protected __listenChildEvents(leafer: ILeaferBase): void {\n        leafer.once([\n            [LayoutEvent.END, this.__onReady, this],\n            [RenderEvent.START, this.__onCreated, this],\n            [RenderEvent.END, this.__onViewReady, this]\n        ])\n        if (this.realCanvas) this.__eventIds.push(leafer.on_(RenderEvent.END, this.__onChildRenderEnd, this))\n    }\n\n}", "import { IBooleanMap, IShortcutKeyCodes, IShortcutKeys, IShortcutKeysCheck, IUIEvent } from '@leafer/interface'\n\n\nconst downKeyMap: IBooleanMap = {}\n\nexport const Keyboard = {\n\n    isHoldSpaceKey(): boolean {\n        return Keyboard.isHold('Space')\n    },\n\n    isHold(code: IShortcutKeyCodes): boolean {\n        return downKeyMap[code]\n    },\n\n    // 是否按住快捷键，可扩展语义化快捷键组合 ctrl + F || shift + F\n    isHoldKeys(shortcutKeys: IShortcutKeysCheck | IShortcutKeys, e?: IUIEvent): boolean {\n        return e ? (shortcutKeys as IShortcutKeysCheck)(e) : undefined\n    },\n\n    setDownCode(code: string): void {\n        if (!downKeyMap[code]) downKeyMap[code] = true\n    },\n\n    setUpCode(code: string): void {\n        downKeyMap[code] = false\n    }\n\n}", "import { IUIEvent } from '@leafer/interface'\n\n\nexport const PointerButton = {\n\n    LEFT: 1,\n\n    RIGHT: 2,\n\n    MIDDLE: 4,\n\n    defaultLeft(event: IUIEvent): void { if (!event.buttons) event.buttons = 1 },\n\n    left(event: IUIEvent): boolean { return event.buttons === 1 },\n\n    right(event: IUIEvent): boolean { return event.buttons === 2 },\n\n    middle(event: IUIEvent): boolean { return event.buttons === 4 }\n\n}", "import { ILeaf, ILeafList, IPointData, IUIEvent, IShortcutKeys, IShortcutKeysCheck } from '@leafer/interface'\nimport { Event, EventCreator } from '@leafer/core'\n\nimport { Keyboard } from './Keyboard'\nimport { PointerButton as B } from './PointerButton'\n\n\nexport class UIEvent extends Event implements IUIEvent {\n\n    readonly x: number\n    readonly y: number\n\n    readonly path: ILeafList\n    readonly throughPath?: ILeafList\n\n    readonly altKey: boolean\n    readonly ctrlKey: boolean\n    readonly shiftKey: boolean\n    readonly metaKey: boolean\n    public get spaceKey(): boolean { return Keyboard.isHoldSpaceKey() }\n\n    public get left(): boolean { return B.left(this) }\n    public get right(): boolean { return B.right(this) }\n    public get middle(): boolean { return B.middle(this) }\n    readonly buttons: number\n\n    declare readonly target: ILeaf\n    declare readonly current: ILeaf\n    readonly bubbles: boolean = true\n\n    readonly time: number\n\n    constructor(params: IUIEvent) {\n        super(params.type)\n        Object.assign(this, params)\n    }\n\n\n    public isHoldKeys(shortcutKeys?: IShortcutKeysCheck | IShortcutKeys): boolean {\n        return Keyboard.isHoldKeys(shortcutKeys, this)\n    }\n\n    public getBoxPoint(relative?: ILeaf): IPointData {\n        return (relative || this.current).getBoxPoint(this)\n    }\n\n    public getInnerPoint(relative?: ILeaf): IPointData {\n        return (relative || this.current).getInnerPoint(this)\n    }\n\n    public getLocalPoint(relative?: ILeaf): IPointData {\n        return (relative || this.current).getLocalPoint(this)\n    }\n\n    public getPagePoint(): IPointData {\n        return this.current.getPagePoint(this)\n    }\n\n    // 兼容代码，未来可移除\n    public getInner(relative?: ILeaf): IPointData { return this.getInnerPoint(relative) }\n    public getLocal(relative?: ILeaf): IPointData { return this.getLocalPoint(relative) }\n    public getPage(): IPointData { return this.getPagePoint() }\n    // ---\n\n    static changeName(oldName: string, newName: string): void {\n        EventCreator.changeName(oldName, newName)\n    }\n\n}", "import { IPointData, IBoundsData, IDragBoundsType, ILeaf, ISide } from '@leafer/interface'\nimport { Bounds, BoundsHelper, MathHelper, isFinite } from '@leafer/core'\n\n\nconst { min, max, abs } = Math, { float, sign } = MathHelper, { minX, maxX, minY, maxY } = BoundsHelper\nconst tempContent = new Bounds(), tempDragBounds = new Bounds()\n\nexport const DragBoundsHelper = {\n\n    // 拖拽区域内移动\n    limitMove(leaf: ILeaf, move: IPointData): void {\n        const { dragBounds, dragBoundsType } = leaf\n        if (dragBounds) D.getValidMove(leaf.__localBoxBounds, D.getDragBounds(leaf), dragBoundsType, move, true)\n        D.axisMove(leaf, move)\n    },\n\n    // 拖拽区域内缩放\n    limitScaleOf(leaf: ILeaf, origin: IPointData, scale: IPointData, lockRatio?: boolean): void {\n        const { dragBounds, dragBoundsType } = leaf\n        if (dragBounds) D.getValidScaleOf(leaf.__localBoxBounds, D.getDragBounds(leaf), dragBoundsType, leaf.getLocalPointByInner(leaf.getInnerPointByBox(origin)), scale, lockRatio, true)\n    },\n\n    // 按轴移动\n    axisMove(leaf: ILeaf, move: IPointData) {\n        const { draggable } = leaf\n        if (draggable === 'x') move.y = 0\n        if (draggable === 'y') move.x = 0\n    },\n\n    getDragBounds(leaf: ILeaf): IBoundsData {\n        const { dragBounds } = leaf\n        return dragBounds === 'parent' ? leaf.parent.boxBounds : dragBounds\n    },\n\n    isInnerMode(content: IBoundsData, dragBounds: IBoundsData, dragBoundsType: IDragBoundsType, sideType: ISide): boolean {\n        return dragBoundsType === 'inner' || (dragBoundsType === 'auto' && content[sideType] > dragBounds[sideType])\n    },\n\n    getValidMove(content: IBoundsData, dragBounds: IBoundsData, dragBoundsType: IDragBoundsType, move: IPointData, change?: boolean): IPointData {\n        const x = content.x + move.x, y = content.y + move.y, right = x + content.width, bottom = y + content.height\n        const boundsRight = dragBounds.x + dragBounds.width, boundsBottom = dragBounds.y + dragBounds.height\n\n        if (!change) move = { ...move }\n\n        if (D.isInnerMode(content, dragBounds, dragBoundsType, 'width')) {  // inner 模式\n            if (x > dragBounds.x) move.x += dragBounds.x - x\n            else if (right < boundsRight) move.x += boundsRight - right\n        } else { // outer 模式\n            if (x < dragBounds.x) move.x += dragBounds.x - x\n            else if (right > boundsRight) move.x += boundsRight - right\n        }\n\n        if (D.isInnerMode(content, dragBounds, dragBoundsType, 'height')) { // inner 模式\n            if (y > dragBounds.y) move.y += dragBounds.y - y\n            else if (bottom < boundsBottom) move.y += boundsBottom - bottom\n        } else { // outer 模式\n            if (y < dragBounds.y) move.y += dragBounds.y - y\n            else if (bottom > boundsBottom) move.y += boundsBottom - bottom\n        }\n\n        // 避免出现为0的抖动小数\n        move.x = float(move.x)\n        move.y = float(move.y)\n\n        return move\n    },\n\n    getValidScaleOf(content: IBoundsData, dragBounds: IBoundsData, dragBoundsType: IDragBoundsType, origin: IPointData, scale: IPointData, lockRatio?: boolean, change?: boolean): IPointData {\n        if (!change) scale = { ...scale }\n\n        tempDragBounds.set(dragBounds)\n        tempContent.set(content).scaleOf(origin, scale.x, scale.y)\n\n        const originLeftScale = (origin.x - content.x) / content.width, originRightScale = 1 - originLeftScale\n        const originTopScale = (origin.y - content.y) / content.height, originBottomScale = 1 - originTopScale\n\n        let correctScaleX = 1, correctScaleY = 1, aScale: number, bScale: number, aSize: number, bSize: number\n\n        if (D.isInnerMode(content, dragBounds, dragBoundsType, 'width')) {  // inner 模式\n\n            if (scale.x < 0) tempContent.scaleOf(origin, correctScaleX = 1 / scale.x, 1) // 阻止镜像\n\n            aSize = float(tempContent.minX - tempDragBounds.minX)\n            bSize = float(tempDragBounds.maxX - tempContent.maxX)\n\n            aScale = originLeftScale && aSize > 0 ? 1 + aSize / (originLeftScale * tempContent.width) : 1\n            bScale = originRightScale && bSize > 0 ? 1 + bSize / (originRightScale * tempContent.width) : 1\n            correctScaleX *= max(aScale, bScale)\n\n        } else { // outer 模式\n\n            if (scale.x < 0) {\n                if (float(minX(content) - minX(dragBounds)) <= 0 || float(maxX(dragBounds) - maxX(content)) <= 0) tempContent.scaleOf(origin, correctScaleX = 1 / scale.x, 1) // 到达边界时阻止镜像\n                tempContent.unsign()\n            }\n\n            aSize = float(tempDragBounds.minX - tempContent.minX)\n            bSize = float(tempContent.maxX - tempDragBounds.maxX)\n\n            aScale = originLeftScale && aSize > 0 ? 1 - aSize / (originLeftScale * tempContent.width) : 1\n            bScale = originRightScale && bSize > 0 ? 1 - bSize / (originRightScale * tempContent.width) : 1\n            correctScaleX *= min(aScale, bScale)\n\n        }\n\n        if (D.isInnerMode(content, dragBounds, dragBoundsType, 'height')) { // inner 模式\n\n            if (scale.y < 0) tempContent.scaleOf(origin, 1, correctScaleY = 1 / scale.y) // 阻止镜像\n\n            aSize = float(tempContent.minY - tempDragBounds.minY)\n            bSize = float(tempDragBounds.maxY - tempContent.maxY)\n\n            aScale = originTopScale && aSize > 0 ? 1 + aSize / (originTopScale * tempContent.height) : 1\n            bScale = originBottomScale && bSize > 0 ? 1 + bSize / (originBottomScale * tempContent.height) : 1\n\n            correctScaleY *= max(aScale, bScale)\n\n            if (lockRatio) {\n                aScale = max(abs(correctScaleX), abs(correctScaleY))\n                correctScaleX = sign(correctScaleX) * aScale\n                correctScaleY = sign(correctScaleY) * aScale\n            }\n\n        } else { // outer 模式\n\n            if (scale.y < 0) {\n                if (float(minY(content) - minY(dragBounds)) <= 0 || float(maxY(dragBounds) - maxY(content)) <= 0) tempContent.scaleOf(origin, 1, correctScaleY = 1 / scale.y) // 到达边界时阻止镜像\n                tempContent.unsign()\n            }\n\n            aSize = float(tempDragBounds.minY - tempContent.minY)\n            bSize = float(tempContent.maxY - tempDragBounds.maxY)\n\n            aScale = originTopScale && aSize > 0 ? 1 - aSize / (originTopScale * tempContent.height) : 1\n            bScale = originBottomScale && bSize > 0 ? 1 - bSize / (originBottomScale * tempContent.height) : 1\n            correctScaleY *= min(aScale, bScale)\n\n        }\n\n        scale.x *= isFinite(correctScaleX) ? correctScaleX : 1\n        scale.y *= isFinite(correctScaleY) ? correctScaleY : 1\n\n        return scale\n    }\n}\n\nconst D = DragBoundsHelper", "import { IPointerEvent, PointerType } from '@leafer/interface'\nimport { registerUIEvent } from '@leafer/core'\n\nimport { UIEvent } from './UIEvent'\n\n\n@registerUIEvent()\nexport class PointerEvent extends UIEvent implements IPointerEvent {\n\n    static POINTER = 'pointer'\n\n    static BEFORE_DOWN = 'pointer.before_down'\n    static BEFORE_MOVE = 'pointer.before_move'\n    static BEFORE_UP = 'pointer.before_up'\n\n    static DOWN = 'pointer.down'\n    static MOVE = 'pointer.move'\n    static UP = 'pointer.up'\n\n    static OVER = 'pointer.over'\n    static OUT = 'pointer.out'\n\n    static ENTER = 'pointer.enter'\n    static LEAVE = 'pointer.leave'\n\n    static TAP = 'tap'\n    static DOUBLE_TAP = 'double_tap'\n\n    static CLICK = 'click'\n    static DOUBLE_CLICK = 'double_click'\n\n    static LONG_PRESS = 'long_press'\n    static LONG_TAP = 'long_tap'\n\n    static MENU = 'pointer.menu'\n    static MENU_TAP = 'pointer.menu_tap'\n\n    public readonly width: number\n    public readonly height: number\n    public readonly pointerType: PointerType\n    public readonly moving?: boolean // 是否处于平移视图状态\n    public readonly dragging?: boolean // 是否处于拖拽状态\n    public readonly multiTouch?: boolean\n    public readonly pressure: number\n    public readonly tangentialPressure?: number\n    public readonly tiltX?: number\n    public readonly tiltY?: number\n    public readonly twist?: number\n\n}\n\nexport const MyPointerEvent = PointerEvent", "import { IDragEvent, IPointData, ILeaf, ILeafList, IObject, IBoundsData } from '@leafer/interface'\nimport { registerUIEvent, LeafList, BoundsHelper, PointHelper } from '@leafer/core'\n\nimport { DragBoundsHelper } from './DragBoundsHelper'\nimport { PointerEvent } from './PointerEvent'\n\n\nconst tempMove = {} as IPointData\n\n@registerUIEvent()\nexport class DragEvent extends PointerEvent implements IDragEvent {\n\n    static BEFORE_DRAG = 'drag.before_drag'\n\n    static START = 'drag.start'\n    static DRAG = 'drag'\n    static END = 'drag.end'\n\n    static OVER = 'drag.over'\n    static OUT = 'drag.out'\n\n    static ENTER = 'drag.enter'\n    static LEAVE = 'drag.leave'\n\n    readonly moveX: number\n    readonly moveY: number\n    readonly totalX: number\n    readonly totalY: number\n\n    static list: ILeafList\n    static data: IObject\n\n    static setList(data: ILeaf | ILeaf[] | ILeafList): void {\n        this.list = data instanceof LeafList ? data : new LeafList(data as ILeaf[])\n    }\n\n    static setData(data: IObject): void {\n        this.data = data\n    }\n\n    static getValidMove(leaf: ILeaf, localStart: IPointData, worldTotal: IPointData, checkLimit = true): IPointData {\n        const move = leaf.getLocalPoint(worldTotal, null, true)\n        PointHelper.move(move, localStart.x - leaf.x, localStart.y - leaf.y)\n        if (checkLimit) this.limitMove(leaf, move)\n        DragBoundsHelper.axisMove(leaf, move)\n        return move\n    }\n\n    static limitMove(leaf: ILeaf, move: IPointData): void {\n        DragBoundsHelper.limitMove(leaf, move)\n    }\n\n    public getPageMove(total?: boolean): IPointData {\n        this.assignMove(total)\n        return this.current.getPagePoint(tempMove, null, true)\n    }\n\n    public getInnerMove(relative?: ILeaf, total?: boolean): IPointData {\n        if (!relative) relative = this.current\n        this.assignMove(total)\n        return relative.getInnerPoint(tempMove, null, true)\n    }\n\n    public getLocalMove(relative?: ILeaf, total?: boolean): IPointData {\n        if (!relative) relative = this.current\n        this.assignMove(total)\n        return relative.getLocalPoint(tempMove, null, true)\n    }\n\n    public getPageTotal(): IPointData {\n        return this.getPageMove(true)\n    }\n\n    public getInnerTotal(relative?: ILeaf): IPointData {\n        return this.getInnerMove(relative, true)\n    }\n\n    public getLocalTotal(relative?: ILeaf): IPointData {\n        return this.getLocalMove(relative, true)\n    }\n\n    public getPageBounds(): IBoundsData {\n        const total = this.getPageTotal(), start = this.getPagePoint(), bounds = {} as IBoundsData\n        BoundsHelper.set(bounds, start.x - total.x, start.y - total.y, total.x, total.y)\n        BoundsHelper.unsign(bounds)\n        return bounds\n    }\n\n    protected assignMove(total: boolean): void {\n        tempMove.x = total ? this.totalX : this.moveX\n        tempMove.y = total ? this.totalY : this.moveY\n    }\n\n}\n\nexport const MyDragEvent = DragEvent", "import { IDropEvent, ILeaf, ILeafList, IObject } from '@leafer/interface'\nimport { registerUIEvent } from '@leafer/core'\n\nimport { PointerEvent } from './PointerEvent'\nimport { DragEvent } from './DragEvent'\n\n\n@registerUIEvent()\nexport class DropEvent extends PointerEvent implements IDropEvent {\n\n    static DROP = 'drop'\n\n    readonly list: ILeafList\n    readonly data: IObject\n\n    static setList(data: ILeaf | ILeaf[] | ILeafList): void {\n        DragEvent.setList(data)\n    }\n\n    static setData(data: IObject): void {\n        DragEvent.setData(data)\n    }\n\n}", "import { IMoveEvent } from '@leafer/interface'\nimport { registerUIEvent } from '@leafer/core'\n\nimport { DragEvent } from './DragEvent'\n\n@registerUIEvent()\nexport class MoveEvent extends DragEvent implements IMoveEvent {\n\n    static BEFORE_MOVE = 'move.before_move'\n\n    static START = 'move.start'\n    static MOVE = 'move'\n    static DRAG_ANIMATE = 'move.drag_animate'\n    static END = 'move.end'\n\n    static PULL_DOWN = 'move.pull_down'\n    static REACH_BOTTOM = 'move.reach_bottom'\n\n    readonly moveType: 'drag' | 'move'\n}", "import { ITouchEvent } from '@leafer/interface'\nimport { registerUIEvent } from '@leafer/core'\n\nimport { UIEvent } from './UIEvent'\n\n\n@registerUIEvent()\nexport class TouchEvent extends UIEvent implements ITouchEvent {\n\n}\n\nexport const MyTouchEvent = TouchEvent", "import { IRotateEvent } from '@leafer/interface'\nimport { registerUIEvent } from '@leafer/core'\n\nimport { PointerEvent } from './PointerEvent'\n\n\n@registerUIEvent()\nexport class RotateEvent extends PointerEvent implements IRotateEvent {\n\n    static BEFORE_ROTATE = 'rotate.before_rotate'\n\n    static START = 'rotate.start'\n    static ROTATE = 'rotate'\n    static END = 'rotate.end'\n\n    readonly rotation: number\n    readonly totalRotation: number\n\n}", "import { ISwipeEvent } from '@leafer/interface'\nimport { registerUIEvent } from '@leafer/core'\n\nimport { DragEvent } from './DragEvent'\n\n\n@registerUIEvent()\nexport class SwipeEvent extends DragEvent implements ISwipeEvent {\n\n    static SWIPE = 'swipe'\n\n    static LEFT = 'swipe.left'\n    static RIGHT = 'swipe.right'\n    static UP = 'swipe.up'\n    static DOWN = 'swipe.down'\n\n    readonly speed: number\n    readonly direction: string\n\n}", "import { IZoomEvent } from '@leafer/interface'\nimport { registerUIEvent } from '@leafer/core'\n\nimport { PointerEvent } from './PointerEvent'\n\n@registerUIEvent()\nexport class ZoomEvent extends PointerEvent implements IZoomEvent {\n\n    static BEFORE_ZOOM = 'zoom.before_zoom'\n\n    static START = 'zoom.start'\n    static ZOOM = 'zoom'\n    static END = 'zoom.end'\n\n    readonly scale: number\n    readonly totalScale: number\n\n}", "import { IKeyCodes, IKeyEvent } from '@leafer/interface'\nimport { registerUIEvent } from '@leafer/core'\n\nimport { UIEvent } from './UIEvent'\n\n\n@registerUIEvent()\nexport class KeyEvent extends UIEvent implements IKeyEvent {\n\n    static BEFORE_DOWN = 'key.before_down'\n    static BEFORE_UP = 'key.before_up'\n\n    static DOWN = 'key.down'\n    static HOLD = 'key.hold'\n    static UP = 'key.up'\n\n    public readonly code: IKeyCodes\n    public readonly key: string\n\n}", "import { IPointerEvent, IDragEvent, ISwipeEvent, IUIEvent, IPointData, ILeafList, IDropEvent, IObject } from '@leafer/interface'\nimport { PointHelper, LeafList, isUndefined, LeafHelper } from '@leafer/core'\n\nimport { SwipeEvent, DragEvent } from '@leafer-ui/event'\n\n\nexport const InteractionHelper = {\n\n    getDragEventData(startPoint: IPointData, lastPoint: IPointData, event: IPointerEvent): IDragEvent {\n        return {\n            ...event,\n            x: event.x,\n            y: event.y,\n            moveX: event.x - lastPoint.x,\n            moveY: event.y - lastPoint.y,\n            totalX: event.x - startPoint.x,\n            totalY: event.y - startPoint.y,\n        } as IDragEvent\n    },\n\n    getDropEventData(event: IPointerEvent, list: ILeafList, data: IObject): IDropEvent {\n        return {\n            ...event,\n            list,\n            data\n        }\n    },\n\n    getSwipeDirection(angle: number): string {\n        if (angle < -45 && angle > -135) return SwipeEvent.UP\n        else if (angle > 45 && angle < 135) return SwipeEvent.DOWN\n        else if (angle <= 45 && angle >= -45) return SwipeEvent.RIGHT\n        else return SwipeEvent.LEFT\n    },\n\n    getSwipeEventData(startPoint: IPointData, lastDragData: IDragEvent, event: IPointerEvent): ISwipeEvent {\n        return {\n            ...event,\n            moveX: lastDragData.moveX,\n            moveY: lastDragData.moveY,\n            totalX: event.x - startPoint.x,\n            totalY: event.y - startPoint.y,\n            type: I.getSwipeDirection(PointHelper.getAngle(startPoint, event)),\n        }\n    },\n\n\n    getBase(e: IObject): IUIEvent {\n        const pointerUpButtons = e.button === 1 ? 4 : e.button // 0: left, 1: middle, 2: right\n        return {\n            altKey: e.altKey,\n            ctrlKey: e.ctrlKey,\n            shiftKey: e.shiftKey,\n            metaKey: e.metaKey,\n            time: Date.now(),\n            buttons: isUndefined(e.buttons) ? 1 : (e.buttons === 0 ? pointerUpButtons : e.buttons), // touchEvent no button and buttons, set default\n            origin: e\n        } as IUIEvent\n    },\n\n    pathHasEventType(path: ILeafList, type: string): boolean {\n        const { list } = path\n        for (let i = 0, len = list.length; i < len; i++) {\n            if (list[i].hasEvent(type)) return true\n        }\n        return false\n    },\n\n    filterPathByEventType(path: ILeafList, type: string): ILeafList {\n        const find = new LeafList()\n        const { list } = path\n        for (let i = 0, len = list.length; i < len; i++) {\n            if (list[i].hasEvent(type)) find.add(list[i])\n        }\n        return find\n    },\n\n    pathCanDrag(path: ILeafList): boolean {\n        return path && path.list.some(item => LeafHelper.draggable(item) || (!item.isLeafer && item.hasEvent(DragEvent.DRAG)))\n    },\n\n    pathHasOutside(path: ILeafList): boolean { // 滚动条元素\n        return path && path.list.some(item => item.isOutside)\n    },\n}\n\nconst I = InteractionHelper", "import { IPointerEvent, IDragEvent, ILeaf, ILeafList, ITimer, IFunction, IPointDataMap, IMoveEvent } from '@leafer/interface'\nimport { PointHelper, LeafList, LeafHelper, isNumber, isString } from '@leafer/core'\n\nimport { MoveEvent, DragEvent, DropEvent, PointerButton } from '@leafer-ui/event'\n\nimport { InteractionHelper } from './InteractionHelper'\nimport { InteractionBase } from './Interaction'\n\n\nconst emptyList = new LeafList()\nconst { getDragEventData, getDropEventData, getSwipeEventData } = InteractionHelper\n\nexport class Dragger {\n\n    public interaction: InteractionBase\n\n    public moving: boolean\n    public dragging: boolean\n\n    public dragData: IDragEvent\n    public downData: IPointerEvent\n\n    public dragDataList: IDragEvent[] = [] // 记录列表备用\n\n    public draggableList: ILeafList\n    public realDraggableList: ILeafList\n    protected dragOverPath: ILeafList\n    protected dragEnterPath: ILeafList\n\n    public dragStartPoints: IPointDataMap\n    public autoMoveTimer: ITimer\n\n    public canAnimate: boolean\n    public canDragOut: boolean\n    public animateWait: IFunction\n\n    constructor(interaction: InteractionBase) {\n        this.interaction = interaction\n    }\n\n    public setDragData(data: IPointerEvent): void { // pointer down\n        if (this.animateWait) this.dragEndReal()\n        this.downData = this.interaction.downData\n        this.dragData = getDragEventData(data, data, data)\n        this.canAnimate = this.canDragOut = true\n    }\n\n    public getList(realDraggable?: boolean, hover?: boolean): ILeafList {\n        const { proxy } = this.interaction.selector\n        const hasProxyList = proxy && proxy.list.length, dragList = DragEvent.list || this.draggableList || emptyList\n        return this.dragging && (hasProxyList ? (realDraggable ? emptyList : new LeafList(hover ? [...proxy.list, ...proxy.dragHoverExclude] : proxy.list)) : dragList) // realDraggable 需排除代理选择器，它有自身的拖拽逻辑\n    }\n\n    public checkDrag(data: IPointerEvent, canDrag: boolean): void {\n        const { interaction } = this\n\n        if (this.moving && data.buttons < 1) {\n            this.canAnimate = false // 防止dragEnd动画\n            interaction.pointerCancel() // 按住中键/右键拖出页面后的up事件接收不到\n            return\n        }\n\n        if (!this.moving && canDrag) {\n            if (this.moving = interaction.canMove(this.downData) || interaction.isHoldRightKey || interaction.isMobileDragEmpty) {\n                (this.dragData as IMoveEvent).moveType = 'drag'\n                interaction.emit(MoveEvent.START, this.dragData)\n            }\n        }\n\n        if (!this.moving) this.dragStart(data, canDrag)\n\n        this.drag(data)\n    }\n\n    public dragStart(data: IPointerEvent, canDrag: boolean): void {\n        if (!this.dragging) {\n            this.dragging = canDrag && PointerButton.left(data)\n            if (this.dragging) {\n                this.interaction.emit(DragEvent.START, this.dragData)\n                this.getDraggableList(this.dragData.path)\n                this.setDragStartPoints(this.realDraggableList = this.getList(true))\n            }\n        }\n    }\n\n    protected setDragStartPoints(list: ILeafList | ILeaf[]): void {\n        this.dragStartPoints = {}\n        list.forEach(leaf => this.dragStartPoints[leaf.innerId] = { x: leaf.x, y: leaf.y })\n    }\n\n    protected getDraggableList(path: ILeafList): void {\n        let leaf: ILeaf\n        for (let i = 0, len = path.length; i < len; i++) {\n            leaf = path.list[i]\n            if (LeafHelper.draggable(leaf)) {\n                this.draggableList = new LeafList(leaf)\n                break\n            }\n        }\n    }\n\n    public drag(data: IPointerEvent): void {\n        const { interaction, dragData, downData } = this\n        const { path, throughPath } = downData\n        this.dragData = getDragEventData(downData, dragData, data)\n        if (throughPath) this.dragData.throughPath = throughPath\n        this.dragData.path = path\n\n        this.dragDataList.push(this.dragData)\n\n        if (this.moving) {\n            data.moving = true;\n            (this.dragData as IMoveEvent).moveType = 'drag'\n            interaction.emit(MoveEvent.BEFORE_MOVE, this.dragData)\n            interaction.emit(MoveEvent.MOVE, this.dragData)\n        } else if (this.dragging) {\n            data.dragging = true\n            this.dragReal()\n            interaction.emit(DragEvent.BEFORE_DRAG, this.dragData)\n            interaction.emit(DragEvent.DRAG, this.dragData)\n        }\n    }\n\n    protected dragReal(isDragEnd?: boolean): void {\n        const { interaction } = this, { running } = interaction\n        const list = this.realDraggableList\n        if (list.length && running) {\n            const { totalX, totalY } = this.dragData, { dragLimitAnimate } = interaction.p\n            const checkLimitMove = !dragLimitAnimate || !!isDragEnd\n            list.forEach(leaf => {\n                if (leaf.draggable) {\n                    const axisDrag = isString(leaf.draggable)\n                    const move = DragEvent.getValidMove(leaf, this.dragStartPoints[leaf.innerId], { x: totalX, y: totalY }, checkLimitMove || axisDrag)\n                    if (dragLimitAnimate && !axisDrag && isDragEnd) LeafHelper.animateMove(leaf, move, isNumber(dragLimitAnimate) ? dragLimitAnimate : 0.3)\n                    else leaf.move(move)\n                }\n            })\n        }\n    }\n\n    public dragOverOrOut(data: IPointerEvent): void {\n        const { interaction } = this\n        const { dragOverPath } = this\n        const { path } = data\n        this.dragOverPath = path\n\n        if (dragOverPath) {\n            if (path.indexAt(0) !== dragOverPath.indexAt(0)) {\n                interaction.emit(DragEvent.OUT, data, dragOverPath)\n                interaction.emit(DragEvent.OVER, data, path)\n            }\n        } else interaction.emit(DragEvent.OVER, data, path)\n    }\n\n    public dragEnterOrLeave(data: IPointerEvent): void {\n        const { interaction } = this\n        const { dragEnterPath } = this\n        const { path } = data\n\n        interaction.emit(DragEvent.LEAVE, data, dragEnterPath, path)\n        interaction.emit(DragEvent.ENTER, data, path, dragEnterPath)\n        this.dragEnterPath = path\n    }\n\n    public dragEnd(data: IPointerEvent): void {\n        if (!this.dragging && !this.moving) return\n        if (this.checkDragEndAnimate(data)) return\n        this.dragEndReal(data)\n    }\n\n    public dragEndReal(data?: IPointerEvent): void {\n        const { interaction, downData, dragData } = this\n        if (!data) data = dragData\n        const { path, throughPath } = downData\n        const endDragData = getDragEventData(downData, data, data)\n        if (throughPath) endDragData.throughPath = throughPath\n        endDragData.path = path\n\n        if (this.moving) {\n            this.moving = false;\n            (endDragData as IMoveEvent).moveType = 'drag'\n            interaction.emit(MoveEvent.END, endDragData)\n        }\n\n        if (this.dragging) {\n            const dropList = this.getList()\n\n            this.dragging = false\n            if (interaction.p.dragLimitAnimate) this.dragReal(true)\n            interaction.emit(DragEvent.END, endDragData)\n\n            this.swipe(data, downData, dragData, endDragData)\n            this.drop(data, dropList, this.dragEnterPath)\n        }\n\n        this.autoMoveCancel()\n        this.dragReset()\n        this.animate(null, 'off')\n    }\n\n\n    protected swipe(data: IPointerEvent, downData: IPointerEvent, dragData: IDragEvent, endDragData: IDragEvent): void {\n        const { interaction } = this\n        if (PointHelper.getDistance(downData, data) > interaction.config.pointer.swipeDistance) {\n            const swipeData = getSwipeEventData(downData, dragData, endDragData)\n            this.interaction.emit(swipeData.type, swipeData)\n        }\n    }\n\n    protected drop(data: IPointerEvent, dropList: ILeafList, dragEnterPath: ILeafList): void {\n        const dropData = getDropEventData(data, dropList, DragEvent.data)\n        dropData.path = dragEnterPath\n        this.interaction.emit(DropEvent.DROP, dropData)\n        this.interaction.emit(DragEvent.LEAVE, data, dragEnterPath)\n    }\n\n    protected dragReset(): void {\n        DragEvent.list = DragEvent.data = this.draggableList = this.dragData = this.downData = this.dragOverPath = this.dragEnterPath = null\n        this.dragDataList = []\n    }\n\n\n    // @leafer-in/viewport will rewrite\n\n    public checkDragEndAnimate(_data: IPointerEvent, _speed?: number): boolean | number { return false }\n\n    public animate(_func?: IFunction, _off?: 'off'): void { }  // dragEnd animation\n\n    public stopAnimate(): void { }\n\n    public checkDragOut(_data: IPointerEvent): void { }\n\n    public autoMoveOnDragOut(_data: IPointerEvent): void { }\n\n    public autoMoveCancel(): void { }\n\n    // ---\n\n    public destroy(): void {\n        this.dragReset()\n    }\n}", "import { IUIEvent, ILeaf, ILeafList } from '@leafer/interface'\nimport { EventCreator, Debug } from '@leafer/core'\nimport { State } from '@leafer-ui/draw'\n\n\nconst debug = Debug.get('emit')\n\nexport function emit(type: string, data: IUIEvent, path?: ILeafList, excludePath?: ILeafList): void {\n    if (!path && !data.path) return\n\n    let leaf: ILeaf\n    data.type = type\n\n    if (path) data = { ...data, path }\n    else path = data.path\n\n    data.target = path.indexAt(0)\n\n    try {\n\n        // capture\n        for (let i = path.length - 1; i > -1; i--) {\n            leaf = path.list[i]\n            if (emitEvent(leaf, type, data, true, excludePath)) return\n            if (leaf.isApp) emitAppChildren(leaf, type, data, true, excludePath) //  other leafer\n        }\n\n        // bubble\n        for (let i = 0, len = path.length; i < len; i++) {\n            leaf = path.list[i]\n            if (leaf.isApp) emitAppChildren(leaf, type, data, false, excludePath) //  other leafer\n            if (emitEvent(leaf, type, data, false, excludePath)) return\n        }\n\n    } catch (e) {\n        debug.error(e)\n    }\n}\n\nconst allowTypes = ['move', 'zoom', 'rotate', 'key']\nfunction emitAppChildren(leaf: ILeaf, type: string, data: IUIEvent, capture?: boolean, excludePath?: ILeafList): void {\n    if (allowTypes.some(name => type.startsWith(name)) && leaf.__.hitChildren && !exclude(leaf, excludePath)) {\n        let child: ILeaf\n        for (let i = 0, len = leaf.children.length; i < len; i++) {\n            child = leaf.children[i]\n            if (!data.path.has(child) && child.__.hittable) emitEvent(child, type, data, capture, excludePath) //  other leafer\n        }\n    }\n}\n\nfunction emitEvent(leaf: ILeaf, type: string, data: IUIEvent, capture?: boolean, excludePath?: ILeafList): boolean {\n    if (leaf.destroyed) return false\n    if (leaf.__.hitSelf && !exclude(leaf, excludePath)) {\n\n        if (State.updateEventStyle && !capture) State.updateEventStyle(leaf, type) // hoverStyle / pressStyle\n\n        if (leaf.hasEvent(type, capture)) {\n            data.phase = capture ? 1 : ((leaf === data.target) ? 2 : 3)\n            const event = EventCreator.get(type, data)\n            leaf.emitEvent(event, capture)\n            if (event.isStop) return true\n        }\n    }\n    return false\n}\n\nfunction exclude(leaf: ILeaf, excludePath?: ILeafList): boolean {\n    return excludePath && excludePath.has(leaf)\n}", "import { IInteractionConfig } from '@leafer/interface'\n\nexport const config: IInteractionConfig = {\n    wheel: {\n        zoomSpeed: 0.5,\n        moveSpeed: 0.5,\n        rotateSpeed: 0.5,\n        delta: { x: 80 / 4, y: 8.0 }, // 基准速度（会影响zoomSpeed)，可根据不同系统、浏览器细化定制\n    },\n    pointer: {\n        type: 'pointer',\n        snap: true,\n        hitRadius: 5,\n        tapTime: 120,\n        longPressTime: 800,\n        transformTime: 500,\n        hover: true,\n        dragHover: true,\n        dragDistance: 2,\n        swipeDistance: 20,\n    },\n    touch: {\n        preventDefault: 'auto'\n    },\n    multiTouch: {},\n    move: { autoDistance: 2 },\n    zoom: {},\n    cursor: true,\n    keyEvent: true\n}", "import { IUIEvent, IPointerEvent, ILeaf, IInteraction, IInteractionConfig, ITransformer, ILeafList, IMoveEvent, IZoomEvent, IRotateEvent, IWheelEvent, ISelector, IBounds, IEventListenerId, IInteractionCanvas, ITimer, IKeepTouchData, IKeyEvent, IPickOptions, ICursorType, IBooleanMap, IPickBottom, IClientPointData, IPointData, ILeaferConfig, IMoveConfig, IPointerConfig } from '@leafer/interface'\nimport { LeaferEvent, ResizeEvent, LeafList, Bounds, PointHelper, DataHelper, Platform, isNumber } from '@leafer/core'\n\nimport { IApp } from '@leafer-ui/interface'\nimport { PointerEvent, DropEvent, KeyEvent, PointerButton, Keyboard } from '@leafer-ui/event'\n\nimport { Dragger } from './Dragger'\nimport { emit } from './emit'\nimport { InteractionHelper } from './InteractionHelper'\nimport { config } from './config'\n\n\nconst { pathHasEventType, pathCanDrag, pathHasOutside } = InteractionHelper\nexport class InteractionBase implements IInteraction {\n\n    public target: ILeaf\n    public canvas: IInteractionCanvas\n    public selector: ISelector\n\n    public running: boolean\n\n    public get dragging(): boolean { return this.dragger.dragging }\n    public get transforming(): boolean { return this.transformer.transforming }\n\n    public get moveMode(): boolean { return this.m.drag === true || this.isHoldSpaceKey || this.isHoldMiddleKey || (this.isHoldRightKey && this.dragger.moving) || this.isDragEmpty }\n    public get canHover(): boolean { return this.p.hover && !(this.config as ILeaferConfig).mobile }\n\n    public get isDragEmpty(): boolean { return this.m.dragEmpty && this.isRootPath(this.hoverData) && (!this.downData || this.isRootPath(this.downData)) }\n    public get isMobileDragEmpty(): boolean { return this.m.dragEmpty && !this.canHover && this.downData && this.isTreePath(this.downData) }\n    public get isHoldMiddleKey(): boolean { return this.m.holdMiddleKey && this.downData && PointerButton.middle(this.downData) }\n    public get isHoldRightKey(): boolean { return this.m.holdRightKey && this.downData && PointerButton.right(this.downData) }\n    public get isHoldSpaceKey(): boolean { return this.m.holdSpaceKey && Keyboard.isHoldSpaceKey() }\n\n    public config: IInteractionConfig = DataHelper.clone(config)\n    public get m(): IMoveConfig { return this.config.move }\n    public get p(): IPointerConfig { return this.config.pointer }\n\n    public cursor: ICursorType | ICursorType[]\n    public get hitRadius(): number { return this.p.hitRadius }\n\n    public bottomList?: IPickBottom[]\n\n    public shrinkCanvasBounds: IBounds\n\n    public downData: IPointerEvent\n    public hoverData: IPointerEvent\n    public focusData: ILeaf\n\n    public downTime: number\n\n    protected overPath: LeafList\n    protected enterPath: LeafList\n\n    protected waitMenuTap: boolean\n    protected waitRightTap: boolean\n    protected waitTap: boolean\n    protected longPressTimer: ITimer\n    protected longPressed: boolean\n    protected tapCount = 0\n    protected tapTimer: ITimer\n\n    public dragger: Dragger\n    public transformer: ITransformer\n\n    protected __eventIds: IEventListenerId[]\n    protected defaultPath: ILeafList\n\n    protected downKeyMap: IBooleanMap = {}\n\n    constructor(target: ILeaf, canvas: IInteractionCanvas, selector: ISelector, userConfig?: IInteractionConfig) {\n        this.target = target\n        this.canvas = canvas\n        this.selector = selector\n        this.defaultPath = new LeafList(target)\n\n        this.createTransformer()\n        this.dragger = new Dragger(this)\n\n        if (userConfig) this.config = DataHelper.default(userConfig, this.config)\n        this.__listenEvents()\n    }\n\n\n    public start(): void {\n        this.running = true\n    }\n\n    public stop(): void {\n        this.running = false\n    }\n\n\n    public receive(_event: any): void { }\n\n\n    public pointerDown(data?: IPointerEvent, useDefaultPath?: boolean): void {\n        if (!data) data = this.hoverData\n        if (!data) return\n\n        PointerButton.defaultLeft(data)\n        this.updateDownData(data)\n        this.checkPath(data, useDefaultPath)\n\n        this.downTime = Date.now()\n\n        this.emit(PointerEvent.BEFORE_DOWN, data) // downData maybe changed\n        this.emit(PointerEvent.DOWN, data)\n\n        if (PointerButton.left(data)) {\n            this.tapWait()\n            this.longPressWait(data)\n        }\n\n        this.waitRightTap = PointerButton.right(data)\n\n        this.dragger.setDragData(data) // must after down event\n        if (!this.isHoldRightKey) this.updateCursor(data)\n    }\n\n    public pointerMove(data?: IPointerEvent): void {\n        if (!data) data = this.hoverData\n        if (!data) return\n\n        const { downData } = this\n        if (downData) PointerButton.defaultLeft(data)\n\n        const hit = this.canvas.bounds.hitPoint(data)\n        if (hit || downData) {\n            this.pointerMoveReal(data)\n            if (downData) this.dragger.checkDragOut(data)\n        }\n    }\n\n    public pointerMoveReal(data: IPointerEvent): void {\n        this.emit(PointerEvent.BEFORE_MOVE, data, this.defaultPath)\n\n        if (this.downData) {\n            const canDrag = PointHelper.getDistance(this.downData, data) > this.p.dragDistance\n            if (canDrag) {\n                this.pointerWaitCancel()\n                this.waitRightTap = false\n            }\n\n            this.dragger.checkDrag(data, canDrag)\n        }\n\n        if (!this.dragger.moving) {\n            this.updateHoverData(data)\n            this.checkPath(data)\n\n            this.emit(PointerEvent.MOVE, data)\n\n            this.pointerHover(data)\n\n            if (this.dragging) {\n                this.dragger.dragOverOrOut(data)\n                this.dragger.dragEnterOrLeave(data)\n            }\n        }\n\n        this.updateCursor(this.downData || data)\n    }\n\n    public pointerUp(data?: IPointerEvent): void {\n        const { downData } = this\n        if (!data) data = downData\n        if (!downData) return\n\n        PointerButton.defaultLeft(data)\n        data.multiTouch = downData.multiTouch\n\n        this.findPath(data)\n        const upData = { ...data, path: data.path.clone() }\n\n        data.path.addList(downData.path.list)  // downPath必须触发\n\n        this.checkPath(data)\n\n        this.downData = null // must before pointer.up event\n        this.emit(PointerEvent.BEFORE_UP, data)\n        this.emit(PointerEvent.UP, data)\n\n        this.touchLeave(data)\n\n        if (!data.isCancel) {\n            this.tap(data)\n            this.menuTap(data)\n        }\n\n        this.dragger.dragEnd(data)\n\n        this.updateCursor(upData)\n    }\n\n    public pointerCancel(): void {\n        const data = { ...this.dragger.dragData }\n        data.isCancel = true\n        this.pointerUp(data)\n    }\n\n\n    // context menu\n    public menu(data: IPointerEvent): void {\n        this.findPath(data)\n        this.emit(PointerEvent.MENU, data)\n        this.waitMenuTap = true\n        if (!this.downData && this.waitRightTap) this.menuTap(data) // fix: Windows 触摸屏双击右键菜单事件会在pointer.up之后触发\n    }\n\n    public menuTap(data: IPointerEvent): void {\n        if (this.waitRightTap && this.waitMenuTap) {\n            this.emit(PointerEvent.MENU_TAP, data)\n            this.waitRightTap = this.waitMenuTap = false\n        }\n    }\n\n    // @leafer-in/viewport will rewrite:  transform viewport\n\n    public createTransformer(): void { }\n\n    public move(_data: IMoveEvent): void { }\n\n    public zoom(_data: IZoomEvent): void { }\n\n    public rotate(_data: IRotateEvent): void { }\n\n    public transformEnd(): void { }\n\n    public wheel(_data: IWheelEvent): void { }\n\n    public multiTouch(_data: IUIEvent, _list: IKeepTouchData[]): void { }\n\n    // ---\n\n    // key\n\n    public keyDown(data: IKeyEvent): void {\n        if (!this.config.keyEvent) return\n\n        this.emit(KeyEvent.BEFORE_DOWN, data, this.defaultPath) // 键盘按下前出发，还没有setDownCode\n\n        const { code } = data\n        if (!this.downKeyMap[code]) {\n            this.downKeyMap[code] = true\n            Keyboard.setDownCode(code)\n\n            this.emit(KeyEvent.HOLD, data, this.defaultPath)\n            if (this.moveMode) {\n                this.cancelHover()\n                this.updateCursor()\n            }\n        }\n        this.emit(KeyEvent.DOWN, data, this.defaultPath)\n    }\n\n    public keyUp(data: IKeyEvent): void {\n        if (!this.config.keyEvent) return\n\n        this.emit(KeyEvent.BEFORE_UP, data, this.defaultPath) // 键盘弹起前出发，还没有setUpCode\n\n        const { code } = data\n        this.downKeyMap[code] = false\n        Keyboard.setUpCode(code)\n\n        this.emit(KeyEvent.UP, data, this.defaultPath)\n        if (this.cursor === 'grab') this.updateCursor()\n    }\n\n\n    // helper\n    protected pointerHover(data: IPointerEvent): void {\n        if (this.canHover && !(this.dragging && !this.p.dragHover)) {\n            data.path || (data.path = new LeafList()) // 离开画布的情况\n            this.pointerOverOrOut(data)\n            this.pointerEnterOrLeave(data)\n        }\n    }\n\n    protected pointerOverOrOut(data: IPointerEvent): void {\n        const { path } = data\n        const { overPath } = this\n        this.overPath = path\n\n        if (overPath) {\n            if (path.indexAt(0) !== overPath.indexAt(0)) {\n                this.emit(PointerEvent.OUT, data, overPath)\n                this.emit(PointerEvent.OVER, data, path)\n            }\n        } else {\n            this.emit(PointerEvent.OVER, data, path)\n        }\n    }\n\n    protected pointerEnterOrLeave(data: IPointerEvent): void {\n        let { path } = data\n\n        if (this.downData && !this.moveMode) {\n            path = path.clone()\n            this.downData.path.forEach(leaf => path.add(leaf))\n        }\n\n        const { enterPath } = this\n        this.enterPath = path\n\n        this.emit(PointerEvent.LEAVE, data, enterPath, path)\n        this.emit(PointerEvent.ENTER, data, path, enterPath)\n    }\n\n    protected touchLeave(data: IPointerEvent): void {\n        if (data.pointerType === 'touch') {\n            if (this.enterPath) {\n                this.emit(PointerEvent.LEAVE, data)\n                if (this.dragger.dragging) this.emit(DropEvent.LEAVE, data)\n            }\n        }\n    }\n\n    protected tap(data: IPointerEvent): void {\n        const { pointer } = this.config\n\n        const hasLong = this.longTap(data)\n        if (!pointer.tapMore && hasLong) return // long_press / long_tap\n\n        if (!this.waitTap) return\n        if (pointer.tapMore) this.emitTap(data)\n\n        const useTime = Date.now() - this.downTime\n\n        const hasDouble = [PointerEvent.DOUBLE_TAP, PointerEvent.DOUBLE_CLICK].some(type => pathHasEventType(data.path, type))\n\n        if (useTime < pointer.tapTime + 50 && hasDouble) {\n\n            this.tapCount++\n            if (this.tapCount === 2) {\n                this.tapWaitCancel()\n                this.emitDoubleTap(data)\n            } else {\n                clearTimeout(this.tapTimer)\n                this.tapTimer = setTimeout(() => {\n                    if (!pointer.tapMore) {\n                        this.tapWaitCancel()\n                        this.emitTap(data)\n                    }\n                }, pointer.tapTime)\n            }\n\n        } else {\n\n            if (!pointer.tapMore) {\n                this.tapWaitCancel()\n                this.emitTap(data)\n            }\n        }\n    }\n\n\n    // update\n    public findPath(data: IPointerEvent, options?: IPickOptions): ILeafList {\n        const { hitRadius, through } = this.p\n        const { bottomList, target } = this\n        if (!Platform.backgrounder && !data.origin) target && target.updateLayout() // 模拟交互\n        const find = this.selector.getByPoint(data, hitRadius, { bottomList, name: data.type, ...(options || { through }) })\n        if (find.throughPath) data.throughPath = find.throughPath\n        data.path = find.path\n        return find.path\n    }\n\n    public isRootPath(data: IPointerEvent): boolean {\n        return data && (data.path.list[0] as ILeaf).isLeafer\n    }\n\n    public isTreePath(data: IPointerEvent): boolean {\n        const app = this.target.app as IApp\n        if (!app || !app.isApp) return false\n        return app.editor && (!data.path.has(app.editor) && data.path.has(app.tree) && !(data.target as ILeaf).syncEventer) // 当dragEmpty为true时，在手机端(pointer.hover为false)可以拖动tree层（编辑器选中的元素除外）\n    }\n\n    protected checkPath(data: IPointerEvent, useDefaultPath?: boolean): void {\n        if (useDefaultPath || (this.moveMode && !pathHasOutside(data.path))) data.path = this.defaultPath\n    }\n\n    public canMove(data: IPointerEvent): boolean { // moveMode and path can move\n        return data && (this.moveMode || (this.m.drag === 'auto' && !pathCanDrag(data.path))) && !pathHasOutside(data.path)\n    }\n\n\n    public isDrag(leaf: ILeaf): boolean {\n        return this.dragger.getList().has(leaf)\n    }\n\n    public isPress(leaf: ILeaf): boolean {\n        return this.downData && this.downData.path.has(leaf)\n    }\n\n    public isHover(leaf: ILeaf): boolean {\n        return this.enterPath && this.enterPath.has(leaf)\n    }\n\n    public isFocus(leaf: ILeaf): boolean {\n        return this.focusData === leaf\n    }\n\n\n    public cancelHover(): void {\n        const { hoverData } = this\n        if (hoverData) {\n            hoverData.path = this.defaultPath\n            this.pointerHover(hoverData)\n        }\n    }\n\n    public stopDragAnimate(): void {\n        this.dragger.stopAnimate()\n    }\n\n\n    public updateDownData(data?: IPointerEvent, options?: IPickOptions, merge?: boolean): void {\n        const { downData } = this\n        if (!data && downData) data = downData\n        if (!data) return\n        this.findPath(data, options)\n        if (merge && downData) data.path.addList(downData.path.list)\n        this.downData = data\n    }\n\n    public updateHoverData(data?: IPointerEvent): void {\n        if (!data) data = this.hoverData\n        if (!data) return\n        this.findPath(data, { exclude: this.dragger.getList(false, true), name: PointerEvent.MOVE })\n        this.hoverData = data\n    }\n\n    public updateCursor(data?: IPointerEvent): void {\n        if (!this.config.cursor || !this.canHover) return\n\n        if (!data) {\n            this.updateHoverData()\n            data = this.downData || this.hoverData\n        }\n\n        if (this.dragger.moving) {\n            return this.setCursor('grabbing')\n        } else if (this.canMove(data)) {\n            return this.setCursor(this.downData ? 'grabbing' : 'grab')\n        } else if (!data) return\n\n        let leaf: ILeaf, cursor: ICursorType | ICursorType[]\n\n        const { path } = data\n        for (let i = 0, len = path.length; i < len; i++) {\n            leaf = path.list[i]\n            cursor = (leaf.syncEventer && leaf.syncEventer.cursor) || leaf.cursor\n            if (cursor) break\n        }\n\n        this.setCursor(cursor)\n    }\n\n    public setCursor(cursor: ICursorType | ICursorType[]): void {\n        this.cursor = cursor\n    }\n\n    public getLocal(clientPoint: IClientPointData, updateClient?: boolean): IPointData {\n        const clientBounds = this.canvas.getClientBounds(updateClient)\n        const point = { x: clientPoint.clientX - clientBounds.x, y: clientPoint.clientY - clientBounds.y }\n\n        // 兼容clientBounds进行了transform的情况\n        const { bounds } = this.canvas\n        point.x *= bounds.width / clientBounds.width\n        point.y *= bounds.height / clientBounds.height\n\n        if (this.p.snap) PointHelper.round(point)\n        return point\n    }\n\n\n    protected emitTap(data: IPointerEvent) {\n        this.emit(PointerEvent.TAP, data)\n        this.emit(PointerEvent.CLICK, data)\n    }\n\n    protected emitDoubleTap(data: IPointerEvent) {\n        this.emit(PointerEvent.DOUBLE_TAP, data)\n        this.emit(PointerEvent.DOUBLE_CLICK, data)\n    }\n\n    public pointerWaitCancel(): void {\n        this.tapWaitCancel()\n        this.longPressWaitCancel()\n    }\n\n    protected tapWait(): void {\n        clearTimeout(this.tapTimer)\n        this.waitTap = true\n    }\n\n    protected tapWaitCancel(): void {\n        if (this.waitTap) {\n            clearTimeout(this.tapTimer)\n            this.waitTap = false\n            this.tapCount = 0\n        }\n    }\n\n    protected longPressWait(data: IPointerEvent): void {\n        clearTimeout(this.longPressTimer)\n        this.longPressTimer = setTimeout(() => {\n            this.longPressed = true\n            this.emit(PointerEvent.LONG_PRESS, data)\n        }, this.p.longPressTime)\n    }\n\n    protected longTap(data: IPointerEvent): boolean {\n        let hasLong\n        if (this.longPressed) {\n            this.emit(PointerEvent.LONG_TAP, data)\n            if (pathHasEventType(data.path, PointerEvent.LONG_TAP) || pathHasEventType(data.path, PointerEvent.LONG_PRESS)) hasLong = true\n        }\n        this.longPressWaitCancel()\n        return hasLong\n    }\n\n    protected longPressWaitCancel(): void {\n        if (this.longPressTimer) {\n            clearTimeout(this.longPressTimer)\n            this.longPressed = false\n        }\n    }\n\n    protected __onResize(): void {\n        const { dragOut } = this.m\n        this.shrinkCanvasBounds = new Bounds(this.canvas.bounds)\n        this.shrinkCanvasBounds.spread(-(isNumber(dragOut) ? dragOut : 2))\n    }\n\n    protected __listenEvents(): void {\n        const { target } = this\n        this.__eventIds = [target.on_(ResizeEvent.RESIZE, this.__onResize, this)]\n        target.once(LeaferEvent.READY, () => this.__onResize())\n    }\n\n    protected __removeListenEvents(): void {\n        this.target.off_(this.__eventIds)\n        this.__eventIds.length = 0\n    }\n\n\n    public emit(type: string, data: IUIEvent, path?: ILeafList, excludePath?: ILeafList): void {\n        if (this.running) emit(type, data, path, excludePath)\n    }\n\n\n    public destroy(): void {\n        if (this.__eventIds.length) {\n            this.stop()\n            this.__removeListenEvents()\n            this.dragger.destroy()\n            if (this.transformer) this.transformer.destroy()\n            this.downData = this.overPath = this.enterPath = null\n        }\n    }\n\n}", "import { ICursorTypeMap, ICursorType } from '@leafer/interface'\n\n\nexport class Cursor {\n\n    static custom: ICursorTypeMap = {}\n\n    static set(name: string, value: ICursorType | ICursorType[]): void {\n        this.custom[name] = value\n    }\n\n    static get(name: string): ICursorType | ICursorType[] {\n        return this.custom[name]\n    }\n\n}", "import { IHitCanvasManager, ILeaf, IHitCanvas, ILeafList, ILeaferCanvasConfig } from '@leafer/interface'\nimport { CanvasManager, LeafList, Creator } from '@leafer/core'\n\n\nexport class HitCanvasManager extends CanvasManager implements IHitCanvasManager {\n\n    public maxTotal = 1000 // 最多缓存多少张画布\n\n    protected pathList: ILeafList = new LeafList()\n    protected pixelList: ILeafList = new LeafList()\n\n    public getPixelType(leaf: ILeaf, config?: ILeaferCanvasConfig): IHitCanvas {\n        this.__autoClear()\n        this.pixelList.add(leaf)\n        return Creator.hitCanvas(config)\n    }\n\n    public getPathType(leaf: ILeaf): IHitCanvas {\n        this.__autoClear()\n        this.pathList.add(leaf)\n        return Creator.hitCanvas()\n    }\n\n    public clearImageType(): void {\n        this.__clearLeafList(this.pixelList)\n    }\n\n    public clearPathType(): void {\n        this.__clearLeafList(this.pathList)\n    }\n\n    protected __clearLeafList(leafList: ILeafList): void {\n        if (leafList.length) {\n            leafList.forEach(leaf => {\n                if (leaf.__hitCanvas) {\n                    leaf.__hitCanvas.destroy()\n                    leaf.__hitCanvas = null\n                }\n            })\n            leafList.reset()\n        }\n    }\n\n    protected __autoClear(): void {\n        if (this.pathList.length + this.pixelList.length > this.maxTotal) this.clear()\n    }\n\n    public clear(): void {\n        this.clearPathType()\n        this.clearImageType()\n    }\n\n}", "import { Platform, Creator } from '@leafer/core'\n\nimport { ISelector, ILeaf } from '@leafer-ui/interface'\n\n\nPlatform.getSelector = function (leaf: ILeaf): ISelector {\n    return leaf.leafer ? leaf.leafer.selector : (Platform.selector || (Platform.selector = Creator.selector()))\n}", "import { IRadiusPointData, ILeaferCanvas, IPointData, IBranch } from '@leafer/interface'\nimport { Leaf, PointHelper, BoundsHelper, Platform } from '@leafer/core'\n\n\nconst { toInnerRadiusPointOf, copyRadiusPoint } = PointHelper\nconst { hitRadiusPoint, hitPoint } = BoundsHelper\nconst inner = {} as IRadiusPointData, worldRadiusPoint = {} as IRadiusPointData\n\nconst leaf = Leaf.prototype\n\nleaf.hit = function (worldPoint: IPointData, hitRadius: number = 0): boolean {\n    this.updateLayout()\n\n    copyRadiusPoint(worldRadiusPoint, worldPoint, hitRadius)\n\n    const world = this.__world\n    if (hitRadius ? !hitRadiusPoint(world, worldRadiusPoint) : !hitPoint(world, worldRadiusPoint)) return false\n\n    return this.isBranch ? Platform.getSelector(this).hitPoint({ ...worldRadiusPoint }, hitRadius, { target: this as unknown as IBranch }) : this.__hitWorld(worldRadiusPoint)\n}\n\nleaf.__hitWorld = function (point: IRadiusPointData, forceHitFill?: boolean): boolean {\n    const data = this.__\n    if (!data.hitSelf) return false\n\n    const world = this.__world, layout = this.__layout\n    const isSmall = world.width < 10 && world.height < 10\n\n    if (data.hitRadius) {\n        copyRadiusPoint(inner, point, data.hitRadius)\n        point = inner\n    }\n\n    toInnerRadiusPointOf(point, world, inner)\n\n    if (data.hitBox || isSmall) {\n        if (BoundsHelper.hitRadiusPoint(layout.boxBounds, inner)) return true\n        if (isSmall) return false\n    }\n\n    if (layout.hitCanvasChanged || !this.__hitCanvas) {\n        this.__updateHitCanvas()\n        if (!layout.boundsChanged) layout.hitCanvasChanged = false\n    }\n\n    return this.__hit(inner, forceHitFill)\n}\n\nleaf.__hitFill = function (inner: IRadiusPointData): boolean { const h = this.__hitCanvas; return h && h.hitFill(inner, this.__.windingRule) }\n\nleaf.__hitStroke = function (inner: IRadiusPointData, strokeWidth: number): boolean { const h = this.__hitCanvas; return h && h.hitStroke(inner, strokeWidth) }\n\nleaf.__hitPixel = function (inner: IRadiusPointData): boolean { const h = this.__hitCanvas; return h && h.hitPixel(inner, this.__layout.renderBounds, h.hitScale) }\n\nleaf.__drawHitPath = function (canvas: ILeaferCanvas): void { canvas && this.__drawRenderPath(canvas) }", "import { IRadiusPointData } from '@leafer/interface'\nimport { Platform, Matrix, ImageManager, tempBounds } from '@leafer/core'\nimport { UI } from '@leafer-ui/draw'\n\n\nconst matrix = new Matrix()\nconst ui = UI.prototype\n\nui.__updateHitCanvas = function (): void {\n\n    if (this.__box) this.__box.__updateHitCanvas()\n\n    const { hitCanvasManager } = this.leafer || (this.parent && this.parent.leafer) || {}// 兼容 boxStyle\n    if (!hitCanvasManager) return\n\n    const data = this.__\n    const isHitPixelFill = (data.__isAlphaPixelFill || data.__isCanvas) && data.hitFill === 'pixel'\n    const isHitPixelStroke = data.__isAlphaPixelStroke && data.hitStroke === 'pixel'\n    const isHitPixel = isHitPixelFill || isHitPixelStroke\n\n    if (!this.__hitCanvas) this.__hitCanvas = isHitPixel ? hitCanvasManager.getPixelType(this, { contextSettings: { willReadFrequently: true } }) : hitCanvasManager.getPathType(this)\n\n    const h = this.__hitCanvas\n\n    if (isHitPixel) {\n        const { renderBounds } = this.__layout\n        const size = Platform.image.hitCanvasSize\n        const scale = h.hitScale = tempBounds.set(0, 0, size, size).getFitMatrix(renderBounds).a\n        const { x, y, width, height } = tempBounds.set(renderBounds).scale(scale)\n        h.resize({ width, height, pixelRatio: 1 })\n        h.clear()\n\n        ImageManager.patternLocked = true\n        this.__renderShape(h, { matrix: matrix.setWith(this.__world).scaleWith(1 / scale).invertWith().translate(-x, -y), snapshot: true, ignoreFill: !isHitPixelFill, ignoreStroke: !isHitPixelStroke }) // 矩阵\n        ImageManager.patternLocked = false\n        h.resetTransform()\n\n        data.__isHitPixel = true\n    } else {\n        data.__isHitPixel && (data.__isHitPixel = false)\n    }\n\n    this.__drawHitPath(h)\n    h.setStrokeOptions(data)\n\n}\n\nui.__hit = function (inner: IRadiusPointData, forceHitFill?: boolean): boolean {\n\n    if (this.__box && this.__box.__hit(inner)) return true\n\n    // hit pixel\n    const data = this.__\n    if (data.__isHitPixel && this.__hitPixel(inner)) return true\n\n    // hit path\n    const { hitFill } = data\n    const needHitFillPath = ((data.fill || data.__isCanvas) && (hitFill === 'path' || (hitFill === 'pixel' && !(data.__isAlphaPixelFill || data.__isCanvas)))) || hitFill === 'all' || forceHitFill\n    if (needHitFillPath && this.__hitFill(inner)) return true\n\n    const { hitStroke, __maxStrokeWidth: strokeWidth } = data\n    const needHitStrokePath = (data.stroke && (hitStroke === 'path' || (hitStroke === 'pixel' && !data.__isAlphaPixelStroke))) || hitStroke === 'all'\n    if (!needHitFillPath && !needHitStrokePath) return false\n\n    const radiusWidth = inner.radiusX * 2\n    let hitWidth = radiusWidth\n\n    if (needHitStrokePath) {\n        switch (data.strokeAlign) {\n            case 'inside':\n                hitWidth += strokeWidth * 2\n                if (!needHitFillPath && this.__hitFill(inner) && this.__hitStroke(inner, hitWidth)) return true\n                hitWidth = radiusWidth\n                break\n            case 'center':\n                hitWidth += strokeWidth\n                break\n            case 'outside':\n                hitWidth += strokeWidth * 2\n                if (!needHitFillPath) {\n                    if (!this.__hitFill(inner) && this.__hitStroke(inner, hitWidth)) return true\n                    hitWidth = radiusWidth\n                }\n                break\n        }\n    }\n\n    return hitWidth ? this.__hitStroke(inner, hitWidth) : false\n}", "import { IRadiusPointData } from '@leafer/interface'\nimport { BoundsHelper } from '@leafer/core'\nimport { UI, Rect, Box } from '@leafer-ui/draw'\n\n\nconst ui = UI.prototype, rect = Rect.prototype, box = Box.prototype\n\n// hit \n\nrect.__updateHitCanvas = box.__updateHitCanvas = function () {\n    if (this.stroke || this.cornerRadius || ((this.fill || this.__.__isCanvas) && this.hitFill === 'pixel') || this.hitStroke === 'all') ui.__updateHitCanvas.call(this)\n    else if (this.__hitCanvas) this.__hitCanvas = null\n}\n\nrect.__hitFill = box.__hitFill = function (inner: IRadiusPointData): boolean {\n    return this.__hitCanvas ? ui.__hitFill.call(this, inner) : BoundsHelper.hitRadiusPoint(this.__layout.boxBounds, inner)\n}", "import { ILeaferCanvas } from '@leafer/interface'\nimport { Text } from '@leafer-ui/draw'\n\n\nText.prototype.__drawHitPath = function (canvas: ILeaferCanvas): void {\n    const { __lineHeight, fontSize, __baseLine, __letterSpacing, __textDrawData: data } = this.__\n\n    canvas.beginPath()\n\n    if (__letterSpacing < 0) this.__drawPathByBox(canvas)\n    else data.rows.forEach(row => canvas.rect(row.x, row.y - __baseLine, row.width, __lineHeight < fontSize ? fontSize : __lineHeight))\n}\n\n", "import { Platform } from '@leafer/core'\n\nimport { IPointData, IPickOptions, IPickResult } from '@leafer-ui/interface'\nimport { Group, emptyData } from '@leafer-ui/draw'\n\n\nGroup.prototype.pick = function (hitPoint: IPointData, options?: IPickOptions): IPickResult {\n    options || (options = emptyData)\n    this.updateLayout()\n    return Platform.getSelector(this).getByPoint(hitPoint, options.hitRadius || 0, { ...options, target: this })\n}", "\nimport { IPointData, IRadiusPointData, IWindingRule } from '@leafer/interface'\nimport { LeaferCanvasBase, tempBounds } from '@leafer/core'\n\n\nconst canvas = LeaferCanvasBase.prototype\n\ncanvas.hitFill = function (point: IPointData, fillRule?: IWindingRule): boolean {\n    return fillRule ? this.context.isPointInPath(point.x, point.y, fillRule) : this.context.isPointInPath(point.x, point.y)\n}\n\ncanvas.hitStroke = function (point: IPointData, strokeWidth?: number): boolean {\n    this.strokeWidth = strokeWidth\n    return this.context.isPointInStroke(point.x, point.y)\n}\n\ncanvas.hitPixel = function (radiusPoint: IRadiusPointData, offset?: IPointData, scale = 1): boolean { // 画布必须有alpha通道\n    let { x, y, radiusX, radiusY } = radiusPoint\n    if (offset) x -= offset.x, y -= offset.y\n    tempBounds.set(x - radiusX, y - radiusY, radiusX * 2, radiusY * 2).scale(scale).ceil()\n    const { data } = this.context.getImageData(tempBounds.x, tempBounds.y, tempBounds.width || 1, tempBounds.height || 1)\n    for (let i = 0, len = data.length; i < len; i += 4) { if (data[i + 3] > 0) return true }\n    return data[3] > 0\n}", "import { IPointData } from '../math/IMath'\n\ntype Command = number\ntype x = number\ntype y = number\ntype x1 = number\ntype y1 = number\ntype x2 = number\ntype y2 = number\ntype radiusX = number\ntype radiusY = number\ntype xAxisRotation = number\ntype largeArcFlag = number\ntype sweepFlag = number\n\n\nexport type MCommandData = [Command, x, y]\nexport type HCommandData = [Command, x]\nexport type VCommandData = [Command, y]\nexport type LCommandData = MCommandData\n\nexport type CCommandData = [Command, x1, y1, x2, y2, x, y]\nexport type SCommandData = [Command, x2, y2, x, y]\n\nexport type QCommandData = [Command, x1, y1, x, y]\nexport type TCommandData = [Command, x, y]\n\nexport type ZCommandData = [Command]\n\nexport type ACommandData = [Command, radiusX, radiusY, xAxisRotation, largeArcFlag, sweepFlag, x, y]\n\n\n// 非svg标准的canvas绘图命令\ntype width = number\ntype height = number\ntype rotation = number\ntype startAngle = number\ntype endAngle = number\ntype anticlockwise = boolean\ntype cornerRadius = number | number[]\ntype radius = number\n\nexport type RectCommandData = [Command, x, y, width, height]\nexport type RoundRectCommandData = [Command, x, y, width, height, cornerRadius]\nexport type EllipseCommandData = [Command, x, y, radiusX, radiusY, rotation, startAngle, endAngle, anticlockwise]\nexport type ArcCommandData = [Command, x, y, radius, startAngle, endAngle, anticlockwise]\nexport type ArcToCommandData = [Command, x1, y1, x2, y2, radius]\n\n\nexport type CanvasPathCommand = 1 | 2 | 5 | 7 | 11 // M | L | C | Q | Z   canvas可以绘制的命令\n\nexport type IPathCommandData = number[] // ...(MCommandData | LCommandData | CCommandData | QCommandData | ZCommandData)\n\n\n// 路径命令对象\nexport interface MoveToCommandObject {\n    name: 'M'\n    x: number\n    y: number\n}\nexport interface LineToCommandObject {\n    name: 'L'\n    x: number\n    y: number\n}\n\nexport interface BezierCurveToCommandObject {\n    name: 'C'\n    x1: number\n    y1: number\n    x2: number\n    y2: number\n    x: number\n    y: number\n}\n\nexport interface QuadraticCurveToCommandObject {\n    name: 'Q'\n    x1: number\n    y1: number\n    x: number\n    y: number\n}\n\nexport interface ClosePathCommandObject {\n    name: 'Z'\n}\n\nexport type IPathCommandObject = MoveToCommandObject | LineToCommandObject | BezierCurveToCommandObject | QuadraticCurveToCommandObject | ClosePathCommandObject // M | L | C | Q | Z   canvas可以绘制的命令\n\n\n// 可视化路径节点\n\nexport interface IPathCommandNodeBase {\n    name: 'M^' | 'L^' | 'C^' | 'Z^'\n    x: number\n    y: number\n    a?: IPointData // 第一个手柄，连接上一个节点\n    b?: IPointData // 第二个手柄，连接下一个节点\n    ab?: PathNodeHandleType // 手柄类型\n}\n\nexport interface MoveToCommandNode extends IPathCommandNodeBase {\n    name: 'M^'\n}\nexport interface LineToCommandNode extends IPathCommandNodeBase {\n    name: 'L^'\n}\n\nexport interface BezierCurveToCommandNode extends IPathCommandNodeBase {\n    name: 'C^'\n}\n\nexport interface ClosePathCommandNode {\n    name: 'Z^'\n    x?: number\n    y?: number\n    a?: IPointData\n    b?: IPointData\n    ab?: PathNodeHandleType\n}\n\nexport type IPathCommandNode = MoveToCommandNode | LineToCommandNode | BezierCurveToCommandNode | ClosePathCommandNode // M | L | C | Z   路径节点命令(适合可视化编辑)\n\nexport enum PathNodeHandleType { // 手柄类型\n    none = 1, // 无手柄\n    free = 2, // 每个手柄自由控制\n    mirrorAngle = 3, // 仅镜像角度\n    mirror = 4,  // 镜像角度和长度\n}\n\nexport type PathNodeHandleName = 'a' | 'b' // 手柄名称\n\nexport interface IPathNodeBase {\n    pathNode: IPathCommandNode\n}", "import { IAutoBounds, ISizeData, IScreenSizeData, IResizeEventListener, IFunction } from '@leafer/interface'\nimport { LeaferCanvasBase, canvasSizeAttrs, ResizeEvent, DataHelper, Platform, Debug, isString, isUndefined } from '@leafer/core'\n\n\nconst debug = Debug.get('LeaferCanvas')\n\nexport class LeaferCanvas extends LeaferCanvasBase {\n\n    declare public view: HTMLCanvasElement\n    declare public parentView: HTMLElement\n\n    public set zIndex(zIndex: number) {\n        const { style } = this.view\n        style.zIndex = zIndex as unknown as string\n        this.setAbsolute(this.view)\n    }\n\n    public set childIndex(index: number) {\n        const { view, parentView } = this\n        if (view && parentView) {\n            const beforeNode = parentView.children[index]\n            if (beforeNode) {\n                this.setAbsolute(beforeNode as HTMLCanvasElement)\n                parentView.insertBefore(view, beforeNode)\n            } else {\n                parentView.appendChild(beforeNode)\n            }\n        }\n    }\n\n    protected resizeObserver: ResizeObserver\n    protected autoBounds: IAutoBounds\n    protected resizeListener: IResizeEventListener\n    protected windowListener: IFunction\n\n    public init(): void {\n        const { config } = this\n        const view = config.view || config.canvas\n\n        view ? this.__createViewFrom(view) : this.__createView()\n        const { style } = this.view\n        style.display || (style.display = 'block')\n        this.parentView = this.view.parentElement\n\n        if (this.parentView) {\n            const pStyle = this.parentView.style\n            pStyle.webkitUserSelect = pStyle.userSelect = 'none' // fix safari: use webkitUserSelect\n            this.view.classList.add('leafer-canvas-view')\n        }\n\n        if (Platform.syncDomFont && !this.parentView) { // fix: firefox default font\n            style.display = 'none'\n            if (document.body) document.body.appendChild(this.view)\n        }\n\n        this.__createContext()\n\n        if (!this.autoLayout) this.resize(config as IScreenSizeData)\n    }\n\n    public set backgroundColor(color: string) { this.view.style.backgroundColor = color }\n    public get backgroundColor(): string { return this.view.style.backgroundColor }\n\n    public set hittable(hittable: boolean) { this.view.style.pointerEvents = hittable ? 'auto' : 'none' }\n    public get hittable() { return this.view.style.pointerEvents !== 'none' }\n\n    protected __createView(): void {\n        this.view = document.createElement('canvas')\n    }\n\n    protected __createViewFrom(inputView: string | object): void {\n        let find: unknown = isString(inputView) ? document.getElementById(inputView) : inputView as HTMLElement\n        if (find) {\n            if (find instanceof HTMLCanvasElement) {\n\n                this.view = find\n\n            } else {\n\n                let parent = find as HTMLDivElement\n                if (find === window || find === document) {\n                    const div = document.createElement('div')\n                    const { style } = div\n                    style.position = 'absolute'\n                    style.top = style.bottom = style.left = style.right = '0px'\n                    document.body.appendChild(div)\n                    parent = div\n                }\n\n                this.__createView()\n                const view = this.view\n\n                if (parent.hasChildNodes()) {\n                    this.setAbsolute(view)\n                    parent.style.position || (parent.style.position = 'relative')\n                }\n\n                parent.appendChild(view)\n            }\n        } else {\n            debug.error(`no id: ${inputView}`)\n            this.__createView()\n        }\n    }\n\n    protected setAbsolute(view: HTMLCanvasElement): void {\n        const { style } = view\n        style.position = 'absolute'\n        style.top = style.left = '0px'\n    }\n\n    public updateViewSize(): void {\n        const { width, height, pixelRatio } = this\n        const { style } = this.view\n\n        style.width = width + 'px'\n        style.height = height + 'px'\n\n        if (!this.unreal) {\n            this.view.width = Math.ceil(width * pixelRatio)\n            this.view.height = Math.ceil(height * pixelRatio)\n        }\n    }\n\n\n    public updateClientBounds(): void {\n        if (this.view.parentElement) this.clientBounds = this.view.getBoundingClientRect()\n    }\n\n    public startAutoLayout(autoBounds: IAutoBounds, listener: IResizeEventListener): void {\n        this.resizeListener = listener\n\n        if (autoBounds) {  // check auto layout\n\n            this.autoBounds = autoBounds\n\n            if (this.resizeObserver) return\n\n            try {\n\n                this.resizeObserver = new ResizeObserver((entries) => {\n                    this.updateClientBounds()\n                    for (const entry of entries) this.checkAutoBounds(entry.contentRect)\n                })\n\n                const parent = this.parentView\n                if (parent) {\n                    this.resizeObserver.observe(parent)\n                    this.checkAutoBounds(parent.getBoundingClientRect())\n                } else {\n                    this.checkAutoBounds(this.view)\n                    debug.warn('no parent')\n                }\n\n            } catch {\n\n                this.imitateResizeObserver()\n\n            }\n\n            this.stopListenPixelRatio()\n\n        } else {\n\n            this.listenPixelRatio()\n            if (this.unreal) this.updateViewSize() // must update\n\n        }\n\n    }\n\n    protected imitateResizeObserver(): void {\n        if (this.autoLayout) {\n            if (this.parentView) this.checkAutoBounds(this.parentView.getBoundingClientRect())\n            Platform.requestRender(this.imitateResizeObserver.bind(this))\n        }\n    }\n\n    // check devicePixelRatio change\n\n    protected listenPixelRatio() {\n        if (!this.windowListener) window.addEventListener('resize', this.windowListener = () => {\n            const pixelRatio = Platform.devicePixelRatio\n            if (!this.config.pixelRatio && this.pixelRatio !== pixelRatio) {\n                const { width, height } = this\n                this.emitResize({ width, height, pixelRatio })\n            }\n        })\n    }\n\n    protected stopListenPixelRatio() {\n        if (this.windowListener) {\n            window.removeEventListener('resize', this.windowListener)\n            this.windowListener = null\n        }\n    }\n\n    protected checkAutoBounds(parentSize: ISizeData): void {\n        const view = this.view\n        const { x, y, width, height } = this.autoBounds.getBoundsFrom(parentSize)\n        const size = { width, height, pixelRatio: this.config.pixelRatio ? this.pixelRatio : Platform.devicePixelRatio } as IScreenSizeData\n        if (!this.isSameSize(size)) {\n            const { style } = view\n            style.marginLeft = x + 'px'\n            style.marginTop = y + 'px'\n            this.emitResize(size)\n        }\n    }\n\n    public stopAutoLayout(): void {\n        this.autoLayout = false\n        if (this.resizeObserver) this.resizeObserver.disconnect()\n        this.resizeListener = this.resizeObserver = null\n    }\n\n    protected emitResize(size: IScreenSizeData): void {\n        const oldSize = {} as IScreenSizeData\n        DataHelper.copyAttrs(oldSize, this, canvasSizeAttrs)\n        this.resize(size)\n        if (this.resizeListener && !isUndefined(this.width)) this.resizeListener(new ResizeEvent(size, oldSize))\n    }\n\n\n    public unrealCanvas(): void { // App needs to use\n        if (!this.unreal && this.parentView) { // canvas 替换成 div, 方便放入子canvas\n            let view = this.view\n            if (view) view.remove()\n\n            view = this.view = document.createElement('div') as any\n            this.parentView.appendChild(this.view)\n            view.classList.add('leafer-app-view')\n\n            this.unreal = true\n        }\n    }\n\n    public destroy(): void {\n        const { view } = this\n        if (view) {\n            this.stopAutoLayout()\n            this.stopListenPixelRatio()\n            if (view.parentElement) view.remove()\n            super.destroy()\n        }\n    }\n\n}", "import { canvasPatch } from '@leafer/core'\n\nexport { LeaferCanvas } from './LeaferCanvas'\n\ncanvasPatch(CanvasRenderingContext2D.prototype)\ncanvasPatch(Path2D.prototype)", "export * from '@leafer/core'\n\nexport * from '@leafer/canvas-web'\nexport * from '@leafer/image-web'\n\nimport { ICreator, IFunction, IExportImageType, IExportFileType, IObject, ICanvasType } from '@leafer/interface'\nimport { Platform, Creator, FileHelper, defineKey } from '@leafer/core'\n\nimport { LeaferCanvas } from '@leafer/canvas-web'\nimport { LeaferImage } from '@leafer/image-web'\n\n\nconst { mineType, fileType } = FileHelper\n\nObject.assign(Creator, {\n    canvas: (options?, manager?) => new LeaferCanvas(options, manager),\n    image: (options) => new LeaferImage(options)\n} as ICreator)\n\n\nexport function useCanvas(_canvasType: ICanvasType, _power?: IObject): void {\n    Platform.origin = {\n        createCanvas(width: number, height: number): HTMLCanvasElement {\n            const canvas = document.createElement('canvas')\n            canvas.width = width\n            canvas.height = height\n            return canvas\n        },\n        canvasToDataURL: (canvas: HTMLCanvasElement, type?: IExportImageType, quality?: number) => {\n            const imageType = mineType(type), url = canvas.toDataURL(imageType, quality)\n            return imageType === 'image/bmp' ? url.replace('image/png;', 'image/bmp;') : url\n        },\n        canvasToBolb: (canvas: HTMLCanvasElement, type?: IExportFileType, quality?: number) => new Promise((resolve) => canvas.toBlob(resolve, mineType(type), quality)),\n        canvasSaveAs: (canvas: HTMLCanvasElement, filename: string, quality?: any) => {\n            const url = canvas.toDataURL(mineType(fileType(filename)), quality)\n            return Platform.origin.download(url, filename)\n        },\n        download(url: string, filename: string): Promise<void> {\n            return new Promise((resolve) => {\n                let el = document.createElement('a')\n                el.href = url\n                el.download = filename\n                document.body.appendChild(el)\n                el.click()\n                document.body.removeChild(el)\n                resolve()\n            })\n        },\n        loadImage(src: any): Promise<HTMLImageElement> {\n            return new Promise((resolve, reject) => {\n                const img = new Platform.origin.Image()\n                const { crossOrigin } = Platform.image\n                if (crossOrigin) {\n                    img.setAttribute('crossOrigin', crossOrigin)\n                    img.crossOrigin = crossOrigin\n                }\n                img.onload = () => { resolve(img) }\n                img.onerror = (e: any) => { reject(e) }\n                img.src = Platform.image.getRealURL(src)\n            })\n        },\n        Image,\n        PointerEvent,\n        DragEvent\n    }\n\n    Platform.event = {\n        stopDefault(origin: Event): void { origin.preventDefault() },\n        stopNow(origin: Event): void { origin.stopImmediatePropagation() },\n        stop(origin: Event): void { origin.stopPropagation() }\n    }\n\n    Platform.canvas = Creator.canvas()\n    Platform.conicGradientSupport = !!Platform.canvas.context.createConicGradient\n}\n\nPlatform.name = 'web'\nPlatform.isMobile = 'ontouchstart' in window\nPlatform.requestRender = function (render: IFunction): void { window.requestAnimationFrame(render) }\ndefineKey(Platform, 'devicePixelRatio', { get() { return devicePixelRatio } })\n\n\n// same as worker\n\nconst { userAgent } = navigator\n\nif (userAgent.indexOf(\"Firefox\") > -1) {\n    Platform.conicGradientRotate90 = true\n    Platform.intWheelDeltaY = true\n    Platform.syncDomFont = true\n} else if (/iPhone|iPad|iPod/.test(navigator.userAgent) || (/Macintosh/.test(navigator.userAgent) && /Version\\/[\\d.]+.*Safari/.test(navigator.userAgent))) {\n    Platform.fullImageShadow = true // 苹果内核渲染阴影\n}\n\nif (userAgent.indexOf('Windows') > -1) {\n    Platform.os = 'Windows'\n    Platform.intWheelDeltaY = true\n} else if (userAgent.indexOf('Mac') > -1) {\n    Platform.os = 'Mac'\n} else if (userAgent.indexOf('Linux') > -1) {\n    Platform.os = 'Linux'\n}", "import { ILeaf, IWatcher, IEventListenerId, ILeafList, IWatcherConfig } from '@leafer/interface'\nimport { PropertyEvent, ChildEvent, RenderEvent, WatchEvent, LeafList, DataHelper } from '@leafer/core'\n\n\nexport class Watcher implements IWatcher {\n\n    public target: ILeaf\n\n    public totalTimes: number = 0\n\n    public disabled: boolean\n    public running: boolean\n    public changed: boolean\n\n    public hasVisible: boolean\n    public hasAdd: boolean\n    public hasRemove: boolean\n    public get childrenChanged() { return this.hasAdd || this.hasRemove || this.hasVisible }\n\n    public config: IWatcherConfig = {}\n\n    public get updatedList(): ILeafList {\n        if (this.hasRemove && this.config.usePartLayout) {\n            const updatedList = new LeafList()\n            this.__updatedList.list.forEach(item => { if (item.leafer) updatedList.add(item) })\n            return updatedList\n        } else {\n            return this.__updatedList\n        }\n    }\n\n    protected __eventIds: IEventListenerId[]\n    protected __updatedList: ILeafList = new LeafList()\n\n    constructor(target: ILeaf, userConfig?: IWatcherConfig) {\n        this.target = target\n        if (userConfig) this.config = DataHelper.default(userConfig, this.config)\n        this.__listenEvents()\n    }\n\n    public start(): void {\n        if (this.disabled) return\n        this.running = true\n    }\n\n    public stop(): void {\n        this.running = false\n    }\n\n    public disable(): void {\n        this.stop()\n        this.__removeListenEvents()\n        this.disabled = true\n    }\n\n    public update(): void {\n        this.changed = true\n        if (this.running) this.target.emit(RenderEvent.REQUEST)\n    }\n\n    protected __onAttrChange(event: PropertyEvent): void {\n        if (this.config.usePartLayout) this.__updatedList.add(event.target as ILeaf)\n        this.update()\n    }\n\n    protected __onChildEvent(event: ChildEvent): void {\n        if (this.config.usePartLayout) {\n            if (event.type === ChildEvent.ADD) {\n                this.hasAdd = true\n                this.__pushChild(event.child)\n            } else {\n                this.hasRemove = true\n                this.__updatedList.add(event.parent)\n            }\n        }\n        this.update()\n    }\n\n    protected __pushChild(child: ILeaf): void {\n        this.__updatedList.add(child)\n        if (child.isBranch) this.__loopChildren(child)\n    }\n\n    protected __loopChildren(parent: ILeaf): void {\n        const { children } = parent\n        for (let i = 0, len = children.length; i < len; i++) this.__pushChild(children[i])\n    }\n\n    public __onRquestData(): void {\n        this.target.emitEvent(new WatchEvent(WatchEvent.DATA, { updatedList: this.updatedList }))\n        this.__updatedList = new LeafList()\n        this.totalTimes++\n        this.changed = this.hasVisible = this.hasRemove = this.hasAdd = false\n    }\n\n    protected __listenEvents(): void {\n        this.__eventIds = [\n            this.target.on_([\n                [PropertyEvent.CHANGE, this.__onAttrChange, this],\n                [[ChildEvent.ADD, ChildEvent.REMOVE], this.__onChildEvent, this],\n                [WatchEvent.REQUEST, this.__onRquestData, this]\n            ])\n        ]\n    }\n\n    protected __removeListenEvents(): void {\n        this.target.off_(this.__eventIds)\n    }\n\n    public destroy(): void {\n        if (this.target) {\n            this.stop()\n            this.__removeListenEvents()\n            this.target = this.__updatedList = null\n        }\n    }\n\n}", "import { ILeafLayout, ILeafLevelList, ILeafList, ILeaf } from '@leafer/interface'\nimport { BranchHelper, LeafHelper } from '@leafer/core'\n\n\nconst { updateAllMatrix, updateBounds: updateOneBounds, updateChange: updateOneChange } = LeafHelper\nconst { pushAllChildBranch, pushAllParent } = BranchHelper\n\n\nexport function updateMatrix(updateList: ILeafList, levelList: ILeafLevelList): void {\n\n    let layout: ILeafLayout\n    updateList.list.forEach(leaf => {  // 更新矩阵, 所有子元素，和父元素都需要更新bounds\n        layout = leaf.__layout\n        if (levelList.without(leaf) && !layout.proxyZoom) { // 防止重复， 子元素可能已经被父元素更新过\n\n            if (layout.matrixChanged) {\n\n                updateAllMatrix(leaf, true)\n\n                levelList.add(leaf)\n                if (leaf.isBranch) pushAllChildBranch(leaf, levelList)\n                pushAllParent(leaf, levelList)\n\n            } else if (layout.boundsChanged) {\n\n                levelList.add(leaf)\n                if (leaf.isBranch) leaf.__tempNumber = 0  // 标识需要更新子Leaf元素的WorldBounds分支, 0表示不需要更新\n                pushAllParent(leaf, levelList)\n            }\n        }\n    })\n\n}\n\nexport function updateBounds(boundsList: ILeafLevelList): void {\n    let list: ILeaf[], branch: ILeaf, children: ILeaf[]\n    boundsList.sort(true)\n    boundsList.levels.forEach(level => {\n        list = boundsList.levelMap[level]\n        for (let i = 0, len = list.length; i < len; i++) {\n            branch = list[i]\n\n            // 标识了需要更新子元素\n            if (branch.isBranch && branch.__tempNumber) {\n                children = branch.children\n                for (let j = 0, jLen = children.length; j < jLen; j++) {\n                    if (!children[j].isBranch) {\n                        updateOneBounds(children[j])\n                    }\n                }\n            }\n            updateOneBounds(branch)\n        }\n    })\n}\n\n\nexport function updateChange(updateList: ILeafList): void {\n    updateList.list.forEach(updateOneChange)\n}", "import { IBounds, ILayoutBlockData, ILeafList, ILeaf } from '@leafer/interface'\nimport { Bounds, LeafBoundsHelper, LeafList, isArray } from '@leafer/core'\n\n\nconst { worldBounds } = LeafBoundsHelper\n\nexport class LayoutBlockData implements ILayoutBlockData {\n\n    public updatedList: ILeafList\n    public updatedBounds: IBounds = new Bounds()\n\n    public beforeBounds: IBounds = new Bounds()\n    public afterBounds: IBounds = new Bounds()\n\n    constructor(list: ILeafList | ILeaf[]) {\n        if (isArray(list)) list = new LeafList(list)\n        this.updatedList = list\n    }\n\n    public setBefore(): void {\n        this.beforeBounds.setListWithFn(this.updatedList.list, worldBounds)\n    }\n\n    public setAfter(): void {\n        this.afterBounds.setListWithFn(this.updatedList.list, worldBounds)\n        this.updatedBounds.setList([this.beforeBounds, this.afterBounds])\n    }\n\n    public merge(data: ILayoutBlockData): void {\n        this.updatedList.addList(data.updatedList.list)\n        this.beforeBounds.add(data.beforeBounds)\n        this.afterBounds.add(data.afterBounds)\n        this.updatedBounds.add(data.updatedBounds)\n    }\n\n    public destroy(): void {\n        this.updatedList = null\n    }\n\n}", "import { ILayouter, ILeaf, ILayoutBlockData, IEventListenerId, ILayouterConfig, ILeafList } from '@leafer/interface'\nimport { LayoutEvent, WatchEvent, LeafLevelList, LeafList, BranchHelper, LeafHelper, DataHelper, Run, Debug } from '@leafer/core'\n\nimport { updateMatrix, updateBounds, updateChange } from './LayouterHelper'\nimport { LayoutBlockData } from './LayoutBlockData'\n\n\nconst { updateAllMatrix, updateAllChange } = LeafHelper\n\nconst debug = Debug.get('Layouter')\n\nexport class Layouter implements ILayouter {\n\n    public target: ILeaf\n    public layoutedBlocks: ILayoutBlockData[]\n    public extraBlock: ILayoutBlockData // around / autoLayout\n\n    public totalTimes: number = 0\n    public times: number\n\n    public disabled: boolean\n    public running: boolean\n    public layouting: boolean\n\n    public waitAgain: boolean\n\n    public config: ILayouterConfig = { usePartLayout: true }\n\n    protected __updatedList: ILeafList\n    protected __levelList: LeafLevelList = new LeafLevelList()\n    protected __eventIds: IEventListenerId[]\n\n    constructor(target: ILeaf, userConfig?: ILayouterConfig) {\n        this.target = target\n        if (userConfig) this.config = DataHelper.default(userConfig, this.config)\n        this.__listenEvents()\n    }\n\n    public start(): void {\n        if (this.disabled) return\n        this.running = true\n    }\n\n    public stop(): void {\n        this.running = false\n    }\n\n    public disable(): void {\n        this.stop()\n        this.__removeListenEvents()\n        this.disabled = true\n    }\n\n    public layout(): void {\n        if (this.layouting || !this.running) return\n        const { target } = this\n        this.times = 0\n\n        try {\n            target.emit(LayoutEvent.START)\n            this.layoutOnce()\n            target.emitEvent(new LayoutEvent(LayoutEvent.END, this.layoutedBlocks, this.times))\n        } catch (e) {\n            debug.error(e)\n        }\n\n        this.layoutedBlocks = null\n    }\n\n    public layoutAgain(): void {\n        if (this.layouting) {\n            this.waitAgain = true\n        } else {\n            this.layoutOnce()\n        }\n    }\n\n    public layoutOnce(): void {\n        if (this.layouting) return debug.warn('layouting')\n        if (this.times > 3) return debug.warn('layout max times')\n\n        this.times++\n        this.totalTimes++\n\n        this.layouting = true\n\n        this.target.emit(WatchEvent.REQUEST)\n\n        if (this.totalTimes > 1 && this.config.usePartLayout) {\n            this.partLayout()\n        } else {\n            this.fullLayout()\n        }\n\n        this.layouting = false\n\n        if (this.waitAgain) {\n            this.waitAgain = false\n            this.layoutOnce()\n        }\n    }\n\n    public partLayout(): void {\n        if (!this.__updatedList?.length) return\n\n        const t = Run.start('PartLayout')\n        const { target, __updatedList: updateList } = this\n        const { BEFORE, LAYOUT, AFTER } = LayoutEvent\n\n        const blocks = this.getBlocks(updateList)\n        blocks.forEach(item => item.setBefore())\n        target.emitEvent(new LayoutEvent(BEFORE, blocks, this.times))\n\n        this.extraBlock = null\n        updateList.sort()\n        updateMatrix(updateList, this.__levelList)\n        updateBounds(this.__levelList)\n        updateChange(updateList)\n\n        if (this.extraBlock) blocks.push(this.extraBlock)\n        blocks.forEach(item => item.setAfter())\n\n        target.emitEvent(new LayoutEvent(LAYOUT, blocks, this.times))\n        target.emitEvent(new LayoutEvent(AFTER, blocks, this.times))\n\n        this.addBlocks(blocks)\n\n        this.__levelList.reset()\n        this.__updatedList = null\n        Run.end(t)\n    }\n\n    public fullLayout(): void {\n        const t = Run.start('FullLayout')\n\n        const { target } = this\n        const { BEFORE, LAYOUT, AFTER } = LayoutEvent\n\n        const blocks = this.getBlocks(new LeafList(target))\n        target.emitEvent(new LayoutEvent(BEFORE, blocks, this.times))\n\n        Layouter.fullLayout(target)\n\n        blocks.forEach(item => { item.setAfter() })\n        target.emitEvent(new LayoutEvent(LAYOUT, blocks, this.times))\n        target.emitEvent(new LayoutEvent(AFTER, blocks, this.times))\n\n        this.addBlocks(blocks)\n\n        Run.end(t)\n    }\n\n    static fullLayout(target: ILeaf): void {\n        updateAllMatrix(target, true)\n\n        if (target.isBranch) BranchHelper.updateBounds(target)\n        else LeafHelper.updateBounds(target)\n\n        updateAllChange(target)\n    }\n\n    public addExtra(leaf: ILeaf): void {\n        if (!this.__updatedList.has(leaf)) {\n            const { updatedList, beforeBounds } = this.extraBlock || (this.extraBlock = new LayoutBlockData([]))\n            updatedList.length ? beforeBounds.add(leaf.__world) : beforeBounds.set(leaf.__world)\n            updatedList.add(leaf)\n        }\n    }\n\n    public createBlock(data: ILeafList | ILeaf[]): ILayoutBlockData {\n        return new LayoutBlockData(data)\n    }\n\n    public getBlocks(list: ILeafList): ILayoutBlockData[] {\n        return [this.createBlock(list)]\n    }\n\n    public addBlocks(current: ILayoutBlockData[]) {\n        this.layoutedBlocks ? this.layoutedBlocks.push(...current) : this.layoutedBlocks = current\n    }\n\n    protected __onReceiveWatchData(event: WatchEvent): void {\n        this.__updatedList = event.data.updatedList\n    }\n\n    protected __listenEvents(): void {\n        this.__eventIds = [\n            this.target.on_([\n                [LayoutEvent.REQUEST, this.layout, this],\n                [LayoutEvent.AGAIN, this.layoutAgain, this],\n                [WatchEvent.DATA, this.__onReceiveWatchData, this]\n            ])\n        ]\n    }\n\n    protected __removeListenEvents(): void {\n        this.target.off_(this.__eventIds)\n    }\n\n    public destroy(): void {\n        if (this.target) {\n            this.stop()\n            this.__removeListenEvents()\n            this.target = this.config = null\n        }\n    }\n\n}\n\n\n", "import { ILeaf, ILeaferBase, ILeaferCanvas, IRenderer, IRendererConfig, IEventListenerId, IBounds, IFunction, IRenderOptions, ILeafList } from '@leafer/interface'\nimport { LayoutEvent, RenderEvent, ResizeEvent, ImageManager, Bounds, DataHelper, Platform, Debug, Run } from '@leafer/core'\n\n\nconst debug = Debug.get('Renderer')\n\nexport class Renderer implements IRenderer {\n\n    public target: ILeaf\n    public canvas: ILeaferCanvas\n    public updateBlocks: IBounds[]\n\n    public FPS = 60\n    public totalTimes = 0\n    public times: number = 0\n\n    public running: boolean\n    public rendering: boolean\n\n    public waitAgain: boolean\n    public changed: boolean\n    public ignore: boolean\n\n    public config: IRendererConfig = {\n        usePartRender: true,\n        ceilPartPixel: true,\n        maxFPS: 120\n    }\n\n    static clipSpread = 10\n\n    protected renderBounds: IBounds\n    protected renderOptions: IRenderOptions\n    protected totalBounds: IBounds\n\n    protected requestTime: number\n    protected frameTime: number\n    protected frames: number[] = []\n    protected __eventIds: IEventListenerId[]\n\n    protected get needFill(): boolean { return !!(!this.canvas.allowBackgroundColor && this.config.fill) }\n\n    constructor(target: ILeaf, canvas: ILeaferCanvas, userConfig?: IRendererConfig) {\n        this.target = target\n        this.canvas = canvas\n        if (userConfig) this.config = DataHelper.default(userConfig, this.config)\n        this.__listenEvents()\n    }\n\n    public start(): void {\n        this.running = true\n        this.update(false)\n    }\n\n    public stop(): void {\n        this.running = false\n    }\n\n    public update(change = true): void {\n        if (!this.changed) this.changed = change\n        if (!this.requestTime) this.__requestRender()\n    }\n\n    public requestLayout(): void {\n        this.target.emit(LayoutEvent.REQUEST)\n    }\n\n    public checkRender(): void {\n        if (this.running) {\n            const { target } = this\n            if (target.isApp) {\n                target.emit(RenderEvent.CHILD_START, target);\n                (target.children as ILeaferBase[]).forEach(leafer => {\n                    leafer.renderer.FPS = this.FPS\n                    leafer.renderer.checkRender()\n                })\n                target.emit(RenderEvent.CHILD_END, target)\n            }\n\n            if (this.changed && this.canvas.view) this.render()\n            this.target.emit(RenderEvent.NEXT)\n        }\n    }\n\n    public render(callback?: IFunction): void {\n        if (!(this.running && this.canvas.view)) return this.update()\n\n        const { target } = this\n        this.times = 0\n        this.totalBounds = new Bounds()\n\n        debug.log(target.innerName, '--->')\n\n        try {\n            this.emitRender(RenderEvent.START)\n            this.renderOnce(callback)\n            this.emitRender(RenderEvent.END, this.totalBounds)\n\n            ImageManager.clearRecycled()\n        } catch (e) {\n            this.rendering = false\n            debug.error(e)\n        }\n\n        debug.log('-------------|')\n    }\n\n    public renderAgain(): void {\n        if (this.rendering) {\n            this.waitAgain = true\n        } else {\n            this.renderOnce()\n        }\n    }\n\n    public renderOnce(callback?: IFunction): void {\n        if (this.rendering) return debug.warn('rendering')\n        if (this.times > 3) return debug.warn('render max times')\n\n        this.times++\n        this.totalTimes++\n\n        this.rendering = true\n        this.changed = false\n        this.renderBounds = new Bounds()\n        this.renderOptions = {}\n\n        if (callback) {\n            this.emitRender(RenderEvent.BEFORE)\n            callback()\n        } else {\n            this.requestLayout()\n\n            if (this.ignore) {\n                this.ignore = this.rendering = false // 仍保留 updateBlocks 用于下次渲染\n                return\n            }\n\n            this.emitRender(RenderEvent.BEFORE)\n\n            if (this.config.usePartRender && this.totalTimes > 1) {\n                this.partRender()\n            } else {\n                this.fullRender()\n            }\n        }\n\n        this.emitRender(RenderEvent.RENDER, this.renderBounds, this.renderOptions)\n        this.emitRender(RenderEvent.AFTER, this.renderBounds, this.renderOptions)\n\n        this.updateBlocks = null\n        this.rendering = false\n\n        if (this.waitAgain) {\n            this.waitAgain = false\n            this.renderOnce()\n        }\n    }\n\n    public partRender(): void {\n        const { canvas, updateBlocks: list } = this\n        if (!list) return // debug.warn('PartRender: need update attr')\n\n        this.mergeBlocks()\n        list.forEach(block => { if (canvas.bounds.hit(block) && !block.isEmpty()) this.clipRender(block) })\n    }\n\n    public clipRender(block: IBounds): void {\n        const t = Run.start('PartRender')\n        const { canvas } = this, bounds = block.getIntersect(canvas.bounds), realBounds = new Bounds(bounds)\n\n        canvas.save()\n\n        bounds.spread(Renderer.clipSpread).ceil() // 局部渲染区域需扩大一些，避免出现残影\n\n        const { ceilPartPixel } = this.config\n        canvas.clipWorld(bounds, ceilPartPixel)\n        canvas.clearWorld(bounds, ceilPartPixel)\n\n        this.__render(bounds, realBounds)\n        canvas.restore()\n\n        Run.end(t)\n    }\n\n    public fullRender(): void {\n        const t = Run.start('FullRender')\n        const { canvas } = this\n\n        canvas.save()\n        canvas.clear()\n        this.__render(canvas.bounds)\n        canvas.restore()\n\n        Run.end(t)\n    }\n\n    protected __render(bounds: IBounds, realBounds?: IBounds): void {\n        const { canvas, target } = this, includes = bounds.includes(target.__world), options: IRenderOptions = includes ? { includes } : { bounds, includes }\n\n        if (this.needFill) canvas.fillWorld(bounds, this.config.fill)\n        if (Debug.showRepaint) Debug.drawRepaint(canvas, bounds)\n\n        if (this.config.useCellRender) options.cellList = this.getCellList()\n\n        Platform.render(target, canvas, options)\n\n        this.renderBounds = realBounds = realBounds || bounds\n        this.renderOptions = options\n        this.totalBounds.isEmpty() ? this.totalBounds = realBounds : this.totalBounds.add(realBounds)\n\n        canvas.updateRender(realBounds)\n    }\n\n    // need rewrite\n    getCellList(): ILeafList {\n        return undefined\n    }\n\n    public addBlock(block: IBounds): void {\n        if (!this.updateBlocks) this.updateBlocks = []\n        this.updateBlocks.push(block)\n    }\n\n    public mergeBlocks(): void {\n        const { updateBlocks: list } = this\n        if (list) {\n            const bounds = new Bounds()\n            bounds.setList(list)\n            list.length = 0\n            list.push(bounds)\n        }\n    }\n\n    protected __requestRender(): void {\n        const target = this.target as ILeaferBase\n        if (this.requestTime || !target) return\n        if (target.parentApp) return target.parentApp.requestRender(false) // App 模式下统一走 app 控制渲染帧\n\n        this.requestTime = this.frameTime || Date.now()\n\n        const render = () => {\n\n            const nowFPS = 1000 / ((this.frameTime = Date.now()) - this.requestTime)\n\n            const { maxFPS } = this.config\n            if (maxFPS && nowFPS > maxFPS) return Platform.requestRender(render)\n\n            const { frames } = this\n            if (frames.length > 30) frames.shift()\n            frames.push(nowFPS)\n            this.FPS = Math.round(frames.reduce((a, b) => a + b, 0) / frames.length) // 帧率采样\n            this.requestTime = 0\n\n            this.checkRender()\n\n        }\n\n        Platform.requestRender(render)\n    }\n\n    protected __onResize(e: ResizeEvent): void {\n        if (this.canvas.unreal) return\n        if (e.bigger || !e.samePixelRatio) {\n            const { width, height } = e.old\n            const bounds = new Bounds(0, 0, width, height)\n            if (!bounds.includes(this.target.__world) || this.needFill || !e.samePixelRatio) {\n                this.addBlock(this.canvas.bounds)\n                this.target.forceUpdate('surface')\n                return\n            }\n        }\n\n        // 需要象征性派发一下渲染事件\n        this.addBlock(new Bounds(0, 0, 1, 1))\n        this.update()\n    }\n\n    protected __onLayoutEnd(event: LayoutEvent): void {\n        if (event.data) event.data.map(item => {\n            let empty: boolean\n            if (item.updatedList) item.updatedList.list.some(leaf => {\n                empty = (!leaf.__world.width || !leaf.__world.height)\n                if (empty) {\n                    if (!leaf.isLeafer) debug.tip(leaf.innerName, ': empty')\n                    empty = (!leaf.isBranch || leaf.isBranchLeaf) // render object\n                }\n                return empty\n            })\n            this.addBlock(empty ? this.canvas.bounds : item.updatedBounds)\n        })\n    }\n\n    protected emitRender(type: string, bounds?: IBounds, options?: IRenderOptions): void {\n        this.target.emitEvent(new RenderEvent(type, this.times, bounds, options))\n    }\n\n    protected __listenEvents(): void {\n        this.__eventIds = [\n            this.target.on_([\n                [RenderEvent.REQUEST, this.update, this],\n                [LayoutEvent.END, this.__onLayoutEnd, this],\n                [RenderEvent.AGAIN, this.renderAgain, this],\n                [ResizeEvent.RESIZE, this.__onResize, this]\n            ])\n        ]\n    }\n\n    protected __removeListenEvents(): void {\n        this.target.off_(this.__eventIds)\n    }\n\n    public destroy(): void {\n        if (this.target) {\n            this.stop()\n            this.__removeListenEvents()\n            this.config = {}\n            this.target = this.canvas = null\n        }\n    }\n}", "import { ILeaf, ILeafList, IPointData, IRadiusPointData, IPickResult, IPickOptions, ISelector, IPickBottom, IPicker, ILeaferBase, ILeafData } from '@leafer/interface'\nimport { BoundsHelper, LeafList, LeafHelper, PointHelper } from '@leafer/core'\n\n\nconst tempPoint = {} as IRadiusPointData\nconst { copyRadiusPoint } = PointHelper\nconst { hitRadiusPoint } = BoundsHelper\n\n\nexport class Picker implements IPicker {\n\n    protected target?: ILeaf\n    protected selector: ISelector\n\n    protected findList: ILeafList\n    protected exclude: ILeafList\n\n    protected point: IRadiusPointData\n\n    constructor(target: ILeaf, selector: ISelector) {\n        this.target = target\n        this.selector = selector\n    }\n\n    public getByPoint(hitPoint: IPointData, hitRadius: number, options?: IPickOptions): IPickResult {\n        if (!hitRadius) hitRadius = 0\n        if (!options) options = {}\n\n        const through = options.through || false\n        const ignoreHittable = options.ignoreHittable || false\n        const target = options.target || this.target\n        this.exclude = options.exclude || null\n\n        this.point = { x: hitPoint.x, y: hitPoint.y, radiusX: hitRadius, radiusY: hitRadius }\n        this.findList = new LeafList(options.findList)\n\n        // path\n        if (!options.findList) this.hitBranch(target.isBranchLeaf ? { children: [target] } as ILeaf : target)  // 包含through元素\n\n        const { list } = this.findList\n        const leaf = this.getBestMatchLeaf(list, options.bottomList, ignoreHittable, !!options.findList)\n        const path = ignoreHittable ? this.getPath(leaf) : this.getHitablePath(leaf)\n\n        this.clear()\n\n        return through ? { path, target: leaf, throughPath: list.length ? this.getThroughPath(list) : path } : { path, target: leaf }\n    }\n\n    public hitPoint(hitPoint: IPointData, hitRadius: number, options?: IPickOptions): boolean {\n        return !!this.getByPoint(hitPoint, hitRadius, options).target // 后期需进行优化 ！！！\n    }\n\n    public getBestMatchLeaf(list: ILeaf[], bottomList: IPickBottom[], ignoreHittable: boolean, allowNull?: boolean): ILeaf {\n        const findList = this.findList = new LeafList()\n\n        if (list.length) {\n            let find: ILeaf\n            const { x, y } = this.point\n            const point = { x, y, radiusX: 0, radiusY: 0 }\n            for (let i = 0, len = list.length; i < len; i++) {\n                find = list[i]\n                if (ignoreHittable || LeafHelper.worldHittable(find)) {\n                    this.hitChild(find, point)\n                    if (findList.length) {\n                        if (find.isBranchLeaf && list.some(item => item !== find && LeafHelper.hasParent(item, find))) {\n                            findList.reset()\n                            break // Frame / Box 同时碰撞到子元素时，忽略自身，优先选中子元素\n                        }\n                        return findList.list[0]\n                    }\n                }\n            }\n        }\n\n        if (bottomList) { // 底部虚拟元素，一般为编辑器的虚拟框\n            for (let i = 0, len = bottomList.length; i < len; i++) {\n                this.hitChild(bottomList[i].target, this.point, bottomList[i].proxy)\n                if (findList.length) return findList.list[0]\n            }\n        }\n\n        if (allowNull) return null\n        return ignoreHittable ? list[0] : list.find(item => LeafHelper.worldHittable(item))\n    }\n\n    public getPath(leaf: ILeaf): LeafList {\n        const path = new LeafList(), syncList = [], { target } = this\n\n        while (leaf) {\n            if (leaf.syncEventer) syncList.push(leaf.syncEventer)\n            path.add(leaf)\n            leaf = leaf.parent\n            if (leaf === target) break\n        }\n\n        // 存在同步触发\n        if (syncList.length) {\n            syncList.forEach(item => {\n                while (item) {\n                    if (item.__.hittable) path.add(item)\n                    item = item.parent\n                    if (item === target) break\n                }\n            })\n        }\n\n        if (target) path.add(target)\n        return path\n    }\n\n    public getHitablePath(leaf: ILeaf): LeafList {\n        const path = this.getPath(leaf && leaf.hittable ? leaf : null)\n        let item: ILeaf, hittablePath = new LeafList()\n        for (let i = path.list.length - 1; i > -1; i--) {\n            item = path.list[i]\n            if (!item.__.hittable) break\n            hittablePath.addAt(item, 0)\n            if (!item.__.hitChildren || (item.isLeafer && (item as ILeaferBase).mode === 'draw')) break\n        }\n        return hittablePath\n    }\n\n    public getThroughPath(list: ILeaf[]): LeafList {\n        const throughPath = new LeafList()\n        const pathList: ILeafList[] = []\n\n        for (let i = list.length - 1; i > -1; i--) {\n            pathList.push(this.getPath(list[i]))\n        }\n\n        let path: ILeafList, nextPath: ILeafList, leaf: ILeaf\n        for (let i = 0, len = pathList.length; i < len; i++) {\n            path = pathList[i], nextPath = pathList[i + 1]\n            for (let j = 0, jLen = path.length; j < jLen; j++) {\n                leaf = path.list[j]\n                if (nextPath && nextPath.has(leaf)) break\n                throughPath.add(leaf)\n            }\n        }\n\n        return throughPath\n    }\n\n    protected hitBranch(branch: ILeaf): void {\n        this.eachFind(branch.children, branch.__onlyHitMask)\n    }\n\n    protected eachFind(children: ILeaf[], hitMask: boolean): void {\n        let child: ILeaf, hit: boolean, data: ILeafData\n        const { point } = this, len = children.length\n        for (let i = len - 1; i > -1; i--) {\n            child = children[i], data = child.__\n            if (!data.visible || (hitMask && !data.mask)) continue\n            hit = hitRadiusPoint(child.__world, data.hitRadius ? copyRadiusPoint(tempPoint, point, data.hitRadius) : point)\n\n            if (child.isBranch) {\n                if (hit || child.__ignoreHitWorld) {\n                    if (child.isBranchLeaf && data.__clipAfterFill && !child.__hitWorld(point, true)) continue // 裁剪的Box需要先检测自身是否碰撞到\n                    if (child.topChildren) this.eachFind(child.topChildren, false) // 滚动条等覆盖物\n                    this.eachFind(child.children, child.__onlyHitMask)\n                    if (child.isBranchLeaf) this.hitChild(child, point) // Box / Frame\n                }\n            } else {\n                if (hit) this.hitChild(child, point)\n            }\n        }\n    }\n\n    protected hitChild(child: ILeaf, point: IRadiusPointData, proxy?: ILeaf): void {\n        if (this.exclude && this.exclude.has(child)) return\n        if (child.__hitWorld(point)) {\n            const { parent } = child\n            if (parent && parent.__hasMask && !child.__.mask) {\n\n                let findMasks: ILeaf[] = [], item: ILeaf\n                const { children } = parent\n\n                for (let i = 0, len = children.length; i < len; i++) {\n                    item = children[i]\n                    if (item.__.mask) findMasks.push(item)\n                    if (item === child) {\n                        if (findMasks && !findMasks.every(value => value.__hitWorld(point))) return // 遮罩上层的元素，与遮罩相交的区域才能响应事件\n                        break\n                    }\n                }\n\n            }\n            this.findList.add(proxy || child)\n        }\n    }\n\n    protected clear(): void {\n        this.point = null\n        this.findList = null\n        this.exclude = null\n    }\n\n    public destroy(): void {\n        this.clear()\n    }\n\n}", "import { ILeaf, ISelector, ISelectorProxy, IPickResult, IPickOptions, IPointData, ISelectorConfig, IFinder, IFindMethod, IFindCondition, IPicker } from '@leafer/interface'\nimport { Creator, DataHelper, Plugin, Platform } from '@leafer/core'\n\nimport { Picker } from './Picker'\n\n\nexport class Selector implements ISelector {\n\n    public target?: ILeaf // target 不存在时，为临时选择器（不能缓存数据）\n    public proxy?: ISelectorProxy // editor\n\n    public config: ISelectorConfig = {}\n\n    public picker: IPicker\n    public finder?: IFinder\n\n    constructor(target: ILeaf, userConfig?: ISelectorConfig) {\n        if (userConfig) this.config = DataHelper.default(userConfig, this.config)\n        this.picker = new Picker(this.target = target, this)\n        this.finder = Creator.finder && Creator.finder()\n    }\n\n    public getByPoint(hitPoint: IPointData, hitRadius: number, options?: IPickOptions): IPickResult {\n        const { target, picker } = this\n        if (Platform.backgrounder) target && target.updateLayout()\n        return picker.getByPoint(hitPoint, hitRadius, options)\n    }\n\n    public hitPoint(hitPoint: IPointData, hitRadius: number, options?: IPickOptions): boolean {\n        return this.picker.hitPoint(hitPoint, hitRadius, options)\n    }\n\n    // @leafer-in/find will rewrite\n    public getBy(condition: number | string | IFindCondition | IFindMethod, branch?: ILeaf, one?: boolean, options?: any): ILeaf | ILeaf[] {\n        return this.finder ? this.finder.getBy(condition, branch, one, options) : Plugin.need('find')\n    }\n\n    public destroy(): void {\n        this.picker.destroy()\n        if (this.finder) this.finder.destroy()\n    }\n\n}", "// leafer's partner, allow replace\nexport * from '@leafer/watcher'\nexport * from '@leafer/layouter'\nexport * from '@leafer/renderer'\nexport * from '@leafer/selector'\n\nimport { ICreator, ILeaf, ILeaferCanvas, IRenderOptions } from '@leafer/interface'\nimport { Creator, LeafList, Platform } from '@leafer/core'\n\nimport { Watcher } from '@leafer/watcher'\nimport { Layouter } from '@leafer/layouter'\nimport { Renderer } from '@leafer/renderer'\nimport { Selector } from '@leafer/selector'\n\n\nObject.assign(Creator, {\n    watcher: (target, options?) => new Watcher(target, options),\n    layouter: (target, options?) => new Layouter(target, options),\n    renderer: (target, canvas, options?) => new Renderer(target, canvas, options),\n    selector: (target?, options?) => new Selector(target, options)\n} as ICreator)\n\nPlatform.layout = Layouter.fullLayout\nPlatform.render = function (target: ILeaf, canvas: ILeaferCanvas, options: IRenderOptions): void {\n    const topOptions: IRenderOptions = { ...options, topRendering: true }\n    options.topList = new LeafList()\n    target.__render(canvas, options)\n    if (options.topList.length) options.topList.forEach(item => item.__render(canvas, topOptions))\n}", "import { IPointData, IPointerEvent, PointerType } from '@leafer/interface'\nimport { InteractionHelper } from '@leafer-ui/core'\n\n\nexport const PointerEventHelper = {\n\n    convert(e: PointerEvent, local: IPointData): IPointerEvent {\n        const base = InteractionHelper.getBase(e), { x, y } = local\n        const data: IPointerEvent = {\n            ...base,\n            x,\n            y,\n            width: e.width,\n            height: e.height,\n            pointerType: e.pointerType as PointerType,\n            pressure: e.pressure,\n        }\n\n        if (data.pointerType === 'pen') {\n            data.tangentialPressure = e.tangentialPressure\n            data.tiltX = e.tiltX\n            data.tiltY = e.tiltY\n            data.twist = e.twist\n        }\n        return data\n    },\n\n    convertMouse(e: MouseEvent, local: IPointData): IPointerEvent {\n        const base = InteractionHelper.getBase(e), { x, y } = local\n        return {\n            ...base,\n            x,\n            y,\n            width: 1,\n            height: 1,\n            pointerType: 'mouse',\n            pressure: 0.5,\n        }\n    },\n\n    convertTouch(e: TouchEvent, local: IPointData): IPointerEvent {\n        const touch = PointerEventHelper.getTouch(e)\n        const base = InteractionHelper.getBase(e), { x, y } = local\n        return {\n            ...base,\n            x,\n            y,\n            width: 1,\n            height: 1,\n            pointerType: 'touch',\n            multiTouch: e.touches.length > 1,\n            pressure: touch.force,\n        }\n    },\n\n    getTouch(e: TouchEvent): Touch {\n        return e.targetTouches[0] || e.changedTouches[0]\n    }\n\n}", "import { IKeyCodes, IKeyEvent } from '@leafer/interface'\nimport { InteractionHelper } from '@leafer-ui/core'\n\n\nexport const KeyEventHelper = {\n\n    convert(e: KeyboardEvent): IKeyEvent {\n        const base = InteractionHelper.getBase(e)\n        const data: IKeyEvent = {\n            ...base,\n            code: e.code as IKeyCodes,\n            key: e.key\n        }\n        return data\n    }\n\n}", "import { IObject, IPointData, ITimer, IKeepTouchData, ICursorType, IClientPointData, IZoomEvent, IRotateEvent } from '@leafer/interface'\nimport { MathHelper, isArray, isObject, isString } from '@leafer/core'\nimport { InteractionBase, InteractionHelper, Cursor } from '@leafer-ui/core'\n\nimport { PointerEventHelper } from './PointerEventHelper'\nimport { KeyEventHelper } from './KeyEventHelper'\n\n\ninterface IGestureEvent extends IClientPointData, UIEvent {\n    scale: number\n    rotation: number\n    preventDefault(): void\n}\n\n\nconst { pathCanDrag } = InteractionHelper\n\nexport class Interaction extends InteractionBase {\n\n    protected view: HTMLElement\n\n    protected viewEvents: IObject\n    protected windowEvents: IObject\n\n    protected usePointer: boolean\n    protected useMultiTouch: boolean\n    protected useTouch: boolean\n\n    protected get notPointer(): boolean { const { p } = this; return p.type !== 'pointer' || p.touch || this.useMultiTouch }\n    protected get notTouch(): boolean { const { p } = this; return p.type === 'mouse' || this.usePointer }\n    protected get notMouse(): boolean { return this.usePointer || this.useTouch }\n\n    protected touchTimer: ITimer\n    protected touches?: Touch[]\n    protected lastGestureScale: number\n    protected lastGestureRotation: number\n\n    protected __listenEvents(): void {\n        super.__listenEvents()\n\n        const view = this.view = this.canvas.view as HTMLCanvasElement\n\n        // PointerEvent > TouchEvent > MouseEvent\n        this.viewEvents = {\n            'pointerdown': this.onPointerDown,\n            'mousedown': this.onMouseDown,\n            'touchstart': this.onTouchStart,\n            'pointerleave': this.onPointerLeave,\n\n            'contextmenu': this.onContextMenu,\n\n            'wheel': this.onWheel,\n            'gesturestart': this.onGesturestart,\n            'gesturechange': this.onGesturechange,\n            'gestureend': this.onGestureend\n        }\n\n        this.windowEvents = {\n            'pointermove': this.onPointerMove,\n            'pointerup': this.onPointerUp,\n            'pointercancel': this.onPointerCancel,\n\n            'mousemove': this.onMouseMove,\n            'mouseup': this.onMouseUp,\n\n            // touch / multitouch\n            'touchmove': this.onTouchMove,\n            'touchend': this.onTouchEnd,\n            'touchcancel': this.onTouchCancel,\n\n            'keydown': this.onKeyDown,\n            'keyup': this.onKeyUp,\n\n            'scroll': this.onScroll\n        }\n\n        const { viewEvents, windowEvents } = this\n\n        for (let name in viewEvents) {\n            viewEvents[name] = viewEvents[name].bind(this)\n            view.addEventListener(name, viewEvents[name])\n        }\n\n        for (let name in windowEvents) {\n            windowEvents[name] = windowEvents[name].bind(this)\n            window.addEventListener(name, windowEvents[name])\n        }\n    }\n\n    protected __removeListenEvents(): void {\n        super.__removeListenEvents()\n\n        const { viewEvents, windowEvents } = this\n\n        for (let name in viewEvents) {\n            this.view.removeEventListener(name, viewEvents[name])\n            this.viewEvents = {}\n        }\n\n        for (let name in windowEvents) {\n            window.removeEventListener(name, windowEvents[name])\n            this.windowEvents = {}\n        }\n    }\n\n    protected getTouches(touches: TouchList): Touch[] {\n        const list: Touch[] = []\n        for (let i = 0, len = touches.length; i < len; i++) {\n            list.push(touches[i])\n        }\n        return list\n    }\n\n\n    protected preventDefaultPointer(e: UIEvent): void {\n        const { pointer } = this.config\n        if (pointer.preventDefault) e.preventDefault()\n    }\n\n    protected preventDefaultWheel(e: UIEvent): void {\n        const { wheel } = this.config\n        if (wheel.preventDefault) e.preventDefault()\n    }\n\n    protected preventWindowPointer(e: UIEvent) {\n        return !this.downData && e.target !== this.view\n    }\n\n    // key\n    protected onKeyDown(e: KeyboardEvent): void {\n        this.keyDown(KeyEventHelper.convert(e))\n    }\n\n    protected onKeyUp(e: KeyboardEvent): void {\n        this.keyUp(KeyEventHelper.convert(e))\n    }\n\n    // context menu\n\n    protected onContextMenu(e: PointerEvent): void {\n        if (this.config.pointer.preventDefaultMenu) e.preventDefault()\n        this.menu(PointerEventHelper.convert(e, this.getLocal(e)))\n    }\n\n    protected onScroll(): void {\n        this.canvas.updateClientBounds()\n    }\n\n    // pointer\n    protected onPointerDown(e: PointerEvent): void {\n        this.preventDefaultPointer(e)\n\n        if (this.notPointer) return\n        this.usePointer || (this.usePointer = true)\n        this.pointerDown(PointerEventHelper.convert(e, this.getLocal(e)))\n    }\n\n    protected onPointerMove(e: PointerEvent, isLeave?: boolean): void {\n        if (this.notPointer || this.preventWindowPointer(e)) return\n        this.usePointer || (this.usePointer = true)\n        const data = PointerEventHelper.convert(e, this.getLocal(e, true))\n        isLeave ? this.pointerHover(data) : this.pointerMove(data)\n    }\n\n    protected onPointerLeave(e: PointerEvent): void {\n        this.onPointerMove(e, true)\n    }\n\n    protected onPointerUp(e: PointerEvent): void {\n        if (this.downData) this.preventDefaultPointer(e)\n        if (this.notPointer || this.preventWindowPointer(e)) return\n        this.pointerUp(PointerEventHelper.convert(e, this.getLocal(e)))\n    }\n\n    protected onPointerCancel(): void {\n        if (this.useMultiTouch) return\n        this.pointerCancel()\n    }\n\n\n    // mouse\n    protected onMouseDown(e: MouseEvent): void {\n        this.preventDefaultPointer(e)\n\n        if (this.notMouse) return\n        this.pointerDown(PointerEventHelper.convertMouse(e, this.getLocal(e)))\n    }\n\n    protected onMouseMove(e: MouseEvent): void {\n        if (this.notMouse || this.preventWindowPointer(e)) return\n        this.pointerMove(PointerEventHelper.convertMouse(e, this.getLocal(e, true)))\n    }\n\n    protected onMouseUp(e: MouseEvent): void {\n        if (this.downData) this.preventDefaultPointer(e)\n        if (this.notMouse || this.preventWindowPointer(e)) return\n        this.pointerUp(PointerEventHelper.convertMouse(e, this.getLocal(e)))\n    }\n\n    protected onMouseCancel(): void {\n        if (this.notMouse) return\n        this.pointerCancel()\n    }\n\n\n    // touch\n    protected onTouchStart(e: TouchEvent): void {\n        const touch = PointerEventHelper.getTouch(e)\n        const local = this.getLocal(touch, true)\n        const { preventDefault } = this.config.touch\n        if (preventDefault === true || (preventDefault === 'auto' && pathCanDrag(this.findPath(local)))) e.preventDefault()\n\n        this.multiTouchStart(e)\n\n        if (this.notTouch) return\n        if (this.touchTimer) {\n            window.clearTimeout(this.touchTimer)\n            this.touchTimer = 0\n        }\n        this.useTouch = true\n        this.pointerDown(PointerEventHelper.convertTouch(e, local))\n    }\n\n    protected onTouchMove(e: TouchEvent): void {\n        this.multiTouchMove(e)\n\n        if (this.notTouch || this.preventWindowPointer(e)) return\n        const touch = PointerEventHelper.getTouch(e)\n        this.pointerMove(PointerEventHelper.convertTouch(e, this.getLocal(touch)))\n    }\n\n    protected onTouchEnd(e: TouchEvent): void {\n        this.multiTouchEnd()\n\n        if (this.notTouch || this.preventWindowPointer(e)) return\n        if (this.touchTimer) clearTimeout(this.touchTimer)\n        this.touchTimer = setTimeout(() => {\n            this.useTouch = false\n        }, 500) // stop touch > mouse\n        const touch = PointerEventHelper.getTouch(e)\n        this.pointerUp(PointerEventHelper.convertTouch(e, this.getLocal(touch)))\n    }\n\n    protected onTouchCancel(): void {\n        if (this.notTouch) return\n        this.pointerCancel()\n    }\n\n\n    // multiTouch\n    protected multiTouchStart(e: TouchEvent): void {\n        this.useMultiTouch = (e.touches.length > 1)\n        this.touches = this.useMultiTouch ? this.getTouches(e.touches) : undefined\n        if (this.useMultiTouch) this.pointerCancel()\n    }\n\n    protected multiTouchMove(e: TouchEvent): void {\n        if (!this.useMultiTouch) return\n        if (e.touches.length > 1) {\n            const touches = this.getTouches(e.touches)\n            const list = this.getKeepTouchList(this.touches, touches)\n            if (list.length > 1) {\n                this.multiTouch(InteractionHelper.getBase(e), list)\n                this.touches = touches\n            }\n        }\n    }\n\n    protected multiTouchEnd(): void {\n        this.touches = null\n        this.useMultiTouch = false\n        this.transformEnd()\n    }\n\n    protected getKeepTouchList(old: Touch[], touches: Touch[]): IKeepTouchData[] {\n        let to: Touch\n        const list: IKeepTouchData[] = []\n        old.forEach(from => {\n            to = touches.find(touch => touch.identifier === from.identifier)\n            if (to) list.push({ from: this.getLocal(from), to: this.getLocal(to) })\n        })\n        return list\n    }\n\n    protected getLocalTouchs(points: Touch[]): IPointData[] {\n        return points.map(point => this.getLocal(point))\n    }\n\n\n    // wheel\n    protected onWheel(e: WheelEvent): void {\n        this.preventDefaultWheel(e)\n        this.wheel({\n            ...InteractionHelper.getBase(e),\n            ...this.getLocal(e),\n            deltaX: e.deltaX,\n            deltaY: e.deltaY\n        })\n    }\n\n\n    // safari \n    protected onGesturestart(e: IGestureEvent): void {\n        if (this.useMultiTouch) return\n        this.preventDefaultWheel(e)\n\n        this.lastGestureScale = 1\n        this.lastGestureRotation = 0\n    }\n\n    protected onGesturechange(e: IGestureEvent): void {\n        if (this.useMultiTouch) return\n        this.preventDefaultWheel(e)\n\n        const eventBase = InteractionHelper.getBase(e)\n        Object.assign(eventBase, this.getLocal(e))\n\n        const scale = (e.scale / this.lastGestureScale)\n        const rotation = (e.rotation - this.lastGestureRotation) / Math.PI * 180 * (MathHelper.within(this.config.wheel.rotateSpeed, 0, 1) / 4 + 0.1)\n\n        this.zoom({ ...eventBase, scale: scale * scale } as IZoomEvent)\n        this.rotate({ ...eventBase, rotation } as IRotateEvent)\n\n        this.lastGestureScale = e.scale\n        this.lastGestureRotation = e.rotation\n    }\n\n    protected onGestureend(e: IGestureEvent): void {\n        if (this.useMultiTouch) return\n        this.preventDefaultWheel(e)\n\n        this.transformEnd()\n    }\n\n\n    // cursor\n    public setCursor(cursor: ICursorType | ICursorType[]): void {\n        super.setCursor(cursor)\n        const list: ICursorType[] = []\n        this.eachCursor(cursor, list)\n        if (isObject(list[list.length - 1])) list.push('default')\n        this.canvas.view.style.cursor = list.map(item => (isObject(item)) ? `url(${item.url}) ${item.x || 0} ${item.y || 0}` : item).join(',')\n    }\n\n    protected eachCursor(cursor: ICursorType | ICursorType[], list: ICursorType[], level = 0): void {\n        level++\n        if (isArray(cursor)) {\n            cursor.forEach(item => this.eachCursor(item, list, level))\n        } else {\n            const custom = isString(cursor) && Cursor.get(cursor)\n            if (custom && level < 2) {\n                this.eachCursor(custom, list, level)\n            } else {\n                list.push(cursor)\n            }\n        }\n    }\n\n    public destroy(): void {\n        if (this.view) {\n            super.destroy()\n            this.view = null\n            this.touches = null\n        }\n    }\n\n}", "import { ILeaferCanvas, IRenderOptions } from '@leafer/interface'\n\nimport { IImagePaint, ILeafPaint, IUI } from '@leafer-ui/interface'\nimport { PaintImage, Paint } from \"@leafer-ui/draw\"\n\n\nexport function fill(fill: string, ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions): void {\n    canvas.fillStyle = fill\n    fillPathOrText(ui, canvas, renderOptions)\n}\n\n\nexport function fills(fills: ILeafPaint[], ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions): void {\n    let item: ILeafPaint, originPaint: IImagePaint, countImage: number\n    for (let i = 0, len = fills.length; i < len; i++) {\n        item = fills[i], originPaint = item.originPaint as IImagePaint\n\n        if (item.image) {\n\n            countImage ? countImage++ : countImage = 1\n\n            if (PaintImage.checkImage(item, !ui.__.__font, ui, canvas, renderOptions)) continue\n\n            if (!item.style) {\n                if (countImage === 1 && item.image.isPlacehold) ui.drawImagePlaceholder(item, canvas, renderOptions) // 图片加载中或加载失败\n                continue\n            }\n\n        }\n\n        canvas.fillStyle = item.style\n\n        if (item.transform || originPaint.scaleFixed) {\n\n            canvas.save()\n            if (item.transform) canvas.transform(item.transform)\n            if (originPaint.scaleFixed) {\n                const { scaleX, scaleY } = ui.getRenderScaleData(true)\n                if (originPaint.scaleFixed === true || (originPaint.scaleFixed === 'zoom-in' && scaleX > 1 && scaleY > 1)) canvas.scale(1 / scaleX, 1 / scaleY)\n            }\n            if (originPaint.blendMode) canvas.blendMode = originPaint.blendMode\n            fillPathOrText(ui, canvas, renderOptions)\n            canvas.restore()\n\n        } else {\n\n            if (originPaint.blendMode) {\n\n                canvas.saveBlendMode(originPaint.blendMode)\n                fillPathOrText(ui, canvas, renderOptions)\n                canvas.restoreBlendMode()\n\n            } else fillPathOrText(ui, canvas, renderOptions)\n\n        }\n\n    }\n}\n\n\nexport function fillPathOrText(ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions): void {\n    ui.__.__font ? Paint.fillText(ui, canvas, renderOptions) : (ui.__.windingRule ? canvas.fill(ui.__.windingRule) : canvas.fill())\n}", "import { ILeaferCanvas, IRenderOptions } from '@leafer/interface'\nimport { LeafHelper, isObject } from \"@leafer/core\"\n\nimport { IUI, ILeafPaint } from '@leafer-ui/interface'\nimport { Paint } from '@leafer-ui/draw'\n\n\nexport function stroke(stroke: string, ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions): void {\n    const data = ui.__\n    if (!data.__strokeWidth) return\n\n    if (data.__font) {\n\n        Paint.strokeText(stroke, ui, canvas, renderOptions)\n\n    } else {\n\n        switch (data.strokeAlign) {\n            case 'center':\n                drawCenter(stroke, 1, ui, canvas, renderOptions)\n                break\n            case 'inside':\n                drawInside(stroke, ui, canvas, renderOptions)\n                break\n            case 'outside':\n                drawOutside(stroke, ui, canvas, renderOptions)\n                break\n        }\n\n    }\n}\n\n\nexport function strokes(strokes: ILeafPaint[], ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions): void {\n    Paint.stroke(strokes as any, ui, canvas, renderOptions)\n}\n\n\nfunction drawCenter(stroke: string | ILeafPaint[], strokeWidthScale: number, ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions) {\n    const data = ui.__\n    if (isObject(stroke)) {\n        Paint.drawStrokesStyle(stroke, strokeWidthScale, false, ui, canvas, renderOptions)\n    } else {\n        canvas.setStroke(stroke, data.__strokeWidth * strokeWidthScale, data)\n        canvas.stroke()\n    }\n\n    if (data.__useArrow) Paint.strokeArrow(stroke, ui, canvas, renderOptions)\n}\n\nfunction drawInside(stroke: string | ILeafPaint[], ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions) {\n    canvas.save()\n    canvas.clipUI(ui)\n\n    drawCenter(stroke, 2, ui, canvas, renderOptions)\n    canvas.restore()\n}\n\nfunction drawOutside(stroke: string | ILeafPaint[], ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions) {\n    const data = ui.__\n    if (data.__fillAfterStroke) {\n\n        drawCenter(stroke, 2, ui, canvas, renderOptions)\n\n    } else {\n        const { renderBounds } = ui.__layout\n        const out = canvas.getSameCanvas(true, true)\n        ui.__drawRenderPath(out)\n\n        drawCenter(stroke, 2, ui, out, renderOptions)\n\n        out.clipUI(data)\n        out.clearWorld(renderBounds)\n\n        LeafHelper.copyCanvasByWorld(ui, canvas, out)\n\n        out.recycle(ui.__nowWorld)\n    }\n}\n", "import { ILeaferCanvas, IRenderOptions } from '@leafer/interface'\nimport { LeafHelper, isObject } from \"@leafer/core\"\n\nimport { IUI, ITextRowData, ILeafPaint, IStrokeAlign, ILeafStrokePaint } from '@leafer-ui/interface'\nimport { PaintImage, Paint } from \"@leafer-ui/draw\"\n\n\nexport function strokeText(stroke: string | ILeafPaint[], ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions): void {\n    switch (ui.__.strokeAlign) {\n        case 'center':\n            drawCenter(stroke, 1, ui, canvas, renderOptions)\n            break\n        case 'inside':\n            drawAlign(stroke, 'inside', ui, canvas, renderOptions)\n            break\n        case 'outside':\n            ui.__.__fillAfterStroke ? drawCenter(stroke, 2, ui, canvas, renderOptions) : drawAlign(stroke, 'outside', ui, canvas, renderOptions)\n            break\n    }\n}\n\nfunction drawCenter(stroke: string | ILeafPaint[], strokeWidthScale: number, ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions): void {\n    const data = ui.__\n    if (isObject(stroke)) {\n        Paint.drawStrokesStyle(stroke, strokeWidthScale, true, ui, canvas, renderOptions)\n    } else {\n        canvas.setStroke(stroke, data.__strokeWidth * strokeWidthScale, data)\n        Paint.drawTextStroke(ui, canvas, renderOptions)\n    }\n}\n\nfunction drawAlign(stroke: string | ILeafPaint[], align: IStrokeAlign, ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions): void {\n    const out = canvas.getSameCanvas(true, true)\n    out.font = ui.__.__font\n    drawCenter(stroke, 2, ui, out, renderOptions)\n\n    out.blendMode = align === 'outside' ? 'destination-out' : 'destination-in'\n    Paint.fillText(ui, out, renderOptions)\n    out.blendMode = 'normal'\n\n    LeafHelper.copyCanvasByWorld(ui, canvas, out)\n\n    out.recycle(ui.__nowWorld)\n}\n\n\nexport function drawTextStroke(ui: IUI, canvas: ILeaferCanvas, _renderOptions: IRenderOptions): void {\n\n    let row: ITextRowData, data = ui.__.__textDrawData\n    const { rows, decorationY } = data\n\n    for (let i = 0, len = rows.length; i < len; i++) {\n        row = rows[i]\n\n        if (row.text) canvas.strokeText(row.text, row.x, row.y)\n        else if (row.data) row.data.forEach(charData => { canvas.strokeText(charData.char, charData.x, row.y) })\n    }\n\n    if (decorationY) {\n        const { decorationHeight } = data\n        rows.forEach(row => decorationY.forEach(value => canvas.strokeRect(row.x, row.y + value, row.width, decorationHeight)))\n    }\n\n}\n\nexport function drawStrokesStyle(strokes: ILeafStrokePaint[], strokeWidthScale: number, isText: boolean, ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions): void {\n    let item: ILeafStrokePaint\n    const data = ui.__, { __hasMultiStrokeStyle } = data\n    __hasMultiStrokeStyle || canvas.setStroke(undefined, data.__strokeWidth * strokeWidthScale, data)\n\n    for (let i = 0, len = strokes.length; i < len; i++) {\n        item = strokes[i]\n\n        if (item.image && PaintImage.checkImage(item, false, ui, canvas, renderOptions)) continue\n\n        if (item.style) {\n            if (__hasMultiStrokeStyle) {\n                const { strokeStyle } = item\n                strokeStyle ? canvas.setStroke(item.style, data.__getRealStrokeWidth(strokeStyle) * strokeWidthScale, data, strokeStyle) : canvas.setStroke(item.style, data.__strokeWidth * strokeWidthScale, data)\n            } else canvas.strokeStyle = item.style\n\n            if (item.originPaint.blendMode) {\n                canvas.saveBlendMode(item.originPaint.blendMode)\n                isText ? Paint.drawTextStroke(ui, canvas, renderOptions) : canvas.stroke()\n                canvas.restoreBlendMode()\n            } else {\n                isText ? Paint.drawTextStroke(ui, canvas, renderOptions) : canvas.stroke()\n            }\n        }\n    }\n}", "import { IBoundsData, ILeaferCanvas, IRenderOptions, IMatrix } from '@leafer/interface'\nimport { BoundsHelper, FourNumberHelper, Matrix, Platform } from '@leafer/core'\n\nimport { IUI, ICachedShape } from '@leafer-ui/interface'\n\n\nconst { getSpread, copyAndSpread, toOuterOf, getOuterOf, getByMove, move, getIntersectData } = BoundsHelper\nconst tempBounds = {} as IBoundsData\n\nexport function shape(ui: IUI, current: ILeaferCanvas, options: IRenderOptions): ICachedShape {\n    const canvas = current.getSameCanvas()\n    const currentBounds = current.bounds, nowWorld = ui.__nowWorld, layout = ui.__layout\n    const nowWorldShapeBounds = ui.__nowWorldShapeBounds || (ui.__nowWorldShapeBounds = {} as IBoundsData)\n\n    toOuterOf(layout.strokeSpread ? (copyAndSpread(tempBounds, layout.boxBounds, layout.strokeSpread), tempBounds) : layout.boxBounds, nowWorld, nowWorldShapeBounds)\n\n    let bounds: IBoundsData, renderBounds: IBoundsData, matrix: IMatrix, fitMatrix: IMatrix, shapeBounds: IBoundsData, worldCanvas: ILeaferCanvas\n\n    let { scaleX, scaleY } = ui.getRenderScaleData(true)\n\n    if (currentBounds.includes(nowWorldShapeBounds)) {\n\n        worldCanvas = canvas\n        bounds = shapeBounds = nowWorldShapeBounds\n        renderBounds = nowWorld\n\n    } else {\n\n        let worldClipBounds: IBoundsData // 作为绘制阴影的裁剪形状\n\n        if (Platform.fullImageShadow) { // fix: iOS Safari 18.5 以上, 只裁剪部分区域渲染阴影会有问题\n            worldClipBounds = nowWorldShapeBounds\n        } else {\n\n            const spreadBounds = layout.renderShapeSpread ? getSpread(currentBounds, FourNumberHelper.swapAndScale(layout.renderShapeSpread, scaleX, scaleY)) : currentBounds  // spread需要反向交换值\n            worldClipBounds = getIntersectData(spreadBounds, nowWorldShapeBounds)\n        }\n\n        fitMatrix = currentBounds.getFitMatrix(worldClipBounds)\n        let { a: fitScaleX, d: fitScaleY } = fitMatrix\n\n        if (fitMatrix.a < 1) {\n            worldCanvas = current.getSameCanvas()\n            ui.__renderShape(worldCanvas, options)\n\n            scaleX *= fitScaleX\n            scaleY *= fitScaleY\n        }\n\n\n        shapeBounds = getOuterOf(nowWorldShapeBounds, fitMatrix)\n        bounds = getByMove(shapeBounds, -fitMatrix.e, -fitMatrix.f)\n\n        renderBounds = getOuterOf(nowWorld, fitMatrix)\n        move(renderBounds, -fitMatrix.e, -fitMatrix.f)\n\n\n        const userMatrix = options.matrix\n        if (userMatrix) {\n            matrix = new Matrix(fitMatrix) // 仅用于渲染\n            matrix.multiply(userMatrix)\n            fitScaleX *= userMatrix.scaleX\n            fitScaleY *= userMatrix.scaleY\n        } else matrix = fitMatrix\n\n        matrix.withScale(fitScaleX, fitScaleY)\n        options = { ...options, matrix }\n    }\n\n    ui.__renderShape(canvas, options)\n\n    return {\n        canvas, matrix, fitMatrix, bounds, renderBounds,\n        worldCanvas, shapeBounds, scaleX, scaleY\n    }\n}", "import { DataHelper, isArray, isObject, isString, isUndefined } from '@leafer/core'\n\nimport { IUI, IPaint, ILeafPaint, IRGB, IBooleanMap, IObject, IPaintAttr, IStrokeComputedStyle } from '@leafer-ui/interface'\nimport { ColorConvert, PaintImage, PaintGradient } from '@leafer-ui/draw'\n\n\nlet recycleMap: IBooleanMap\nconst { stintSet } = DataHelper, { hasTransparent } = ColorConvert\n\nexport function compute(attrName: IPaintAttr, ui: IUI): void {\n    const data = ui.__, leafPaints: ILeafPaint[] = []\n\n    let paints: IPaint[] = data.__input[attrName], isAlphaPixel: boolean, isTransparent: boolean\n    if (!isArray(paints)) paints = [paints]\n\n    recycleMap = PaintImage.recycleImage(attrName, data)\n\n    let maxChildStrokeWidth: number\n\n    for (let i = 0, len = paints.length, item: ILeafPaint; i < len; i++) {\n        if (item = getLeafPaint(attrName, paints[i], ui)) {\n            leafPaints.push(item)\n\n            // 检测多个子描边样式和宽度\n            if (item.strokeStyle) {\n                maxChildStrokeWidth || (maxChildStrokeWidth = 1)\n                if (item.strokeStyle.strokeWidth) maxChildStrokeWidth = Math.max(maxChildStrokeWidth, item.strokeStyle.strokeWidth as number)\n            }\n        }\n    }\n\n    (data as IObject)['_' + attrName] = leafPaints.length ? leafPaints : undefined\n\n    if (leafPaints.length) {\n\n        if (leafPaints.every(item => item.isTransparent)) {\n            if (leafPaints.some(item => item.image)) isAlphaPixel = true\n            isTransparent = true\n        }\n\n        if (attrName === 'fill') {\n            stintSet(data, '__isAlphaPixelFill', isAlphaPixel)\n            stintSet(data, '__isTransparentFill', isTransparent)\n        } else {\n            stintSet(data, '__isAlphaPixelStroke', isAlphaPixel)\n            stintSet(data, '__isTransparentStroke', isTransparent)\n            stintSet(data, '__hasMultiStrokeStyle', maxChildStrokeWidth)\n        }\n\n    } else {\n        data.__removePaint(attrName, false)\n    }\n\n}\n\n\nfunction getLeafPaint(attrName: string, paint: IPaint, ui: IUI): ILeafPaint {\n    if (!isObject(paint) || paint.visible === false || paint.opacity === 0) return undefined\n\n    let leafPaint: ILeafPaint\n    const { boxBounds } = ui.__layout\n\n    switch (paint.type) {\n        case 'image':\n            if (!paint.url) return undefined\n            leafPaint = PaintImage.image(ui, attrName, paint, boxBounds, !recycleMap || !recycleMap[paint.url])\n            break\n        case 'linear':\n            leafPaint = PaintGradient.linearGradient(paint, boxBounds)\n            break\n        case 'radial':\n            leafPaint = PaintGradient.radialGradient(paint, boxBounds)\n            break\n        case 'angular':\n            leafPaint = PaintGradient.conicGradient(paint, boxBounds)\n            break\n        case 'solid':\n            const { type, color, opacity } = paint\n            leafPaint = { type, style: ColorConvert.string(color, opacity) }\n            break\n        default:\n            if (!isUndefined((paint as IRGB).r)) leafPaint = { type: 'solid', style: ColorConvert.string(paint) }\n    }\n\n    if (leafPaint) {\n        // 原始paint\n        leafPaint.originPaint = paint\n\n        // 描边样式\n        if (isString(leafPaint.style) && hasTransparent(leafPaint.style)) leafPaint.isTransparent = true\n        if (paint.style) {\n            if (paint.style.strokeWidth === 0) return undefined\n            leafPaint.strokeStyle = paint.style as IStrokeComputedStyle\n        }\n    }\n\n    return leafPaint\n}", "import { IPaintModule } from '@leafer-ui/interface'\n\nimport { fill, fills, fillPathOrText } from './Fill'\nimport { fillText } from './FillText'\nimport { stroke, strokes } from './Stroke'\nimport { strokeText, drawTextStroke, drawStrokesStyle } from './StrokeText'\nimport { shape } from './Shape'\nimport { compute } from './Compute'\n\n\nexport const PaintModule: IPaintModule = {\n    compute,\n\n    fill,\n    fills,\n    fillPathOrText,\n    fillText,\n\n    stroke,\n    strokes,\n    strokeText,\n    drawTextStroke,\n    drawStrokesStyle,\n\n    shape\n}", "import { ILeaferCanvas, IRenderOptions } from '@leafer/interface'\n\nimport { ITextRowData, IText } from '@leafer-ui/interface'\n\n\nexport function fillText(ui: IText, canvas: ILeaferCanvas, _renderOptions: IRenderOptions): void {\n\n    const data = ui.__, { rows, decorationY } = data.__textDrawData\n    if (data.__isPlacehold && data.placeholderColor) canvas.fillStyle = data.placeholderColor\n\n    let row: ITextRowData\n\n    for (let i = 0, len = rows.length; i < len; i++) {\n        row = rows[i]\n\n        if (row.text) canvas.fillText(row.text, row.x, row.y)\n        else if (row.data) row.data.forEach(charData => { canvas.fillText(charData.char, charData.x, row.y) })\n    }\n\n    if (decorationY) {\n        const { decorationColor, decorationHeight } = data.__textDrawData\n        if (decorationColor) canvas.fillStyle = decorationColor\n        rows.forEach(row => decorationY.forEach(value => canvas.fillRect(row.x, row.y + value, row.width, decorationHeight)))\n    }\n\n}\n", "import { IBoundsData, IImageEvent, ILeaferImage, IObject } from '@leafer/interface'\nimport { Bounds, BoundsHelper, ImageEvent, ImageManager } from '@leafer/core'\n\nimport { IUI, IImagePaint, ILeafPaint } from '@leafer-ui/interface'\nimport { PaintImage } from \"@leafer-ui/draw\"\n\n\ninterface IImagePaintCache {\n    leafPaint: ILeafPaint\n    paint: IImagePaint\n    boxBounds: IBoundsData\n}\n\nlet cache: IImagePaintCache, box = new Bounds()\nconst { isSame } = BoundsHelper\n\nexport function image(ui: IUI, attrName: string, paint: IImagePaint, boxBounds: IBoundsData, firstUse: boolean): ILeafPaint {\n    let leafPaint: ILeafPaint, event: IImageEvent\n    const image = ImageManager.get(paint)\n\n    if (cache && paint === cache.paint && isSame(boxBounds, cache.boxBounds)) {\n        leafPaint = cache.leafPaint\n    } else {\n        leafPaint = { type: paint.type, image }\n        if (image.hasAlphaPixel) leafPaint.isTransparent = true\n\n        cache = image.use > 1 ? { leafPaint, paint, boxBounds: box.set(boxBounds) } : null // 只保留最后一个cache\n    }\n\n    if (firstUse || image.loading) event = { image, attrName, attrValue: paint }\n\n    if (image.ready) {\n\n        checkSizeAndCreateData(ui, attrName, paint, image, leafPaint, boxBounds)\n\n        if (firstUse) {\n            onLoad(ui, event)\n            onLoadSuccess(ui, event)\n        }\n\n    } else if (image.error) {\n\n        if (firstUse) onLoadError(ui, event, image.error)\n\n    } else { // need load\n\n        if (firstUse) {\n            ignoreRender(ui, true) // wait loaded\n            onLoad(ui, event)\n        }\n\n        leafPaint.loadId = image.load(\n            () => {\n                ignoreRender(ui, false)\n                if (!ui.destroyed) {\n                    if (checkSizeAndCreateData(ui, attrName, paint, image, leafPaint, boxBounds)) {\n                        if (image.hasAlphaPixel) ui.__layout.hitCanvasChanged = true\n                        ui.forceUpdate('surface')\n                    }\n                    onLoadSuccess(ui, event)\n                }\n                leafPaint.loadId = undefined\n            },\n            (error) => {\n                ignoreRender(ui, false)\n                onLoadError(ui, event, error)\n                leafPaint.loadId = undefined\n            },\n            paint.lod && image.getThumbSize(paint.lod)\n        )\n\n        if (ui.placeholderColor) {\n            if (!ui.placeholderDelay) image.isPlacehold = true\n            else setTimeout(() => {\n                if (!image.ready) {\n                    image.isPlacehold = true\n                    ui.forceUpdate('surface')\n                }\n            }, ui.placeholderDelay)\n        }\n\n    }\n\n    return leafPaint\n}\n\n\nfunction checkSizeAndCreateData(ui: IUI, attrName: string, paint: IImagePaint, image: ILeaferImage, leafPaint: ILeafPaint, boxBounds: IBoundsData): boolean {\n    if (attrName === 'fill' && !ui.__.__naturalWidth) {\n        const data = ui.__\n        data.__naturalWidth = image.width / data.pixelRatio\n        data.__naturalHeight = image.height / data.pixelRatio\n        if (data.__autoSide) {\n            ui.forceUpdate('width')\n            if (ui.__proxyData) {\n                ui.setProxyAttr('width', data.width)\n                ui.setProxyAttr('height', data.height)\n            }\n            return false\n        }\n    }\n\n    if (!leafPaint.data) PaintImage.createData(leafPaint, image, paint, boxBounds)\n    return true\n}\n\n\n\nfunction onLoad(ui: IUI, event: IImageEvent): void {\n    emit(ui, ImageEvent.LOAD, event)\n}\n\n\nfunction onLoadSuccess(ui: IUI, event: IImageEvent): void {\n    emit(ui, ImageEvent.LOADED, event)\n}\n\n\nfunction onLoadError(ui: IUI, event: IImageEvent, error: string | IObject,): void {\n    event.error = error\n    ui.forceUpdate('surface')\n    emit(ui, ImageEvent.ERROR, event)\n}\n\n\nfunction emit(ui: IUI, type: string, data: IImageEvent): void {\n    if (ui.hasEvent(type)) ui.emitEvent(new ImageEvent(type, data))\n}\n\nfunction ignoreRender(ui: IUI, value: boolean): void {\n    const { leafer } = ui\n    if (leafer && leafer.viewReady) leafer.renderer.ignore = value // prevent blink on hover\n}", "import { IBoundsData, IGap, ILeaferImage, IPointData, IPointGap, IScaleData } from '@leafer/interface'\nimport { MatrixHelper, MathHelper, Bounds, AlignHelper, BoundsHelper, PointHelper, isObject, isString, isNumber } from '@leafer/core'\n\nimport { IImagePaint, ILeafPaint, ILeafPaintPatternData } from '@leafer-ui/interface'\nimport { PaintImage } from \"@leafer-ui/draw\"\n\n\nconst { get, translate } = MatrixHelper\nconst tempBox = new Bounds()\nconst tempScaleData = {} as IScaleData\nconst tempImage = {} as IBoundsData\n\nexport function createData(leafPaint: ILeafPaint, image: ILeaferImage, paint: IImagePaint, box: IBoundsData): void {\n    leafPaint.data = PaintImage.getPatternData(paint, box, image)\n}\n\nexport function getPatternData(paint: IImagePaint, box: IBoundsData, image: ILeaferImage): ILeafPaintPatternData {\n    if (paint.padding) box = tempBox.set(box).shrink(paint.padding)\n    if (paint.mode === 'strench' as string) paint.mode = 'stretch' // 兼容代码，后续可移除\n\n    const { width, height } = image\n    const { opacity, mode, align, offset, scale, size, rotation, skew, clipSize, repeat, gap, filters, interlace } = paint\n    const sameBox = box.width === width && box.height === height\n\n    const data: ILeafPaintPatternData = { mode }\n    const swapSize = align !== 'center' && (rotation || 0) % 180 === 90\n    BoundsHelper.set(tempImage, 0, 0, swapSize ? height : width, swapSize ? width : height)\n\n    let scaleX: number, scaleY: number\n\n    if (!mode || mode === 'cover' || mode === 'fit') { // mode 默认值为 cover\n        if (!sameBox || rotation) {\n            scaleX = scaleY = BoundsHelper.getFitScale(box, tempImage, mode !== 'fit')\n            BoundsHelper.put(box, image, align, scaleX, false, tempImage)\n            BoundsHelper.scale(tempImage, scaleX, scaleY, true)\n        }\n    } else {\n        if (scale || size) {\n            MathHelper.getScaleData(scale, size, image, tempScaleData)\n            scaleX = tempScaleData.scaleX\n            scaleY = tempScaleData.scaleY\n        }\n\n        if (align || gap || repeat) {\n            if (scaleX) BoundsHelper.scale(tempImage, scaleX, scaleY, true)\n            if (align) AlignHelper.toPoint(align, tempImage, box, tempImage, true, true)\n        }\n    }\n\n    if (offset) PointHelper.move(tempImage, offset)\n\n    switch (mode) {\n        case 'stretch':\n            if (!sameBox) {\n                scaleX = box.width / width, scaleY = box.height / height\n                PaintImage.stretchMode(data, box, scaleX, scaleY)\n            } else if (scaleX) scaleX = scaleY = undefined\n            break\n        case 'normal':\n        case 'clip':\n            if (tempImage.x || tempImage.y || scaleX || clipSize || rotation || skew) {\n                let clipScaleX: number, clipScaleY: number\n                if (clipSize) clipScaleX = box.width / clipSize.width, clipScaleY = box.height / clipSize.height\n                PaintImage.clipMode(data, box, tempImage.x, tempImage.y, scaleX, scaleY, rotation, skew, clipScaleX, clipScaleY)\n                if (clipScaleX) scaleX = scaleX ? scaleX * clipScaleX : clipScaleX, scaleY = scaleY ? scaleY * clipScaleY : clipScaleY\n            }\n            break\n        case 'repeat':\n            if (!sameBox || scaleX || rotation || skew) PaintImage.repeatMode(data, box, width, height, tempImage.x, tempImage.y, scaleX, scaleY, rotation, skew, align, paint.freeTransform)\n            if (!repeat) data.repeat = 'repeat'\n            const count = isObject(repeat)\n            if (gap || count) data.gap = getGapData(gap, count && repeat, tempImage.width, tempImage.height, box)\n            break\n        case 'fit':\n        case 'cover':\n        default:\n            if (scaleX) PaintImage.fillOrFitMode(data, box, tempImage.x, tempImage.y, scaleX, scaleY, rotation)\n    }\n\n    if (!data.transform) {\n        if (box.x || box.y) translate(data.transform = get(), box.x, box.y)\n    }\n\n    if (scaleX) {\n        data.scaleX = scaleX\n        data.scaleY = scaleY\n    }\n\n    if (opacity && opacity < 1) data.opacity = opacity\n    if (filters) data.filters = filters\n    if (repeat) data.repeat = isString(repeat) ? (repeat === 'x' ? 'repeat-x' : 'repeat-y') : 'repeat'\n    if (interlace) data.interlace = (isNumber(interlace) || interlace.type === 'percent') ? { type: 'x', offset: interlace } : interlace\n    return data\n}\n\n\nfunction getGapData(gap: IGap | IPointGap, repeat: IPointData, width: number, height: number, box: IBoundsData): IPointData {\n    let xGap: IGap, yGap: IGap\n    if (isObject(gap)) xGap = gap.x, yGap = gap.y\n    else xGap = yGap = gap\n    return { x: getGapValue(xGap, width, box.width, repeat && repeat.x), y: getGapValue(yGap, height, box.height, repeat && repeat.y) }\n}\n\nfunction getGapValue(gap: IGap, size: number, totalSize: number, rows: number): number {\n    const auto = isString(gap) || rows\n    const remain = rows ? totalSize - rows * size : totalSize % size\n    const value = auto ? remain / ((rows || Math.floor(totalSize / size)) - 1) : gap\n    return gap === 'auto' ? (value < 0 ? 0 : value) : value\n}", "import { IBoundsData, IPointData, IMatrixData, IAlign } from '@leafer/interface'\nimport { getMatrixData, MatrixHelper } from '@leafer/core'\n\nimport { ILeafPaintPatternData } from '@leafer-ui/interface'\n\n\nlet origin = {} as IPointData, tempMatrix = getMatrixData()\nconst { get, set, rotateOfOuter, translate, scaleOfOuter, multiplyParent, scale: scaleHelper, rotate, skew: skewHelper } = MatrixHelper\n\nexport function stretchMode(data: ILeafPaintPatternData, box: IBoundsData, scaleX: number, scaleY: number): void {\n    const transform: IMatrixData = get(), { x, y } = box\n    if (x || y) translate(transform, x, y)\n    else transform.onlyScale = true\n    scaleHelper(transform, scaleX, scaleY)\n    data.transform = transform\n}\n\nexport function fillOrFitMode(data: ILeafPaintPatternData, box: IBoundsData, x: number, y: number, scaleX: number, scaleY: number, rotation: number): void {\n    const transform: IMatrixData = get()\n    translate(transform, box.x + x, box.y + y)\n    scaleHelper(transform, scaleX, scaleY)\n    if (rotation) rotateOfOuter(transform, { x: box.x + box.width / 2, y: box.y + box.height / 2 }, rotation)\n    data.transform = transform\n}\n\nexport function clipMode(data: ILeafPaintPatternData, box: IBoundsData, x: number, y: number, scaleX: number, scaleY: number, rotation: number, skew: IPointData, clipScaleX?: number, clipScaleY?: number): void {\n    const transform: IMatrixData = get()\n    layout(transform, box, x, y, scaleX, scaleY, rotation, skew)\n    if (clipScaleX) {\n        if (rotation || skew) {\n            set(tempMatrix)\n            scaleOfOuter(tempMatrix, box, clipScaleX, clipScaleY)\n            multiplyParent(transform, tempMatrix)\n        } else scaleOfOuter(transform, box, clipScaleX, clipScaleY)\n    }\n    data.transform = transform\n}\n\nexport function repeatMode(data: ILeafPaintPatternData, box: IBoundsData, width: number, height: number, x: number, y: number, scaleX: number, scaleY: number, rotation: number, skew: IPointData, align: IAlign, freeTransform?: boolean): void {\n    const transform = get()\n    if (freeTransform) { // 自由变换\n        layout(transform, box, x, y, scaleX, scaleY, rotation, skew)\n    } else {\n        if (rotation) {\n            if (align === 'center') {\n                rotateOfOuter(transform, { x: width / 2, y: height / 2 }, rotation)\n            } else {\n                rotate(transform, rotation)\n                switch (rotation) {\n                    case 90:\n                        translate(transform, height, 0)\n                        break\n                    case 180:\n                        translate(transform, width, height)\n                        break\n                    case 270:\n                        translate(transform, 0, width)\n                        break\n                }\n            }\n        }\n        origin.x = box.x + x\n        origin.y = box.y + y\n        translate(transform, origin.x, origin.y)\n        if (scaleX) scaleOfOuter(transform, origin, scaleX, scaleY)\n    }\n    data.transform = transform\n}\n\nfunction layout(transform: IMatrixData, box: IBoundsData, x: number, y: number, scaleX: number, scaleY: number, rotation: number, skew: IPointData) {\n    // rotate -> skew -> scale -> translate\n    if (rotation) rotate(transform, rotation)\n    if (skew) skewHelper(transform, skew.x, skew.y)\n    if (scaleX) scaleHelper(transform, scaleX, scaleY)\n    translate(transform, box.x + x, box.y + y)\n}\n", "/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\r\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\r\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\r\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\r\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\r\n    var _, done = false;\r\n    for (var i = decorators.length - 1; i >= 0; i--) {\r\n        var context = {};\r\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\r\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\r\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\r\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\r\n        if (kind === \"accessor\") {\r\n            if (result === void 0) continue;\r\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\r\n            if (_ = accept(result.get)) descriptor.get = _;\r\n            if (_ = accept(result.set)) descriptor.set = _;\r\n            if (_ = accept(result.init)) initializers.unshift(_);\r\n        }\r\n        else if (_ = accept(result)) {\r\n            if (kind === \"field\") initializers.unshift(_);\r\n            else descriptor[key] = _;\r\n        }\r\n    }\r\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\r\n    done = true;\r\n};\r\n\r\nexport function __runInitializers(thisArg, initializers, value) {\r\n    var useValue = arguments.length > 2;\r\n    for (var i = 0; i < initializers.length; i++) {\r\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\r\n    }\r\n    return useValue ? value : void 0;\r\n};\r\n\r\nexport function __propKey(x) {\r\n    return typeof x === \"symbol\" ? x : \"\".concat(x);\r\n};\r\n\r\nexport function __setFunctionName(f, name, prefix) {\r\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\r\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\r\n};\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\r\n    return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\r\n    function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nvar ownKeys = function(o) {\r\n    ownKeys = Object.getOwnPropertyNames || function (o) {\r\n        var ar = [];\r\n        for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\r\n        return ar;\r\n    };\r\n    return ownKeys(o);\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n\r\nexport function __addDisposableResource(env, value, async) {\r\n    if (value !== null && value !== void 0) {\r\n        if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\r\n        var dispose, inner;\r\n        if (async) {\r\n            if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\r\n            dispose = value[Symbol.asyncDispose];\r\n        }\r\n        if (dispose === void 0) {\r\n            if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\r\n            dispose = value[Symbol.dispose];\r\n            if (async) inner = dispose;\r\n        }\r\n        if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\r\n        if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\r\n        env.stack.push({ value: value, dispose: dispose, async: async });\r\n    }\r\n    else if (async) {\r\n        env.stack.push({ async: true });\r\n    }\r\n    return value;\r\n\r\n}\r\n\r\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\r\n\r\nexport function __disposeResources(env) {\r\n    function fail(e) {\r\n        env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\r\n        env.hasError = true;\r\n    }\r\n    var r, s = 0;\r\n    function next() {\r\n        while (r = env.stack.pop()) {\r\n            try {\r\n                if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\r\n                if (r.dispose) {\r\n                    var result = r.dispose.call(r.value);\r\n                    if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\r\n                }\r\n                else s |= 1;\r\n            }\r\n            catch (e) {\r\n                fail(e);\r\n            }\r\n        }\r\n        if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\r\n        if (env.hasError) throw env.error;\r\n    }\r\n    return next();\r\n}\r\n\r\nexport function __rewriteRelativeImportExtension(path, preserveJsx) {\r\n    if (typeof path === \"string\" && /^\\.\\.?\\//.test(path)) {\r\n        return path.replace(/\\.(tsx)$|((?:\\.d)?)((?:\\.[^./]+?)?)\\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {\r\n            return tsx ? preserveJsx ? \".jsx\" : \".js\" : d && (!ext || !cm) ? m : (d + ext + \".\" + cm.toLowerCase() + \"js\");\r\n        });\r\n    }\r\n    return path;\r\n}\r\n\r\nexport default {\r\n    __extends: __extends,\r\n    __assign: __assign,\r\n    __rest: __rest,\r\n    __decorate: __decorate,\r\n    __param: __param,\r\n    __esDecorate: __esDecorate,\r\n    __runInitializers: __runInitializers,\r\n    __propKey: __propKey,\r\n    __setFunctionName: __setFunctionName,\r\n    __metadata: __metadata,\r\n    __awaiter: __awaiter,\r\n    __generator: __generator,\r\n    __createBinding: __createBinding,\r\n    __exportStar: __exportStar,\r\n    __values: __values,\r\n    __read: __read,\r\n    __spread: __spread,\r\n    __spreadArrays: __spreadArrays,\r\n    __spreadArray: __spreadArray,\r\n    __await: __await,\r\n    __asyncGenerator: __asyncGenerator,\r\n    __asyncDelegator: __asyncDelegator,\r\n    __asyncValues: __asyncValues,\r\n    __makeTemplateObject: __makeTemplateObject,\r\n    __importStar: __importStar,\r\n    __importDefault: __importDefault,\r\n    __classPrivateFieldGet: __classPrivateFieldGet,\r\n    __classPrivateFieldSet: __classPrivateFieldSet,\r\n    __classPrivateFieldIn: __classPrivateFieldIn,\r\n    __addDisposableResource: __addDisposableResource,\r\n    __disposeResources: __disposeResources,\r\n    __rewriteRelativeImportExtension: __rewriteRelativeImportExtension,\r\n};\r\n", "import { ILeaferCanvas, IRenderOptions } from '@leafer/interface'\nimport { Platform, MatrixHelper, MathHelper, ImageManager } from '@leafer/core'\n\nimport { IUI, ILeafPaint, IMatrixData } from '@leafer-ui/interface'\nimport { PaintImage } from \"@leafer-ui/draw\"\n\n\nconst { get, scale, copy } = MatrixHelper\nconst { getFloorScale } = MathHelper, { abs } = Math\n\nexport function createPatternTask(paint: ILeafPaint, ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions): void {\n    if (!paint.patternTask) {\n        paint.patternTask = ImageManager.patternTasker.add(async () => {\n            PaintImage.createPattern(paint, ui, canvas, renderOptions)\n            ui.forceUpdate('surface')\n        }, 0, () => {\n            paint.patternTask = null\n            return canvas.bounds.hit(ui.__nowWorld)\n        })\n    }\n}\n\nexport function createPattern(paint: ILeafPaint, ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions): void {\n    let { scaleX, scaleY } = PaintImage.getImageRenderScaleData(paint, ui, canvas, renderOptions), id = scaleX + '-' + scaleY\n\n    if (paint.patternId !== id && !ui.destroyed) {\n        if (!(Platform.image.isLarge(paint.image, scaleX, scaleY) && !paint.data.repeat)) {\n\n            const { image, data } = paint, { transform, gap } = data, fixScale = PaintImage.getPatternFixScale(paint, scaleX, scaleY)\n            let imageMatrix: IMatrixData, xGap: number, yGap: number, { width, height } = image\n\n            if (fixScale) scaleX *= fixScale, scaleY *= fixScale\n\n            width *= scaleX\n            height *= scaleY\n\n            // 平铺间距\n            if (gap) {\n                xGap = gap.x * scaleX / abs(data.scaleX || 1)\n                yGap = gap.y * scaleY / abs(data.scaleY || 1)\n            }\n\n            if (transform || scaleX !== 1 || scaleY !== 1) {\n                scaleX *= getFloorScale(width + (xGap || 0)) // 缩放至floor画布宽高的状态\n                scaleY *= getFloorScale(height + (yGap || 0))\n\n                imageMatrix = get()\n                if (transform) copy(imageMatrix, transform)\n                scale(imageMatrix, 1 / scaleX, 1 / scaleY)\n            }\n\n            const imageCanvas = image.getCanvas(width, height, data.opacity, data.filters, xGap, yGap, ui.leafer && ui.leafer.config.smooth, data.interlace)\n            const pattern = image.getPattern(imageCanvas, data.repeat || (Platform.origin.noRepeat || 'no-repeat'), imageMatrix, paint)\n\n            paint.style = pattern\n            paint.patternId = id\n\n        }\n    }\n}\n\nexport function getPatternFixScale(paint: ILeafPaint, imageScaleX: number, imageScaleY: number): number {\n    const { image } = paint\n    let fixScale: number, maxSize = Platform.image.maxPatternSize, imageSize = image.width * image.height\n\n    if (image.isSVG) {\n        if (imageScaleX > 1) fixScale = Math.ceil(imageScaleX) / imageScaleX // fix: svg按整数倍放大，避免产生加深线条\n    } else {\n        if (maxSize > imageSize) maxSize = imageSize // 防止大于元素自身宽高\n    }\n\n    if ((imageSize *= imageScaleX * imageScaleY) > maxSize) fixScale = Math.sqrt(maxSize / imageSize)\n    return fixScale\n}", "import { IPaintImageModule } from '@leafer-ui/interface'\n\nimport { image } from './image'\nimport { createData, getPatternData } from './data'\nimport { fillOrFitMode, clipMode, repeatMode, stretchMode } from './mode'\nimport { createPatternTask, createPattern, getPatternFixScale } from './pattern'\nimport { checkImage, drawImage, getImageRenderScaleData } from './check'\nimport { recycleImage } from './recycle'\n\n\nexport const PaintImageModule: IPaintImageModule = {\n    image,\n\n    checkImage,\n    drawImage,\n    getImageRenderScaleData,\n    recycleImage,\n\n    createPatternTask,\n    createPattern,\n    getPatternFixScale,\n\n    createData,\n    getPatternData,\n\n    stretchMode,\n    fillOrFitMode,\n    clipMode,\n    repeatMode\n}", "import { ILeaferCanvas, IRenderOptions, IScaleData } from '@leafer/interface'\nimport { Platform, ResizeEvent } from '@leafer/core'\n\nimport { IUI, ILeafPaint, IImagePaint } from '@leafer-ui/interface'\nimport { PaintImage } from \"@leafer-ui/draw\"\n\n\nexport function checkImage(paint: ILeafPaint, drawImage: boolean, ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions): boolean {\n    const { scaleX, scaleY } = PaintImage.getImageRenderScaleData(paint, ui, canvas, renderOptions)\n    const { image, data, originPaint } = paint, { exporting, snapshot } = renderOptions\n\n    if (!data || (paint.patternId === scaleX + '-' + scaleY && !exporting) || snapshot) {\n        return false // 生成图案中\n    } else {\n\n        if (drawImage) {\n            if (data.repeat) {\n                drawImage = false\n            } else if (!((originPaint as IImagePaint).changeful || (Platform.name === 'miniapp' && ResizeEvent.isResizing(ui)) || exporting)) { //  小程序resize过程中直接绘制原图（绕过垃圾回收bug)\n                drawImage = Platform.image.isLarge(image, scaleX, scaleY) || image.width * scaleX > 8096 || image.height * scaleY > 8096 // 大长图单边超过8096生成pattern会有问题\n            }\n        }\n\n        if (drawImage) {\n            if (ui.__.__isFastShadow) { // fix: 快速阴影时，直接 drawImage 会无阴影，需fill一下\n                canvas.fillStyle = paint.style || '#000'\n                canvas.fill()\n            }\n            PaintImage.drawImage(paint, scaleX, scaleY, ui, canvas, renderOptions) // 直接绘制图像，不生成图案\n            return true\n        } else {\n            if (!paint.style || (originPaint as IImagePaint).sync || exporting) PaintImage.createPattern(paint, ui, canvas, renderOptions)\n            else PaintImage.createPatternTask(paint, ui, canvas, renderOptions)\n            return false\n        }\n    }\n}\n\nexport function drawImage(paint: ILeafPaint, _imageScaleX: number, _imageScaleY: number, ui: IUI, canvas: ILeaferCanvas, _renderOptions: IRenderOptions): void {\n    const { data, image } = paint, { blendMode } = paint.originPaint as IImagePaint, { opacity, transform } = data, view = image.getFull(data.filters), u = ui.__\n    let { width, height } = image, clipUI: any\n\n    if ((clipUI = (transform && !transform.onlyScale) || u.path || u.cornerRadius) || opacity || blendMode) {\n        canvas.save()\n        clipUI && canvas.clipUI(ui)\n        blendMode && (canvas.blendMode = blendMode)\n        opacity && (canvas.opacity *= opacity)\n        transform && canvas.transform(transform)\n        canvas.drawImage(view, 0, 0, width, height) // svg need size\n        canvas.restore()\n    } else { // 简单矩形\n        if (data.scaleX) width *= data.scaleX, height *= data.scaleY\n        canvas.drawImage(view, 0, 0, width, height)\n    }\n\n}\n\nexport function getImageRenderScaleData(paint: ILeafPaint, ui: IUI, canvas?: ILeaferCanvas, _renderOptions?: IRenderOptions): IScaleData {\n    const scaleData = ui.getRenderScaleData(true, paint.originPaint.scaleFixed), { data } = paint\n    if (canvas) {\n        const { pixelRatio } = canvas\n        scaleData.scaleX *= pixelRatio\n        scaleData.scaleY *= pixelRatio\n    }\n    if (data && data.scaleX) {\n        scaleData.scaleX *= Math.abs(data.scaleX)\n        scaleData.scaleY *= Math.abs(data.scaleY)\n    }\n    return scaleData\n}", "import { IBooleanMap, ILeaferImage, IObject } from '@leafer/interface'\nimport { ImageManager, isArray } from '@leafer/core'\n\nimport { IImagePaint, ILeafPaint, IPaintAttr, IUIData } from '@leafer-ui/interface'\n\n\nexport function recycleImage(attrName: IPaintAttr, data: IUIData): IBooleanMap {\n    const paints: ILeafPaint[] = (data as IObject)['_' + attrName]\n\n    if (isArray(paints)) {\n\n        let paint: ILeafPaint, image: ILeaferImage, recycleMap: IBooleanMap, input: IImagePaint[], url: string\n\n        for (let i = 0, len = paints.length; i < len; i++) {\n\n            paint = paints[i]\n            image = paint.image\n            url = image && image.url\n\n            if (url) {\n                if (!recycleMap) recycleMap = {}\n                recycleMap[url] = true\n                ImageManager.recyclePaint(paint)\n\n                // stop load\n                if (image.loading) {\n                    if (!input) {\n                        input = (data.__input && data.__input[attrName]) || []\n                        if (!isArray(input)) input = [input]\n                    }\n                    image.unload(paints[i].loadId, !input.some((item: IImagePaint) => item.url === url))\n                }\n            }\n\n        }\n\n        return recycleMap\n\n    }\n\n    return null\n}", "import { IObject, IBoundsData, IPointData } from '@leafer/interface'\nimport { AroundHelper, Platform, isString } from '@leafer/core'\n\nimport { IGradientPaint, ILeafPaint, IColorStop, IColorString } from '@leafer-ui/interface'\nimport { ColorConvert } from '@leafer-ui/draw'\n\n\nconst { toPoint } = AroundHelper, { hasTransparent } = ColorConvert\nconst realFrom = {} as IPointData\nconst realTo = {} as IPointData\n\nexport function linearGradient(paint: IGradientPaint, box: IBoundsData): ILeafPaint {\n\n    let { from, to, type, opacity } = paint\n\n    toPoint(from || 'top', box, realFrom)\n    toPoint(to || 'bottom', box, realTo)\n\n    const style = Platform.canvas.createLinearGradient(realFrom.x, realFrom.y, realTo.x, realTo.y)\n    const data: ILeafPaint = { type, style }\n\n    applyStops(data, style, paint.stops, opacity)\n\n    return data\n\n}\n\nexport function applyStops(data: ILeafPaint, gradient: IObject, stops: IColorStop[] | IColorString[], opacity: number): void {\n    if (stops) {\n        let stop: IColorStop | string, color: string, offset: number, isTransparent: boolean\n        for (let i = 0, len = stops.length; i < len; i++) {\n            stop = stops[i]\n            if (isString(stop)) offset = i / (len - 1), color = ColorConvert.string(stop, opacity)\n            else offset = stop.offset, color = ColorConvert.string(stop.color, opacity)\n            gradient.addColorStop(offset, color)\n            if (!isTransparent && hasTransparent(color)) isTransparent = true\n        }\n        if (isTransparent) data.isTransparent = true\n    }\n}", "import { IBoundsData } from '@leafer/interface'\nimport { Platform, PointHelper, MatrixHelper, AroundHelper } from '@leafer/core'\n\nimport { IGradientPaint, ILeafPaint, IMatrixData, IPointData } from '@leafer-ui/interface'\n\nimport { applyStops } from './linear'\n\n\nconst { getAngle, getDistance } = PointHelper\nconst { get, rotateOfOuter, scaleOfOuter } = MatrixHelper\n\nconst { toPoint } = AroundHelper\nconst realFrom = {} as IPointData\nconst realTo = {} as IPointData\n\nexport function radialGradient(paint: IGradientPaint, box: IBoundsData): ILeafPaint {\n\n    let { from, to, type, opacity, stretch } = paint\n\n    toPoint(from || 'center', box, realFrom)\n    toPoint(to || 'bottom', box, realTo)\n\n    const style = Platform.canvas.createRadialGradient(realFrom.x, realFrom.y, 0, realFrom.x, realFrom.y, getDistance(realFrom, realTo))\n    const data: ILeafPaint = { type, style }\n\n    applyStops(data, style, paint.stops, opacity)\n\n    const transform = getTransform(box, realFrom, realTo, stretch, true)\n    if (transform) data.transform = transform\n\n    return data\n\n}\n\nexport function getTransform(box: IBoundsData, from: IPointData, to: IPointData, stretch: number, rotate90: boolean): IMatrixData {\n    let transform: IMatrixData\n    const { width, height } = box\n\n    if (width !== height || stretch) {\n        const angle = getAngle(from, to)\n        transform = get()\n        if (rotate90) {\n            scaleOfOuter(transform, from, width / height * (stretch || 1), 1)\n            rotateOfOuter(transform, from, angle + 90)\n        } else {\n            scaleOfOuter(transform, from, 1, width / height * (stretch || 1))\n            rotateOfOuter(transform, from, angle)\n        }\n    }\n\n    return transform\n}", "import { IPointData, IBoundsData } from '@leafer/interface'\nimport { Platform, PointHelper, AroundHelper } from '@leafer/core'\n\nimport { IGradientPaint, ILeafPaint } from '@leafer-ui/interface'\n\nimport { applyStops } from './linear'\nimport { getTransform } from './radial'\n\n\nconst { getDistance } = PointHelper\n\nconst { toPoint } = AroundHelper\nconst realFrom = {} as IPointData\nconst realTo = {} as IPointData\n\nexport function conicGradient(paint: IGradientPaint, box: IBoundsData): ILeafPaint {\n\n    let { from, to, type, opacity, stretch } = paint\n\n    toPoint(from || 'center', box, realFrom)\n    toPoint(to || 'bottom', box, realTo)\n\n    const style = Platform.conicGradientSupport ? Platform.canvas.createConicGradient(0, realFrom.x, realFrom.y) : Platform.canvas.createRadialGradient(realFrom.x, realFrom.y, 0, realFrom.x, realFrom.y, getDistance(realFrom, realTo))\n    const data: ILeafPaint = { type, style }\n\n    applyStops(data, style, paint.stops, opacity)\n\n    const transform = getTransform(box, realFrom, realTo, stretch || 1, Platform.conicGradientRotate90)\n    if (transform) data.transform = transform\n\n    return data\n\n}", "import { IPaintGradientModule } from '@leafer-ui/interface'\n\nimport { linearGradient } from './linear'\nimport { radialGradient, getTransform } from './radial'\nimport { conicGradient } from './conic'\n\n\nexport const PaintGradientModule: IPaintGradientModule = {\n    linearGradient,\n    radialGradient,\n    conicGradient,\n    getTransform\n}", "import { IBoundsData, IFourNumber, ILeaferCanvas, IMatrixData, IOffsetBoundsData } from '@leafer/interface'\nimport { BoundsHelper, LeafHelper, Matrix, Platform } from '@leafer/core'\n\nimport { IUI, ICachedShape, ILeafShadowEffect } from '@leafer-ui/interface'\nimport { ColorConvert, Effect } from '@leafer-ui/draw'\n\n\nconst { copy, move, toOffsetOutBounds } = BoundsHelper, { max, abs } = Math\nconst tempBounds = {} as IBoundsData, tempMatrix = new Matrix()\nconst offsetOutBounds = {} as IOffsetBoundsData\n\nexport function shadow(ui: IUI, current: ILeaferCanvas, shape: ICachedShape): void {\n\n    let copyBounds: IBoundsData, transform: IMatrixData\n\n    const { __nowWorld: nowWorld } = ui\n    const { shadow } = ui.__\n    const { worldCanvas, bounds, renderBounds, shapeBounds, scaleX, scaleY } = shape\n\n    const other = current.getSameCanvas()\n    const end = shadow.length - 1\n\n    toOffsetOutBounds(bounds, offsetOutBounds, renderBounds)\n\n    shadow.forEach((item, index) => {\n\n        let otherScale = 1 // 关联 scaleFixed 逻辑\n\n        if (item.scaleFixed) {\n            const sx = Math.abs(nowWorld.scaleX)\n            if (sx > 1) otherScale = 1 / sx\n        }\n\n        other.setWorldShadow((offsetOutBounds.offsetX + (item.x || 0) * scaleX * otherScale), (offsetOutBounds.offsetY + (item.y || 0) * scaleY * otherScale), (item.blur || 0) * scaleX * otherScale, ColorConvert.string(item.color))\n\n        transform = Effect.getShadowTransform(ui, other, shape, item, offsetOutBounds, otherScale)\n        if (transform) other.setTransform(transform)\n\n        drawWorldShadow(other, offsetOutBounds, shape)\n\n        if (transform) other.resetTransform()\n\n        copyBounds = renderBounds\n\n        if (item.box) {\n\n            other.restore() // remove shadow style\n            other.save()\n\n            if (worldCanvas) {\n                other.copyWorld(other, renderBounds, nowWorld, 'copy')\n                copyBounds = nowWorld\n            }\n\n            worldCanvas ? other.copyWorld(worldCanvas, nowWorld, nowWorld, 'destination-out') : other.copyWorld(shape.canvas, shapeBounds, bounds, 'destination-out')\n        }\n\n        LeafHelper.copyCanvasByWorld(ui, current, other, copyBounds, item.blendMode)\n\n        if (end && index < end) other.clearWorld(copyBounds)\n    })\n\n    other.recycle(copyBounds)\n\n}\n\nexport function getShadowRenderSpread(_ui: IUI, shadow: ILeafShadowEffect[]): IFourNumber {\n    let top = 0, right = 0, bottom = 0, left = 0, x: number, y: number, spread: number, blur: number\n    shadow.forEach(item => {\n        x = item.x || 0, y = item.y || 0, blur = (item.blur || 0) * 1.5, spread = abs(item.spread || 0) // must abs spread\n\n        top = max(top, spread + blur - y)\n        right = max(right, spread + blur + x)\n        bottom = max(bottom, spread + blur + y)\n        left = max(left, spread + blur - x)\n    })\n    return (top === right && right === bottom && bottom === left) ? top : [top, right, bottom, left]\n}\n\nexport function getShadowTransform(ui: IUI, canvas: ILeaferCanvas, _shape: ICachedShape, shadow: ILeafShadowEffect, outBounds: IBoundsData, otherScale: number, isInnerShaodw?: boolean): IMatrixData {\n    if (shadow.spread) {\n        const spread = shadow.spread * 2 * otherScale * (isInnerShaodw ? -1 : 1), { width, height } = ui.__layout.strokeBounds\n        tempMatrix.set().scaleOfOuter({ x: (outBounds.x + outBounds.width / 2) * canvas.pixelRatio, y: (outBounds.y + outBounds.height / 2) * canvas.pixelRatio }, 1 + spread / width, 1 + spread / height)\n        return tempMatrix\n    }\n    return undefined\n}\n\nexport function drawWorldShadow(canvas: ILeaferCanvas, outBounds: IBoundsData, shape: ICachedShape): void {\n    const { shapeBounds } = shape\n    let from: IBoundsData, to: IBoundsData\n\n    if (Platform.fullImageShadow) { // Safari\n        copy(tempBounds, canvas.bounds)\n        move(tempBounds, outBounds.x - shapeBounds.x, outBounds.y - shapeBounds.y)\n        from = canvas.bounds, to = tempBounds\n    } else {\n        from = shapeBounds, to = outBounds\n    }\n\n    canvas.copyWorld(shape.canvas, from, to)\n}", "import { IBoundsData, IMatrixData, ILeaferCanvas, IOffsetBoundsData } from '@leafer/interface'\nimport { BoundsHelper, LeafHelper } from '@leafer/core'\n\nimport { IUI, ICachedShape } from '@leafer-ui/interface'\nimport { ColorConvert, Effect } from '@leafer-ui/draw'\n\nimport { drawWorldShadow, getShadowRenderSpread } from './Shadow'\n\n\nconst { toOffsetOutBounds } = BoundsHelper\nconst offsetOutBounds = {} as IOffsetBoundsData\n\nexport function innerShadow(ui: IUI, current: ILeaferCanvas, shape: ICachedShape): void {\n\n    let copyBounds: IBoundsData, transform: IMatrixData\n\n    const { __nowWorld: nowWorld } = ui\n    const { innerShadow } = ui.__\n    const { worldCanvas, bounds, renderBounds, shapeBounds, scaleX, scaleY } = shape\n\n    const other = current.getSameCanvas()\n    const end = innerShadow.length - 1\n\n    toOffsetOutBounds(bounds, offsetOutBounds, renderBounds)\n\n    innerShadow.forEach((item, index) => {\n\n        let otherScale = 1 // 关联 scaleFixed 逻辑\n\n        if (item.scaleFixed) {\n            const sx = Math.abs(nowWorld.scaleX)\n            if (sx > 1) otherScale = 1 / sx\n        }\n\n        other.save()\n\n        other.setWorldShadow((offsetOutBounds.offsetX + (item.x || 0) * scaleX * otherScale), (offsetOutBounds.offsetY + (item.y || 0) * scaleY * otherScale), (item.blur || 0) * scaleX * otherScale)\n\n        transform = Effect.getShadowTransform(ui, other, shape, item, offsetOutBounds, otherScale, true)\n        if (transform) other.setTransform(transform)\n\n        drawWorldShadow(other, offsetOutBounds, shape)\n\n        other.restore()\n\n        if (worldCanvas) {\n            other.copyWorld(other, renderBounds, nowWorld, 'copy')\n            other.copyWorld(worldCanvas, nowWorld, nowWorld, 'source-out')\n            copyBounds = nowWorld\n        } else {\n            other.copyWorld(shape.canvas, shapeBounds, bounds, 'source-out')\n            copyBounds = renderBounds\n        }\n\n        other.fillWorld(copyBounds, ColorConvert.string(item.color), 'source-in')\n\n        LeafHelper.copyCanvasByWorld(ui, current, other, copyBounds, item.blendMode)\n\n        if (end && index < end) other.clearWorld(copyBounds)\n\n    })\n\n    other.recycle(copyBounds)\n\n}\n\nexport const getInnerShadowSpread = getShadowRenderSpread", "import { IEffectModule, ILeafShadowEffect } from '@leafer-ui/interface'\n\nimport { shadow, getShadowRenderSpread, getShadowTransform } from './Shadow'\nimport { innerShadow, getInnerShadowSpread } from './InnerShadow'\nimport { blur } from './Blur'\nimport { backgroundBlur } from './BackgroundBlur'\n\n\nexport const EffectModule: IEffectModule = {\n    shadow,\n    innerShadow,\n    blur,\n    backgroundBlur,\n\n    // @leafer-in/shadow will rewrite\n    getShadowRenderSpread,\n    getShadowTransform,\n    isTransformShadow(_shadow: ILeafShadowEffect): boolean { return undefined },\n\n    getInnerShadowSpread\n}", "import { ILeaferCanvas } from '@leafer/interface'\n\nimport { IUI } from '@leafer-ui/interface'\n\nexport function blur(ui: IUI, current: ILeaferCanvas, origin: ILeaferCanvas): void {\n    const { blur } = ui.__\n    origin.setWorldBlur(blur * ui.__nowWorld.a)\n    origin.copyWorldToInner(current, ui.__nowWorld, ui.__layout.renderBounds)\n    origin.filter = 'none'\n}\n", "import { ILeaferCanvas } from '@leafer/interface'\nimport { IUI, ICachedShape } from '@leafer-ui/interface'\n\nexport function backgroundBlur(_ui: IUI, _current: ILeaferCanvas, _shape: ICachedShape): void {\n\n}", "import { IBlendMode, ILeaf, ILeaferCanvas, IMaskType, IRenderOptions } from '@leafer/interface'\nimport { LeafBoundsHelper } from '@leafer/core'\n\nimport { Group } from '@leafer-ui/draw'\n\n\ntype IMaskMode = 'path' | 'alpha' | 'grayscale' | 'opacity-path'\nconst { excludeRenderBounds } = LeafBoundsHelper\nlet usedGrayscaleAlpha: boolean\n\nGroup.prototype.__renderMask = function (canvas: ILeaferCanvas, options: IRenderOptions): void {\n\n    let child: ILeaf, maskCanvas: ILeaferCanvas, contentCanvas: ILeaferCanvas, maskOpacity: number, currentMask: IMaskMode, mask: boolean | IMaskType\n    const { children } = this\n\n    for (let i = 0, len = children.length; i < len; i++) {\n        child = children[i], mask = child.__.mask\n\n        if (mask) {\n\n            if (currentMask) {\n                maskEnd(this, currentMask, canvas, contentCanvas, maskCanvas, maskOpacity, undefined, true)\n                maskCanvas = contentCanvas = null\n            }\n\n            // mask start\n\n            if (mask === 'clipping' || mask === 'clipping-path') excludeRenderBounds(child, options) || child.__render(canvas, options) // 剪贴蒙版，需要渲染自身到原画布中，如果应用遮罩会造成透明度减半。clipping-path 支持渲染外描边。\n\n            maskOpacity = child.__.opacity\n            usedGrayscaleAlpha = false\n\n            if (mask === 'path' || mask === 'clipping-path') {\n\n                if (maskOpacity < 1) {\n\n                    currentMask = 'opacity-path'\n                    if (!contentCanvas) contentCanvas = getCanvas(canvas)\n\n                } else {\n                    currentMask = 'path'\n                    canvas.save()\n                }\n\n                child.__clip(contentCanvas || canvas, options)\n\n            } else { // pixel\n\n                currentMask = mask === 'grayscale' ? 'grayscale' : 'alpha'\n                if (!maskCanvas) maskCanvas = getCanvas(canvas)\n                if (!contentCanvas) contentCanvas = getCanvas(canvas)\n                child.__render(maskCanvas, options)\n\n            }\n\n            continue\n        }\n\n        const childBlendMode = maskOpacity === 1 && child.__.__blendMode\n\n        // 元素存在混合模式，将先前的内容绘制到原画布\n        if (childBlendMode) maskEnd(this, currentMask, canvas, contentCanvas, maskCanvas, maskOpacity, undefined, false)\n\n        excludeRenderBounds(child, options) || child.__render(contentCanvas || canvas, options)\n\n        // 元素存在混合模式，应用遮罩后直接与原画布混合\n        if (childBlendMode) maskEnd(this, currentMask, canvas, contentCanvas, maskCanvas, maskOpacity, childBlendMode as IBlendMode, false)\n\n    }\n\n    maskEnd(this, currentMask, canvas, contentCanvas, maskCanvas, maskOpacity, undefined, true)\n\n}\n\n\nfunction maskEnd(leaf: ILeaf, maskMode: IMaskMode, canvas: ILeaferCanvas, contentCanvas: ILeaferCanvas, maskCanvas: ILeaferCanvas, maskOpacity: number, blendMode: IBlendMode, recycle: boolean): void {\n    switch (maskMode) {\n        case 'grayscale':\n            if (!usedGrayscaleAlpha) usedGrayscaleAlpha = true, maskCanvas.useGrayscaleAlpha(leaf.__nowWorld)\n        case 'alpha':\n            usePixelMask(leaf, canvas, contentCanvas, maskCanvas, blendMode, recycle); break\n        case 'opacity-path':\n            copyContent(leaf, canvas, contentCanvas, maskOpacity, blendMode, recycle); break\n        case 'path':\n            if (recycle) canvas.restore()\n    }\n}\n\n\nfunction getCanvas(canvas: ILeaferCanvas): ILeaferCanvas {\n    return canvas.getSameCanvas(false, true)\n}\n\n\nfunction usePixelMask(leaf: ILeaf, canvas: ILeaferCanvas, content: ILeaferCanvas, mask: ILeaferCanvas, blendMode: IBlendMode, recycle: boolean): void {\n    const realBounds = leaf.__nowWorld\n    content.resetTransform()\n    content.opacity = 1\n    content.useMask(mask, realBounds)\n    if (recycle) mask.recycle(realBounds)\n\n    copyContent(leaf, canvas, content, 1, blendMode, recycle)\n}\n\n\nfunction copyContent(leaf: ILeaf, canvas: ILeaferCanvas, content: ILeaferCanvas, maskOpacity: number, blendMode: IBlendMode, recycle: boolean): void {\n    const realBounds = leaf.__nowWorld\n\n    canvas.resetTransform()\n    canvas.opacity = maskOpacity\n    canvas.copyWorld(content, realBounds, undefined, blendMode)\n\n    recycle ? content.recycle(realBounds) : content.clearWorld(realBounds)\n}", "import { IBooleanMap } from '@leafer-ui/interface'\n\nconst money = '¥￥＄€£￡¢￠'\nconst letter = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz'\n\nconst langBefore = '《（「〈『〖【〔｛┌＜‘“＝' + money\nconst langAfter = '》）」〉』〗】〕｝┐＞’”！？，、。：；‰'\nconst langSymbol = '≮≯≈≠＝…'\nconst langBreak = '—／～｜┆·'\n\nconst beforeChar = '{[(<\\'\"' + langBefore\nconst afterChar = '>)]}%!?,.:;\\'\"' + langAfter\nconst symbolChar = afterChar + '_#~&*+\\\\=|' + langSymbol\nconst breakChar = '- ' + langBreak\n\nconst cjkRangeList = [\n    [0x4E00, 0x9FFF], // CJK Unified Ideographs\n    [0x3400, 0x4DBF], // CJK Unified Ideographs Extension A\n    [0x20000, 0x2A6DF], // CJK Unified Ideographs Extension B\n    [0x2A700, 0x2B73F], // CJK Unified Ideographs Extension C\n    [0x2B740, 0x2B81F], // CJK Unified Ideographs Extension D\n    [0x2B820, 0x2CEAF], // CJK Unified Ideographs Extension E\n    [0x2CEB0, 0x2EBEF], // CJK Unified Ideographs Extension F\n    [0x30000, 0x3134F], // CJK Unified Ideographs Extension G\n    [0x31350, 0x323AF], // CJK Unified Ideographs Extension H\n    [0x2E80, 0x2EFF], // CJK Radicals Supplement\n    [0x2F00, 0x2FDF], // Kangxi Radicals\n    [0x2FF0, 0x2FFF], // Ideographic Description Characters\n    [0x3000, 0x303F], // CJK Symbols and Punctuation\n    [0x31C0, 0x31EF], // CJK Strokes\n    [0x3200, 0x32FF], // Enclosed CJK Letters and Months\n    [0x3300, 0x33FF], // CJK Compatibility\n    [0xF900, 0xFAFF], // CJK Compatibility Ideographs\n    [0xFE30, 0xFE4F], // CJK Compatibility Forms\n    [0x1F200, 0x1F2FF], // Enclosed Ideographic Supplement\n    [0x2F800, 0x2FA1F], // CJK Compatibility Ideographs Supplement\n]\n\nconst cjkReg = new RegExp(cjkRangeList.map(([start, end]) => `[\\\\u${start.toString(16)}-\\\\u${end.toString(16)}]`).join('|'))\n\nfunction mapChar(str: string): IBooleanMap {\n    const map: IBooleanMap = {}\n    str.split('').forEach(char => map[char] = true)\n    return map\n}\n\nconst letterMap = mapChar(letter)\nconst beforeMap = mapChar(beforeChar)\nconst afterMap = mapChar(afterChar)\nconst symbolMap = mapChar(symbolChar)\nconst breakMap = mapChar(breakChar)\n\nexport enum CharType {\n    Letter, // en... number\n    Single, // cjk\n    Before, // (\n    After, // )\n    Symbol, // *\n    Break, // space\n}\n\nconst { Letter, Single, Before, After, Symbol, Break } = CharType\n\nexport function getCharType(char: string): CharType {\n\n    if (letterMap[char]) {\n        return Letter\n    } else if (breakMap[char]) {\n        return Break\n    } else if (beforeMap[char]) {\n        return Before\n    } else if (afterMap[char]) {\n        return After\n    } else if (symbolMap[char]) {\n        return Symbol\n    } else if (cjkReg.test(char)) {\n        return Single\n    } else {\n        return Letter\n    }\n\n}\n", "import { ITextRowData, ITextCharData } from '@leafer-ui/interface'\n\n\nexport const TextRowHelper = {\n\n    trimRight(row: ITextRowData): void {\n        const { words } = row\n        let trimRight = 0, len = words.length, char: ITextCharData\n\n        for (let i = len - 1; i > -1; i--) {\n            char = words[i].data[0]\n            if (char.char === ' ') {\n                trimRight++\n                row.width -= char.width\n            } else {\n                break\n            }\n        }\n\n        if (trimRight) words.splice(len - trimRight, trimRight)\n    }\n\n}", "import { ITextCase } from '@leafer-ui/interface'\n\nexport function getTextCase(char: string, textCase: ITextCase, firstChar?: boolean): string {\n    switch (textCase) {\n        case 'title':\n            return firstChar ? char.toUpperCase() : char\n        case 'upper':\n            return char.toUpperCase()\n        case 'lower':\n            return char.toLowerCase()\n        default:\n            return char\n    }\n}", "import { Platform } from '@leafer/core'\n\nimport { IBoundsData, ITextData, ITextDrawData, ITextRowData, ITextWordData } from '@leafer-ui/interface'\n\nimport { CharType, getCharType } from './CharType'\nimport { TextRowHelper } from './TextRowHelper'\nimport { getTextCase } from './TextCase'\n\n\nconst { trimRight } = TextRowHelper\nconst { Letter, Single, Before, After, Symbol, Break } = CharType\n\nlet word: ITextWordData, row: ITextRowData, wordWidth: number, rowWidth: number, realWidth: number\nlet char: string, charWidth: number, startCharSize: number, charSize: number, charType: CharType, lastCharType: CharType, langBreak: boolean, afterBreak: boolean, paraStart: boolean\nlet textDrawData: ITextDrawData, rows: ITextRowData[] = [], bounds: IBoundsData, findMaxWidth: boolean\n\nexport function createRows(drawData: ITextDrawData, content: string, style: ITextData): void {\n\n    textDrawData = drawData\n    rows = drawData.rows\n    bounds = drawData.bounds\n    findMaxWidth = !bounds.width && !style.autoSizeAlign\n\n    const { __letterSpacing, paraIndent, textCase } = style\n    const { canvas } = Platform, { width } = bounds\n\n    if (style.__isCharMode) {\n\n        const wrap = style.textWrap !== 'none'\n        const breakAll = style.textWrap === 'break'\n\n        paraStart = true\n        lastCharType = null\n        startCharSize = charWidth = charSize = wordWidth = rowWidth = 0\n        word = { data: [] }, row = { words: [] }\n\n        if (__letterSpacing) content = [...content] as any // 防止切分表情等多个字符组成的字符，转成数组字符是最安全的\n\n        for (let i = 0, len = content.length; i < len; i++) {\n\n            char = content[i]\n\n            if (char === '\\n') {\n\n                if (wordWidth) addWord()\n                row.paraEnd = true\n                addRow()\n\n                paraStart = true\n\n            } else {\n\n                charType = getCharType(char)\n\n                if (charType === Letter && textCase !== 'none') char = getTextCase(char, textCase, !wordWidth)\n\n                charWidth = canvas.measureText(char).width\n                if (__letterSpacing) {\n                    if (__letterSpacing < 0) charSize = charWidth\n                    charWidth += __letterSpacing\n                }\n\n                langBreak = (charType === Single && (lastCharType === Single || lastCharType === Letter)) || (lastCharType === Single && charType !== After) // break  U字 文字 or 字U  字（  字*  exclude 字。\n                afterBreak = ((charType === Before || charType === Single) && (lastCharType === Symbol || lastCharType === After)) // split >(  =文 。哈  ;文\n\n                realWidth = paraStart && paraIndent ? width - paraIndent : width\n\n                if (wrap && (width && rowWidth + wordWidth + charWidth > realWidth)) { // wrap\n\n                    if (breakAll) {\n\n                        if (wordWidth) addWord() // break\n                        if (rowWidth) addRow()\n\n                    } else {\n                        if (!afterBreak) afterBreak = charType === Letter && lastCharType == After // split ，S  \n\n                        if (langBreak || afterBreak || charType === Break || charType === Before || charType === Single || (wordWidth + charWidth > realWidth)) {\n\n                            if (wordWidth) addWord() // break\n                            if (rowWidth) addRow()\n\n                        } else {\n\n                            if (rowWidth) addRow()\n                        }\n                    }\n\n                }\n\n                if (char === ' ' && paraStart !== true && (rowWidth + wordWidth) === 0) {\n\n                    // trim space\n\n                } else {\n\n                    if (charType === Break) {\n\n                        if (char === ' ' && wordWidth) addWord()\n                        addChar(char, charWidth)\n                        addWord()\n\n                    } else if (langBreak || afterBreak) {\n\n                        if (wordWidth) addWord()\n                        addChar(char, charWidth)\n\n                    } else {\n\n                        addChar(char, charWidth)\n\n                    }\n                }\n\n                lastCharType = charType\n\n            }\n\n        }\n\n        if (wordWidth) addWord()\n        if (rowWidth) addRow()\n\n        rows.length > 0 && (rows[rows.length - 1].paraEnd = true)\n\n    } else {\n\n        content.split('\\n').forEach(content => {\n            textDrawData.paraNumber++\n            rowWidth = canvas.measureText(content).width\n            rows.push({ x: paraIndent || 0, text: content, width: rowWidth, paraStart: true })\n            if (findMaxWidth) setMaxWidth()\n        })\n\n    }\n}\n\n\nfunction addChar(char: string, width: number): void {\n    if (charSize && !startCharSize) startCharSize = charSize\n    word.data.push({ char, width })\n    wordWidth += width\n}\n\nfunction addWord(): void {\n    rowWidth += wordWidth\n    word.width = wordWidth\n    row.words.push(word)\n    word = { data: [] }\n    wordWidth = 0\n}\n\nfunction addRow(): void {\n    if (paraStart) {\n        textDrawData.paraNumber++\n        row.paraStart = true\n        paraStart = false\n    }\n\n    if (charSize) { // letterSpacing < 0, like -20% -100%\n        row.startCharSize = startCharSize\n        row.endCharSize = charSize\n        startCharSize = 0\n    }\n\n    row.width = rowWidth\n    if (bounds.width) trimRight(row)\n    else if (findMaxWidth) setMaxWidth()\n    rows.push(row)\n    row = { words: [] }\n    rowWidth = 0\n}\n\nfunction setMaxWidth(): void {\n    if (rowWidth > (textDrawData.maxWidth || 0)) textDrawData.maxWidth = rowWidth\n}\n", "import { Platform, Direction4, isString } from '@leafer/core'\n\nimport { ITextData, ITextDrawData } from '@leafer-ui/interface'\n\nimport { createRows } from './TextRows'\nimport { layoutChar } from './CharLayout'\nimport { layoutText } from './TextLayout'\nimport { clipText } from './TextClip'\nimport { decorationText } from './TextDecoration'\n\n\nconst { top, right, bottom, left } = Direction4\n\nexport function getDrawData(content: string | number, style: ITextData): ITextDrawData {\n\n    if (!isString(content)) content = String(content)\n\n    let x = 0, y = 0\n\n    let width = style.__getInput('width') || 0\n    let height = style.__getInput('height') || 0\n\n    const { __padding: padding } = style\n\n    if (padding) {\n        if (width) x = padding[left], width -= (padding[right] + padding[left]), !width && (width = 0.01) // 防止变为自动宽度\n        else if (!style.autoSizeAlign) x = padding[left]\n\n        if (height) y = padding[top], height -= (padding[top] + padding[bottom]), !height && (height = 0.01)\n        else if (!style.autoSizeAlign) y = padding[top]\n    }\n\n    const drawData: ITextDrawData = {\n        bounds: { x, y, width, height },\n        rows: [],\n        paraNumber: 0,\n        font: Platform.canvas.font = style.__font\n    }\n\n    createRows(drawData, content, style) // set rows, paraNumber\n\n    if (padding) padAutoText(padding, drawData, style, width, height)\n\n    layoutText(drawData, style) // set bounds\n\n    if (style.__isCharMode) layoutChar(drawData, style, width, height) // set char.x\n\n    if (drawData.overflow) clipText(drawData, style, x, width)\n\n    if (style.textDecoration !== 'none') decorationText(drawData, style)\n\n    return drawData\n\n}\n\n\nfunction padAutoText(padding: number[], drawData: ITextDrawData, style: ITextData, width: number, height: number): void {\n    if (!width && style.autoSizeAlign) {\n        switch (style.textAlign) {\n            case 'left': offsetText(drawData, 'x', padding[left]); break\n            case 'right': offsetText(drawData, 'x', -padding[right])\n        }\n    }\n\n    if (!height && style.autoSizeAlign) {\n        switch (style.verticalAlign) {\n            case 'top': offsetText(drawData, 'y', padding[top]); break\n            case 'bottom': offsetText(drawData, 'y', -padding[bottom])\n        }\n    }\n}\n\n\nfunction offsetText(drawData: ITextDrawData, attrName: 'x' | 'y', value: number): void {\n    const { bounds, rows } = drawData\n    bounds[attrName] += value\n    for (let i = 0; i < rows.length; i++) rows[i][attrName] += value\n}", "import { ITextConvertModule } from '@leafer-ui/interface'\n\nimport { getDrawData } from './TextConvert'\n\nexport const TextConvertModule: ITextConvertModule = {\n    getDrawData\n}", "import { ITextData, ITextDrawData, ITextRowData } from '@leafer-ui/interface'\n\n\nexport function layoutText(drawData: ITextDrawData, style: ITextData): void {\n\n    const { rows, bounds } = drawData, countRows = rows.length\n    const { __lineHeight, __baseLine, __letterSpacing, __clipText, textAlign, verticalAlign, paraSpacing, autoSizeAlign } = style\n\n    let { x, y, width, height } = bounds, realHeight = __lineHeight * countRows + (paraSpacing ? paraSpacing * (drawData.paraNumber - 1) : 0)\n    let starY: number = __baseLine\n\n    // verticalAlign\n\n    if (__clipText && realHeight > height) {\n        realHeight = Math.max(height, __lineHeight)\n        if (countRows > 1) drawData.overflow = countRows\n    } else if (height || autoSizeAlign) {\n        switch (verticalAlign) {\n            case 'middle': y += (height - realHeight) / 2; break\n            case 'bottom': y += (height - realHeight)\n        }\n    }\n    starY += y\n\n    // textAlign\n\n    let row: ITextRowData, rowX: number, rowWidth: number, layoutWidth = (width || autoSizeAlign) ? width : drawData.maxWidth\n\n    for (let i = 0, len = countRows; i < len; i++) {\n        row = rows[i]\n        row.x = x\n\n        if (row.width < width || (row.width > width && !__clipText)) {\n            switch (textAlign) {\n                case 'center': row.x += (layoutWidth - row.width) / 2; break\n                case 'right': row.x += layoutWidth - row.width\n            }\n        }\n\n        if (row.paraStart && paraSpacing && i > 0) starY += paraSpacing\n\n        row.y = starY\n\n        starY += __lineHeight\n\n        if (drawData.overflow > i && starY > realHeight) {\n            row.isOverflow = true\n            drawData.overflow = i + 1\n        }\n\n        rowX = row.x\n        rowWidth = row.width\n\n        if (__letterSpacing < 0) { // letterSpacing < 0, like -20% -100%\n            if (row.width < 0) {\n                rowWidth = -row.width + style.fontSize + __letterSpacing\n                rowX -= rowWidth\n                rowWidth += style.fontSize\n            } else {\n                rowWidth -= __letterSpacing\n            }\n        }\n\n        if (rowX < bounds.x) bounds.x = rowX\n        if (rowWidth > bounds.width) bounds.width = rowWidth\n\n        // clip nowrap\n        if (__clipText && width && width < rowWidth) {\n            row.isOverflow = true\n            if (!drawData.overflow) drawData.overflow = rows.length\n        }\n    }\n\n    bounds.y = y\n    bounds.height = realHeight\n\n}", "import { ITextCharData, ITextData, ITextDrawData, ITextRowData } from '@leafer-ui/interface'\n\n\nconst CharMode = 0 // data: [{char:'a', x: 0}, {char:'b', x: 5}, {char:'d', x:20}]\nconst WordMode = 1 // data: [{ char:'ab', x: 0}, { char:'d', x:20}]\nconst TextMode = 2 // text: 'ab  c'\n\nexport function layoutChar(drawData: ITextDrawData, style: ITextData, width: number, _height: number): void {\n\n    const { rows } = drawData\n    const { textAlign, paraIndent, __letterSpacing } = style\n\n    const justifyLast = width && textAlign.includes('both')  // 最后一行是否两端对齐\n    const justify = justifyLast || (width && textAlign.includes('justify')) // 是否两端对齐文本\n    const justifyLetter = justify && textAlign.includes('letter') // 英文是否通过加大字符间距两端对齐\n\n    let charX: number, remainingWidth: number, addWordWidth: number, addLetterWidth: number, indentWidth: number, mode: number, wordChar: ITextCharData, wordsLength: number, isLastWord: boolean, canJustify: boolean\n\n    rows.forEach(row => {\n        if (row.words) {\n\n            indentWidth = paraIndent && row.paraStart ? paraIndent : 0, wordsLength = row.words.length\n            if (justify) {\n                canJustify = !row.paraEnd || justifyLast\n                remainingWidth = width - row.width - indentWidth\n                if (justifyLetter) addLetterWidth = remainingWidth / (row.words.reduce((total, item) => total + item.data.length, 0) - 1) //  remainingWidth / （lettersLength - 1）\n                else addWordWidth = wordsLength > 1 ? remainingWidth / (wordsLength - 1) : 0\n            }\n            mode = (__letterSpacing || row.isOverflow || justifyLetter) ? CharMode : (addWordWidth ? WordMode : TextMode)\n            if (row.isOverflow && !__letterSpacing) row.textMode = true\n\n            if (mode === TextMode) {\n\n                row.x += indentWidth\n                toTextChar(row)\n\n            } else {\n\n                row.x += indentWidth\n                charX = row.x\n                row.data = []\n\n                row.words.forEach((word, index) => {\n\n                    if (mode === WordMode) {\n\n                        wordChar = { char: '', x: charX }\n                        charX = toWordChar(word.data, charX, wordChar)\n                        if (row.isOverflow || wordChar.char !== ' ') row.data.push(wordChar)\n\n                    } else {\n\n                        charX = toChar(word.data, charX, row.data, row.isOverflow, canJustify && addLetterWidth)\n\n                    }\n\n                    if (canJustify) {\n                        isLastWord = index === wordsLength - 1\n\n                        if (addWordWidth) {\n                            if (!isLastWord) charX += addWordWidth, row.width += addWordWidth\n                        } else if (addLetterWidth) {\n                            row.width += addLetterWidth * (word.data.length - (isLastWord ? 1 : 0))\n                        }\n                    }\n\n                })\n            }\n\n            row.words = null\n        }\n    })\n\n}\n\nfunction toTextChar(row: ITextRowData): void {\n    row.text = ''\n    row.words.forEach(word => {\n        word.data.forEach(char => {\n            row.text += char.char\n        })\n    })\n}\n\nfunction toWordChar(data: ITextCharData[], charX: number, wordChar: ITextCharData): number {\n    data.forEach(char => {\n        wordChar.char += char.char\n        charX += char.width\n    })\n    return charX\n}\n\nfunction toChar(data: ITextCharData[], charX: number, rowData: ITextCharData[], isOverflow?: boolean, addLetterWidth?: number): number {\n    data.forEach(char => {\n        if (isOverflow || char.char !== ' ') {\n            char.x = charX\n            rowData.push(char)\n        }\n        charX += char.width\n        addLetterWidth && (charX += addLetterWidth)\n    })\n    return charX\n}", "import { Platform } from '@leafer/core'\n\nimport { ITextCharData, ITextData, ITextDrawData, ITextRowData } from '@leafer-ui/interface'\n\n\nexport function clipText(drawData: ITextDrawData, style: ITextData, x: number, width: number): void {\n    if (!width) return\n\n    const { rows, overflow } = drawData\n    let { textOverflow } = style\n    rows.splice(overflow)\n\n    if (textOverflow && textOverflow !== 'show') {\n        if (textOverflow === 'hide') textOverflow = ''\n        else if (textOverflow === 'ellipsis') textOverflow = '...'\n\n        let char: ITextCharData, charRight: number\n        const ellipsisWidth = textOverflow ? Platform.canvas.measureText(textOverflow).width : 0\n        const right = x + width - ellipsisWidth\n        const list = style.textWrap === 'none' ? rows : [rows[overflow - 1]]\n\n        list.forEach(row => {\n\n            if (row.isOverflow && row.data) {\n\n                let end = row.data.length - 1\n\n                for (let i = end; i > -1; i--) {\n                    char = row.data[i]\n                    charRight = char.x + char.width\n                    if (i === end && charRight < right) {\n                        break\n                    } else if ((charRight < right && char.char !== ' ') || !i) { // 至少保留一个文字\n                        row.data.splice(i + 1)\n                        row.width -= char.width\n                        break\n                    }\n                    row.width -= char.width\n                }\n\n                row.width += ellipsisWidth\n                row.data.push({ char: textOverflow, x: charRight })\n\n                if (row.textMode) toTextChar(row)\n            }\n\n\n        })\n\n    }\n\n}\n\nfunction toTextChar(row: ITextRowData): void {\n    row.text = ''\n    row.data.forEach(char => {\n        row.text += char.char\n    })\n    row.data = null\n}", "import { isObject } from '@leafer/core'\n\nimport { ITextData, ITextDecorationType, ITextDrawData } from '@leafer-ui/interface'\nimport { ColorConvert } from '@leafer-ui/draw'\n\n\nexport function decorationText(drawData: ITextDrawData, style: ITextData): void {\n    let type: ITextDecorationType, offset = 0\n    const { fontSize, textDecoration } = style\n    drawData.decorationHeight = fontSize / 11\n    if (isObject(textDecoration)) {\n        type = textDecoration.type\n        if (textDecoration.color) drawData.decorationColor = ColorConvert.string(textDecoration.color)\n        if (textDecoration.offset) offset = Math.min(fontSize * 0.3, Math.max(textDecoration.offset, -fontSize * 0.15))\n    } else type = textDecoration\n    switch (type) {\n        case 'under':\n            drawData.decorationY = [fontSize * 0.15 + offset]\n            break\n        case 'delete':\n            drawData.decorationY = [-fontSize * 0.35]\n            break\n        case 'under-delete':\n            drawData.decorationY = [fontSize * 0.15 + offset, -fontSize * 0.35]\n    }\n}", "import { IColorConvertModule } from '@leafer-ui/interface'\n\nimport { string } from './color'\n\n\nexport const ColorConvertModule = {\n    string\n} as IColorConvertModule", "import { isString, isNumber, isUndefined } from '@leafer/core'\n\nimport { IColor } from '@leafer-ui/interface'\nimport { ColorConvert } from '@leafer-ui/draw'\n\n\nexport function string(color: IColor, opacity?: number): string {\n    if (!color) return '#000'\n    const doOpacity = isNumber(opacity) && opacity < 1\n    if (isString(color)) {\n        if (doOpacity && ColorConvert.object) color = ColorConvert.object(color)\n        else return color\n    }\n    let a = isUndefined(color.a) ? 1 : color.a\n    if (doOpacity) a *= opacity\n    const rgb = color.r + ',' + color.g + ',' + color.b\n    return a === 1 ? 'rgb(' + rgb + ')' : 'rgba(' + rgb + ',' + a + ')'\n}", "// leaferui's partner, allow replace\nimport { Paint, PaintImage, PaintGradient, Effect, TextConvert, ColorConvert } from '@leafer-ui/draw'\n\nimport { PaintModule } from '@leafer-ui/paint'\nimport { PaintImageModule } from '@leafer-ui/image'\nimport { PaintGradientModule } from '@leafer-ui/gradient'\nimport { EffectModule } from '@leafer-ui/effect'\nimport '@leafer-ui/mask'\n\nimport { TextConvertModule } from '@leafer-ui/text'\nimport { ColorConvertModule } from '@leafer-ui/color'\n\n\nObject.assign(TextConvert, TextConvertModule)\nObject.assign(ColorConvert, ColorConvertModule)\n\nObject.assign(Paint, PaintModule)\nObject.assign(PaintImage, PaintImageModule)\nObject.assign(PaintGradient, PaintGradientModule)\n\nObject.assign(Effect, EffectModule)", "export * from '@leafer-ui/interface'\n\nexport * from './core'\nexport * from '@leafer/partner'\n\nexport * from '@leafer-ui/core'\nexport * from '@leafer-ui/interaction-web'\nexport * from '@leafer-ui/partner'\n\nimport { ICreator } from '@leafer/interface'\nimport { useCanvas, Creator, LeaferCanvas } from './core'\nimport { HitCanvasManager } from '@leafer-ui/core'\nimport { Interaction } from '@leafer-ui/interaction-web'\n\n\nObject.assign(Creator, {\n    interaction: (target, canvas, selector, options?) => new Interaction(target, canvas, selector, options),\n    hitCanvas: (options?, manager?) => new LeaferCanvas(options, manager),\n    hitCanvasManager: () => new HitCanvasManager()\n} as ICreator)\n\nuseCanvas('canvas')"],
  "mappings": "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",
  "names": ["Answer", "emptyData", "isUndefined", "value", "isNull", "isString", "isFinite", "Number", "isNumber", "numberReg", "tryToNumber", "test", "isArray", "Array", "isObject", "isData", "isEmptyData", "JSON", "stringify", "DataHelper", "default", "t", "defaultData", "assign", "merge", "exclude", "Object", "keys", "forEach", "key", "constructor", "_a", "o", "_b", "copyAttrs", "from", "include", "clone", "data", "parse", "list", "map", "i", "len", "length", "attrName", "LeafData", "__useNaturalRatio", "__isLinePath", "path", "this", "__usePathBox", "__pathInputed", "__blendMode", "eraser", "blendMode", "leaf", "__leaf", "name", "__input", "__getData", "tag", "inputValue", "names", "options", "__getInput", "matrix", "a", "b", "c", "d", "e", "f", "__localMatrix", "__middle", "__checkSingle", "opacity", "isBranch", "__hasMultiPaint", "__hasEraser", "filter", "__single", "__removeNaturalSize", "__naturalWidth", "__naturalHeight", "destroy", "IncrementId", "RUNTIME", "LEAF", "TASK", "CNAVAS", "IMAGE", "types", "typeName", "I", "tempA", "tempB", "tempTo", "max", "Math", "tempFour", "FourNumberHelper", "zero", "set", "to", "top", "right", "bottom", "left", "setTemp", "change", "get", "num", "maxValue", "other", "toTempAB", "add", "scaleX", "scaleY", "round", "pow", "floor", "PI", "MathHelper", "within", "min", "fourNumber", "formatRotation", "rotation", "unsign", "float", "addRotation", "gap", "oldRotation", "r", "abs", "maxLength", "sign", "scale", "size", "originSize", "scaleData", "width", "height", "assignScale", "x", "y", "getFloorScale", "randInt", "randColor", "random", "OneRadian", "PI2", "PI_2", "getPointData", "getBoundsData", "getMatrixData", "sin", "cos", "acos", "sqrt", "tempPoint", "getWorld", "skewX", "skewY", "MatrixHelper", "defaultMatrix", "defaultWorld", "tempMatrix", "hasOrigin", "pixelRatio", "origin", "M", "toInnerPoint", "scaleOfInner", "translateInner", "cosR", "sinR", "rotateOfInner", "rotate", "skewOfInner", "skew", "child", "parent", "abcdChanged", "childScaleData", "multiply", "tempInvert", "multiplyParent", "copy", "invert", "s", "inner", "distance", "outer", "layout", "around", "bcChanged", "sx", "sy", "firstSkewY", "world", "toOuterPoint", "atan2", "PointHelper", "defaultPoint", "tempRadiusPoint", "radiusX", "radiusY", "point", "halfPixel", "P", "rx", "ry", "temp", "toInnerRadiusPointOf", "copyRadiusPoint", "setRadius", "getCenter", "getCenterX", "x1", "x2", "getCenterY", "y1", "y2", "getDistance", "getDistanceFrom", "getMinDistanceFrom", "x3", "y3", "getAngle", "getAtan2", "getRotation", "toOrigin", "getRadianFrom", "fromX", "fromY", "originX", "originY", "toX", "toY", "toOriginX", "toOriginY", "changeTo", "fromTo", "originPoints", "points", "p", "push", "isSame", "reset", "Point", "move", "scaleOf", "toInnerOf", "toOuterOf", "getDistancePoint", "Matrix", "dataWithScale", "translate", "pixelScale", "scaleOfOuter", "angle", "rotateOfOuter", "skewOfOuter", "divide", "divideParent", "invertWith", "setLayout", "getLayout", "withScale", "TwoPointBoundsHelper", "tempPointBounds", "minX", "minY", "maxX", "maxY", "addPoint", "pb", "setBounds", "Direction4", "Direction9", "directionData", "item", "type", "AroundHelper", "box", "onlyBoxSize", "content", "onlyContentSize", "getPoint", "toPoint", "AlignHelper", "align", "setPoint", "toBounds", "TB", "ceil", "boundsRight", "boundsBottom", "tempBounds", "BoundsHelper", "bounds", "spread", "isShrink", "side", "four", "B", "scrollX", "scrollY", "getByMove", "offsetBounds", "offsetX", "offsetY", "onlySize", "tempToOuterOf", "getOuterOf", "put", "baseScale", "getFitScale", "isCoverMode", "sw", "sh", "putScale", "changeSize", "n", "copyAndSpread", "shrink", "isPoint", "setListWithFn", "undefined", "addMode", "boundsDataFn", "first", "index", "hitRadiusPoint", "pointMatrix", "tempToInnerRadiusPointOf", "hitPoint", "tempToInnerOf", "hit", "otherMatrix", "includes", "getIntersectData", "isEmpty", "hasSize", "Bounds", "getFitMatrix", "boundsList", "setList", "setPoints", "getPoints", "boundsMatrix", "intersect", "AutoBounds", "autoSize", "UnitConvertHelper", "number", "percentRefer", "StringNumberMap", "E", "Platform", "text", "fileType", "url", "encodeURIComponent", "image", "hitCanvasSize", "maxCacheSize", "maxPatternSize", "crossOrigin", "isLarge", "largeSize", "isSuperLarge", "prefix", "suffix", "startsWith", "view", "xGap", "yGap", "clip", "smooth", "_filters", "interlace", "realWidth", "realHeight", "interlaceX", "interlaceY", "interlaceOffset", "offset", "canvas", "createCanvas", "ctx", "getContext", "globalAlpha", "imageSmoothingEnabled", "canUse", "setTransform", "drawImage", "__closed", "pattern", "transform", "paint", "stintSet", "Debug", "repeatMap", "filterList", "getNameList", "excludeList", "color", "fillWorld", "replace", "strokeWorld", "_options", "showHit", "showBounds", "w", "__nowWorld", "setWorld", "__drawHitPath", "fillStyle", "fill", "resetTransform", "setStroke", "stroke", "messages", "D", "enable", "every", "some", "console", "log", "warn", "showWarn", "Error", "error", "debug", "Run", "currentId", "currentName", "idMap", "nameMap", "nameToIdMap", "microsecond", "id", "create", "R", "performance", "now", "Date", "time", "duration", "end", "check", "Plugin", "needPlugins", "tip", "rs", "need", "setTimeout", "has", "Creator", "editor", "UICreator", "UI", "__tag", "prototype", "repeat", "ui", "EventCreator", "nameList", "Event", "oldName", "newName", "constName", "find", "params", "CanvasManager", "manager", "old", "recycled", "isSameSize", "clearRecycled", "clear", "__decorate", "decorators", "target", "desc", "arguments", "getOwnPropertyDescriptor", "Reflect", "decorate", "defineProperty", "__awaiter", "thisArg", "_arguments", "generator", "Promise", "resolve", "reject", "fulfilled", "step", "next", "rejected", "result", "done", "then", "apply", "contextAttr", "realName", "property", "context", "contextMethodNameList", "contextMethod", "_target", "key", "push", "emptyArray", "Canvas", "value", "this", "context", "globalCompositeOperation", "blendMode", "setLineDash", "dashPattern", "getLineDash", "__bindContext", "method", "forEach", "name", "bind", "textBaseline", "_a", "_b", "_c", "_d", "_e", "_f", "resetTransform", "getTransform", "save", "restore", "a", "b", "c", "d", "e", "f", "isObject", "transform", "_x", "_y", "_angle", "_path2d", "_rule", "_width", "_height", "image", "sx", "sy", "sw", "sh", "dx", "dy", "dw", "dh", "arguments", "length", "drawImage", "beginPath", "_cp1x", "_cp1y", "_cp2x", "_cp2y", "_cpx", "_cpy", "closePath", "_radius", "_startAngle", "_endAngle", "_anticlockwise", "_x1", "_y1", "_x2", "_y2", "_radiusX", "_radiusY", "_rotation", "_x0", "_y0", "_image", "_repetition", "_r0", "_r1", "_text", "_maxWidth", "destroy", "__decorate", "contextAttr", "prototype", "copy", "multiplyParent", "pixelScale", "MatrixHelper", "round", "Math", "tempPixelBounds", "Bounds", "tempPixelBounds2", "minSize", "width", "height", "pixelRatio", "canvasSizeAttrs", "LeaferCanvasBase", "size", "pixelWidth", "pixelHeight", "pixelSnap", "config", "allowBackgroundColor", "view", "parentView", "manager", "super", "worldTransform", "innerId", "IncrementId", "create", "CNAVAS", "autoLayout", "Platform", "devicePixelRatio", "init", "__createContext", "contextSettings", "getContext", "_filename", "_options", "_type", "_quality", "safeResize", "isSameSize", "takeCanvas", "unreal", "getSameCanvas", "copyWorld", "s", "DataHelper", "copyAttrs", "bounds", "updateViewSize", "updateClientBounds", "smooth", "clearWorld", "recycle", "update", "clientBounds", "_autoBounds", "_listener", "stopAutoLayout", "_cursor", "matrix", "parentMatrix", "w", "ignorePixelSnap", "half", "setTransform", "color", "strokeWidth", "options", "childOptions", "strokeStyle", "setStrokeOptions", "strokeCap", "strokeJoin", "dashOffset", "miterLimit", "isUndefined", "savedBlendMode", "restoreBlendMode", "_point", "_fillRule", "_strokeWidth", "_radiusPoint", "_offset", "_scale", "x", "y", "blur", "shadowOffsetX", "shadowOffsetY", "shadowBlur", "shadowColor", "filter", "canvas", "from", "to", "ceilPixel", "setTempPixelBounds", "setTempPixelBounds2", "fromWorld", "toInnerBounds", "BoundsHelper", "tempToOuterOf", "onlyResetTransform", "useWorldTransform", "alpha", "pixel", "imageData", "getImageData", "data", "i", "len", "putImageData", "maskCanvas", "fromBounds", "toBounds", "eraserCanvas", "fillStyle", "fillRect", "strokeRect", "rect", "clip", "ruleData", "windingRule", "clearRect", "clear", "ceil", "intersect", "copyToPixelBounds", "pixelBounds", "set", "scale", "useSameWorldTransform", "useSameSmooth", "get", "Creator", "Object", "assign", "clearBounds", "recycled", "_bounds", "unrealCanvas", "PathHelper", "creator", "_pathString", "_curveMode", "_old", "CanvasCommandOnlyMap", "N", "D", "X", "G", "F", "O", "P", "U", "PathCommandMap", "M", "m", "L", "l", "H", "h", "V", "v", "C", "S", "Q", "q", "T", "t", "A", "Z", "z", "R", "PathCommandLengthMap", "NeedConvertToCanvasCommandMap", "NeedConvertToCurveCommandMap", "PathNumberCommandMap", "PathNumberCommandLengthMap", "RectHelper", "drawer", "cornerRadius", "MathHelper", "fourNumber", "min", "right", "bottom", "moveTo", "arcTo", "lineTo", "sin", "cos", "hypot", "atan2", "abs", "PI", "sqrt", "pow", "setPoint", "addPoint", "TwoPointBoundsHelper", "toNumberPoints", "PointHelper", "tempPoint", "BezierHelper", "originPoints", "curve", "close", "points", "aX", "aY", "bX", "bY", "cX", "cY", "c1X", "c1Y", "c2X", "c2Y", "baX", "baY", "ba", "cb", "path", "radius", "drawRoundRect", "convertToCanvasData", "fromX", "fromY", "x1", "y1", "toX", "toY", "setPointBounds", "setEndPoint", "setStartPoint", "BAx", "BAy", "CBx", "CBy", "startRadian", "endRadian", "lenBA", "lenCB", "totalRadian", "PI2", "anticlockwise", "sign", "centerX", "PI_2", "centerY", "ellipse", "OneRadian", "arc", "startAngle", "endAngle", "cx", "cy", "radiusX", "radiusY", "rotation", "rotationRadian", "rotationSin", "rotationCos", "parts", "partRadian", "partRadian4Sin", "control", "endCos", "endSin", "x2", "y2", "startCos", "startSin", "startX", "startY", "toTwoPointBounds", "pointBounds", "addMode", "tList", "t1", "t2", "sqrtV", "z1", "z2", "o", "getPointAndSet", "point", "fromV", "v1", "v2", "toV", "EllipseHelper", "largeFlag", "sweepFlag", "curveMode", "halfX", "halfY", "px", "py", "rxSquare", "rySquare", "pySquare", "pxSquare", "ellipseToCurve", "PathCommandNodeHelper", "toCommand", "_nodes", "toNode", "_data", "Command", "roundRect", "quadraticCurveTo", "ellipticalArc", "debug", "Debug", "PathConvert", "current", "dot", "floatLength", "count", "command", "lastCommand", "str", "j", "float", "pathString", "needConvert", "char", "lastChar", "num", "convertCommand", "StringNumberMap", "pushData", "index", "toCanvasData", "old", "controlX", "controlY", "copyData", "error", "list", "item", "end", "strNum", "Number", "getMinDistanceFrom", "getRadianFrom", "tan", "startPoint", "PathCommandDataHelper", "isNumber", "fourCorners", "isNull", "lastX", "lastY", "bezierCurveTo", "drawEllipse", "drawArc", "drawPoints", "PathCreator", "__path", "isString", "parse", "paint", "clearPath", "PathDrawer", "toTwoPointBoundsByQuadraticCurve", "addPointBounds", "addBounds", "tempPointBounds", "PathBounds", "setBounds", "getCenterX", "getCenterY", "PathCorner", "_cornerSmoothing", "commandLen", "secondX", "secondY", "isArray", "pen", "canvasPatch", "FileHelper", "alphaPixelTypes", "upperCaseTypeMap", "mineType", "type", "startsWith", "filename", "split", "fileType", "some", "quality", "blob", "toUpperCase", "TaskItem", "task", "parallel", "time", "id", "TASK", "run", "isComplete", "runing", "canUse", "cancel", "complete", "parent", "isCancel", "TaskProcessor", "total", "delayNumber", "finishedIndex", "parallelSuccessNumber", "remain", "percent", "totalTime", "runTime", "running", "empty", "taskCallback", "start", "delay", "setTimeout", "timer", "parallelList", "pause", "clearTimeout", "resume", "skip", "stop", "setParallelList", "runParallelTasks", "runTask", "onComplete", "then", "onTask", "nextTask", "catch", "onError", "runParallelTask", "fillParallelTask", "onParallelError", "pop", "parallelWaitNumber", "nextIndex", "Resource", "tasker", "map", "repeat", "r", "format", "Promise", "resolve", "reject", "setImage", "load", "url", "ImageManager", "maxRecycled", "recycledList", "patternTasker", "use", "isLarge", "remove", "clearLevels", "I", "force", "hasAlphaPixel", "isFormat", "includes", "clearRecycled", "IMAGE", "LeaferImage", "crossOrigin", "completed", "ready", "waitComplete", "setView", "isSVG", "onSuccess", "thumbSize", "loading", "add", "__awaiter", "origin", "loadImage", "getLoadUrl", "img", "setThumbView", "stopEvent", "isSuccess", "odd", "_filters", "opacity", "filters", "xGap", "yGap", "interlace", "cache", "params", "resize", "pattern", "createPattern", "setPatternTransform", "_thumbSize", "_view", "_lod", "getMinLevel", "_level", "_checkUse", "defineKey", "target", "descriptor", "noConfigurable", "configurable", "enumerable", "defineProperty", "getDescriptor", "object", "getOwnPropertyDescriptor", "createDescriptor", "defaultValue", "privateKey", "decorateLeafAttr", "descriptorFn", "defineLeafAttr", "attr", "partDescriptor", "defaultDescriptor", "__getAttr", "__setAttr", "defineDataProcessor", "dataType", "positionType", "checkFiniteNumber", "__layout", "matrixChanged", "matrixChange", "scrollType", "__scrollWorld", "autoLayoutType", "__hasAutoLayout", "around", "flow", "__local", "createLocal", "doBoundsType", "scaleType", "scaleChanged", "scaleChange", "rotationType", "rotationChanged", "rotationChange", "boundsType", "naturalBoundsType", "__", "__removeNaturalSize", "leaf", "boxChanged", "boxChange", "pathInputType", "__pathInputed", "__pathForRender", "pathType", "affectStrokeBoundsType", "useStroke", "doStrokeType", "__useStroke", "strokeChanged", "strokeChange", "__useArrow", "strokeType", "affectRenderBoundsType", "renderChanged", "renderChange", "surfaceType", "surfaceChanged", "surfaceChange", "dimType", "stintSet", "dim", "bright", "dimskip", "opacityType", "opacityChanged", "opacityChange", "mask", "checkMask", "visibleType", "oldValue", "visible", "animationOut", "__runAnimation", "doVisible", "animation", "__hasMask", "__updateMask", "forceUpdate", "sortType", "waitParent", "childrenSortChange", "maskType", "eraserType", "__updateEraser", "hitType", "hitCanvasChanged", "showBounds", "leafer", "updateCursor", "cursorType", "dataProcessor", "processor", "_key", "layoutProcessor", "__DataProcessor", "computedKey", "setMethodName", "charAt", "slice", "property", "__leaf", "isEmpty", "isEmptyData", "clone", "isBox", "isBranchLeaf", "naturalWidth", "__naturalWidth", "pathInputed", "boxBounds", "__useNaturalRatio", "__naturalHeight", "children", "naturalHeight", "find", "__proto__", "excludeNames", "rewrite", "constructor", "rewriteAble", "doRewrite", "useModule", "module", "exclude", "getOwnPropertyNames", "keys", "writable", "registerUI", "UICreator", "register", "registerUIEvent", "EventCreator", "toInnerPoint", "toOuterPoint", "scaleOfOuter", "rotateOfOuter", "skewOfOuter", "divideParent", "getLayout", "LeafHelper", "checkAutoLayout", "waitAutoLayout", "updateMatrix", "isBranch", "updateAllMatrix", "layout", "__updateLocalMatrix", "__updateWorldMatrix", "boundsChanged", "__updateLocalBounds", "__updateWorldBounds", "__updateWorldOpacity", "updateAllWorldOpacity", "stateStyleChanged", "updateState", "__updateChange", "updateChange", "updateAllChange", "hittable", "draggable", "editable", "hitSelf", "locked", "currentCanvas", "fromCanvas", "__nowWorld", "__worldFlipped", "fullImageShadow", "copyWorldByReset", "copyWorldToInner", "renderBounds", "isInnerPoint", "transition", "local", "localTransform", "scrollWorldTransform", "moveLocal", "pointSnap", "animate", "scaleX", "scaleY", "zoomOfLocal", "getTempLocal", "__localMatrix", "hasHighPosition", "scaleResize", "angle", "rotateOfLocal", "formatRotation", "skewX", "skewY", "skewOfLocal", "originPoint", "getInnerOrigin", "hasOffset", "offsetX", "offsetY", "changedPoint", "move", "axis", "getLocalOrigin", "innerOrigin", "AroundHelper", "toPoint", "getRelativeWorld", "relative", "temp", "p", "speed", "requestRender", "animateMove", "worldPoint", "updateLayout", "tempToInnerOf", "LeafBoundsHelper", "worldBounds", "__world", "localBoxBounds", "eraser", "localStrokeBounds", "localRenderBounds", "maskLocalBoxBounds", "__localBoxBounds", "maskLocalStrokeBounds", "maskLocalRenderBounds", "excludeRenderBounds", "child", "hit", "hideBounds", "findMask", "updateBounds", "BranchHelper", "sort", "zIndex", "__tempNumber", "branch", "leafList", "__childBranchNumber", "pushAllChildBranch", "pushList", "pushAllBranchStack", "branchStack", "updateBoundsByBranchStack", "changeScaleX", "changeScaleY", "WaitHelper", "wait", "splice", "toOuterOf", "getPoints", "localContent", "worldContent", "worldBox", "worldStroke", "LeafLayout", "contentBounds", "_contentBounds", "strokeBounds", "_strokeBounds", "_renderBounds", "localContentBounds", "_localStrokeBounds", "_localRenderBounds", "worldContentBounds", "worldBoxBounds", "worldStrokeBounds", "isApp", "watcher", "changed", "layouter", "root", "__fullLayouting", "defaultMatrix", "zoomLayer", "getWorldBounds", "getLocalBounds", "getInnerBounds", "unscale", "layoutBounds", "getWorldPoint", "getLocalPointByInner", "uScaleX", "uScaleY", "relativeLeaf", "innerToWorld", "shrinkContent", "spreadStroke", "renderSpread", "spreadRenderCancel", "spreadRender", "shrinkContentCancel", "spreadStrokeCancel", "same", "localBoxChanged", "localBoxChange", "strokeSpread", "_scaleOrRotationChange", "affectRotation", "affectScaleOrRotation", "childrenSortChanged", "affectChildrenSort", "Event", "bubbles", "stopDefault", "isStopDefault", "event", "stopNow", "isStopNow", "isStop", "ChildEvent", "ADD", "REMOVE", "CREATED", "MOUNTED", "UNMOUNTED", "DESTROY", "SCROLL", "PropertyEvent", "attrName", "newValue", "CHANGE", "LEAFER_CHANGE", "extraPropertyEventMap", "scrollX", "scrollY", "ImageEvent", "LOAD", "LOADED", "ERROR", "BoundsEvent", "mode", "WORLD", "__hasWorldEvent", "__hasLocalEvent", "hasEvent", "RESIZE", "INNER", "LOCAL", "leaferIsReady", "resized", "emit", "boundsEventMap", "ResizeEvent", "bigger", "smaller", "samePixelRatio", "oldSize", "resizingKeys", "WatchEvent", "REQUEST", "DATA", "LayoutEvent", "times", "START", "BEFORE", "LAYOUT", "AFTER", "AGAIN", "END", "RenderEvent", "renderOptions", "CHILD_START", "CHILD_END", "RENDER", "NEXT", "LeaferEvent", "BEFORE_READY", "READY", "AFTER_READY", "VIEW_READY", "VIEW_COMPLETED", "STOP", "RESTART", "UPDATE_MODE", "TRANSFORM", "MOVE", "SCALE", "ROTATE", "SKEW", "leaferTransformAttrMap", "Eventer", "on", "listener", "capture", "once", "events", "__getListenerMap", "typeList", "findIndex", "checkHas", "__bubbleMap", "__captureMap", "off", "captureOrBind", "has", "syncEventer", "emitEvent", "hasB", "hasC", "eventer", "on_", "off_", "LeafEventer", "destroyEventer", "LeafDataProxy", "leaferIsCreated", "__getInput", "isFinite", "warn", "innerName", "__realSetAttr", "isLeafer", "transformEventName", "emitPropertyEvent", "extraPropertyEvent", "__proxyData", "setProxyAttr", "normalStyle", "lockNormalStyle", "getProxyAttr", "__get", "setLayout", "translateInner", "defaultWorld", "LeafMatrix", "copyAndSpread", "LeafBounds", "__onUpdateSize", "emitLocal", "emitWorld", "__updatePath", "__updateRenderPath", "__updateBoxBounds", "__updateLocalBoxBounds", "__updateStrokeSpread", "__updateStrokeBounds", "__updateLocalStrokeBounds", "strokeBoxSpread", "__updateRenderSpread", "__updateRenderBounds", "__updateLocalRenderBounds", "__hasMotionPath", "__updateMotionPath", "__updateAutoLayout", "_secondLayout", "__usePathBox", "__extraUpdate", "__updateFlowLayout", "__autoSide", "__updateNaturalSize", "LeafRender", "shape", "__renderShape", "cellList", "__worldOpacity", "topRendering", "topList", "setWorld", "__getNowWorld", "dimOpacity", "__single", "__renderEraser", "tempCanvas", "__draw", "copyCanvasByWorld", "__blendMode", "drawBounds", "__drawShape", "__drawRenderPath", "clipUI", "hasSize", "BranchRender", "__updateSortChildren", "__checkSingle", "nowWorld", "__useDim", "__renderBranch", "__renderMask", "__render", "__clip", "tempScaleData", "LEAF", "moveWorld", "zoomOfWorld", "rotateOfWorld", "skewOfWorld", "transformWorld", "getFlipTransform", "drop", "Leaf", "tag", "__tag", "_value", "LeafData", "__LayoutProcessor", "created", "getBounds", "worldRenderBounds", "worldOpacity", "__onlyHitMask", "hitChildren", "__ignoreHitWorld", "__hasEraser", "__inLazyBounds", "lazyBounds", "reset", "__emitLifeEvent", "forceRender", "__level", "resetCustom", "toJSON", "nextRender", "waitLeafer", "leafs", "__bindLeafer", "_isTemp", "_name", "__getInputData", "JSON", "stringify", "toSVG", "toHTML", "_attrName", "_newValue", "_condition", "_tag", "_id", "_sync", "addExtra", "__updateContentBounds", "_canvas", "__cameraWorld", "cameraWorld", "world", "getClampRenderScale", "scaleFixed", "patternLocked", "getLayoutBounds", "getLayoutPoints", "inner", "change", "distance", "worldToInner", "getBoxPointByInner", "getInnerPoint", "_relative", "_distance", "box", "worldToLocal", "getInnerPointByBox", "localToWorld", "page", "worldOrigin", "_noResize", "_scaleX", "_scaleY", "_world", "_hitRadius", "_forceHitFill", "_local", "_inner", "__updateHitCanvas", "_originCanvas", "getMotionPathData", "Plugin", "need", "_motionDistance", "getMotionTotal", "_complete", "_child", "_index", "_bind", "_captureOrBind", "_capture", "_event", "fn", "addAttr", "helpValue", "destroyed", "setListWithFn", "Branch", "affectSort", "noIndex", "childLayout", "__emitChildEvent", "__remove", "__preRemove", "__realRemoveChild", "removeAll", "indexOf", "hitCanvasManager", "LeafList", "addList", "unshift", "reverse", "itemCallback", "LeafLevelList", "_length", "levels", "levelMap", "level", "version", "__decorate", "decorators", "target", "key", "desc", "d", "c", "arguments", "length", "r", "Object", "getOwnPropertyDescriptor", "Reflect", "decorate", "i", "defineProperty", "effectType", "defaultValue", "decorateLeafAttr", "attr", "value", "this", "__setAttr", "__", "__useEffect", "__layout", "renderChanged", "renderChange", "resizeType", "boxChanged", "boxChange", "__updateSize", "zoomLayerType", "privateKey", "defineKey", "isLeafer", "get", "isApp", "tree", "zoomLayer", "leafer", "createAttr", "createDescriptor", "TextConvert", "ColorConvert", "color", "length", "first", "i", "lastIndexOf", "parseFloat", "slice", "UnitConvert", "UnitConvertHelper", "PathArrow", "Paint", "PaintImage", "PaintGradient", "Effect", "Filter", "apply", "Plugin", "need", "Export", "State", "setStyleName", "set", "Transition", "list", "attrName", "fn", "get", "parse", "objectToCanvasData", "PathConvert", "stintSet", "DataHelper", "hasTransparent", "emptyPaint", "originPaint", "debug", "Debug", "UIData", "LeafData", "scale", "scaleX", "scaleY", "this", "x", "y", "__strokeWidth", "__getRealStrokeWidth", "__maxStrokeWidth", "t", "__hasMultiStrokeStyle", "Math", "max", "strokeWidth", "__hasMultiPaint", "fill", "__useStroke", "__isFills", "__isStrokes", "stroke", "__useEffect", "__clipAfterFill", "cornerRadius", "innerShadow", "__pathInputed", "__hasSurface", "__autoWidth", "_width", "__autoHeight", "_height", "__autoSide", "__autoSize", "value", "_visible", "leafer", "__leaf", "watcher", "hasVisible", "warn", "__naturalWidth", "__removeNaturalSize", "isString", "__removePaint", "_fill", "isObject", "__setPaint", "_stroke", "isStr", "__setInput", "_path", "__input", "__removeInput", "setArray", "__computePaint", "compute", "__needComputePaint", "childStyle", "strokeWidthFixed", "isUndefined", "getClampRenderScale", "layout", "__layout", "boxChanged", "boxChange", "isArray", "removeInput", "recycleImage", "undefined", "data", "key", "some", "item", "visible", "filter", "GroupData", "BoxData", "__boxStroke", "__drawAfterFill", "__single", "overflow", "children", "isOverflow", "super", "LeaferData", "names", "options", "__getInputData", "canvasSizeAttrs", "forEach", "FrameData", "LineData", "__usePathBox", "points", "RectData", "EllipseData", "PolygonData", "StarData", "PathData", "PenData", "fontWeightMap", "thin", "light", "normal", "medium", "bold", "black", "TextData", "__useNaturalRatio", "_fontWeight", "box", "__box", "boxStyle", "UICreator", "boxLayout", "parent", "__world", "boxBounds", "strokeChanged", "strokeChange", "destroy", "_boxStyle", "textEditing", "ImageData", "__setImageFill", "_url", "type", "mode", "url", "__getData", "CanvasData", "__isCanvas", "canvas", "toDataURL", "add", "FourNumberHelper", "UIBounds", "__updateStrokeSpread", "spread", "boxSpread", "__", "strokeAlign", "hitStroke", "miterLimitAddWidth", "__isLinePath", "storkeCapAddWidth", "strokeCap", "__useArrow", "strokeSpread", "strokeBoxSpread", "__updateRenderSpread", "shadow", "blur", "backgroundBlur", "renderSpread", "getShadowRenderSpread", "getSpread", "shapeSpread", "getInnerShadowSpread", "renderShapeSpread", "UIRender", "__updateChange", "useStroke", "__isTransparentFill", "otherEffect", "isTransformShadow", "useFastShadow", "__checkSingle", "drawFast", "originCanvas", "__complex", "__fillAfterStroke", "__isFastShadow", "__drawRenderPath", "shape", "__nowWorld", "__getNowWorld", "strokes", "fills", "worldCanvas", "recycle", "getRenderScaleData", "scaleFixed", "save", "setWorldShadow", "string", "restore", "__pathForRender", "__drawFast", "ignoreFill", "__isAlphaPixelFill", "ignoreStroke", "__isAlphaPixelStroke", "clipUI", "__drawContent", "ui", "RectRender", "width", "height", "fillStyle", "fillRect", "setStroke", "half", "strokeRect", "__clip", "ce", "UI", "UI_1", "Leaf", "app", "isFrame", "MathHelper", "assignScale", "isAutoWidth", "autoWidth", "isAutoHeight", "autoHeight", "pen", "path", "__drawPathByBox", "_data", "_transition", "Object", "assign", "name", "__getInput", "createProxyData", "_condition", "_options", "tag", "find", "id", "findOne", "curve", "pathForRender", "update", "toCanvasData", "floatLength", "stringify", "getPath", "load", "__onUpdateSize", "lazy", "__inLazyBounds", "running", "__updateRenderPath", "PathCorner", "smooth", "cornerSmoothing", "addArrows", "beginPath", "__drawPathByData", "drawer", "ignoreCornerRadius", "PathDrawer", "drawPathByData", "roundRect", "isNumber", "rect", "closePath", "_paint", "renderOptions", "placeholderColor", "keyframe", "_type", "_isTemp", "_nextStyle", "_filename", "json", "clone", "toJSON", "one", "prototype", "__tag", "registerUI", "dataProcessor", "_config", "_toolName", "_editorName", "__animate", "killAnimate", "__decorate", "zoomLayerType", "dataType", "surfaceType", "opacityType", "visibleType", "dimType", "sortType", "maskType", "eraserType", "positionType", "boundsType", "scaleType", "rotationType", "scrollType", "autoLayoutType", "naturalBoundsType", "affectRenderBoundsType", "pathInputType", "pathType", "hitType", "strokeType", "cursorType", "effectType", "rewrite", "reset", "useModule", "rewriteAble", "Group", "isBranch", "__setBranch", "transition", "clear", "child", "childlessJSON", "map", "_hitPoint", "index", "after", "indexOf", "before", "_child", "_index", "_children", "_destroy", "ve", "Branch", "Leafer", "Leafer_1", "isApp", "isLeafer", "imageReady", "viewReady", "Resource", "isComplete", "layoutLocked", "layouter", "view", "FPS", "renderer", "cursorPoint", "interaction", "hoverData", "clientBounds", "getClientBounds", "getBoundsData", "userConfig", "config", "start", "hittable", "lazySpeard", "leafs", "__eventIds", "__controllers", "__readyWait", "__viewReadyWait", "__viewCompletedWait", "__nextRenderWait", "init", "parentApp", "__setLeafer", "__bindApp", "initType", "Creator", "push", "__setApp", "__checkAutoLayout", "selector", "unshift", "hitCanvasManager", "canvasManager", "CanvasManager", "__listenEvents", "__startTimer", "setTimeout", "bind", "WaitHelper", "run", "__initWait", "onInit", "waitInit", "clearTimeout", "ready", "emitLeafer", "LeaferEvent", "RESTART", "START", "render", "stop", "STOP", "unlockLayout", "updateLayout", "lockLayout", "size", "copyAttrs", "keys", "bounds", "sync", "addBlock", "Bounds", "change", "cursor", "setCursor", "updateCursor", "updateLazyBounds", "lazyBounds", "isSameSize", "old", "resize", "__onResize", "ResizeEvent", "event", "emitEvent", "clearRecycled", "__level", "autoLayout", "AutoBounds", "startAutoLayout", "newValue", "includes", "__changeCanvasSize", "__changeFill", "zIndex", "__updateSortChildren", "emit", "UPDATE_MODE", "__setAttr", "__getAttr", "stopAutoLayout", "__doResize", "allowBackgroundColor", "backgroundColor", "forceRender", "__onCreated", "created", "__onReady", "BEFORE_READY", "READY", "AFTER_READY", "__onViewReady", "VIEW_READY", "__onLayoutEnd", "grow", "fixedWidth", "fixedHeight", "pixelRatio", "worldBoxBounds", "__onNextRender", "viewCompleted", "__checkViewCompleted", "requestRender", "nextRender", "VIEW_COMPLETED", "__onWatchData", "childrenChanged", "off", "splice", "_zoomType", "_optionsOrPadding", "_scroll", "moveX", "moveY", "_checkLimit", "changeScale", "clientPoint", "updateClient", "getLocal", "getPagePoint", "getWorldPointByClient", "worldPoint", "updateClientBounds", "_event", "runId", "Run", "innerName", "once", "end", "LayoutEvent", "RenderEvent", "END", "on_", "WatchEvent", "DATA", "NEXT", "__removeListenEvents", "off_", "doDestory", "destroyed", "remove", "ImageManager", "e", "error", "LeafList", "Rect", "scroll", "BoundsHelper", "group", "Box", "isBranchLeaf", "renderChanged", "renderChange", "__updateRectRenderSpread", "__updateRectBoxBounds", "_secondLayout", "pathInputed", "__extraUpdate", "__updateBoxBounds", "__updateNaturalSize", "__updateStrokeBounds", "__updateRenderBounds", "isScrollMode", "renderBounds", "childrenRenderBounds", "__updateRectRenderBounds", "__checkScroll", "_isScrollMode", "__updateRectChange", "_canvas", "__renderRect", "__renderGroup", "hasScroller", "scroller", "__render", "setWorld", "Frame", "moveTo", "ellipse", "PathCommandDataHelper", "Ellipse", "__updatePath", "innerRadius", "startAngle", "endAngle", "rx", "ry", "open", "Platform", "ellipseToCurve", "sin", "cos", "PI", "lineTo", "drawPoints", "Polygon", "sides", "Star", "corners", "rotate", "getAngle", "getDistance", "defaultPoint", "PointHelper", "Line", "toPoint", "rotation", "to", "getPointData", "closed", "affectStrokeBoundsType", "Image", "image", "MyImage", "Canvas", "context", "drawImage", "LeaferImage", "paint", "ImageEvent", "LOADED", "offset", "matrix", "Matrix", "worldTransform", "invert", "m", "translate", "multiplyParent", "withScale", "__updateSize", "safeResize", "resizeType", "copyAndSpread", "setList", "Text", "textDrawData", "__textDrawData", "__updateTextDrawData", "lineHeight", "letterSpacing", "fontFamily", "fontSize", "fontWeight", "italic", "textCase", "textOverflow", "padding", "__lineHeight", "number", "__letterSpacing", "__baseLine", "__font", "fourNumber", "getDrawData", "__isPlacehold", "placeholder", "text", "contentBounds", "b", "top", "right", "bottom", "left", "__padding", "__textBoxBounds", "font", "__draw", "exporting", "__drawShape", "Path", "Pen", "pathElement", "pathStyle", "__path", "_x", "_y", "_x1", "_y1", "_x2", "_y2", "_cornerRadius", "_radiusX", "_radiusY", "_rotation", "_startAngle", "_endAngle", "_anticlockwise", "_radius", "_points", "_curve", "_close", "clearPath", "forceUpdate", "target", "defineKey", "PathCreator", "__decorate", "decorators", "target", "key", "desc", "d", "c", "arguments", "length", "r", "Object", "getOwnPropertyDescriptor", "Reflect", "decorate", "i", "defineProperty", "App", "Leafer", "__tag", "isApp", "userConfig", "data", "super", "parentApp", "init", "ground", "tree", "sky", "editor", "this", "addLeafer", "type", "Creator", "__setApp", "canvas", "realCanvas", "view", "config", "parentView", "unrealCanvas", "leafer", "watcher", "disable", "layouter", "__updateLocalBounds", "forEach", "updateLayout", "start", "stop", "unlockLayout", "lockLayout", "bounds", "sync", "forceRender", "merge", "add", "index", "setTimeout", "__getChildConfig", "isUndefined", "childIndex", "__listenChildEvents", "fn", "children", "__onCreated", "created", "every", "child", "__onReady", "ready", "__onViewReady", "viewReady", "e", "renderer", "addBlock", "renderBounds", "update", "options", "context", "matrix", "__render", "copyWorld", "event", "resize", "__onResize", "Object", "assign", "hittable", "DataHelper", "autoLayout", "copyAttrs", "canvasSizeAttrs", "fill", "once", "LayoutEvent", "END", "RenderEvent", "START", "__eventIds", "push", "on_", "__onChildRenderEnd", "__decorate", "registerUI", "downKeyMap", "Keyboard", "isHoldSpaceKey", "isHold", "code", "isHoldKeys", "shortcutKeys", "PointerButton", "LEFT", "RIGHT", "MIDDLE", "buttons", "left", "right", "middle", "UIEvent", "Event", "spaceKey", "B", "params", "bubbles", "relative", "current", "getBoxPoint", "getInnerPoint", "getLocalPoint", "getPagePoint", "getPage", "oldName", "newName", "EventCreator", "changeName", "min", "max", "abs", "Math", "float", "sign", "MathHelper", "minX", "maxX", "minY", "maxY", "BoundsHelper", "tempContent", "Bounds", "tempDragBounds", "DragBoundsHelper", "leaf", "move", "dragBounds", "dragBoundsType", "D", "getValidMove", "__localBoxBounds", "getDragBounds", "axisMove", "origin", "scale", "lockRatio", "getValidScaleOf", "getLocalPointByInner", "getInnerPointByBox", "draggable", "y", "x", "parent", "boxBounds", "isInnerMode", "content", "sideType", "change", "width", "bottom", "height", "boundsRight", "boundsBottom", "set", "scaleOf", "originLeftScale", "originRightScale", "originTopScale", "originBottomScale", "aScale", "bScale", "aSize", "bSize", "correctScaleX", "correctScaleY", "unsign", "isFinite", "PointerEvent", "POINTER", "BEFORE_DOWN", "BEFORE_MOVE", "BEFORE_UP", "DOWN", "MOVE", "UP", "OVER", "OUT", "ENTER", "LEAVE", "TAP", "DOUBLE_TAP", "CLICK", "DOUBLE_CLICK", "LONG_PRESS", "LONG_TAP", "MENU", "MENU_TAP", "registerUIEvent", "MyPointerEvent", "tempMove", "DragEvent", "list", "LeafList", "localStart", "worldTotal", "checkLimit", "PointHelper", "limitMove", "total", "assignMove", "getPageTotal", "getPageMove", "getInnerMove", "getLocalMove", "getPageBounds", "totalX", "moveX", "totalY", "moveY", "BEFORE_DRAG", "DRAG", "MyDragEvent", "DropEvent", "setList", "setData", "DROP", "MoveEvent", "DRAG_ANIMATE", "PULL_DOWN", "REACH_BOTTOM", "TouchEvent", "MyTouchEvent", "RotateEvent", "BEFORE_ROTATE", "ROTATE", "SwipeEvent", "SWIPE", "ZoomEvent", "BEFORE_ZOOM", "ZOOM", "KeyEvent", "HOLD", "InteractionHelper", "getDragEventData", "startPoint", "lastPoint", "getDropEventData", "getSwipeDirection", "angle", "getSwipeEventData", "lastDragData", "I", "getAngle", "pointerUpButtons", "button", "altKey", "ctrlKey", "shiftKey", "metaKey", "time", "Date", "now", "path", "i", "len", "length", "hasEvent", "find", "pathCanDrag", "some", "item", "LeafHelper", "isLeafer", "pathHasOutside", "isOutside", "emptyList", "Dragger", "interaction", "dragDataList", "animateWait", "dragEndReal", "downData", "dragData", "canAnimate", "canDragOut", "realDraggable", "hover", "proxy", "selector", "hasProxyList", "dragList", "draggableList", "dragging", "dragHoverExclude", "canDrag", "moving", "pointerCancel", "canMove", "isHoldRightKey", "isMobileDragEmpty", "moveType", "emit", "dragStart", "drag", "getDraggableList", "setDragStartPoints", "realDraggableList", "getList", "dragStartPoints", "innerId", "throughPath", "dragReal", "isDragEnd", "running", "dragLimitAnimate", "p", "checkLimitMove", "axisDrag", "isString", "animateMove", "isNumber", "dragOverPath", "indexAt", "dragEnterPath", "checkDragEndAnimate", "endDragData", "dropList", "swipe", "drop", "autoMoveCancel", "dragReset", "animate", "getDistance", "pointer", "swipeDistance", "swipeData", "dropData", "_data", "_speed", "_func", "_off", "stopAnimate", "destroy", "debug", "Debug", "get", "allowTypes", "emitAppChildren", "capture", "excludePath", "name", "startsWith", "__", "hitChildren", "exclude", "has", "emitEvent", "destroyed", "hitSelf", "State", "updateEventStyle", "phase", "target", "isStop", "wheel", "zoomSpeed", "moveSpeed", "rotateSpeed", "delta", "snap", "hitRadius", "tapTime", "longPressTime", "transformTime", "dragHover", "dragDistance", "touch", "preventDefault", "multiTouch", "autoDistance", "zoom", "cursor", "keyEvent", "pathHasEventType", "InteractionBase", "dragger", "transforming", "transformer", "moveMode", "m", "isHoldMiddleKey", "isDragEmpty", "canHover", "mobile", "dragEmpty", "isRootPath", "hoverData", "isTreePath", "holdMiddleKey", "holdRightKey", "holdSpaceKey", "clone", "tapCount", "defaultPath", "createTransformer", "default", "__listenEvents", "_event", "useDefaultPath", "defaultLeft", "updateDownData", "checkPath", "downTime", "tapWait", "longPressWait", "waitRightTap", "setDragData", "updateCursor", "hitPoint", "pointerMoveReal", "checkDragOut", "pointerWaitCancel", "checkDrag", "updateHoverData", "pointerHover", "dragOverOrOut", "dragEnterOrLeave", "findPath", "upData", "addList", "touchLeave", "isCancel", "tap", "menuTap", "dragEnd", "pointerUp", "waitMenuTap", "transformEnd", "_list", "setDownCode", "cancelHover", "setUpCode", "pointerOverOrOut", "pointerEnterOrLeave", "overPath", "enterPath", "pointerType", "hasLong", "longTap", "tapMore", "waitTap", "emitTap", "useTime", "hasDouble", "tapWaitCancel", "emitDoubleTap", "clearTimeout", "tapTimer", "through", "bottomList", "Platform", "backgrounder", "getByPoint", "app", "syncEventer", "focusData", "stopDragAnimate", "setCursor", "clientPoint", "updateClient", "clientBounds", "getClientBounds", "point", "clientX", "clientY", "round", "longPressWaitCancel", "longPressTimer", "longPressed", "dragOut", "shrinkCanvasBounds", "spread", "ResizeEvent", "RESIZE", "LeaferEvent", "READY", "__removeListenEvents", "off_", "error", "Cursor", "value", "custom", "HitCanvasManager", "CanvasManager", "constructor", "maxTotal", "pathList", "pixelList", "__autoClear", "hitCanvas", "clearImageType", "__clearLeafList", "clearPathType", "leafList", "__hitCanvas", "reset", "clear", "getSelector", "toInnerRadiusPointOf", "copyRadiusPoint", "hitRadiusPoint", "inner", "worldRadiusPoint", "Leaf", "prototype", "hit", "worldPoint", "world", "__world", "isBranch", "__hitWorld", "forceHitFill", "layout", "__layout", "isSmall", "hitBox", "hitCanvasChanged", "__updateHitCanvas", "boundsChanged", "__hit", "__hitFill", "h", "hitFill", "windingRule", "__hitStroke", "strokeWidth", "hitStroke", "__hitPixel", "hitPixel", "hitScale", "__drawHitPath", "__drawRenderPath", "Matrix", "ui", "UI", "__box", "hitCanvasManager", "isHitPixelFill", "__isAlphaPixelFill", "__isCanvas", "isHitPixelStroke", "__isAlphaPixelStroke", "isHitPixel", "getPixelType", "contextSettings", "willReadFrequently", "getPathType", "size", "image", "hitCanvasSize", "tempBounds", "getFitMatrix", "a", "pixelRatio", "ImageManager", "patternLocked", "__renderShape", "setWith", "scaleWith", "invertWith", "translate", "snapshot", "ignoreFill", "ignoreStroke", "resetTransform", "__isHitPixel", "setStrokeOptions", "needHitFillPath", "__maxStrokeWidth", "needHitStrokePath", "stroke", "radiusWidth", "radiusX", "hitWidth", "strokeAlign", "rect", "Rect", "box", "Box", "cornerRadius", "call", "Text", "__lineHeight", "fontSize", "__baseLine", "__letterSpacing", "__textDrawData", "beginPath", "__drawPathByBox", "rows", "row", "Group", "pick", "emptyData", "LeaferCanvasBase", "fillRule", "isPointInPath", "isPointInStroke", "radiusPoint", "offset", "radiusY", "ceil", "getImageData", "PathNodeHandleType", "debug", "Debug", "get", "LeaferCanvas", "LeaferCanvasBase", "zIndex", "style", "this", "view", "setAbsolute", "index", "parentView", "beforeNode", "children", "insertBefore", "appendChild", "init", "config", "canvas", "__createViewFrom", "__createView", "display", "parentElement", "pStyle", "webkitUserSelect", "userSelect", "classList", "add", "Platform", "syncDomFont", "document", "body", "__createContext", "autoLayout", "resize", "color", "backgroundColor", "hittable", "pointerEvents", "createElement", "inputView", "find", "isString", "getElementById", "HTMLCanvasElement", "parent", "window", "div", "position", "top", "bottom", "left", "right", "hasChildNodes", "error", "updateViewSize", "width", "height", "pixelRatio", "unreal", "Math", "ceil", "updateClientBounds", "clientBounds", "getBoundingClientRect", "autoBounds", "listener", "resizeListener", "resizeObserver", "ResizeObserver", "entries", "entry", "checkAutoBounds", "contentRect", "observe", "warn", "_a", "imitateResizeObserver", "stopListenPixelRatio", "listenPixelRatio", "requestRender", "bind", "windowListener", "addEventListener", "devicePixelRatio", "emitResize", "removeEventListener", "parentSize", "x", "y", "getBoundsFrom", "size", "isSameSize", "marginLeft", "marginTop", "stopAutoLayout", "disconnect", "oldSize", "DataHelper", "copyAttrs", "canvasSizeAttrs", "isUndefined", "ResizeEvent", "unrealCanvas", "remove", "destroy", "super", "canvasPatch", "CanvasRenderingContext2D", "prototype", "Path2D", "mineType", "fileType", "FileHelper", "useCanvas", "_canvasType", "_power", "origin", "canvasToDataURL", "type", "quality", "imageType", "url", "toDataURL", "replace", "canvasToBolb", "Promise", "resolve", "toBlob", "canvasSaveAs", "filename", "download", "el", "href", "click", "removeChild", "loadImage", "src", "reject", "img", "Image", "crossOrigin", "image", "setAttribute", "onload", "onerror", "e", "getRealURL", "PointerEvent", "DragEvent", "event", "preventDefault", "stopImmediatePropagation", "stopPropagation", "Creator", "conicGradientSupport", "context", "createConicGradient", "Object", "assign", "options", "manager", "LeaferImage", "name", "isMobile", "render", "requestAnimationFrame", "defineKey", "userAgent", "navigator", "indexOf", "conicGradientRotate90", "intWheelDeltaY", "test", "fullImageShadow", "os", "Watcher", "childrenChanged", "hasAdd", "hasRemove", "hasVisible", "updatedList", "usePartLayout", "LeafList", "__updatedList", "list", "forEach", "item", "leafer", "target", "userConfig", "totalTimes", "default", "__listenEvents", "start", "disabled", "running", "stop", "disable", "__removeListenEvents", "update", "changed", "emit", "RenderEvent", "REQUEST", "ChildEvent", "ADD", "__pushChild", "child", "isBranch", "__loopChildren", "i", "len", "length", "__onRquestData", "emitEvent", "WatchEvent", "DATA", "__eventIds", "on_", "PropertyEvent", "CHANGE", "__onAttrChange", "REMOVE", "__onChildEvent", "off_", "updateAllMatrix", "updateBounds", "updateOneBounds", "updateChange", "updateOneChange", "LeafHelper", "pushAllChildBranch", "pushAllParent", "BranchHelper", "worldBounds", "LeafBoundsHelper", "LayoutBlockData", "updatedBounds", "Bounds", "beforeBounds", "afterBounds", "isArray", "setBefore", "setListWithFn", "setAfter", "setList", "data", "addList", "updateAllChange", "Layouter", "__levelList", "LeafLevelList", "layout", "layouting", "times", "LayoutEvent", "START", "layoutOnce", "END", "layoutedBlocks", "layoutAgain", "waitAgain", "partLayout", "fullLayout", "t", "Run", "updateList", "BEFORE", "LAYOUT", "AFTER", "blocks", "getBlocks", "extraBlock", "sort", "levelList", "leaf", "__layout", "without", "proxyZoom", "matrixChanged", "boundsChanged", "__tempNumber", "boundsList", "branch", "levels", "level", "levelMap", "j", "jLen", "push", "addBlocks", "reset", "end", "has", "__world", "set", "createBlock", "current", "AGAIN", "__onReceiveWatchData", "Renderer", "needFill", "allowBackgroundColor", "fill", "FPS", "usePartRender", "ceilPartPixel", "maxFPS", "frames", "change", "requestTime", "__requestRender", "requestLayout", "checkRender", "isApp", "CHILD_START", "renderer", "CHILD_END", "NEXT", "callback", "totalBounds", "log", "innerName", "emitRender", "renderOnce", "ImageManager", "clearRecycled", "rendering", "renderAgain", "renderBounds", "renderOptions", "ignore", "partRender", "fullRender", "RENDER", "updateBlocks", "mergeBlocks", "block", "bounds", "hit", "isEmpty", "clipRender", "getIntersect", "realBounds", "save", "spread", "clipSpread", "clipWorld", "clearWorld", "__render", "restore", "clear", "includes", "fillWorld", "showRepaint", "drawRepaint", "useCellRender", "cellList", "getCellList", "updateRender", "parentApp", "frameTime", "Date", "now", "nowFPS", "shift", "round", "reduce", "a", "b", "bigger", "samePixelRatio", "old", "addBlock", "forceUpdate", "map", "empty", "some", "isLeafer", "tip", "isBranchLeaf", "__onLayoutEnd", "RESIZE", "__onResize", "tempPoint", "copyRadiusPoint", "PointHelper", "hitRadiusPoint", "BoundsHelper", "Picker", "selector", "hitPoint", "hitRadius", "through", "ignoreHittable", "exclude", "point", "radiusX", "radiusY", "findList", "hitBranch", "getBestMatchLeaf", "bottomList", "path", "getPath", "getHitablePath", "throughPath", "getThroughPath", "getByPoint", "allowNull", "worldHittable", "hitChild", "hasParent", "proxy", "syncList", "syncEventer", "__", "hittablePath", "addAt", "hitChildren", "mode", "pathList", "nextPath", "eachFind", "__onlyHitMask", "hitMask", "visible", "mask", "__ignoreHitWorld", "__clipAfterFill", "__hitWorld", "topChildren", "__hasMask", "findMasks", "every", "value", "Selector", "picker", "finder", "backgrounder", "updateLayout", "condition", "one", "getBy", "Plugin", "need", "watcher", "layouter", "topOptions", "topRendering", "topList", "PointerEventHelper", "local", "base", "InteractionHelper", "getBase", "pointerType", "pressure", "tangentialPressure", "tiltX", "tiltY", "twist", "touch", "getTouch", "multiTouch", "touches", "force", "targetTouches", "changedTouches", "KeyEventHelper", "code", "key", "pathCanDrag", "Interaction", "InteractionBase", "notPointer", "p", "useMultiTouch", "notTouch", "usePointer", "notMouse", "useTouch", "viewEvents", "pointerdown", "onPointerDown", "mousedown", "onMouseDown", "touchstart", "onTouchStart", "pointerleave", "onPointerLeave", "contextmenu", "onContextMenu", "wheel", "onWheel", "gesturestart", "onGesturestart", "gesturechange", "onGesturechange", "gestureend", "onGestureend", "windowEvents", "pointermove", "onPointerMove", "pointerup", "onPointerUp", "pointercancel", "onPointerCancel", "mousemove", "onMouseMove", "mouseup", "onMouseUp", "touchmove", "onTouchMove", "touchend", "onTouchEnd", "touchcancel", "onTouchCancel", "keydown", "onKeyDown", "keyup", "onKeyUp", "scroll", "onScroll", "pointer", "downData", "keyDown", "convert", "keyUp", "preventDefaultMenu", "menu", "getLocal", "preventDefaultPointer", "pointerDown", "isLeave", "preventWindowPointer", "pointerHover", "pointerMove", "pointerUp", "pointerCancel", "convertMouse", "onMouseCancel", "findPath", "multiTouchStart", "touchTimer", "clearTimeout", "convertTouch", "multiTouchMove", "multiTouchEnd", "setTimeout", "getTouches", "getKeepTouchList", "transformEnd", "to", "from", "identifier", "points", "preventDefaultWheel", "deltaX", "deltaY", "lastGestureScale", "lastGestureRotation", "eventBase", "scale", "rotation", "PI", "MathHelper", "within", "rotateSpeed", "zoom", "rotate", "cursor", "setCursor", "eachCursor", "isObject", "join", "custom", "Cursor", "fillPathOrText", "ui", "__font", "Paint", "fillText", "windingRule", "drawCenter", "stroke", "strokeWidthScale", "drawStrokesStyle", "setStroke", "__strokeWidth", "__useArrow", "strokeArrow", "drawTextStroke", "drawAlign", "align", "out", "getSameCanvas", "font", "blendMode", "copyCanvasByWorld", "recycle", "__nowWorld", "getSpread", "copyAndSpread", "toOuterOf", "getOuterOf", "getByMove", "move", "getIntersectData", "tempBounds", "recycleMap", "stintSet", "hasTransparent", "ColorConvert", "getLeafPaint", "attrName", "paint", "opacity", "leafPaint", "boxBounds", "PaintImage", "PaintGradient", "linearGradient", "radialGradient", "conicGradient", "string", "r", "originPaint", "isTransparent", "strokeWidth", "strokeStyle", "PaintModule", "compute", "leafPaints", "isAlphaPixel", "maxChildStrokeWidth", "paints", "__input", "recycleImage", "max", "__removePaint", "fillStyle", "fills", "countImage", "checkImage", "isPlacehold", "drawImagePlaceholder", "transform", "scaleFixed", "scaleX", "scaleY", "getRenderScaleData", "saveBlendMode", "restoreBlendMode", "_renderOptions", "rows", "decorationY", "__textDrawData", "row", "__isPlacehold", "placeholderColor", "text", "charData", "char", "decorationColor", "decorationHeight", "fillRect", "strokeText", "strokeAlign", "clipUI", "__fillAfterStroke", "__drawRenderPath", "strokes", "strokeRect", "isText", "__hasMultiStrokeStyle", "__getRealStrokeWidth", "shape", "currentBounds", "nowWorld", "nowWorldShapeBounds", "__nowWorldShapeBounds", "matrix", "fitMatrix", "shapeBounds", "worldCanvas", "strokeSpread", "worldClipBounds", "spreadBounds", "renderShapeSpread", "FourNumberHelper", "swapAndScale", "getFitMatrix", "fitScaleX", "d", "fitScaleY", "__renderShape", "f", "userMatrix", "Matrix", "multiply", "withScale", "cache", "box", "isSame", "checkSizeAndCreateData", "__naturalWidth", "__naturalHeight", "__autoSide", "__proxyData", "setProxyAttr", "createData", "onLoad", "ImageEvent", "LOAD", "onLoadSuccess", "LOADED", "onLoadError", "ERROR", "hasEvent", "ignoreRender", "viewReady", "translate", "MatrixHelper", "tempBox", "tempScaleData", "tempImage", "getGapValue", "gap", "totalSize", "floor", "tempMatrix", "getMatrixData", "rotateOfOuter", "scaleOfOuter", "multiplyParent", "scaleHelper", "skew", "skewHelper", "__awaiter", "thisArg", "_arguments", "P", "generator", "fulfilled", "step", "next", "rejected", "result", "done", "then", "apply", "get", "scale", "copy", "MatrixHelper", "getFloorScale", "MathHelper", "abs", "Math", "PaintImageModule", "image", "ui", "attrName", "paint", "boxBounds", "firstUse", "leafPaint", "event", "ImageManager", "cache", "isSame", "type", "hasAlphaPixel", "isTransparent", "use", "box", "set", "loading", "attrValue", "ready", "checkSizeAndCreateData", "onLoad", "onLoadSuccess", "error", "onLoadError", "ignoreRender", "loadId", "load", "destroyed", "__layout", "hitCanvasChanged", "forceUpdate", "undefined", "lod", "getThumbSize", "placeholderColor", "placeholderDelay", "setTimeout", "isPlacehold", "checkImage", "drawImage", "canvas", "renderOptions", "scaleX", "scaleY", "PaintImage", "getImageRenderScaleData", "data", "originPaint", "exporting", "snapshot", "patternId", "repeat", "changeful", "Platform", "name", "ResizeEvent", "isResizing", "isLarge", "width", "height", "__", "__isFastShadow", "fillStyle", "style", "fill", "sync", "createPattern", "createPatternTask", "_imageScaleX", "_imageScaleY", "_renderOptions", "blendMode", "opacity", "transform", "view", "getFull", "filters", "u", "clipUI", "onlyScale", "path", "cornerRadius", "save", "restore", "scaleData", "getRenderScaleData", "scaleFixed", "pixelRatio", "recycleImage", "paints", "isArray", "recycleMap", "input", "url", "i", "len", "length", "recyclePaint", "__input", "unload", "some", "item", "patternTask", "patternTasker", "add", "__awaiter", "this", "bounds", "hit", "__nowWorld", "id", "gap", "fixScale", "getPatternFixScale", "imageMatrix", "xGap", "yGap", "x", "y", "imageCanvas", "getCanvas", "leafer", "config", "smooth", "interlace", "pattern", "getPattern", "origin", "noRepeat", "imageScaleX", "imageScaleY", "maxSize", "maxPatternSize", "imageSize", "isSVG", "ceil", "sqrt", "createData", "getPatternData", "padding", "tempBox", "shrink", "mode", "align", "offset", "size", "rotation", "skew", "clipSize", "sameBox", "swapSize", "BoundsHelper", "tempImage", "getScaleData", "tempScaleData", "AlignHelper", "toPoint", "getFitScale", "put", "PointHelper", "move", "stretchMode", "clipScaleX", "clipScaleY", "clipMode", "repeatMode", "freeTransform", "count", "isObject", "getGapValue", "fillOrFitMode", "translate", "isString", "isNumber", "scaleHelper", "rotateOfOuter", "layout", "tempMatrix", "scaleOfOuter", "multiplyParent", "rotate", "AroundHelper", "hasTransparent", "ColorConvert", "realFrom", "realTo", "applyStops", "gradient", "stops", "stop", "color", "string", "addColorStop", "getAngle", "getDistance", "getTransform", "from", "to", "stretch", "rotate90", "angle", "PaintGradientModule", "linearGradient", "createLinearGradient", "radialGradient", "createRadialGradient", "conicGradient", "conicGradientSupport", "createConicGradient", "conicGradientRotate90", "toOffsetOutBounds", "max", "tempBounds", "Matrix", "offsetOutBounds", "getShadowRenderSpread", "_ui", "shadow", "spread", "blur", "top", "right", "bottom", "left", "forEach", "drawWorldShadow", "outBounds", "shape", "shapeBounds", "fullImageShadow", "copyWorld", "getInnerShadowSpread", "EffectModule", "current", "copyBounds", "nowWorld", "worldCanvas", "renderBounds", "other", "getSameCanvas", "end", "index", "otherScale", "sx", "setWorldShadow", "offsetX", "offsetY", "Effect", "getShadowTransform", "setTransform", "resetTransform", "LeafHelper", "copyCanvasByWorld", "clearWorld", "recycle", "innerShadow", "fillWorld", "setWorldBlur", "a", "copyWorldToInner", "filter", "backgroundBlur", "_current", "_shape", "isInnerShaodw", "strokeBounds", "_shadow", "excludeRenderBounds", "LeafBoundsHelper", "usedGrayscaleAlpha", "maskEnd", "leaf", "maskMode", "contentCanvas", "maskCanvas", "maskOpacity", "useGrayscaleAlpha", "content", "mask", "realBounds", "useMask", "copyContent", "Group", "prototype", "__renderMask", "options", "child", "currentMask", "children", "__render", "__clip", "childBlendMode", "__blendMode", "afterChar", "symbolChar", "cjkReg", "RegExp", "map", "start", "toString", "join", "mapChar", "str", "split", "char", "letterMap", "beforeMap", "afterMap", "symbolMap", "breakMap", "CharType", "Letter", "Single", "Before", "After", "Symbol", "Break", "getCharType", "test", "TextRowHelper", "row", "words", "trimRight", "splice", "getTextCase", "textCase", "firstChar", "toUpperCase", "toLowerCase", "word", "wordWidth", "rowWidth", "realWidth", "charWidth", "startCharSize", "charSize", "charType", "lastCharType", "langBreak", "afterBreak", "paraStart", "textDrawData", "findMaxWidth", "rows", "addChar", "push", "addWord", "addRow", "paraNumber", "endCharSize", "setMaxWidth", "maxWidth", "Direction4", "offsetText", "drawData", "value", "TextConvertModule", "getDrawData", "String", "__getInput", "__padding", "autoSizeAlign", "font", "__font", "__letterSpacing", "paraIndent", "__isCharMode", "wrap", "textWrap", "breakAll", "paraEnd", "measureText", "text", "textAlign", "verticalAlign", "countRows", "__lineHeight", "__baseLine", "__clipText", "paraSpacing", "realHeight", "starY", "overflow", "rowX", "layoutWidth", "isOverflow", "fontSize", "justifyLast", "includes", "justify", "justifyLetter", "charX", "remainingWidth", "addWordWidth", "addLetterWidth", "indentWidth", "wordChar", "wordsLength", "isLastWord", "canJustify", "reduce", "total", "textMode", "rowData", "textOverflow", "charRight", "ellipsisWidth", "textDecoration", "decorationHeight", "decorationColor", "min", "decorationY", "ColorConvertModule", "doOpacity", "object", "isUndefined", "rgb", "r", "g", "b", "Object", "assign", "TextConvert", "Paint", "PaintModule", "PaintGradient", "Creator", "interaction", "target", "selector", "Interaction", "hitCanvas", "manager", "LeaferCanvas", "hitCanvasManager", "HitCanvasManager", "useCanvas"]
}
