{"version":3,"file":"web.min.js","sources":["../../../../src/leafer/packages/interface/src/path/IPathCommand.ts","../../../../src/leafer/packages/display-module/data/src/data.ts","../../../../src/leafer/packages/display-module/data/src/DataHelper.ts","../../../../src/leafer/packages/display-module/data/src/LeafData.ts","../../../../src/leafer/packages/math/src/IncrementId.ts","../../../../src/leafer/packages/math/src/FourNumberHelper.ts","../../../../src/leafer/packages/math/src/MathHelper.ts","../../../../src/leafer/packages/math/src/MatrixHelper.ts","../../../../src/leafer/packages/math/src/PointHelper.ts","../../../../src/leafer/packages/math/src/Point.ts","../../../../src/leafer/packages/math/src/Matrix.ts","../../../../src/leafer/packages/math/src/TwoPointBoundsHelper.ts","../../../../src/leafer/packages/math/src/Direction.ts","../../../../src/leafer/packages/math/src/AroundHelper.ts","../../../../src/leafer/packages/math/src/AlignHelper.ts","../../../../src/leafer/packages/math/src/BoundsHelper.ts","../../../../src/leafer/packages/math/src/Bounds.ts","../../../../src/leafer/packages/math/src/AutoBounds.ts","../../../../src/leafer/packages/math/src/UnitHelper.ts","../../../../src/leafer/packages/math/src/StringNumber.ts","../../../../src/leafer/packages/platform/platform/src/Platform.ts","../../../../src/leafer/packages/debug/src/Debug.ts","../../../../src/leafer/packages/debug/src/Run.ts","../../../../src/leafer/packages/debug/src/Plugin.ts","../../../../src/leafer/packages/platform/platform/src/creator/Creator.ts","../../../../src/leafer/packages/platform/platform/src/creator/UICreator.ts","../../../../src/leafer/packages/platform/platform/src/creator/EventCreator.ts","../../../../src/leafer/packages/canvas/canvas/src/CanvasManager.ts","../../../node_modules/.pnpm/@rollup+plugin-typescript@11.1.6_rollup@4.44.2_tslib@2.8.1_typescript@5.8.3/node_modules/tslib/tslib.es6.js","../../../../src/leafer/packages/canvas/canvas/src/Canvas.ts","../../../../src/leafer/packages/canvas/canvas/src/LeaferCanvasBase.ts","../../../../src/leafer/packages/path/src/PathHelper.ts","../../../../src/leafer/packages/path/src/PathCommandMap.ts","../../../../src/leafer/packages/path/src/RectHelper.ts","../../../../src/leafer/packages/path/src/BezierHelper.ts","../../../../src/leafer/packages/path/src/EllipseHelper.ts","../../../../src/leafer/packages/path/src/PathCommandNodeHelper.ts","../../../../src/leafer/packages/path/src/PathConvert.ts","../../../../src/leafer/packages/path/src/PathCommandDataHelper.ts","../../../../src/leafer/packages/path/src/PathCreator.ts","../../../../src/leafer/packages/path/src/PathDrawer.ts","../../../../src/leafer/packages/path/src/PathBounds.ts","../../../../src/leafer/packages/path/src/PathCorner.ts","../../../../src/leafer/packages/path/src/index.ts","../../../../src/leafer/packages/canvas/canvas/src/patch/roundRect.ts","../../../../src/leafer/packages/canvas/canvas/src/patch/index.ts","../../../../src/leafer/packages/file/src/FileHelper.ts","../../../../src/leafer/packages/task/src/TaskItem.ts","../../../../src/leafer/packages/task/src/TaskProcessor.ts","../../../../src/leafer/packages/file/src/Resource.ts","../../../../src/leafer/packages/image/image/src/ImageManager.ts","../../../../src/leafer/packages/image/image/src/LeaferImage.ts","../../../../src/leafer/packages/decorator/src/object.ts","../../../../src/leafer/packages/decorator/src/data.ts","../../../../src/leafer/packages/decorator/src/rewrite.ts","../../../../src/leafer/packages/decorator/src/class.ts","../../../../src/leafer/packages/display-module/helper/src/LeafHelper.ts","../../../../src/leafer/packages/display-module/helper/src/LeafBoundsHelper.ts","../../../../src/leafer/packages/display-module/helper/src/BranchHelper.ts","../../../../src/leafer/packages/display-module/helper/src/WaitHelper.ts","../../../../src/leafer/packages/display-module/layout/src/LeafLayout.ts","../../../../src/leafer/packages/event/src/Event.ts","../../../../src/leafer/packages/event/src/ChildEvent.ts","../../../../src/leafer/packages/event/src/PropertyEvent.ts","../../../../src/leafer/packages/event/src/ImageEvent.ts","../../../../src/leafer/packages/event/src/BoundsEvent.ts","../../../../src/leafer/packages/event/src/ResizeEvent.ts","../../../../src/leafer/packages/event/src/WatchEvent.ts","../../../../src/leafer/packages/event/src/LayoutEvent.ts","../../../../src/leafer/packages/event/src/RenderEvent.ts","../../../../src/leafer/packages/event/src/LeaferEvent.ts","../../../../src/leafer/packages/event/src/Eventer.ts","../../../../src/leafer/packages/display-module/display-module/src/LeafEventer.ts","../../../../src/leafer/packages/display-module/display-module/src/LeafDataProxy.ts","../../../../src/leafer/packages/display-module/display-module/src/LeafMatrix.ts","../../../../src/leafer/packages/display-module/display-module/src/LeafBounds.ts","../../../../src/leafer/packages/display-module/display-module/src/LeafRender.ts","../../../../src/leafer/packages/display-module/display-module/src/BranchRender.ts","../../../../src/leafer/packages/display/src/Leaf.ts","../../../../src/leafer/packages/display/src/Branch.ts","../../../../src/leafer/packages/list/src/LeafList.ts","../../../../src/leafer/packages/list/src/LeafLevelList.ts","../../../../src/leafer/packages/core/src/index.ts","../../../../src/leafer/packages/canvas/canvas-web/src/LeaferCanvas.ts","../../../../src/leafer/packages/canvas/canvas-web/src/index.ts","../../../../src/ui/packages/platform/web/src/core.ts","../../../../src/leafer/packages/partner/watcher/src/Watcher.ts","../../../../src/leafer/packages/partner/layouter/src/LayouterHelper.ts","../../../../src/leafer/packages/partner/layouter/src/LayoutBlockData.ts","../../../../src/leafer/packages/partner/layouter/src/Layouter.ts","../../../../src/leafer/packages/partner/renderer/src/Renderer.ts","../../../../src/leafer/packages/partner/selector/src/Picker.ts","../../../../src/leafer/packages/partner/selector/src/Selector.ts","../../../../src/ui/packages/decorator/src/data.ts","../../../../src/leafer/packages/partner/partner/src/index.ts","../../../../src/ui/packages/external/src/index.ts","../../../../src/ui/packages/external/src/color.ts","../../../../src/ui/packages/display-module/data/src/UIData.ts","../../../../src/ui/packages/display-module/data/src/GroupData.ts","../../../../src/ui/packages/display-module/data/src/BoxData.ts","../../../../src/ui/packages/display-module/data/src/LeaferData.ts","../../../../src/ui/packages/display-module/data/src/FrameData.ts","../../../../src/ui/packages/display-module/data/src/LineData.ts","../../../../src/ui/packages/display-module/data/src/RectData.ts","../../../../src/ui/packages/display-module/data/src/EllipseData.ts","../../../../src/ui/packages/display-module/data/src/PolygonData.ts","../../../../src/ui/packages/display-module/data/src/StarData.ts","../../../../src/ui/packages/display-module/data/src/PathData.ts","../../../../src/ui/packages/display-module/data/src/PenData.ts","../../../../src/ui/packages/display-module/data/src/TextData.ts","../../../../src/ui/packages/display-module/data/src/ImageData.ts","../../../../src/ui/packages/display-module/data/src/CanvasData.ts","../../../../src/ui/packages/display-module/bounds/src/UIBounds.ts","../../../../src/ui/packages/display-module/render/src/UIRender.ts","../../../../src/ui/packages/display-module/render/src/RectRender.ts","../../../../src/ui/packages/display/src/UI.ts","../../../../src/ui/packages/display/src/Group.ts","../../../../src/ui/packages/display/src/Leafer.ts","../../../../src/ui/packages/display/src/Rect.ts","../../../../src/ui/packages/display/src/Box.ts","../../../../src/ui/packages/display/src/Frame.ts","../../../../src/ui/packages/display/src/Ellipse.ts","../../../../src/ui/packages/display/src/Polygon.ts","../../../../src/ui/packages/display/src/Star.ts","../../../../src/ui/packages/display/src/Line.ts","../../../../src/ui/packages/display/src/Image.ts","../../../../src/ui/packages/display/src/Canvas.ts","../../../../src/ui/packages/display/src/Text.ts","../../../../src/ui/packages/display/src/Path.ts","../../../../src/ui/packages/display/src/Pen.ts","../../../../src/ui/packages/app/src/App.ts","../../../../src/ui/packages/event/src/Keyboard.ts","../../../../src/ui/packages/event/src/PointerButton.ts","../../../../src/ui/packages/event/src/UIEvent.ts","../../../../src/ui/packages/event/src/DragBoundsHelper.ts","../../../../src/ui/packages/event/src/PointerEvent.ts","../../../../src/ui/packages/event/src/DragEvent.ts","../../../../src/ui/packages/event/src/DropEvent.ts","../../../../src/ui/packages/event/src/MoveEvent.ts","../../../../src/ui/packages/event/src/TouchEvent.ts","../../../../src/ui/packages/event/src/RotateEvent.ts","../../../../src/ui/packages/event/src/SwipeEvent.ts","../../../../src/ui/packages/event/src/ZoomEvent.ts","../../../../src/ui/packages/event/src/KeyEvent.ts","../../../../src/ui/packages/interaction/interaction/src/InteractionHelper.ts","../../../../src/ui/packages/interaction/interaction/src/Dragger.ts","../../../../src/ui/packages/interaction/interaction/src/emit.ts","../../../../src/ui/packages/interaction/interaction/src/config.ts","../../../../src/ui/packages/interaction/interaction/src/Interaction.ts","../../../../src/ui/packages/interaction/interaction/src/Cursor.ts","../../../../src/ui/packages/hit/src/HitCanvasManager.ts","../../../../src/ui/packages/hit/src/selector.ts","../../../../src/ui/packages/hit/src/LeafHit.ts","../../../../src/ui/packages/hit/src/UIHit.ts","../../../../src/ui/packages/hit/src/RectHit.ts","../../../../src/ui/packages/hit/src/TextHit.ts","../../../../src/ui/packages/hit/src/pick.ts","../../../../src/ui/packages/hit/src/canvas.ts","../../../../src/ui/packages/interaction/interaction-web/src/PointerEventHelper.ts","../../../../src/ui/packages/interaction/interaction-web/src/KeyEventHelper.ts","../../../../src/ui/packages/interaction/interaction-web/src/Interaction.ts","../../../../src/ui/packages/partner/paint/src/Fill.ts","../../../../src/ui/packages/partner/paint/src/Stroke.ts","../../../../src/ui/packages/partner/paint/src/StrokeText.ts","../../../../src/ui/packages/partner/paint/src/Shape.ts","../../../../src/ui/packages/partner/paint/src/Compute.ts","../../../../src/ui/packages/partner/paint/src/index.ts","../../../../src/ui/packages/partner/paint/src/FillText.ts","../../../../src/ui/packages/partner/image/src/image.ts","../../../../src/ui/packages/partner/image/src/data.ts","../../../../src/ui/packages/partner/image/src/mode.ts","../../../../src/ui/packages/partner/image/src/pattern.ts","../../../../src/ui/packages/partner/image/src/index.ts","../../../../src/ui/packages/partner/image/src/check.ts","../../../../src/ui/packages/partner/image/src/recycle.ts","../../../../src/ui/packages/partner/gradient/src/linear.ts","../../../../src/ui/packages/partner/gradient/src/radial.ts","../../../../src/ui/packages/partner/gradient/src/conic.ts","../../../../src/ui/packages/partner/gradient/src/index.ts","../../../../src/ui/packages/partner/effect/src/Shadow.ts","../../../../src/ui/packages/partner/effect/src/InnerShadow.ts","../../../../src/ui/packages/partner/effect/src/index.ts","../../../../src/ui/packages/partner/effect/src/Blur.ts","../../../../src/ui/packages/partner/effect/src/BackgroundBlur.ts","../../../../src/ui/packages/partner/mask/src/index.ts","../../../../src/ui/packages/partner/text/src/CharType.ts","../../../../src/ui/packages/partner/text/src/TextRowHelper.ts","../../../../src/ui/packages/partner/text/src/TextCase.ts","../../../../src/ui/packages/partner/text/src/TextRows.ts","../../../../src/ui/packages/partner/text/src/TextConvert.ts","../../../../src/ui/packages/partner/text/src/index.ts","../../../../src/ui/packages/partner/text/src/TextLayout.ts","../../../../src/ui/packages/partner/text/src/CharLayout.ts","../../../../src/ui/packages/partner/text/src/TextClip.ts","../../../../src/ui/packages/partner/text/src/TextDecoration.ts","../../../../src/ui/packages/partner/color/src/index.ts","../../../../src/ui/packages/partner/color/src/color.ts","../../../../src/ui/packages/partner/partner/src/index.ts","../../../../src/ui/packages/platform/web/src/index.ts"],"sourcesContent":["import { IPointData } from '../math/IMath'\n\ntype Command = number\ntype x = number\ntype y = number\ntype x1 = number\ntype y1 = number\ntype x2 = number\ntype y2 = number\ntype radiusX = number\ntype radiusY = number\ntype xAxisRotation = number\ntype largeArcFlag = number\ntype sweepFlag = number\n\n\nexport type MCommandData = [Command, x, y]\nexport type HCommandData = [Command, x]\nexport type VCommandData = [Command, y]\nexport type LCommandData = MCommandData\n\nexport type CCommandData = [Command, x1, y1, x2, y2, x, y]\nexport type SCommandData = [Command, x2, y2, x, y]\n\nexport type QCommandData = [Command, x1, y1, x, y]\nexport type TCommandData = [Command, x, y]\n\nexport type ZCommandData = [Command]\n\nexport type ACommandData = [Command, radiusX, radiusY, xAxisRotation, largeArcFlag, sweepFlag, x, y]\n\n\n// 非svg标准的canvas绘图命令\ntype width = number\ntype height = number\ntype rotation = number\ntype startAngle = number\ntype endAngle = number\ntype anticlockwise = boolean\ntype cornerRadius = number | number[]\ntype radius = number\n\nexport type RectCommandData = [Command, x, y, width, height]\nexport type RoundRectCommandData = [Command, x, y, width, height, cornerRadius]\nexport type EllipseCommandData = [Command, x, y, radiusX, radiusY, rotation, startAngle, endAngle, anticlockwise]\nexport type ArcCommandData = [Command, x, y, radius, startAngle, endAngle, anticlockwise]\nexport type ArcToCommandData = [Command, x1, y1, x2, y2, radius]\n\n\nexport type CanvasPathCommand = 1 | 2 | 5 | 7 | 11 // M | L | C | Q | Z   canvas可以绘制的命令\n\nexport type IPathCommandData = number[] // ...(MCommandData | LCommandData | CCommandData | QCommandData | ZCommandData)\n\n\n// 路径命令对象\nexport interface MoveToCommandObject {\n    name: 'M'\n    x: number\n    y: number\n}\nexport interface LineToCommandObject {\n    name: 'L'\n    x: number\n    y: number\n}\n\nexport interface BezierCurveToCommandObject {\n    name: 'C'\n    x1: number\n    y1: number\n    x2: number\n    y2: number\n    x: number\n    y: number\n}\n\nexport interface QuadraticCurveToCommandObject {\n    name: 'Q'\n    x1: number\n    y1: number\n    x: number\n    y: number\n}\n\nexport interface ClosePathCommandObject {\n    name: 'Z'\n}\n\nexport type IPathCommandObject = MoveToCommandObject | LineToCommandObject | BezierCurveToCommandObject | QuadraticCurveToCommandObject | ClosePathCommandObject // M | L | C | Q | Z   canvas可以绘制的命令\n\n\n// 可视化路径节点\n\nexport interface IPathCommandNodeBase {\n    name: 'M^' | 'L^' | 'C^' | 'Z^'\n    x: number\n    y: number\n    a?: IPointData // 第一个手柄，连接上一个节点\n    b?: IPointData // 第二个手柄，连接下一个节点\n    ab?: PathNodeHandleType // 手柄类型\n}\n\nexport interface MoveToCommandNode extends IPathCommandNodeBase {\n    name: 'M^'\n}\nexport interface LineToCommandNode extends IPathCommandNodeBase {\n    name: 'L^'\n}\n\nexport interface BezierCurveToCommandNode extends IPathCommandNodeBase {\n    name: 'C^'\n}\n\nexport interface ClosePathCommandNode {\n    name: 'Z^'\n    x?: number\n    y?: number\n    a?: IPointData\n    b?: IPointData\n    ab?: PathNodeHandleType\n}\n\nexport type IPathCommandNode = MoveToCommandNode | LineToCommandNode | BezierCurveToCommandNode | ClosePathCommandNode // M | L | C | Z   路径节点命令(适合可视化编辑)\n\nexport enum PathNodeHandleType { // 手柄类型\n    none = 1, // 无手柄\n    free = 2, // 每个手柄自由控制\n    mirrorAngle = 3, // 仅镜像角度\n    mirror = 4,  // 镜像角度和长度\n}\n\nexport type PathNodeHandleName = 'a' | 'b' // 手柄名称\n\nexport interface IPathNodeBase {\n    pathNode: IPathCommandNode\n}","import { IObject } from '@leafer/interface'\n\nexport enum Answer {\n    No = 0,\n    Yes = 1,\n    NoAndSkip = 2,\n    YesAndSkip = 3\n}\n\nexport const emptyData: IObject = {}\n\nexport function isUndefined(value: any): boolean {\n    return value === undefined\n}\n\nexport function isNull(value: any): boolean {\n    return value == null // = value === undefined || value === null\n}\n\nexport function isString<T extends string>(value: any): value is T {\n    return typeof value === 'string'\n}\n\nexport const { isFinite } = Number\n\nexport function isNumber<T extends number>(value: any): value is T {\n    return typeof value === 'number'\n}\n\nconst numberReg = /^-?\\d+(?:\\.\\d+)?$/\n\nexport function tryToNumber(value: any): number {\n    return (typeof value === 'string' && numberReg.test(value)) ? +value : value\n}\n\nexport const { isArray } = Array\n\nexport function isObject<T extends object>(value: any): value is T {\n    return value && typeof value === 'object' // fix: null is object\n}\n\nexport function isData<T extends object>(value: any): value is T { // 检测 {} 对象\n    return isObject(value) && !isArray(value) // 排除数组\n}\n\nexport function isEmptyData(value: any): boolean {\n    return JSON.stringify(value) === '{}'\n}","import { IBooleanMap, IObject } from '@leafer/interface'\nimport { isUndefined } from './data'\n\nexport const DataHelper = {\n\n    default<T>(t: T, defaultData: IObject): T {\n        assign(defaultData, t)\n        assign(t, defaultData)\n        return t\n    },\n\n    assign(t: IObject, merge: IObject, exclude?: IObject): void {\n        let value: unknown\n        Object.keys(merge).forEach(key => {\n            value = merge[key]\n            if (value?.constructor === Object && t[key]?.constructor === Object) return assign(t[key], merge[key], exclude && exclude[key])\n            if (exclude && (key in exclude)) {\n                if (exclude[key]?.constructor === Object) assign(t[key] = {}, merge[key], exclude[key])\n                return\n            }\n            t[key] = merge[key]\n        })\n    },\n\n    copyAttrs(t: IObject, from: IObject, include: string[]): IObject {\n        include.forEach(key => {\n            if (!isUndefined(from[key])) t[key] = from[key]\n        })\n        return t\n    },\n\n    clone(data: unknown): IObject {\n        return JSON.parse(JSON.stringify(data))\n    },\n\n    toMap(list: string[]): IBooleanMap {\n        const map = {} as IBooleanMap\n        for (let i = 0, len = list.length; i < len; i++)  map[list[i]] = true\n        return map\n    },\n\n    stintSet<T extends object, K extends keyof T>(data: T, attrName: K, value: T[K]): void {\n        value || (value = undefined)\n        data[attrName] !== value && (data[attrName] = value) // 只有值不一样时才设置，节省内存开销\n    }\n\n}\n\nconst { assign } = DataHelper","import { ILeafData, ILeaf, IObject, IValue, IPathCommandData, IJSONOptions } from '@leafer/interface'\nimport { isArray, isUndefined } from './data'\n\n\nexport class LeafData implements ILeafData {\n\n    public __leaf: ILeaf\n    public __input: IObject\n    public __middle: IObject\n\n    public __single: boolean\n\n    public __naturalWidth?: number\n    public __naturalHeight?: number\n\n    public __pathForRender?: IPathCommandData\n\n    public __useStroke?: boolean\n    public get __useNaturalRatio() { return true }\n\n    public get __isLinePath(): boolean {\n        const { path } = this as ILeafData\n        return path && path.length === 6 && path[0] === 1 // M = 1\n    }\n\n    public get __usePathBox(): boolean {\n        return (this as ILeafData).__pathInputed as any as boolean\n    }\n\n    public get __blendMode(): string {\n        if ((this as ILeafData).eraser && (this as ILeafData).eraser !== 'path') return 'destination-out'\n        const { blendMode } = (this as ILeafData)\n        return blendMode === 'pass-through' ? null : blendMode\n    }\n\n    constructor(leaf: ILeaf) {\n        this.__leaf = leaf\n    }\n\n    public __get(name: string): any {\n        if (this.__input) {\n            const value = this.__input[name]\n            if (!isUndefined(value)) return value\n        }\n        return (this as IObject)[name]\n    }\n\n    public __getData(): IObject {\n        const data: IObject = { tag: this.__leaf.tag }, { __input } = this\n        let inputValue: IValue\n        for (let key in this) {\n            if (key[0] !== '_') {\n                inputValue = __input ? __input[key] : undefined\n                data[key] = isUndefined(inputValue) ? this[key] : inputValue\n            }\n        }\n        return data\n    }\n\n    public __setInput(name: string, value: any): void {\n        this.__input || (this.__input = {})\n        this.__input[name] = value\n    }\n\n    public __getInput(name: string): any {\n        if (this.__input) {\n            const value = this.__input[name]\n            if (!isUndefined(value)) return value\n        }\n\n        if (name === 'path' && !(this as ILeafData).__pathInputed) return // no path mode\n\n        return (this as IObject)['_' + name]\n    }\n\n    public __removeInput(name: string): void {\n        if (this.__input && !isUndefined(this.__input[name])) this.__input[name] = undefined\n    }\n\n    public __getInputData(names?: string[] | IObject, options?: IJSONOptions): IObject {\n        const data: IObject = {}\n\n        if (names) {\n\n            if (isArray(names)) {\n                for (let name of names) data[name] = this.__getInput(name)\n            } else {\n                for (let name in names) data[name] = this.__getInput(name)\n            }\n\n        } else {\n\n            let value: IValue, inputValue: IValue, { __input } = this\n            data.tag = this.__leaf.tag\n            for (let key in this) {\n                if (key[0] !== '_') {\n                    value = (this as IObject)['_' + key]\n                    if (!isUndefined(value)) {\n\n                        if (key === 'path' && !(this as ILeafData).__pathInputed) continue // no path mode\n\n                        inputValue = __input ? __input[key] : undefined\n                        data[key] = isUndefined(inputValue) ? value : inputValue\n                    }\n                }\n            }\n\n        }\n\n        if (options) {\n            if (options.matrix) {\n                const { a, b, c, d, e, f } = this.__leaf.__localMatrix\n                data.matrix = { a, b, c, d, e, f }\n            }\n        }\n\n        return data\n    }\n\n    public __setMiddle(name: string, value: any): void {\n        this.__middle || (this.__middle = {})\n        this.__middle[name] = value\n    }\n\n    public __getMiddle(name: string): any {\n        return this.__middle && this.__middle[name]\n    }\n\n    public __checkSingle(): void {\n        const t = this as ILeafData\n        if (t.blendMode === 'pass-through') {\n            const leaf = this.__leaf\n            if ((t.opacity < 1 && (leaf.isBranch || t.__hasMultiPaint)) || leaf.__hasEraser || t.eraser || t.filter) {\n                t.__single = true\n            } else if (t.__single) {\n                t.__single = false\n            }\n        } else {\n            t.__single = true\n        }\n    }\n\n    public __removeNaturalSize(): void {\n        this.__naturalWidth = this.__naturalHeight = undefined\n    }\n\n    public destroy(): void {\n        this.__input = this.__middle = null\n    }\n}","import { INumberMap } from '@leafer/interface'\n\n\nexport const IncrementId = {\n\n    RUNTIME: 'runtime',\n    LEAF: 'leaf',\n    TASK: 'task',\n    CNAVAS: 'canvas',\n    IMAGE: 'image',\n\n    types: {} as INumberMap,\n\n    create(typeName: string): number {\n        const { types } = I\n        if (types[typeName]) {\n            return types[typeName]++\n        } else {\n            types[typeName] = 1\n            return 0\n        }\n    }\n}\n\nconst I = IncrementId","import { IFourNumber } from '@leafer/interface'\nimport { isNumber, isUndefined } from '@leafer/data'\n\n\nlet tempA: number[], tempB: number[], tempTo: number[]\nconst { max } = Math, tempFour = [0, 0, 0, 0]\n\nexport const FourNumberHelper = {\n\n    zero: [...tempFour],\n\n    tempFour,\n\n    set(to: number[], top: number, right?: number, bottom?: number, left?: number): number[] {\n        if (right === undefined) right = bottom = left = top\n        to[0] = top\n        to[1] = right\n        to[2] = bottom\n        to[3] = left\n        return to\n    },\n\n    setTemp(top: number, right?: number, bottom?: number, left?: number) {\n        return set(tempFour, top, right, bottom, left)\n    },\n\n    toTempAB(a: IFourNumber, b: IFourNumber, change?: boolean): void {\n        tempTo = change ? (isNumber(a) ? b : a) as number[] : []\n        if (isNumber(a)) tempA = setTemp(a), tempB = b as number[]\n        else if (isNumber(b)) tempA = a, tempB = setTemp(b)\n        else tempA = a, tempB = b\n\n        if (tempA.length !== 4) tempA = get(tempA)\n        if (tempB.length !== 4) tempB = get(tempB)\n    },\n\n    get(num: IFourNumber, maxValue?: number): number[] { // top right bottom left || topLeft, topRight, bottomRight, bottomLeft\n        let data: number[]\n        if (!isNumber(num)) {\n            switch (num.length) {\n                case 4:\n                    data = isUndefined(maxValue) ? num : [...num]\n                    break\n                case 2:\n                    data = [num[0], num[1], num[0], num[1]]\n                    break\n                case 3:\n                    data = [num[0], num[1], num[2], num[1]]\n                    break\n                case 1:\n                    num = num[0]\n                    break\n                default:\n                    num = 0\n            }\n        }\n        if (!data) data = [num as number, num as number, num as number, num as number]\n        if (!isUndefined(maxValue)) for (let i = 0; i < 4; i++)  if (data[i] > maxValue) data[i] = maxValue\n        return data\n    },\n\n    max(t: IFourNumber, other: IFourNumber, change?: boolean): IFourNumber {\n        if (isNumber(t) && isNumber(other)) return max(t, other)\n\n        toTempAB(t, other, change)\n\n        return set(\n            tempTo,\n            max(tempA[0], tempB[0]),\n            max(tempA[1], tempB[1]),\n            max(tempA[2], tempB[2]),\n            max(tempA[3], tempB[3])\n        )\n    },\n\n    add(t: IFourNumber, other: IFourNumber, change?: boolean): IFourNumber {\n        if (isNumber(t) && isNumber(other)) return t + other\n\n        toTempAB(t, other, change)\n\n        return set(\n            tempTo,\n            tempA[0] + tempB[0],\n            tempA[1] + tempB[1],\n            tempA[2] + tempB[2],\n            tempA[3] + tempB[3]\n        )\n    },\n\n    swapAndScale(t: IFourNumber, scaleX: number, scaleY: number, change?: boolean): IFourNumber { // 反向交换并缩放\n        if (isNumber(t)) return scaleX === scaleY ? t * scaleX : [t * scaleY, t * scaleX]\n\n        const to = change ? t : []\n        const [top, right, bottom, left] = t.length === 4 ? t : get(t)\n\n        return set(\n            to,\n            bottom * scaleY,\n            left * scaleX,\n            top * scaleY,\n            right * scaleX\n        )\n    }\n\n}\n\nconst { set, get, setTemp, toTempAB } = FourNumberHelper","import { IPointData, IBoundsData, IMatrixData, IRangeSize, IScaleData, ISizeData, IOptionSizeData } from '@leafer/interface'\nimport { isObject, isNumber, isUndefined } from '@leafer/data'\nimport { FourNumberHelper } from './FourNumberHelper'\n\n\nconst { round, pow, max, floor, PI } = Math\n\nexport const MathHelper = {\n\n    within(value: number, min: number | IRangeSize, max?: number): number {\n        if (isObject(min)) max = min.max, min = min.min\n        if (!isUndefined(min) && value < min) value = min\n        if (!isUndefined(max) && value > max) value = max\n        return value\n    },\n\n    fourNumber: FourNumberHelper.get,\n\n    formatRotation(rotation: number, unsign?: boolean): number {\n        rotation %= 360\n        if (unsign) {\n            if (rotation < 0) rotation += 360\n        } else {\n            if (rotation > 180) rotation -= 360\n            if (rotation < -180) rotation += 360\n        }\n        return MathHelper.float(rotation)\n    },\n\n    getGapRotation(addRotation: number, gap: number, oldRotation: number = 0): number {\n        let rotation = addRotation + oldRotation\n        if (gap > 1) {\n            const r = Math.abs(rotation % gap)\n            if (r < 1 || r > gap - 1) rotation = Math.round(rotation / gap) * gap\n        }\n        return rotation - oldRotation\n    },\n\n    float(num: number, maxLength?: number): number {\n        const a = !isUndefined(maxLength) ? pow(10, maxLength) : 1000000000000 // default\n        num = round(num * a) / a\n        return num === -0 ? 0 : num\n    },\n\n    sign(num: number): number {\n        return num < 0 ? -1 : 1\n    },\n\n    getScaleData(scale: number | IPointData, size: number | IOptionSizeData, originSize: ISizeData, scaleData?: IScaleData): IScaleData {\n        if (!scaleData) scaleData = {} as IScaleData\n        if (size) {\n            const scaleX = (isNumber(size) ? size : size.width || 0) / originSize.width, scaleY = (isNumber(size) ? size : size.height || 0) / originSize.height\n            scaleData.scaleX = scaleX || scaleY || 1\n            scaleData.scaleY = scaleY || scaleX || 1\n        } else if (scale) MathHelper.assignScale(scaleData, scale)\n        return scaleData\n    },\n\n    assignScale(scaleData: IScaleData, scale: number | IPointData): void {\n        if (isNumber(scale)) {\n            scaleData.scaleX = scaleData.scaleY = scale\n        } else {\n            scaleData.scaleX = scale.x\n            scaleData.scaleY = scale.y\n        }\n    },\n\n    getFloorScale(num: number, min = 1): number {\n        return max(floor(num), min) / num\n    },\n\n    randInt,\n\n    randColor(opacity?: number): string {\n        return `rgba(${randInt(255)},${randInt(255)},${randInt(255)},${opacity || 1})`\n    }\n}\n\nfunction randInt(num: number): number {\n    return Math.round(Math.random() * num)\n}\n\nexport const OneRadian = PI / 180\nexport const PI2 = PI * 2\nexport const PI_2 = PI / 2\n\nexport function getPointData(): IPointData { return { x: 0, y: 0 } }\nexport function getBoundsData(): IBoundsData { return { x: 0, y: 0, width: 0, height: 0 } }\nexport function getMatrixData(): IMatrixData { return { a: 1, b: 0, c: 0, d: 1, e: 0, f: 0 } }","import { IMatrixData, IPointData, ILayoutData, IMatrixWithLayoutData, IMatrixWithOptionScaleData, IScaleData, IMatrixWithScaleData } from '@leafer/interface'\nimport { isUndefined } from '@leafer/data'\n\nimport { MathHelper, OneRadian, PI_2, getBoundsData, getMatrixData } from './MathHelper'\n\n\nconst { sin, cos, acos, sqrt } = Math\nconst { float } = MathHelper\nconst tempPoint = {} as IPointData\n\nfunction getWorld(): IMatrixWithLayoutData {\n    return { ...getMatrixData(), ...getBoundsData(), scaleX: 1, scaleY: 1, rotation: 0, skewX: 0, skewY: 0 }\n}\n\nexport const MatrixHelper = {\n\n    defaultMatrix: getMatrixData(),\n\n    defaultWorld: getWorld(),\n\n    tempMatrix: {} as IMatrixData,\n\n    set(t: IMatrixData, a = 1, b = 0, c = 0, d = 1, e = 0, f = 0): void {\n        t.a = a\n        t.b = b\n        t.c = c\n        t.d = d\n        t.e = e\n        t.f = f\n    },\n\n    get: getMatrixData,\n\n    getWorld,\n\n    copy(t: IMatrixData, matrix: IMatrixData): void {\n        t.a = matrix.a\n        t.b = matrix.b\n        t.c = matrix.c\n        t.d = matrix.d\n        t.e = matrix.e\n        t.f = matrix.f\n    },\n\n    translate(t: IMatrixData, x: number, y: number): void {\n        t.e += x\n        t.f += y\n    },\n\n    translateInner(t: IMatrixData, x: number, y: number, hasOrigin?: boolean): void {\n        t.e += t.a * x + t.c * y\n        t.f += t.b * x + t.d * y\n        if (hasOrigin) t.e -= x, t.f -= y\n    },\n\n    scale(t: IMatrixData, scaleX: number, scaleY: number = scaleX): void {\n        t.a *= scaleX\n        t.b *= scaleX\n        t.c *= scaleY\n        t.d *= scaleY\n    },\n\n    pixelScale(t: IMatrixData, pixelRatio: number, to?: IMatrixData): void {\n        to || (to = t)\n        to.a = t.a * pixelRatio\n        to.b = t.b * pixelRatio\n        to.c = t.c * pixelRatio\n        to.d = t.d * pixelRatio\n        to.e = t.e * pixelRatio\n        to.f = t.f * pixelRatio\n    },\n\n    scaleOfOuter(t: IMatrixData, origin: IPointData, scaleX: number, scaleY?: number): void {\n        M.toInnerPoint(t, origin, tempPoint)\n        M.scaleOfInner(t, tempPoint, scaleX, scaleY)\n    },\n\n    scaleOfInner(t: IMatrixData, origin: IPointData, scaleX: number, scaleY: number = scaleX): void {\n        M.translateInner(t, origin.x, origin.y)\n        M.scale(t, scaleX, scaleY)\n        M.translateInner(t, -origin.x, -origin.y)\n    },\n\n\n    rotate(t: IMatrixData, rotation: number): void {\n        const { a, b, c, d } = t\n\n        rotation *= OneRadian\n        const cosR = cos(rotation)\n        const sinR = sin(rotation)\n\n        t.a = a * cosR - b * sinR\n        t.b = a * sinR + b * cosR\n        t.c = c * cosR - d * sinR\n        t.d = c * sinR + d * cosR\n    },\n\n    rotateOfOuter(t: IMatrixData, origin: IPointData, rotation: number): void {\n        M.toInnerPoint(t, origin, tempPoint)\n        M.rotateOfInner(t, tempPoint, rotation)\n    },\n\n    rotateOfInner(t: IMatrixData, origin: IPointData, rotation: number): void {\n        M.translateInner(t, origin.x, origin.y)\n        M.rotate(t, rotation)\n        M.translateInner(t, -origin.x, -origin.y)\n    },\n\n\n    skew(t: IMatrixData, skewX: number, skewY?: number): void {\n        const { a, b, c, d } = t\n\n        if (skewY) {\n            skewY *= OneRadian\n            t.a = a + c * skewY\n            t.b = b + d * skewY\n        }\n\n        if (skewX) {\n            skewX *= OneRadian\n            t.c = c + a * skewX\n            t.d = d + b * skewX\n        }\n    },\n\n    skewOfOuter(t: IMatrixData, origin: IPointData, skewX: number, skewY?: number): void {\n        M.toInnerPoint(t, origin, tempPoint)\n        M.skewOfInner(t, tempPoint, skewX, skewY)\n    },\n\n    skewOfInner(t: IMatrixData, origin: IPointData, skewX: number, skewY: number = 0): void {\n        M.translateInner(t, origin.x, origin.y)\n        M.skew(t, skewX, skewY)\n        M.translateInner(t, -origin.x, -origin.y)\n    },\n\n\n    multiply(t: IMatrixData, child: IMatrixData): void {\n        const { a, b, c, d, e, f } = t\n\n        t.a = child.a * a + child.b * c\n        t.b = child.a * b + child.b * d\n        t.c = child.c * a + child.d * c\n        t.d = child.c * b + child.d * d\n        t.e = child.e * a + child.f * c + e\n        t.f = child.e * b + child.f * d + f\n    },\n\n    multiplyParent(t: IMatrixWithOptionScaleData, parent: IMatrixWithOptionScaleData, to?: IMatrixWithOptionScaleData, abcdChanged?: boolean | number, childScaleData?: IScaleData): void { // = transform\n        const { e, f } = t\n\n        to || (to = t)\n\n        if (isUndefined(abcdChanged)) abcdChanged = t.a !== 1 || t.b || t.c || t.d !== 1\n\n        if (abcdChanged) {\n            const { a, b, c, d } = t\n\n            to.a = a * parent.a + b * parent.c\n            to.b = a * parent.b + b * parent.d\n            to.c = c * parent.a + d * parent.c\n            to.d = c * parent.b + d * parent.d\n\n            if (childScaleData) {\n                to.scaleX = parent.scaleX * childScaleData.scaleX\n                to.scaleY = parent.scaleY * childScaleData.scaleY\n            }\n\n        } else {\n            to.a = parent.a\n            to.b = parent.b\n            to.c = parent.c\n            to.d = parent.d\n\n            if (childScaleData) {\n                to.scaleX = parent.scaleX\n                to.scaleY = parent.scaleY\n            }\n        }\n\n        to.e = e * parent.a + f * parent.c + parent.e\n        to.f = e * parent.b + f * parent.d + parent.f\n    },\n\n\n    divide(t: IMatrixData, child: IMatrixData): void {\n        M.multiply(t, M.tempInvert(child))\n    },\n\n    divideParent(t: IMatrixData, parent: IMatrixData): void {\n        M.multiplyParent(t, M.tempInvert(parent))\n    },\n\n    tempInvert(t: IMatrixData): IMatrixData {\n        const { tempMatrix } = M\n        M.copy(tempMatrix, t)\n        M.invert(tempMatrix)\n        return tempMatrix\n    },\n\n    invert(t: IMatrixData): void {\n        const { a, b, c, d, e, f } = t\n        if (!b && !c) {\n            if (a === 1 && d === 1) {\n                t.e = -e\n                t.f = -f\n            } else {\n                const s = 1 / (a * d)\n                t.a = d * s\n                t.d = a * s\n                t.e = -e * d * s\n                t.f = -f * a * s\n            }\n        } else {\n            const s = 1 / (a * d - b * c)\n            t.a = d * s\n            t.b = -b * s\n            t.c = -c * s\n            t.d = a * s\n            t.e = -(e * d - f * c) * s\n            t.f = -(f * a - e * b) * s\n        }\n\n    },\n\n\n    toOuterPoint(t: IMatrixData, inner: IPointData, to?: IPointData, distance?: boolean): void {\n        const { x, y } = inner\n\n        // outer\n        to || (to = inner)\n        to.x = x * t.a + y * t.c\n        to.y = x * t.b + y * t.d\n\n        if (!distance) {\n            to.x += t.e\n            to.y += t.f\n        }\n    },\n\n    toInnerPoint(t: IMatrixData, outer: IPointData, to?: IPointData, distance?: boolean): void {\n        const { a, b, c, d } = t\n        const s = 1 / (a * d - b * c)\n\n        const { x, y } = outer\n\n        // inner\n        to || (to = outer)\n        to.x = (x * d - y * c) * s\n        to.y = (y * a - x * b) * s\n\n        if (!distance) {\n            const { e, f } = t\n            to.x -= (e * d - f * c) * s\n            to.y -= (f * a - e * b) * s\n        }\n    },\n\n    setLayout(t: IMatrixData, layout: ILayoutData, origin?: IPointData, around?: IPointData, bcChanged?: boolean | number): void {\n        const { x, y, scaleX, scaleY } = layout\n\n        if (isUndefined(bcChanged)) bcChanged = layout.rotation || layout.skewX || layout.skewY\n\n        if (bcChanged) {\n\n            const { rotation, skewX, skewY } = layout\n            const r = rotation * OneRadian\n            const cosR = cos(r)\n            const sinR = sin(r)\n\n            if (skewX || skewY) {\n\n                // rotate -> skew -> scale\n                const sx = skewX * OneRadian\n                const sy = skewY * OneRadian\n\n                t.a = (cosR + sy * -sinR) * scaleX\n                t.b = (sinR + sy * cosR) * scaleX\n                t.c = (-sinR + sx * cosR) * scaleY\n                t.d = (cosR + sx * sinR) * scaleY\n\n            } else {\n\n                // rotate -> scale\n                t.a = cosR * scaleX\n                t.b = sinR * scaleX\n                t.c = -sinR * scaleY\n                t.d = cosR * scaleY\n\n            }\n\n        } else {\n            t.a = scaleX\n            t.b = 0\n            t.c = 0\n            t.d = scaleY\n        }\n\n        // translate\n\n        t.e = x\n        t.f = y\n\n        if (origin = origin || around) M.translateInner(t, -origin.x, -origin.y, !around)\n\n    },\n\n    getLayout(t: IMatrixData, origin?: IPointData, around?: IPointData, firstSkewY?: boolean): ILayoutData {\n        const { a, b, c, d, e, f } = t\n\n        let x = e, y = f, scaleX: number, scaleY: number, rotation: number, skewX: number, skewY: number\n\n        if (b || c) {\n\n            const s = a * d - b * c\n\n            if (c && !firstSkewY) {\n                scaleX = sqrt(a * a + b * b)\n                scaleY = s / scaleX\n\n                const cosR = a / scaleX\n                rotation = b > 0 ? acos(cosR) : -acos(cosR)\n\n            } else {\n                scaleY = sqrt(c * c + d * d)\n                scaleX = s / scaleY\n\n                const cosR = c / scaleY\n                rotation = PI_2 - (d > 0 ? acos(-cosR) : -acos(cosR))\n            }\n\n            const cosR = float(cos(rotation)) // when -90 / 90 is 0\n            const sinR = sin(rotation)\n\n            scaleX = float(scaleX), scaleY = float(scaleY)\n            skewX = cosR ? float((c / scaleY + sinR) / cosR / OneRadian, 9) : 0\n            skewY = cosR ? float((b / scaleX - sinR) / cosR / OneRadian, 9) : 0\n            rotation = float(rotation / OneRadian)\n\n        } else {\n            scaleX = a\n            scaleY = d\n            rotation = skewX = skewY = 0\n        }\n\n        if (origin = around || origin) {\n            x += origin.x * a + origin.y * c\n            y += origin.x * b + origin.y * d\n            if (!around) x -= origin.x, y -= origin.y\n        }\n\n        return { x, y, scaleX, scaleY, rotation, skewX, skewY }\n    },\n\n    withScale(t: IMatrixData, scaleX?: number, scaleY = scaleX): IMatrixWithScaleData {\n        const world = t as unknown as IMatrixWithScaleData\n        if (!scaleX || !scaleY) {\n            const { a, b, c, d } = t\n            if (b || c) {\n                scaleX = sqrt(a * a + b * b)\n                scaleY = (a * d - b * c) / scaleX\n            } else {\n                scaleX = a\n                scaleY = d\n            }\n        }\n        world.scaleX = scaleX\n        world.scaleY = scaleY\n        return world\n    },\n\n    reset(t: IMatrixData): void {\n        M.set(t)\n    }\n}\n\nconst M = MatrixHelper","import { IPointData, IMatrixData, IRadiusPointData, IMatrixWithScaleData } from '@leafer/interface'\nimport { isObject, isUndefined } from '@leafer/data'\n\nimport { MathHelper, OneRadian, getPointData } from './MathHelper'\nimport { MatrixHelper as M } from './MatrixHelper'\n\nconst { float } = MathHelper\nconst { toInnerPoint, toOuterPoint } = M\nconst { sin, cos, abs, sqrt, atan2, min, round } = Math\n\n\nexport const PointHelper = {\n\n    defaultPoint: getPointData(),\n\n    tempPoint: {} as IPointData,\n    tempRadiusPoint: {} as IRadiusPointData,\n\n    set(t: IPointData, x = 0, y = 0): void {\n        t.x = x\n        t.y = y\n    },\n\n    setRadius(t: IRadiusPointData, x: number, y?: number): void {\n        t.radiusX = x\n        t.radiusY = isUndefined(y) ? x : y\n    },\n\n    copy(t: IPointData, point: IPointData): void {\n        t.x = point.x\n        t.y = point.y\n    },\n\n    copyFrom(t: IPointData, x: number, y: number): void {\n        t.x = x\n        t.y = y\n    },\n\n    round(t: IPointData, halfPixel?: boolean): void {\n        t.x = halfPixel ? round(t.x - 0.5) + 0.5 : round(t.x)\n        t.y = halfPixel ? round(t.y - 0.5) + 0.5 : round(t.y)\n    },\n\n    move(t: IPointData, x: number | IPointData, y?: number): void {\n        if (isObject(x)) t.x += x.x, t.y += x.y\n        else t.x += x, t.y += y\n    },\n\n\n    scale(t: IPointData, scaleX: number, scaleY = scaleX): void {\n        if (t.x) t.x *= scaleX\n        if (t.y) t.y *= scaleY\n    },\n\n    scaleOf(t: IPointData, origin: IPointData, scaleX: number, scaleY = scaleX): void {\n        t.x += (t.x - origin.x) * (scaleX - 1)\n        t.y += (t.y - origin.y) * (scaleY - 1)\n    },\n\n    rotate(t: IPointData, rotation: number, origin?: IPointData): void {\n        if (!origin) origin = P.defaultPoint\n        rotation *= OneRadian\n        const cosR = cos(rotation)\n        const sinR = sin(rotation)\n        const rx = t.x - origin.x\n        const ry = t.y - origin.y\n        t.x = origin.x + rx * cosR - ry * sinR\n        t.y = origin.y + rx * sinR + ry * cosR\n    },\n\n\n    tempToInnerOf(t: IPointData, matrix: IMatrixData): IPointData {\n        const { tempPoint: temp } = P\n        copy(temp, t)\n        toInnerPoint(matrix, temp, temp)\n        return temp\n    },\n\n    tempToOuterOf(t: IPointData, matrix: IMatrixData): IPointData {\n        const { tempPoint: temp } = P\n        copy(temp, t)\n        toOuterPoint(matrix, temp, temp)\n        return temp\n    },\n\n    tempToInnerRadiusPointOf(t: IRadiusPointData, matrix: IMatrixWithScaleData): IRadiusPointData {\n        const { tempRadiusPoint: temp } = P\n        copy(temp, t)\n        P.toInnerRadiusPointOf(t, matrix, temp)\n        return temp\n    },\n\n    copyRadiusPoint(t: IRadiusPointData, point: IPointData, x: number, y?: number,): IRadiusPointData {\n        copy(t, point)\n        setRadius(t, x, y)\n        return t\n    },\n\n    toInnerRadiusPointOf(t: IRadiusPointData, matrix: IMatrixWithScaleData, to?: IRadiusPointData): void {\n        to || (to = t)\n        toInnerPoint(matrix, t, to)\n        to.radiusX = Math.abs(t.radiusX / matrix.scaleX)\n        to.radiusY = Math.abs(t.radiusY / matrix.scaleY)\n    },\n\n\n    toInnerOf(t: IPointData, matrix: IMatrixData, to?: IPointData): void {\n        toInnerPoint(matrix, t, to)\n    },\n\n    toOuterOf(t: IPointData, matrix: IMatrixData, to?: IPointData): void {\n        toOuterPoint(matrix, t, to)\n    },\n\n\n    getCenter(t: IPointData, to: IPointData): IPointData {\n        return { x: t.x + (to.x - t.x) / 2, y: t.y + (to.y - t.y) / 2 }\n    },\n\n    getCenterX(x1: number, x2: number): number {\n        return x1 + (x2 - x1) / 2\n    },\n\n    getCenterY(y1: number, y2: number): number {\n        return y1 + (y2 - y1) / 2\n    },\n\n    getDistance(t: IPointData, point: IPointData): number {\n        return getDistanceFrom(t.x, t.y, point.x, point.y)\n    },\n\n    getDistanceFrom(x1: number, y1: number, x2: number, y2: number): number {\n        const x = abs(x2 - x1)\n        const y = abs(y2 - y1)\n        return sqrt(x * x + y * y)\n    },\n\n    getMinDistanceFrom(x1: number, y1: number, x2: number, y2: number, x3: number, y3: number): number {\n        return min(getDistanceFrom(x1, y1, x2, y2), getDistanceFrom(x2, y2, x3, y3))\n    },\n\n    getAngle(t: IPointData, to: IPointData): number {\n        return getAtan2(t, to) / OneRadian\n    },\n\n    getRotation(t: IPointData, origin: IPointData, to: IPointData, toOrigin?: IPointData): number {\n        if (!toOrigin) toOrigin = origin\n        return P.getRadianFrom(t.x, t.y, origin.x, origin.y, to.x, to.y, toOrigin.x, toOrigin.y) / OneRadian\n    },\n\n    getRadianFrom(fromX: number, fromY: number, originX: number, originY: number, toX: number, toY: number, toOriginX?: number, toOriginY?: number): number {\n        if (isUndefined(toOriginX)) toOriginX = originX, toOriginY = originY\n        const a = fromX - originX\n        const b = fromY - originY\n        const c = toX - toOriginX\n        const d = toY - toOriginY\n        return Math.atan2(a * d - b * c, a * c + b * d)\n    },\n\n    getAtan2(t: IPointData, to: IPointData): number {\n        return atan2(to.y - t.y, to.x - t.x)\n    },\n\n\n    getDistancePoint(t: IPointData, to: IPointData, distance: number, changeTo?: boolean, fromTo?: boolean): IPointData {\n        const r = getAtan2(t, to)\n        fromTo && (t = to)\n        changeTo || (to = {} as IPointData)\n        to.x = t.x + cos(r) * distance\n        to.y = t.y + sin(r) * distance\n        return to\n    },\n\n    toNumberPoints(originPoints: number[] | IPointData[]): number[] {\n        let points = originPoints as number[]\n        if (isObject(originPoints[0])) points = [], (originPoints as IPointData[]).forEach(p => points.push(p.x, p.y))\n        return points\n    },\n\n    isSame(t: IPointData, point: IPointData): boolean {\n        return float(t.x) === float(point.x) && float(t.y) === float(point.y)\n    },\n\n    reset(t: IPointData): void {\n        P.reset(t)\n    }\n}\n\nconst P = PointHelper\nconst { getDistanceFrom, copy, setRadius, getAtan2 } = P","import { IPoint, IPointData, IMatrixData } from '@leafer/interface'\nimport { isObject } from '@leafer/data'\n\nimport { PointHelper as P } from './PointHelper'\n\nexport class Point implements IPoint {\n\n    public x: number\n    public y: number\n\n    constructor(x?: number | IPointData, y?: number) {\n        this.set(x, y)\n    }\n\n    public set(x?: number | IPointData, y?: number): IPoint {\n        isObject(x) ? P.copy(this, x) : P.set(this, x, y)\n        return this\n    }\n\n    public get(): IPointData {\n        const { x, y } = this\n        return { x, y }\n    }\n\n\n    public clone(): IPoint {\n        return new Point(this)\n    }\n\n\n    public move(x: number | IPointData, y?: number): IPoint {\n        P.move(this, x, y)\n        return this\n    }\n\n    public scale(scaleX: number, scaleY?: number): IPoint {\n        P.scale(this, scaleX, scaleY)\n        return this\n    }\n\n    public scaleOf(origin: IPointData, scaleX: number, scaleY?: number): IPoint {\n        P.scaleOf(this, origin, scaleX, scaleY)\n        return this\n    }\n\n    public rotate(rotation: number, origin?: IPointData): IPoint {\n        P.rotate(this, rotation, origin)\n        return this\n    }\n\n    public rotateOf(origin: IPointData, rotation: number): IPoint {\n        P.rotate(this, rotation, origin)\n        return this\n    }\n\n    public getRotation(origin: IPointData, to: IPointData, toOrigin?: IPointData): number {\n        return P.getRotation(this, origin, to, toOrigin)\n    }\n\n\n    public toInnerOf(matrix: IMatrixData, to?: IPointData): IPoint {\n        P.toInnerOf(this, matrix, to)\n        return this\n    }\n\n    public toOuterOf(matrix: IMatrixData, to?: IPointData): IPoint {\n        P.toOuterOf(this, matrix, to)\n        return this\n    }\n\n\n    public getCenter(to: IPointData): IPoint {\n        return new Point(P.getCenter(this, to))\n    }\n\n    public getDistance(to: IPointData): number {\n        return P.getDistance(this, to)\n    }\n\n    public getDistancePoint(to: IPointData, distance: number, changeTo?: boolean, fromTo?: boolean): IPoint {\n        return new Point(P.getDistancePoint(this, to, distance, changeTo, fromTo))\n    }\n\n    public getAngle(to: IPointData): number {\n        return P.getAngle(this, to)\n    }\n\n    public getAtan2(to: IPointData): number {\n        return P.getAtan2(this, to)\n    }\n\n    public isSame(point: IPointData): boolean {\n        return P.isSame(this, point)\n    }\n\n    public reset(): IPoint {\n        P.reset(this)\n        return this\n    }\n\n}\n\nexport const tempPoint = new Point()","import { IMatrix, IMatrixData, IPointData, ILayoutData, IMatrixWithScaleData } from '@leafer/interface'\nimport { isObject } from '@leafer/data'\n\nimport { MatrixHelper as M } from './MatrixHelper'\n\n\nexport class Matrix implements IMatrix {\n\n    public a: number\n    public b: number\n    public c: number\n    public d: number\n    public e: number\n    public f: number\n\n    public scaleX: number\n    public scaleY: number\n\n    constructor(a?: number | IMatrixData, b?: number, c?: number, d?: number, e?: number, f?: number) {\n        this.set(a, b, c, d, e, f)\n    }\n\n    public set(a?: number | IMatrixData, b?: number, c?: number, d?: number, e?: number, f?: number): IMatrix {\n        isObject(a) ? M.copy(this, a) : M.set(this, a, b, c, d, e, f)\n        return this\n    }\n\n    public setWith(dataWithScale: IMatrixWithScaleData): IMatrix {\n        M.copy(this, dataWithScale)\n        this.scaleX = dataWithScale.scaleX\n        this.scaleY = dataWithScale.scaleY\n        return this\n    }\n\n    public get(): IMatrixData {\n        const { a, b, c, d, e, f } = this\n        return { a, b, c, d, e, f }\n    }\n\n    public clone(): IMatrix {\n        return new Matrix(this)\n    }\n\n\n    public translate(x: number, y: number): IMatrix {\n        M.translate(this, x, y)\n        return this\n    }\n\n    public translateInner(x: number, y: number): IMatrix {\n        M.translateInner(this, x, y)\n        return this\n    }\n\n    public scale(x: number, y?: number): IMatrix {\n        M.scale(this, x, y)\n        return this\n    }\n\n    public scaleWith(x: number, y?: number): IMatrix {\n        M.scale(this, x, y)\n        this.scaleX *= x\n        this.scaleY *= y || x\n        return this\n    }\n\n    public pixelScale(pixelRatio: number): IMatrix {\n        M.pixelScale(this, pixelRatio)\n        return this\n    }\n\n    public scaleOfOuter(origin: IPointData, x: number, y?: number): IMatrix {\n        M.scaleOfOuter(this, origin, x, y)\n        return this\n    }\n    public scaleOfInner(origin: IPointData, x: number, y?: number): IMatrix {\n        M.scaleOfInner(this, origin, x, y)\n        return this\n    }\n\n    public rotate(angle: number): IMatrix {\n        M.rotate(this, angle)\n        return this\n    }\n\n    public rotateOfOuter(origin: IPointData, angle: number): IMatrix {\n        M.rotateOfOuter(this, origin, angle)\n        return this\n    }\n\n    public rotateOfInner(origin: IPointData, angle: number): IMatrix {\n        M.rotateOfInner(this, origin, angle)\n        return this\n    }\n\n\n    public skew(x: number, y?: number): IMatrix {\n        M.skew(this, x, y)\n        return this\n    }\n\n    public skewOfOuter(origin: IPointData, x: number, y?: number): IMatrix {\n        M.skewOfOuter(this, origin, x, y)\n        return this\n    }\n\n    public skewOfInner(origin: IPointData, x: number, y?: number): IMatrix {\n        M.skewOfInner(this, origin, x, y)\n        return this\n    }\n\n\n    public multiply(child: IMatrixData): IMatrix {\n        M.multiply(this, child)\n        return this\n    }\n\n    public multiplyParent(parent: IMatrixData): IMatrix {\n        M.multiplyParent(this, parent)\n        return this\n    }\n\n\n    public divide(child: IMatrixData): IMatrix {\n        M.divide(this, child)\n        return this\n    }\n\n    public divideParent(parent: IMatrixData): IMatrix {\n        M.divideParent(this, parent)\n        return this\n    }\n\n    public invert(): IMatrix {\n        M.invert(this)\n        return this\n    }\n\n    public invertWith(): IMatrix {\n        M.invert(this)\n        this.scaleX = 1 / this.scaleX\n        this.scaleY = 1 / this.scaleY\n        return this\n    }\n\n\n    public toOuterPoint(inner: IPointData, to?: IPointData, distance?: boolean): void {\n        M.toOuterPoint(this, inner, to, distance)\n    }\n\n    public toInnerPoint(outer: IPointData, to?: IPointData, distance?: boolean): void {\n        M.toInnerPoint(this, outer, to, distance)\n    }\n\n\n    public setLayout(data: ILayoutData, origin?: IPointData, around?: IPointData,): IMatrix {\n        M.setLayout(this, data, origin, around)\n        return this\n    }\n\n    public getLayout(origin?: IPointData, around?: IPointData, firstSkewY?: boolean): ILayoutData {\n        return M.getLayout(this, origin, around, firstSkewY)\n    }\n\n    public withScale(scaleX?: number, scaleY?: number): IMatrixWithScaleData {\n        return M.withScale(this, scaleX, scaleY)\n    }\n\n    public reset(): void {\n        M.reset(this)\n    }\n\n}\n\nexport const tempMatrix = new Matrix()","import { ITwoPointBoundsData, IBoundsData } from '@leafer/interface'\n\nexport const TwoPointBoundsHelper = {\n\n    tempPointBounds: {} as ITwoPointBoundsData,\n\n    setPoint(t: ITwoPointBoundsData, minX: number, minY: number): void {\n        t.minX = t.maxX = minX\n        t.minY = t.maxY = minY\n    },\n\n    addPoint(t: ITwoPointBoundsData, x: number, y: number): void {\n        t.minX = x < t.minX ? x : t.minX\n        t.minY = y < t.minY ? y : t.minY\n        t.maxX = x > t.maxX ? x : t.maxX\n        t.maxY = y > t.maxY ? y : t.maxY\n    },\n\n    addBounds(t: ITwoPointBoundsData, x: number, y: number, width: number, height: number): void {\n        addPoint(t, x, y)\n        addPoint(t, x + width, y + height)\n    },\n\n    copy(t: ITwoPointBoundsData, pb: ITwoPointBoundsData): void {\n        t.minX = pb.minX\n        t.minY = pb.minY\n        t.maxX = pb.maxX\n        t.maxY = pb.maxY\n    },\n\n    addPointBounds(t: ITwoPointBoundsData, pb: ITwoPointBoundsData): void {\n        t.minX = pb.minX < t.minX ? pb.minX : t.minX\n        t.minY = pb.minY < t.minY ? pb.minY : t.minY\n        t.maxX = pb.maxX > t.maxX ? pb.maxX : t.maxX\n        t.maxY = pb.maxY > t.maxY ? pb.maxY : t.maxY\n    },\n\n    toBounds(t: ITwoPointBoundsData, setBounds: IBoundsData): void {\n        setBounds.x = t.minX\n        setBounds.y = t.minY\n        setBounds.width = t.maxX - t.minX\n        setBounds.height = t.maxY - t.minY\n    }\n\n}\n\nconst { addPoint } = TwoPointBoundsHelper","export enum Direction4 {\n    top,\n    right,\n    bottom,\n    left\n}\n\nexport enum Direction9 {\n    topLeft,\n    top,\n    topRight,\n    right,\n    bottomRight,\n    bottom,\n    bottomLeft,\n    left,\n    center,\n    'top-left' = 0,\n    'top-right' = 2,\n    'bottom-right' = 4,\n    'bottom-left' = 6\n}","import { IAround, IPointData, IBoundsData, IUnitPointData } from '@leafer/interface'\nimport { isString } from '@leafer/data'\n\nimport { Direction9 } from './Direction'\n\n\nconst directionData: IUnitPointData[] = [\n    { x: 0, y: 0 },  //topLeft\n    { x: 0.5, y: 0 },//top\n    { x: 1, y: 0 },  //topRight\n    { x: 1, y: 0.5 },// right\n    { x: 1, y: 1 },  //bottomRight\n    { x: 0.5, y: 1 },//bottom\n    { x: 0, y: 1 },  //bottomLeft\n    { x: 0, y: 0.5 },//left\n    { x: 0.5, y: 0.5 } // center\n]\ndirectionData.forEach(item => item.type = 'percent')\n\nexport const AroundHelper = {\n\n    directionData, // index Direction9\n\n    tempPoint: {} as IPointData,\n\n    get,\n\n    toPoint(around: IAround, box: IBoundsData, to: IPointData, onlyBoxSize?: boolean, content?: IBoundsData, onlyContentSize?: boolean) {\n        const point = get(around)\n\n        to.x = point.x\n        to.y = point.y\n\n\n        if (point.type === 'percent') {\n            to.x *= box.width\n            to.y *= box.height\n\n            if (content) { // align\n                if (!onlyContentSize) to.x -= content.x, to.y -= content.y\n                if (point.x) to.x -= (point.x === 1) ? content.width : (point.x === 0.5 ? point.x * content.width : 0)\n                if (point.y) to.y -= (point.y === 1) ? content.height : (point.y === 0.5 ? point.y * content.height : 0)\n            }\n        }\n\n        if (!onlyBoxSize) to.x += box.x, to.y += box.y\n    },\n\n    getPoint(around: IAround, box: IBoundsData, to?: IPointData): IPointData {\n        if (!to) to = {} as IPointData\n        AroundHelper.toPoint(around, box, to, true)\n        return to\n    }\n}\n\nfunction get(around: IAround): IUnitPointData {\n    return isString(around) ? directionData[Direction9[around]] : around\n}","import { IPointData, IBoundsData, IAlign } from '@leafer/interface'\nimport { AroundHelper } from './AroundHelper'\n\nconst { toPoint } = AroundHelper\n\nexport const AlignHelper = {\n    toPoint(align: IAlign, content: IBoundsData, box: IBoundsData, to: IPointData, onlyBoxSize?: boolean, onlyContentSize?: boolean): void {\n        toPoint(align, box, to, onlyBoxSize, content, onlyContentSize)\n    }\n}","import { IPointData, IBoundsData, IMatrixData, IFourNumber, IBoundsDataFn, IObject, IMatrix, IOffsetBoundsData, IRadiusPointData, IMatrixWithScaleData, ISide, IAlign, ISizeData, IScrollPointData } from '@leafer/interface'\nimport { isArray, isString } from '@leafer/data'\n\nimport { Matrix } from './Matrix'\nimport { MatrixHelper as M } from './MatrixHelper'\nimport { TwoPointBoundsHelper as TB } from './TwoPointBoundsHelper'\nimport { PointHelper as P } from './PointHelper'\nimport { MathHelper, getBoundsData } from './MathHelper'\nimport { AlignHelper } from './AlignHelper'\n\n\nconst { tempPointBounds, setPoint, addPoint, toBounds } = TB\nconst { toOuterPoint } = M\nconst { float, fourNumber } = MathHelper\nconst { floor, ceil } = Math\n\nlet right: number, bottom: number, boundsRight: number, boundsBottom: number\nconst point = {} as IPointData\nconst toPoint = {} as IPointData\nconst tempBounds = {} as IBoundsData\n\nexport const BoundsHelper = {\n\n    tempBounds,\n\n    set(t: IBoundsData, x = 0, y = 0, width = 0, height = 0): void {\n        t.x = x\n        t.y = y\n        t.width = width\n        t.height = height\n    },\n\n    copy(t: IBoundsData, bounds: IBoundsData): void {\n        t.x = bounds.x\n        t.y = bounds.y\n        t.width = bounds.width\n        t.height = bounds.height\n    },\n\n    copyAndSpread(t: IBoundsData, bounds: IBoundsData, spread: IFourNumber, isShrink?: boolean, side?: ISide): void {\n        const { x, y, width, height } = bounds\n        if (isArray(spread)) {\n            const four = fourNumber(spread)\n            isShrink\n                ? B.set(t, x + four[3], y + four[0], width - four[1] - four[3], height - four[2] - four[0])\n                : B.set(t, x - four[3], y - four[0], width + four[1] + four[3], height + four[2] + four[0])\n        } else {\n            if (isShrink) spread = -spread\n            B.set(t, x - spread, y - spread, width + spread * 2, height + spread * 2)\n        }\n\n        if (side) { // 只扩展/收缩一边\n            if (side === 'width') t.y = y, t.height = height\n            else t.x = x, t.width = width\n        }\n    },\n\n\n    minX(t: IBoundsData): number { return t.width > 0 ? t.x : t.x + t.width },\n\n    minY(t: IBoundsData): number { return t.height > 0 ? t.y : t.y + t.height },\n\n    maxX(t: IBoundsData): number { return t.width > 0 ? t.x + t.width : t.x },\n\n    maxY(t: IBoundsData): number { return t.height > 0 ? t.y + t.height : t.y },\n\n\n    move(t: IBoundsData, x: number, y: number): void {\n        t.x += x\n        t.y += y\n    },\n\n    scroll(t: IBoundsData, data: IScrollPointData): void {\n        t.x += data.scrollX\n        t.y += data.scrollY\n    },\n\n    getByMove(t: IBoundsData, x: number, y: number): IBoundsData {\n        t = { ...t }\n        B.move(t, x, y)\n        return t\n    },\n\n    toOffsetOutBounds(t: IBoundsData, to?: IOffsetBoundsData, offsetBounds?: IBoundsData): void {\n        if (!to) to = t as IOffsetBoundsData\n        else copy(to, t)\n\n        if (!offsetBounds) offsetBounds = t\n        to.offsetX = B.maxX(offsetBounds)\n        to.offsetY = B.maxY(offsetBounds)\n        B.move(to, -to.offsetX, -to.offsetY)\n    },\n\n\n    scale(t: IBoundsData, scaleX: number, scaleY = scaleX, onlySize?: boolean): void {\n        onlySize || P.scale(t, scaleX, scaleY)\n        t.width *= scaleX\n        t.height *= scaleY\n    },\n\n    scaleOf(t: IBoundsData, origin: IPointData, scaleX: number, scaleY = scaleX): void {\n        P.scaleOf(t, origin, scaleX, scaleY)\n        t.width *= scaleX\n        t.height *= scaleY\n    },\n\n    tempToOuterOf(t: IBoundsData, matrix: IMatrixData): IBoundsData {\n        B.copy(tempBounds, t)\n        B.toOuterOf(tempBounds, matrix)\n        return tempBounds\n    },\n\n    getOuterOf(t: IBoundsData, matrix: IMatrixData): IBoundsData {\n        t = { ...t }\n        B.toOuterOf(t, matrix)\n        return t\n    },\n\n    toOuterOf(t: IBoundsData, matrix: IMatrixData, to?: IBoundsData): void {\n\n        to || (to = t)\n\n        if (matrix.b === 0 && matrix.c === 0) {\n\n            const { a, d, e, f } = matrix\n            if (a > 0) {\n                to.width = t.width * a\n                to.x = e + t.x * a\n            } else {\n                to.width = t.width * -a\n                to.x = e + t.x * a - to.width\n            }\n\n            if (d > 0) {\n                to.height = t.height * d\n                to.y = f + t.y * d\n            } else {\n                to.height = t.height * -d\n                to.y = f + t.y * d - to.height\n            }\n\n        } else {\n\n            point.x = t.x\n            point.y = t.y\n\n            toOuterPoint(matrix, point, toPoint)\n            setPoint(tempPointBounds, toPoint.x, toPoint.y)\n\n            point.x = t.x + t.width\n\n            toOuterPoint(matrix, point, toPoint)\n            addPoint(tempPointBounds, toPoint.x, toPoint.y)\n\n            point.y = t.y + t.height\n\n            toOuterPoint(matrix, point, toPoint)\n            addPoint(tempPointBounds, toPoint.x, toPoint.y)\n\n            point.x = t.x\n\n            toOuterPoint(matrix, point, toPoint)\n            addPoint(tempPointBounds, toPoint.x, toPoint.y)\n\n            toBounds(tempPointBounds, to)\n        }\n    },\n\n    toInnerOf(t: IBoundsData, matrix: IMatrixData, to?: IBoundsData): void {\n        to || (to = t)\n        B.move(to, -matrix.e, -matrix.f)\n        B.scale(to, 1 / matrix.a, 1 / matrix.d)\n    },\n\n    getFitMatrix(t: IBoundsData, put: IBoundsData, baseScale = 1): IMatrix {\n        const scale = Math.min(baseScale, B.getFitScale(t, put))\n        return new Matrix(scale, 0, 0, scale, -put.x * scale, -put.y * scale)\n    },\n\n    getFitScale(t: ISizeData, put: ISizeData, isCoverMode?: boolean): number {\n        const sw = t.width / put.width, sh = t.height / put.height\n        return isCoverMode ? Math.max(sw, sh) : Math.min(sw, sh)\n    },\n\n    put(t: ISizeData, put: ISizeData, align: IAlign = 'center', putScale: number | 'fit' | 'cover' = 1, changeSize = true, to?: IPointData): void {\n        to || (to = put as unknown as IPointData)\n        if (isString(putScale)) putScale = B.getFitScale(t, put, putScale === 'cover')\n        tempBounds.width = changeSize ? put.width *= putScale : put.width * putScale\n        tempBounds.height = changeSize ? put.height *= putScale : put.height * putScale\n        AlignHelper.toPoint(align, tempBounds, t as IBoundsData, to, true, true)\n    },\n\n    getSpread(t: IBoundsData, spread: IFourNumber, side?: ISide): IBoundsData {\n        const n = {} as IBoundsData\n        B.copyAndSpread(n, t, spread, false, side)\n        return n\n    },\n\n    spread(t: IBoundsData, spread: IFourNumber, side?: ISide): void {\n        B.copyAndSpread(t, t, spread, false, side)\n    },\n\n    shrink(t: IBoundsData, shrink: IFourNumber, side?: ISide): void {\n        B.copyAndSpread(t, t, shrink, true, side)\n    },\n\n    ceil(t: IBoundsData): void {\n        const { x, y } = t\n        t.x = floor(t.x)\n        t.y = floor(t.y)\n        t.width = x > t.x ? ceil(t.width + x - t.x) : ceil(t.width)\n        t.height = y > t.y ? ceil(t.height + y - t.y) : ceil(t.height)\n    },\n\n    unsign(t: IBoundsData): void {\n        if (t.width < 0) {\n            t.x += t.width\n            t.width = -t.width\n        }\n        if (t.height < 0) {\n            t.y += t.height\n            t.height = -t.height\n        }\n    },\n\n    float(t: IBoundsData, maxLength?: number): void {\n        t.x = float(t.x, maxLength)\n        t.y = float(t.y, maxLength)\n        t.width = float(t.width, maxLength)\n        t.height = float(t.height, maxLength)\n    },\n\n    add(t: IBoundsData, bounds: IBoundsData, isPoint?: boolean): void {\n        right = t.x + t.width\n        bottom = t.y + t.height\n        boundsRight = bounds.x\n        boundsBottom = bounds.y\n\n        if (!isPoint) {\n            boundsRight += bounds.width\n            boundsBottom += bounds.height\n        }\n\n        right = right > boundsRight ? right : boundsRight\n        bottom = bottom > boundsBottom ? bottom : boundsBottom\n\n        t.x = t.x < bounds.x ? t.x : bounds.x\n        t.y = t.y < bounds.y ? t.y : bounds.y\n        t.width = right - t.x\n        t.height = bottom - t.y\n    },\n\n    addList(t: IBoundsData, list: IBoundsData[]): void {\n        B.setListWithFn(t, list, undefined, true)\n    },\n\n    setList(t: IBoundsData, list: IBoundsData[], addMode = false): void {\n        B.setListWithFn(t, list, undefined, addMode)\n    },\n\n    addListWithFn(t: IBoundsData, list: IObject[], boundsDataFn: IBoundsDataFn): void {\n        B.setListWithFn(t, list, boundsDataFn, true)\n    },\n\n    setListWithFn(t: IBoundsData, list: IObject[], boundsDataFn: IBoundsDataFn, addMode = false): void {\n        let bounds: IBoundsData, first = true\n        for (let i = 0, len = list.length; i < len; i++) {\n            bounds = boundsDataFn ? boundsDataFn(list[i], i) : list[i] as IBoundsData\n            if (bounds && (bounds.width || bounds.height)) {\n                if (first) {\n                    first = false\n                    if (!addMode) copy(t, bounds)\n                } else {\n                    add(t, bounds)\n                }\n            }\n        }\n\n        if (first) B.reset(t)\n    },\n\n\n    setPoints(t: IBoundsData, points: IPointData[]): void {\n        points.forEach((point, index) => index === 0 ? setPoint(tempPointBounds, point.x, point.y) : addPoint(tempPointBounds, point.x, point.y))\n        toBounds(tempPointBounds, t)\n    },\n\n    setPoint(t: IBoundsData, point: IPointData): void {\n        B.set(t, point.x, point.y)\n    },\n\n    addPoint(t: IBoundsData, point: IPointData): void {\n        add(t, point as IBoundsData, true)\n    },\n\n    getPoints(t: IBoundsData): IPointData[] {\n        const { x, y, width, height } = t\n        return [\n            { x, y }, // topLeft\n            { x: x + width, y }, // topRight\n            { x: x + width, y: y + height }, // bottomRight\n            { x, y: y + height } // bottomLeft\n        ]\n    },\n\n\n    hitRadiusPoint(t: IBoundsData, point: IRadiusPointData, pointMatrix?: IMatrixWithScaleData): boolean {\n        if (pointMatrix) point = P.tempToInnerRadiusPointOf(point, pointMatrix)\n        return (point.x >= t.x - point.radiusX && point.x <= t.x + t.width + point.radiusX) && (point.y >= t.y - point.radiusY && point.y <= t.y + t.height + point.radiusY)\n    },\n\n    hitPoint(t: IBoundsData, point: IPointData, pointMatrix?: IMatrixData): boolean {\n        if (pointMatrix) point = P.tempToInnerOf(point, pointMatrix)\n        return (point.x >= t.x && point.x <= t.x + t.width) && (point.y >= t.y && point.y <= t.y + t.height)\n    },\n\n\n    hit(t: IBoundsData, other: IBoundsData, otherMatrix?: IMatrixData): boolean {\n        if (otherMatrix) other = B.tempToOuterOf(other, otherMatrix)\n        return !((t.y + t.height < other.y) || (other.y + other.height < t.y) || (t.x + t.width < other.x) || (other.x + other.width < t.x))\n    },\n\n    includes(t: IBoundsData, other: IBoundsData, otherMatrix?: IMatrixData): boolean {\n        if (otherMatrix) other = B.tempToOuterOf(other, otherMatrix)\n        return (t.x <= other.x) && (t.y <= other.y) && (t.x + t.width >= other.x + other.width) && (t.y + t.height >= other.y + other.height)\n    },\n\n    getIntersectData(t: IBoundsData, other: IBoundsData, otherMatrix?: IMatrixData): IBoundsData {\n        if (otherMatrix) other = B.tempToOuterOf(other, otherMatrix)\n        if (!B.hit(t, other)) return getBoundsData()\n\n        let { x, y, width, height } = other\n\n        right = x + width\n        bottom = y + height\n        boundsRight = t.x + t.width\n        boundsBottom = t.y + t.height\n\n        x = x > t.x ? x : t.x\n        y = y > t.y ? y : t.y\n        right = right < boundsRight ? right : boundsRight\n        bottom = bottom < boundsBottom ? bottom : boundsBottom\n\n        width = right - x\n        height = bottom - y\n\n        return { x, y, width, height }\n    },\n\n    intersect(t: IBoundsData, other: IBoundsData, otherMatrix?: IMatrixData): void {\n        B.copy(t, B.getIntersectData(t, other, otherMatrix))\n    },\n\n\n    isSame(t: IBoundsData, bounds: IBoundsData): boolean {\n        return t.x === bounds.x && t.y === bounds.y && t.width === bounds.width && t.height === bounds.height\n    },\n\n    isEmpty(t: IBoundsData): boolean {\n        return t.x === 0 && t.y === 0 && t.width === 0 && t.height === 0\n    },\n\n    hasSize(t: IBoundsData): boolean {\n        return (t.width && t.height) as any as boolean\n    },\n\n    reset(t: IBoundsData): void {\n        B.set(t)\n    }\n}\n\nconst B = BoundsHelper\nconst { add, copy } = B","import { IBounds, IBoundsData, IMatrixData, IPointData, IBoundsDataFn, IObject, IMatrix, IRadiusPointData, IMatrixWithLayoutData, IFourNumber, ISide, IAlign } from '@leafer/interface'\nimport { isObject } from '@leafer/data'\n\nimport { BoundsHelper as B } from './BoundsHelper'\n\n\nexport class Bounds implements IBounds {\n\n    public x: number\n    public y: number\n    public width: number\n    public height: number\n\n    public get minX(): number { return B.minX(this) }\n    public get minY(): number { return B.minY(this) }\n    public get maxX(): number { return B.maxX(this) }\n    public get maxY(): number { return B.maxY(this) }\n\n    constructor(x?: number | IBoundsData, y?: number, width?: number, height?: number) {\n        this.set(x, y, width, height)\n    }\n\n    public set(x?: number | IBoundsData, y?: number, width?: number, height?: number): IBounds {\n        isObject(x) ? B.copy(this, x) : B.set(this, x, y, width, height)\n        return this\n    }\n\n    public get(): IBoundsData {\n        const { x, y, width, height } = this\n        return { x, y, width, height }\n    }\n\n    public clone(): IBounds {\n        return new Bounds(this)\n    }\n\n\n    public move(x: number, y: number): IBounds {\n        B.move(this, x, y)\n        return this\n    }\n\n    public scale(scaleX: number, scaleY?: number, onlySize?: boolean): IBounds {\n        B.scale(this, scaleX, scaleY, onlySize)\n        return this\n    }\n\n    public scaleOf(origin: IPointData, scaleX: number, scaleY?: number): IBounds {\n        B.scaleOf(this, origin, scaleX, scaleY)\n        return this\n    }\n\n    public toOuterOf(matrix: IMatrixData, to?: IBoundsData): IBounds {\n        B.toOuterOf(this, matrix, to)\n        return this\n    }\n\n    public toInnerOf(matrix: IMatrixData, to?: IBoundsData): IBounds {\n        B.toInnerOf(this, matrix, to)\n        return this\n    }\n\n    public getFitMatrix(put: IBoundsData, baseScale?: number): IMatrix {\n        return B.getFitMatrix(this, put, baseScale)\n    }\n\n    public put(put: IBoundsData, align?: IAlign, putScale?: number | 'fit' | 'cover'): void {\n        B.put(this, put, align, putScale)\n    }\n\n    public spread(fourNumber: IFourNumber, side?: ISide): IBounds {\n        B.spread(this, fourNumber, side)\n        return this\n    }\n\n    public shrink(fourNumber: IFourNumber, side?: ISide): IBounds {\n        B.shrink(this, fourNumber, side)\n        return this\n    }\n\n    public ceil(): IBounds {\n        B.ceil(this)\n        return this\n    }\n\n    public unsign(): IBounds {\n        B.unsign(this)\n        return this\n    }\n\n    public float(maxLength?: number): IBounds {\n        B.float(this, maxLength)\n        return this\n    }\n\n\n    public add(bounds: IBoundsData): IBounds {\n        B.add(this, bounds)\n        return this\n    }\n\n    public addList(boundsList: IBoundsData[]): IBounds {\n        B.setList(this, boundsList, true)\n        return this\n    }\n\n    public setList(boundsList: IBoundsData[]): IBounds {\n        B.setList(this, boundsList)\n        return this\n    }\n\n    public addListWithFn(list: IObject[], boundsDataFn: IBoundsDataFn): IBounds {\n        B.setListWithFn(this, list, boundsDataFn, true)\n        return this\n    }\n\n    public setListWithFn(list: IObject[], boundsDataFn: IBoundsDataFn): IBounds {\n        B.setListWithFn(this, list, boundsDataFn)\n        return this\n    }\n\n\n    public setPoint(point: IPointData): IBounds {\n        B.setPoint(this, point)\n        return this\n    }\n\n    public setPoints(points: IPointData[]): IBounds {\n        B.setPoints(this, points)\n        return this\n    }\n\n    public addPoint(point: IPointData): IBounds {\n        B.addPoint(this, point)\n        return this\n    }\n\n    public getPoints(): IPointData[] {\n        return B.getPoints(this)\n    }\n\n\n\n    public hitPoint(point: IPointData, pointMatrix?: IMatrixData): boolean {\n        return B.hitPoint(this, point, pointMatrix)\n    }\n\n    public hitRadiusPoint(point: IRadiusPointData, pointMatrix?: IMatrixWithLayoutData): boolean {\n        return B.hitRadiusPoint(this, point, pointMatrix)\n    }\n\n    public hit(bounds: IBoundsData, boundsMatrix?: IMatrixData): boolean {\n        return B.hit(this, bounds, boundsMatrix)\n    }\n\n    public includes(bounds: IBoundsData, boundsMatrix?: IMatrixData): boolean {\n        return B.includes(this, bounds, boundsMatrix)\n    }\n\n\n    public intersect(bounds: IBoundsData, boundsMatrix?: IMatrixData): IBounds {\n        B.intersect(this, bounds, boundsMatrix)\n        return this\n    }\n\n    public getIntersect(bounds: IBoundsData, boundsMatrix?: IMatrixData): IBounds {\n        return new Bounds(B.getIntersectData(this, bounds, boundsMatrix))\n    }\n\n\n    public isSame(bounds: IBoundsData): boolean {\n        return B.isSame(this, bounds)\n    }\n\n    public isEmpty(): boolean {\n        return B.isEmpty(this)\n    }\n\n    public reset(): void {\n        B.reset(this)\n    }\n\n}\n\nexport const tempBounds = new Bounds()","import { IAutoBounds, IAutoBoundsData, IBounds, ISizeData } from '@leafer/interface'\nimport { isObject } from '@leafer/data'\n\nimport { Bounds } from './Bounds'\n\n\nexport class AutoBounds implements IAutoBounds {\n\n    public top: number\n    public right: number\n    public bottom: number\n    public left: number\n\n    public width: number\n    public height: number\n\n    constructor(top?: number | IAutoBoundsData, right?: number, bottom?: number, left?: number, width?: number, height?: number) {\n        isObject(top) ? this.copy(top) : this.set(top, right, bottom, left, width, height)\n    }\n\n    set(top = 0, right = 0, bottom = 0, left = 0, width = 0, height = 0): void {\n        this.top = top\n        this.right = right\n        this.bottom = bottom\n        this.left = left\n        this.width = width\n        this.height = height\n    }\n\n    copy(autoSize: IAutoBoundsData): void {\n        const { top, right, bottom, left, width, height } = autoSize\n        this.set(top, right, bottom, left, width, height)\n    }\n\n    getBoundsFrom(parent: ISizeData): IBounds {\n        const { top, right, bottom, left, width, height } = this\n        return new Bounds(left, top, width ? width : parent.width - left - right, height ? height : parent.height - top - bottom)\n    }\n\n}","import { IUnitData } from '@leafer/interface'\nimport { isObject } from '@leafer/data'\n\nexport const UnitConvertHelper = {\n    number(value: number | IUnitData, percentRefer?: number): number {\n        return isObject(value) ? (value.type === 'percent' ? value.value * percentRefer : value.value) : value\n    }\n}","import { INumberMap } from '@leafer/interface'\n\n\nexport const StringNumberMap: INumberMap = {\n    '0': 1,\n    '1': 1,\n    '2': 1,\n    '3': 1,\n    '4': 1,\n    '5': 1,\n    '6': 1,\n    '7': 1,\n    '8': 1,\n    '9': 1,\n    '.': 1,\n    'e': 1,\n    'E': 1\n}","import { IPlatform, IObject, IBoundsData, ICanvasPattern, IMatrixData, ILeaferImagePatternPaint, ISizeData, ICanvasContext2D, IInterlace } from '@leafer/interface'\nimport { DataHelper } from '@leafer/data'\nimport { UnitConvertHelper } from '@leafer/math'\n\n\nconst { floor, max } = Math\n\nexport const Platform: IPlatform = {\n    toURL(text: string, fileType?: 'text' | 'svg'): string {\n        let url = encodeURIComponent(text)\n        if (fileType === 'text') url = 'data:text/plain;charset=utf-8,' + url\n        else if (fileType === 'svg') url = 'data:image/svg+xml,' + url\n        return url\n    },\n    image: {\n        hitCanvasSize: 100,\n        maxCacheSize: 2560 * 1600,  // 2k\n        maxPatternSize: 4096 * 2160, // 4k\n        crossOrigin: 'anonymous',\n        isLarge(size: ISizeData, scaleX?: number, scaleY?: number, largeSize?: number): boolean {\n            return size.width * size.height * (scaleX ? scaleX * scaleY : 1) > (largeSize || image.maxCacheSize)\n        },\n        isSuperLarge(size: ISizeData, scaleX?: number, scaleY?: number): boolean {\n            return image.isLarge(size, scaleX, scaleY, image.maxPatternSize)\n        },\n        getRealURL(url: string): string {\n            const { prefix, suffix } = image\n            if (suffix && !url.startsWith('data:') && !url.startsWith('blob:')) url += (url.includes(\"?\") ? \"&\" : \"?\") + suffix\n            if (prefix && url[0] === '/') url = prefix + url\n            return url\n        },\n        resize(view: any, width: number, height: number, xGap?: number, yGap?: number, clip?: IBoundsData, smooth?: boolean, opacity?: number, _filters?: IObject, interlace?: IInterlace): any {\n            const realWidth = max(floor(width + (xGap || 0)), 1), realHeight = max(floor(height + (yGap || 0)), 1)\n\n            let interlaceX: boolean, interlaceY: boolean, interlaceOffset: number\n            if (interlace && (interlaceOffset = UnitConvertHelper.number(interlace.offset, (interlaceX = interlace.type === 'x') ? width : height))) interlaceX || (interlaceY = true)\n\n            const canvas = Platform.origin.createCanvas(interlaceY ? realWidth * 2 : realWidth, interlaceX ? realHeight * 2 : realHeight)\n            const ctx: ICanvasContext2D = canvas.getContext('2d')\n            if (opacity) ctx.globalAlpha = opacity\n            ctx.imageSmoothingEnabled = smooth === false ? false : true // 平滑绘制\n\n            if (image.canUse(view)) {\n                if (clip) {\n                    const scaleX = width / clip.width, scaleY = height / clip.height\n                    ctx.setTransform(scaleX, 0, 0, scaleY, -clip.x * scaleX, -clip.y * scaleY)\n                    ctx.drawImage(view, 0, 0, view.width, view.height)\n                } else ctx.drawImage(view, 0, 0, width, height)\n\n                if (interlaceOffset) {\n                    ctx.drawImage(canvas, 0, 0, realWidth, realHeight, interlaceX ? interlaceOffset - realWidth : realWidth, interlaceX ? realHeight : interlaceOffset - realHeight, realWidth, realHeight)\n                    ctx.drawImage(canvas, 0, 0, realWidth, realHeight, interlaceX ? interlaceOffset : realWidth, interlaceX ? realHeight : interlaceOffset, realWidth, realHeight)\n                }\n            }\n\n            return canvas\n        },\n        canUse(view: any): boolean {\n            return view && view.width && !view.__closed // __closed 为内部标记已销毁\n        },\n        setPatternTransform(pattern: ICanvasPattern, transform?: IMatrixData, paint?: ILeaferImagePatternPaint): void {\n            try {\n                if (transform && pattern.setTransform) {\n                    pattern.setTransform(transform) // maybe error \n                    transform = undefined\n                }\n            } catch { }\n            if (paint) DataHelper.stintSet(paint, 'transform', transform)\n        }\n    }\n}\n\nconst { image } = Platform","import { IBooleanMap, IBoundsData, ILeaferCanvas, IRenderOptions, ILeaf } from '@leafer/interface'\nimport { isString } from '@leafer/data'\nimport { MathHelper } from '@leafer/math'\n\n\nconst { randColor } = MathHelper\nexport class Debug {\n\n    static enable: boolean\n\n    static filterList: string[] = []\n    static excludeList: string[] = []\n\n    // other\n    static showWarn = true\n    static showRepaint: boolean | string\n    static showBounds: boolean | string | 'hit'\n\n    public name: string\n\n    public repeatMap: IBooleanMap = {}\n\n    constructor(name: string) {\n        this.name = name\n    }\n\n    static get(name: string): Debug {\n        return new Debug(name)\n    }\n\n    static set filter(name: string | string[]) {\n        this.filterList = getNameList(name)\n    }\n\n    static set exclude(name: string | string[]) {\n        this.excludeList = getNameList(name)\n    }\n\n    static drawRepaint(canvas: ILeaferCanvas, bounds: IBoundsData): void {\n        const color = randColor()\n        canvas.fillWorld(bounds, color.replace('1)', '.1)'))\n        canvas.strokeWorld(bounds, color)\n    }\n\n    static drawBounds(leaf: ILeaf, canvas: ILeaferCanvas, _options: IRenderOptions): void {\n        const showHit = Debug.showBounds === 'hit', w = leaf.__nowWorld, color = randColor()\n        if (showHit) canvas.setWorld(w), leaf.__drawHitPath(canvas), canvas.fillStyle = color.replace('1)', '.2)'), canvas.fill()\n\n        canvas.resetTransform()\n        canvas.setStroke(color, 2)\n        showHit ? canvas.stroke() : canvas.strokeWorld(w, color)\n    }\n\n\n    log(...messages: unknown[]): void {\n        if (D.enable) {\n            if (D.filterList.length && D.filterList.every(name => name !== this.name)) return\n            if (D.excludeList.length && D.excludeList.some(name => name === this.name)) return\n            console.log('%c' + this.name, 'color:#21ae62', ...messages)\n        }\n    }\n\n    tip(...messages: unknown[]): void {\n        if (D.enable) this.warn(...messages)\n    }\n\n    warn(...messages: unknown[]): void {\n        if (D.showWarn) console.warn(this.name, ...messages)\n    }\n\n    repeat(name: string, ...messages: unknown[]) {\n        if (!this.repeatMap[name]) {\n            this.warn('repeat:' + name, ...messages)\n            this.repeatMap[name] = true\n        }\n    }\n\n    error(...messages: unknown[]): void {\n        try {\n            throw new Error()\n        } catch (e) {\n            console.error(this.name, ...messages, e)\n        }\n    }\n}\n\nfunction getNameList(name: string | string[]): string[] {\n    if (!name) name = []\n    else if (isString(name)) name = [name]\n    return name\n}\n\nconst D = Debug","import { IncrementId } from '@leafer/math'\nimport { isUndefined } from '@leafer/data'\n\nimport { Debug } from './Debug'\n\n\ninterface ids {\n    [name: string]: number\n}\ninterface names {\n    [name: string]: string\n}\n\n\nconst debug = Debug.get('RunTime')\n\nexport const Run = {\n\n    currentId: 0,\n    currentName: '',\n\n    idMap: {} as ids,\n    nameMap: {} as names,\n    nameToIdMap: {} as ids,\n\n    start(name: string, microsecond?: boolean): number {\n        const id = IncrementId.create(IncrementId.RUNTIME)\n        R.currentId = R.idMap[id] = microsecond ? performance.now() : Date.now()\n        R.currentName = R.nameMap[id] = name\n        R.nameToIdMap[name] = id\n        return id\n    },\n\n    end(id: number, microsecond?: boolean): void {\n        const time = R.idMap[id], name = R.nameMap[id]\n        const duration = microsecond ? (performance.now() - time) / 1000 : Date.now() - time\n        R.idMap[id] = R.nameMap[id] = R.nameToIdMap[name] = undefined\n        debug.log(name, duration, 'ms')\n    },\n\n    endOfName(name: string, microsecond?: boolean): void {\n        const id = R.nameToIdMap[name]\n        if (!isUndefined(id)) R.end(id, microsecond)\n    }\n}\n\nconst R = Run","import { IBooleanMap } from '@leafer/interface'\n\n\nconst check = [] as string[]\n\nexport const Plugin = {\n\n    list: {} as IBooleanMap,\n\n    add(name: string, ...needPlugins: string[]) {\n        this.list[name] = true\n        check.push(...needPlugins)\n    },\n\n    has(name: string, tip?: boolean): boolean {\n        const rs = this.list[name]\n        if (!rs && tip) this.need(name)\n        return rs\n    },\n\n    need(name: string): any {\n        console.error('please install and import plugin: ' + (name.includes('-x') ? '' : '@leafer-in/') + name)\n    }\n\n}\n\nsetTimeout(() => check.forEach(name => Plugin.has(name, true)))","import { ICreator, IObject, ILeaf } from '@leafer/interface'\nimport { Plugin } from '@leafer/debug'\n\n\nexport const Creator: ICreator = {\n    editor(_options?: IObject): ILeaf {\n        return Plugin.need('editor')\n    }\n}","import { ILeaf, IObject } from '@leafer/interface'\nimport { isUndefined } from '@leafer/data'\nimport { Debug } from '@leafer/debug'\n\n\nconst debug = Debug.get('UICreator')\n\nexport const UICreator = {\n\n    list: {} as IObject,\n\n    register(UI: IObject): void {\n        const { __tag: tag } = UI.prototype as ILeaf\n        if (list[tag]) debug.repeat(tag)\n        list[tag] = UI\n    },\n\n    get(tag: string, data?: IObject, x?: number, y?: number, width?: number, height?: number): ILeaf {\n        if (!list[tag]) debug.error('not register ' + tag)\n        const ui = new list[tag](data)\n        if (!isUndefined(x)) {\n            ui.x = x\n            if (y) ui.y = y\n            if (width) ui.width = width\n            if (height) ui.height = height\n        }\n        return ui\n    }\n\n}\n\nconst { list } = UICreator","import { IEvent, IObject } from '@leafer/interface'\nimport { isString } from '@leafer/data'\nimport { Debug } from '@leafer/debug'\n\n\nconst debug = Debug.get('EventCreator')\n\nexport const EventCreator = {\n\n    nameList: {} as IObject,\n\n    register(Event: IObject): void {\n        let name: string\n        Object.keys(Event).forEach(key => {\n            name = Event[key]\n            if (isString(name)) nameList[name] && debug.repeat(name), nameList[name] = Event\n        })\n    },\n\n    changeName(oldName: string, newName: string): void {\n        const Event = nameList[oldName]\n        if (Event) {\n            const constName = Object.keys(Event).find(key => Event[key] === oldName)\n            if (constName) {\n                Event[constName] = newName\n                nameList[newName] = Event\n            }\n        }\n    },\n\n    has(type: string): boolean {\n        return !!this.nameList[type]\n    },\n\n    get(type: string, ...params: unknown[]): IEvent {\n        return new nameList[type](...params)\n    }\n\n}\n\nconst { nameList } = EventCreator","import { ILeaferCanvas, IScreenSizeData, ICanvasManager } from '@leafer/interface'\nimport { Creator } from '@leafer/platform'\n\nexport class CanvasManager implements ICanvasManager {\n\n    public list: ILeaferCanvas[] = []\n\n    public add(canvas: ILeaferCanvas): void {\n        canvas.manager = this\n        this.list.push(canvas)\n    }\n\n    public get(size: IScreenSizeData): ILeaferCanvas {\n        let old: ILeaferCanvas\n        const { list } = this\n        for (let i = 0, len = list.length; i < len; i++) {\n            old = list[i]\n            if (old.recycled && old.isSameSize(size)) {\n                old.recycled = false\n                old.manager || (old.manager = this)\n                return old\n            }\n        }\n\n        const canvas = Creator.canvas(size)\n        this.add(canvas)\n        return canvas\n    }\n\n    public recycle(old: ILeaferCanvas): void {\n        old.recycled = true\n    }\n\n    public clearRecycled(): void {\n        let canvas: ILeaferCanvas\n        const filter: ILeaferCanvas[] = []\n        for (let i = 0, len = this.list.length; i < len; i++) {\n            canvas = this.list[i]\n            canvas.recycled ? canvas.destroy() : filter.push(canvas)\n        }\n        this.list = filter\n    }\n\n    public clear(): void {\n        this.list.forEach(item => { item.destroy() })\n        this.list.length = 0\n    }\n\n    public destroy(): void {\n        this.clear()\n    }\n\n}","/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\r\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\r\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\r\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\r\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\r\n    var _, done = false;\r\n    for (var i = decorators.length - 1; i >= 0; i--) {\r\n        var context = {};\r\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\r\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\r\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\r\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\r\n        if (kind === \"accessor\") {\r\n            if (result === void 0) continue;\r\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\r\n            if (_ = accept(result.get)) descriptor.get = _;\r\n            if (_ = accept(result.set)) descriptor.set = _;\r\n            if (_ = accept(result.init)) initializers.unshift(_);\r\n        }\r\n        else if (_ = accept(result)) {\r\n            if (kind === \"field\") initializers.unshift(_);\r\n            else descriptor[key] = _;\r\n        }\r\n    }\r\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\r\n    done = true;\r\n};\r\n\r\nexport function __runInitializers(thisArg, initializers, value) {\r\n    var useValue = arguments.length > 2;\r\n    for (var i = 0; i < initializers.length; i++) {\r\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\r\n    }\r\n    return useValue ? value : void 0;\r\n};\r\n\r\nexport function __propKey(x) {\r\n    return typeof x === \"symbol\" ? x : \"\".concat(x);\r\n};\r\n\r\nexport function __setFunctionName(f, name, prefix) {\r\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\r\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\r\n};\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\r\n    return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\r\n    function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nvar ownKeys = function(o) {\r\n    ownKeys = Object.getOwnPropertyNames || function (o) {\r\n        var ar = [];\r\n        for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\r\n        return ar;\r\n    };\r\n    return ownKeys(o);\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n\r\nexport function __addDisposableResource(env, value, async) {\r\n    if (value !== null && value !== void 0) {\r\n        if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\r\n        var dispose, inner;\r\n        if (async) {\r\n            if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\r\n            dispose = value[Symbol.asyncDispose];\r\n        }\r\n        if (dispose === void 0) {\r\n            if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\r\n            dispose = value[Symbol.dispose];\r\n            if (async) inner = dispose;\r\n        }\r\n        if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\r\n        if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\r\n        env.stack.push({ value: value, dispose: dispose, async: async });\r\n    }\r\n    else if (async) {\r\n        env.stack.push({ async: true });\r\n    }\r\n    return value;\r\n\r\n}\r\n\r\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\r\n\r\nexport function __disposeResources(env) {\r\n    function fail(e) {\r\n        env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\r\n        env.hasError = true;\r\n    }\r\n    var r, s = 0;\r\n    function next() {\r\n        while (r = env.stack.pop()) {\r\n            try {\r\n                if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\r\n                if (r.dispose) {\r\n                    var result = r.dispose.call(r.value);\r\n                    if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\r\n                }\r\n                else s |= 1;\r\n            }\r\n            catch (e) {\r\n                fail(e);\r\n            }\r\n        }\r\n        if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\r\n        if (env.hasError) throw env.error;\r\n    }\r\n    return next();\r\n}\r\n\r\nexport function __rewriteRelativeImportExtension(path, preserveJsx) {\r\n    if (typeof path === \"string\" && /^\\.\\.?\\//.test(path)) {\r\n        return path.replace(/\\.(tsx)$|((?:\\.d)?)((?:\\.[^./]+?)?)\\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {\r\n            return tsx ? preserveJsx ? \".jsx\" : \".js\" : d && (!ext || !cm) ? m : (d + ext + \".\" + cm.toLowerCase() + \"js\");\r\n        });\r\n    }\r\n    return path;\r\n}\r\n\r\nexport default {\r\n    __extends: __extends,\r\n    __assign: __assign,\r\n    __rest: __rest,\r\n    __decorate: __decorate,\r\n    __param: __param,\r\n    __esDecorate: __esDecorate,\r\n    __runInitializers: __runInitializers,\r\n    __propKey: __propKey,\r\n    __setFunctionName: __setFunctionName,\r\n    __metadata: __metadata,\r\n    __awaiter: __awaiter,\r\n    __generator: __generator,\r\n    __createBinding: __createBinding,\r\n    __exportStar: __exportStar,\r\n    __values: __values,\r\n    __read: __read,\r\n    __spread: __spread,\r\n    __spreadArrays: __spreadArrays,\r\n    __spreadArray: __spreadArray,\r\n    __await: __await,\r\n    __asyncGenerator: __asyncGenerator,\r\n    __asyncDelegator: __asyncDelegator,\r\n    __asyncValues: __asyncValues,\r\n    __makeTemplateObject: __makeTemplateObject,\r\n    __importStar: __importStar,\r\n    __importDefault: __importDefault,\r\n    __classPrivateFieldGet: __classPrivateFieldGet,\r\n    __classPrivateFieldSet: __classPrivateFieldSet,\r\n    __classPrivateFieldIn: __classPrivateFieldIn,\r\n    __addDisposableResource: __addDisposableResource,\r\n    __disposeResources: __disposeResources,\r\n    __rewriteRelativeImportExtension: __rewriteRelativeImportExtension,\r\n};\r\n","import { ICanvasAttr, ITextMetrics, ICanvasContext2D, IPath2D, IObject, InnerId, IMatrixData, IFunction, IWindingRule, IBlendMode } from '@leafer/interface'\nimport { isObject } from '@leafer/data'\n\n\nfunction contextAttr(realName?: string) {\n    return (target: Canvas, key: string) => {\n        if (!realName) realName = key\n        const property = {\n            get() { return ((this as unknown as Canvas).context as IObject)[realName] },\n            set(value: unknown) { ((this as unknown as Canvas).context as IObject)[realName] = value }\n        }\n        if (key === 'strokeCap') (property as any).set = function (value: unknown) { ((this as unknown as Canvas).context as IObject)[realName] = value === 'none' ? 'butt' : value }\n        Object.defineProperty(target, key, property)\n    }\n}\n\nconst contextMethodNameList: string[] = []\nfunction contextMethod() {\n    return (_target: Canvas, key: string) => {\n        contextMethodNameList.push(key)\n    }\n}\n\nconst emptyArray: number[] = []\n\n\nexport class Canvas implements ICanvasAttr {\n\n    public readonly innerId: InnerId\n\n    public context: ICanvasContext2D\n\n    // canvas attr\n\n    @contextAttr('imageSmoothingEnabled')\n    public smooth: boolean\n\n    @contextAttr('imageSmoothingQuality')\n    public smoothLevel: ImageSmoothingQuality\n\n    @contextAttr('globalAlpha')\n    public opacity: number\n\n    public set blendMode(value: IBlendMode) {\n        if (value === 'normal') value = 'source-over'\n        this.context.globalCompositeOperation = value as any\n    }\n\n    public get blendMode(): IBlendMode {\n        return this.context.globalCompositeOperation as IBlendMode\n    }\n\n    @contextAttr()\n    public fillStyle: string | object\n\n    @contextAttr()\n    public strokeStyle: string | object\n\n\n    @contextAttr('lineWidth')\n    public strokeWidth: number\n\n    @contextAttr('lineCap')\n    public strokeCap: string\n\n    @contextAttr('lineJoin')\n    public strokeJoin: string\n\n    public set dashPattern(value: number[]) {\n        this.context.setLineDash(value || emptyArray)\n    }\n    public get dashPattern(): number[] {\n        return this.context.getLineDash()\n    }\n\n    @contextAttr('lineDashOffset')\n    public dashOffset: number\n\n    @contextAttr()\n    public miterLimit: number\n\n\n    @contextAttr()\n    public shadowBlur: number\n\n    @contextAttr()\n    public shadowColor: string\n\n    @contextAttr()\n    public shadowOffsetX: number\n\n    @contextAttr()\n    public shadowOffsetY: number\n\n    @contextAttr()\n    public filter: string\n\n\n    @contextAttr()\n    public font: string\n\n    @contextAttr()\n    public fontKerning: string\n\n    @contextAttr()\n    public fontStretch: string\n\n    @contextAttr()\n    public fontVariantCaps: string\n\n\n    @contextAttr()\n    public textAlign: string\n\n    @contextAttr()\n    public textBaseline: string\n\n    @contextAttr()\n    public textRendering: string\n\n    @contextAttr()\n    public wordSpacing: string\n\n    @contextAttr()\n    public letterSpacing: string\n\n\n    @contextAttr()\n    public direction: string\n\n    // end\n\n    public __bindContext(): void {\n        let method: IFunction\n        contextMethodNameList.forEach(name => {\n            method = (this.context as IObject)[name]\n            if (method) (this as IObject)[name] = method.bind(this.context)\n        })\n        this.textBaseline = \"alphabetic\"\n    }\n\n    // canvas method\n\n    @contextMethod()\n    public setTransform(_a: number | IMatrixData, _b?: number, _c?: number, _d?: number, _e?: number, _f?: number): void { }\n\n    @contextMethod()\n    public resetTransform(): void { }\n\n    @contextMethod()\n    public getTransform(): IMatrixData { return void 0 }\n\n    @contextMethod()\n    public save(): void { }\n\n    @contextMethod()\n    public restore(): void { }\n\n    public transform(a: number | IMatrixData, b?: number, c?: number, d?: number, e?: number, f?: number): void {\n        if (isObject(a)) {\n            this.context.transform(a.a, a.b, a.c, a.d, a.e, a.f)\n        } else {\n            this.context.transform(a, b, c, d, e, f)\n        }\n    }\n\n    @contextMethod()\n    public translate(_x: number, _y: number): void { }\n\n    @contextMethod()\n    public scale(_x: number, _y: number): void { }\n\n    @contextMethod()\n    public rotate(_angle: number): void { }\n\n    @contextMethod()\n    public fill(_path2d?: IPath2D | IWindingRule, _rule?: IWindingRule): void { }\n\n    @contextMethod()\n    public stroke(_path2d?: IPath2D): void { }\n\n    @contextMethod()\n    public clip(_path2d?: IPath2D | IWindingRule, _rule?: IWindingRule): void { }\n\n    @contextMethod()\n    public fillRect(_x: number, _y: number, _width: number, _height: number): void { }\n\n    @contextMethod()\n    public strokeRect(_x: number, _y: number, _width: number, _height: number): void { }\n\n    @contextMethod()\n    public clearRect(_x: number, _y: number, _width: number, _height: number): void { }\n\n    public drawImage(image: CanvasImageSource, sx: number, sy: number, sw?: number, sh?: number, dx?: number, dy?: number, dw?: number, dh?: number): void {\n        switch (arguments.length) {\n            case 9:\n\n                // safari: drawimage裁剪画布外的坐标会有问题, 必须是不小于0的坐标点\n                if (sx < 0) {\n                    const d = (-sx / sw) * dw\n                    sw += sx\n                    sx = 0\n                    dx += d\n                    dw -= d\n                }\n\n                if (sy < 0) {\n                    const d = (-sy / sh) * dh\n                    sh += sy\n                    sy = 0\n                    dy += d\n                    dh -= d\n                }\n\n                this.context.drawImage(image, sx, sy, sw, sh, dx, dy, dw, dh)\n                break\n            case 5:\n                this.context.drawImage(image, sx, sy, sw, sh) // = dx, dy, dw, dh\n                break\n            case 3:\n                this.context.drawImage(image, sx, sy)\n        }\n    }\n\n\n    // canvas draw\n    @contextMethod()\n    public beginPath(): void { }\n\n    @contextMethod()\n    public moveTo(_x: number, _y: number): void { }\n\n    @contextMethod()\n    public lineTo(_x: number, _y: number): void { }\n\n    @contextMethod()\n    public bezierCurveTo(_cp1x: number, _cp1y: number, _cp2x: number, _cp2y: number, _x: number, _y: number): void { }\n\n    @contextMethod()\n    public quadraticCurveTo(_cpx: number, _cpy: number, _x: number, _y: number): void { }\n\n    @contextMethod()\n    public closePath(): void { }\n\n    @contextMethod()\n    public arc(_x: number, _y: number, _radius: number, _startAngle: number, _endAngle: number, _anticlockwise?: boolean): void { }\n\n    @contextMethod()\n    public arcTo(_x1: number, _y1: number, _x2: number, _y2: number, _radius: number): void { }\n\n    @contextMethod()\n    public ellipse(_x: number, _y: number, _radiusX: number, _radiusY: number, _rotation: number, _startAngle: number, _endAngle: number, _anticlockwise?: boolean): void { }\n\n    @contextMethod()\n    public rect(_x: number, _y: number, _width: number, _height: number): void { }\n\n    @contextMethod()\n    public roundRect(_x: number, _y: number, _width: number, _height: number, _radius?: number | number[]): void { }\n\n    // end canvas draw\n\n    // paint\n\n    @contextMethod()\n    public createConicGradient(_startAngle: number, _x: number, _y: number): CanvasGradient { return void 0 }\n\n    @contextMethod()\n    public createLinearGradient(_x0: number, _y0: number, _x1: number, _y1: number): CanvasGradient { return void 0 }\n\n    @contextMethod()\n    public createPattern(_image: CanvasImageSource, _repetition: string | null): CanvasPattern | null { return void 0 }\n\n    @contextMethod()\n    public createRadialGradient(_x0: number, _y0: number, _r0: number, _x1: number, _y1: number, _r1: number): CanvasGradient { return void 0 }\n\n    // text\n    @contextMethod()\n    public fillText(_text: string, _x: number, _y: number, _maxWidth?: number): void { }\n\n    @contextMethod()\n    public measureText(_text: string): ITextMetrics { return void 0 }\n\n    @contextMethod()\n    public strokeText(_text: string, _x: number, _y: number, _maxWidth?: number): void { }\n\n    public destroy(): void {\n        this.context = null\n    }\n}","import { IBounds, ILeaferCanvas, ICanvasStrokeOptions, ILeaferCanvasConfig, IWindingRuleData, IExportOptions, IMatrixData, IBoundsData, IAutoBounds, IScreenSizeData, IResizeEventListener, IMatrixWithBoundsData, IPointData, InnerId, ICanvasManager, IWindingRule, IBlendMode, IExportImageType, IExportFileType, IBlob, ICursorType, ILeaferCanvasView, IRadiusPointData, IObject, IMatrixWithOptionHalfData } from '@leafer/interface'\nimport { Bounds, BoundsHelper, MatrixHelper, IncrementId } from '@leafer/math'\nimport { Creator, Platform } from '@leafer/platform'\nimport { DataHelper, isUndefined } from '@leafer/data'\n\nimport { Canvas } from './Canvas'\n\n\nconst { copy, multiplyParent, pixelScale } = MatrixHelper, { round } = Math, tempPixelBounds = new Bounds(), tempPixelBounds2 = new Bounds()\nconst minSize: IScreenSizeData = { width: 1, height: 1, pixelRatio: 1 }\n\nexport const canvasSizeAttrs = ['width', 'height', 'pixelRatio']\n\nexport class LeaferCanvasBase extends Canvas implements ILeaferCanvas {\n\n    declare public readonly innerId: InnerId\n\n    public name: string\n\n    public manager: ICanvasManager\n\n    public size: IScreenSizeData = {} as IScreenSizeData\n\n    public get width(): number { return this.size.width }\n    public get height(): number { return this.size.height }\n\n    public get pixelRatio(): number { return this.size.pixelRatio }\n    public get pixelWidth(): number { return this.width * this.pixelRatio || 0 } // 防止出现 NaN\n    public get pixelHeight(): number { return this.height * this.pixelRatio || 0 }\n\n    public get pixelSnap(): boolean { return this.config.pixelSnap }\n    public set pixelSnap(value: boolean) { this.config.pixelSnap = value }\n\n    public get allowBackgroundColor(): boolean { return this.view && this.parentView }\n\n    public bounds: IBounds\n    public clientBounds: IBoundsData\n\n    public config: ILeaferCanvasConfig\n\n    public autoLayout: boolean\n\n    public view: ILeaferCanvasView\n    public parentView: any\n\n    public unreal?: boolean\n\n    public recycled?: boolean\n\n    public worldTransform: IMatrixData = {} as IMatrixData\n\n    protected savedBlendMode: IBlendMode\n\n    constructor(config?: ILeaferCanvasConfig, manager?: ICanvasManager) {\n        super()\n        if (!config) config = minSize\n\n        this.manager = manager\n        this.innerId = IncrementId.create(IncrementId.CNAVAS)\n\n        const { width, height, pixelRatio } = config\n        this.autoLayout = !width || !height\n\n        this.size.pixelRatio = pixelRatio || Platform.devicePixelRatio\n        this.config = config\n\n        this.init()\n    }\n\n    public init(): void { }\n\n    public __createContext(): void {\n        const { view } = this\n        const { contextSettings } = this.config\n        this.context = contextSettings ? view.getContext('2d', contextSettings) : view.getContext('2d')\n        this.__bindContext()\n    }\n\n    // @leafer-in/export rewrite\n\n    public export(_filename: IExportFileType | string, _options?: IExportOptions | number | boolean): string | Promise<any> { return undefined }\n\n    public toBlob(_type?: IExportFileType, _quality?: number): Promise<IBlob> { return undefined }\n\n    public toDataURL(_type?: IExportImageType, _quality?: number): string | Promise<string> { return undefined }\n\n    public saveAs(_filename: string, _quality?: number): Promise<boolean> { return undefined }\n\n    // ---\n\n    public resize(size: IScreenSizeData, safeResize = true): void {\n        if (this.isSameSize(size)) return\n\n        let takeCanvas: ILeaferCanvas\n        if (this.context && !this.unreal && safeResize && this.width) {\n            takeCanvas = this.getSameCanvas()\n            takeCanvas.copyWorld(this)\n        }\n\n        const s = this.size as IObject\n        DataHelper.copyAttrs(s, size, canvasSizeAttrs)\n        canvasSizeAttrs.forEach(key => s[key] || (s[key] = 1)) // fix: width = 0 or height = 0\n\n        this.bounds = new Bounds(0, 0, this.width, this.height)\n\n        this.updateViewSize()\n        this.updateClientBounds()\n\n        if (this.context) {\n\n            this.smooth = this.config.smooth\n\n            if (!this.unreal && takeCanvas) {\n                this.clearWorld(takeCanvas.bounds)\n                this.copyWorld(takeCanvas)\n                takeCanvas.recycle()\n            }\n\n        }\n\n    }\n\n    public updateViewSize(): void { }\n    public updateClientBounds(): void { }\n    public getClientBounds(update?: boolean): IBoundsData {\n        if (update) this.updateClientBounds()\n        return this.clientBounds || this.bounds\n    }\n\n    public startAutoLayout(_autoBounds: IAutoBounds, _listener: IResizeEventListener): void { }\n    public stopAutoLayout(): void { }\n\n    public setCursor(_cursor: ICursorType | ICursorType[]): void { }\n\n    public setWorld(matrix: IMatrixWithOptionHalfData, parentMatrix?: IMatrixData): void {\n        const { pixelRatio, pixelSnap } = this, w = this.worldTransform\n\n        if (parentMatrix) multiplyParent(matrix, parentMatrix, w)\n        pixelScale(matrix, pixelRatio, w)\n\n        if (pixelSnap && !matrix.ignorePixelSnap) {\n            if (matrix.half && (matrix.half * pixelRatio) % 2) w.e = round(w.e - 0.5) + 0.5, w.f = round(w.f - 0.5) + 0.5\n            else w.e = round(w.e), w.f = round(w.f)\n        }\n\n        this.setTransform(w.a, w.b, w.c, w.d, w.e, w.f)\n    }\n\n    public useWorldTransform(worldTransform?: IMatrixData): void {\n        if (worldTransform) this.worldTransform = worldTransform\n        const w = this.worldTransform\n        if (w) this.setTransform(w.a, w.b, w.c, w.d, w.e, w.f)\n    }\n\n    public setStroke(color: string | object, strokeWidth: number, options?: ICanvasStrokeOptions, childOptions?: ICanvasStrokeOptions): void {\n        if (strokeWidth) this.strokeWidth = strokeWidth\n        if (color) this.strokeStyle = color\n        if (options) this.setStrokeOptions(options, childOptions)\n    }\n\n    public setStrokeOptions(options: ICanvasStrokeOptions, childOptions?: ICanvasStrokeOptions): void {\n        let { strokeCap, strokeJoin, dashPattern, dashOffset, miterLimit } = options\n        if (childOptions) {\n            if (childOptions.strokeCap) strokeCap = childOptions.strokeCap\n            if (childOptions.strokeJoin) strokeJoin = childOptions.strokeJoin\n            if (!isUndefined(childOptions.dashPattern)) dashPattern = childOptions.dashPattern\n            if (!isUndefined(childOptions.dashOffset)) dashOffset = childOptions.dashOffset\n            if (childOptions.miterLimit) miterLimit = childOptions.miterLimit\n        }\n        this.strokeCap = strokeCap\n        this.strokeJoin = strokeJoin\n        this.dashPattern = dashPattern\n        this.dashOffset = dashOffset\n        this.miterLimit = miterLimit\n    }\n\n    public saveBlendMode(blendMode: IBlendMode): void {\n        this.savedBlendMode = this.blendMode\n        this.blendMode = blendMode\n    }\n\n    public restoreBlendMode(): void {\n        this.blendMode = this.savedBlendMode\n    }\n\n    // @leafer-ui/interaction rewrite\n\n    public hitFill(_point: IPointData, _fillRule?: IWindingRule): boolean { return true }\n\n    public hitStroke(_point: IPointData, _strokeWidth?: number): boolean { return true }\n\n    public hitPixel(_radiusPoint: IRadiusPointData, _offset?: IPointData, _scale = 1): boolean { return true }\n\n    // ---\n\n    public setWorldShadow(x: number, y: number, blur: number, color?: string): void {\n        const { pixelRatio } = this\n        this.shadowOffsetX = x * pixelRatio\n        this.shadowOffsetY = y * pixelRatio\n        this.shadowBlur = blur * pixelRatio\n        this.shadowColor = color || 'black'\n    }\n\n    public setWorldBlur(blur: number): void {\n        const { pixelRatio } = this\n        this.filter = `blur(${blur * pixelRatio}px)`\n    }\n\n\n    public copyWorld(canvas: ILeaferCanvas, from?: IBoundsData, to?: IBoundsData, blendMode?: IBlendMode, ceilPixel?: boolean): void {\n        if (blendMode) this.blendMode = blendMode\n        if (from) {\n            this.setTempPixelBounds(from, ceilPixel)\n            if (!to) to = tempPixelBounds // to = from\n            else this.setTempPixelBounds2(to, ceilPixel), to = tempPixelBounds2\n\n            this.drawImage(canvas.view as HTMLCanvasElement, tempPixelBounds.x, tempPixelBounds.y, tempPixelBounds.width, tempPixelBounds.height, to.x, to.y, to.width, to.height)\n        } else {\n            this.drawImage(canvas.view as HTMLCanvasElement, 0, 0)\n        }\n        if (blendMode) this.blendMode = 'source-over'\n    }\n\n    public copyWorldToInner(canvas: ILeaferCanvas, fromWorld: IMatrixWithBoundsData, toInnerBounds: IBoundsData, blendMode?: IBlendMode, ceilPixel?: boolean): void {\n        if (fromWorld.b || fromWorld.c) {\n            this.save()\n            this.resetTransform()\n            this.copyWorld(canvas, fromWorld, BoundsHelper.tempToOuterOf(toInnerBounds, fromWorld), blendMode, ceilPixel)\n            this.restore()\n        } else {\n            if (blendMode) this.blendMode = blendMode\n            this.setTempPixelBounds(fromWorld, ceilPixel)\n            this.drawImage(canvas.view as HTMLCanvasElement, tempPixelBounds.x, tempPixelBounds.y, tempPixelBounds.width, tempPixelBounds.height, toInnerBounds.x, toInnerBounds.y, toInnerBounds.width, toInnerBounds.height)\n            if (blendMode) this.blendMode = 'source-over'\n        }\n    }\n\n    public copyWorldByReset(canvas: ILeaferCanvas, from?: IBoundsData, to?: IBoundsData, blendMode?: IBlendMode, onlyResetTransform?: boolean, ceilPixel?: boolean): void {\n        this.resetTransform()\n        this.copyWorld(canvas, from, to, blendMode, ceilPixel)\n        if (!onlyResetTransform) this.useWorldTransform() // restore world transform\n    }\n\n    public useGrayscaleAlpha(bounds: IBoundsData): void { // 先实现功能，后期需通过 shader 优化性能\n        this.setTempPixelBounds(bounds, true, true)\n\n        let alpha: number, pixel: number\n        const { context } = this, imageData = context.getImageData(tempPixelBounds.x, tempPixelBounds.y, tempPixelBounds.width, tempPixelBounds.height), { data } = imageData\n\n        for (let i = 0, len = data.length; i < len; i += 4) {\n            pixel = data[i] * 0.299 + data[i + 1] * 0.587 + data[i + 2] * 0.114\n            if (alpha = data[i + 3]) data[i + 3] = alpha === 255 ? pixel : alpha * (pixel / 255)\n        }\n\n        context.putImageData(imageData, tempPixelBounds.x, tempPixelBounds.y)\n    }\n\n    public useMask(maskCanvas: ILeaferCanvas, fromBounds?: IBoundsData, toBounds?: IBoundsData): void {\n        this.copyWorld(maskCanvas, fromBounds, toBounds, 'destination-in')\n    }\n\n    public useEraser(eraserCanvas: ILeaferCanvas, fromBounds?: IBoundsData, toBounds?: IBoundsData): void {\n        this.copyWorld(eraserCanvas, fromBounds, toBounds, 'destination-out')\n    }\n\n    public fillWorld(bounds: IBoundsData, color: string | object, blendMode?: IBlendMode, ceilPixel?: boolean): void {\n        if (blendMode) this.blendMode = blendMode\n        this.fillStyle = color\n        this.setTempPixelBounds(bounds, ceilPixel)\n        this.fillRect(tempPixelBounds.x, tempPixelBounds.y, tempPixelBounds.width, tempPixelBounds.height)\n        if (blendMode) this.blendMode = 'source-over'\n    }\n\n    public strokeWorld(bounds: IBoundsData, color: string | object, blendMode?: IBlendMode, ceilPixel?: boolean): void {\n        if (blendMode) this.blendMode = blendMode\n        this.strokeStyle = color\n        this.setTempPixelBounds(bounds, ceilPixel)\n        this.strokeRect(tempPixelBounds.x, tempPixelBounds.y, tempPixelBounds.width, tempPixelBounds.height)\n        if (blendMode) this.blendMode = 'source-over'\n    }\n\n    public clipWorld(bounds: IBoundsData, ceilPixel: boolean = true): void {\n        this.beginPath()\n        this.setTempPixelBounds(bounds, ceilPixel)\n        this.rect(tempPixelBounds.x, tempPixelBounds.y, tempPixelBounds.width, tempPixelBounds.height)\n        this.clip()\n\n    }\n\n    public clipUI(ruleData: IWindingRuleData): void {\n        ruleData.windingRule ? this.clip(ruleData.windingRule) : this.clip()\n    }\n\n    public clearWorld(bounds: IBoundsData, ceilPixel: boolean = true): void {\n        this.setTempPixelBounds(bounds, ceilPixel)\n        this.clearRect(tempPixelBounds.x, tempPixelBounds.y, tempPixelBounds.width, tempPixelBounds.height)\n    }\n\n    public clear(): void {\n        const { pixelRatio } = this\n        this.clearRect(0, 0, this.width * pixelRatio + 2, this.height * pixelRatio + 2)\n    }\n\n\n    // other\n\n    protected setTempPixelBounds(bounds: IBoundsData, ceil?: boolean, intersect?: boolean): void {\n        this.copyToPixelBounds(tempPixelBounds, bounds, ceil, intersect)\n    }\n\n    protected setTempPixelBounds2(bounds: IBoundsData, ceil?: boolean, intersect?: boolean): void {\n        this.copyToPixelBounds(tempPixelBounds2, bounds, ceil, intersect)\n    }\n\n    protected copyToPixelBounds(pixelBounds: IBounds, bounds: IBoundsData, ceil?: boolean, intersect?: boolean): void {\n        pixelBounds.set(bounds)\n        if (intersect) pixelBounds.intersect(this.bounds)\n        pixelBounds.scale(this.pixelRatio)\n        if (ceil) pixelBounds.ceil()\n    }\n\n    public isSameSize(size: IScreenSizeData): boolean {\n        return this.width === size.width && this.height === size.height && (!size.pixelRatio || this.pixelRatio === size.pixelRatio)\n    }\n\n    // 需要有 manager变量\n    public getSameCanvas(useSameWorldTransform?: boolean, useSameSmooth?: boolean): ILeaferCanvas {\n        const { size, pixelSnap } = this, canvas = this.manager ? this.manager.get(size) : Creator.canvas({ ...size })\n        canvas.save()\n\n        if (useSameWorldTransform) copy(canvas.worldTransform, this.worldTransform), canvas.useWorldTransform()\n        if (useSameSmooth) canvas.smooth = this.smooth\n        canvas.pixelSnap !== pixelSnap && (canvas.pixelSnap = pixelSnap)\n\n        return canvas\n    }\n\n    public recycle(clearBounds?: IBoundsData): void {\n        if (!this.recycled) {\n            this.restore()\n            clearBounds ? this.clearWorld(clearBounds) : this.clear()\n            this.manager ? this.manager.recycle(this) : this.destroy()\n        }\n    }\n\n    public updateRender(_bounds?: IBoundsData): void { }\n\n    public unrealCanvas(): void { }\n\n    public destroy(): void {\n        this.manager = this.view = this.parentView = null\n    }\n}","import { IPathCommandData, IPathCreator } from '@leafer/interface'\n\nexport const PathHelper = {\n    // index.ts rewrite\n    creator: {} as IPathCreator,\n    parse(_pathString: string, _curveMode?: boolean): IPathCommandData { return undefined },\n    convertToCanvasData(_old: IPathCommandData, _curveMode?: boolean): IPathCommandData { return undefined }\n}","import { INumberMap, IStringMap } from '@leafer/interface'\n\nexport const CanvasCommandOnlyMap: INumberMap = {\n\n    N: 21, // rect\n    D: 22, // roundRect\n    X: 23, // simple roundRect\n    G: 24, // ellipse\n    F: 25, // simple ellipse\n    O: 26, // arc\n    P: 27, // simple arc\n    U: 28 // arcTo\n\n}\n\nexport const PathCommandMap: INumberMap = {\n\n    // svg and canvas\n\n    M: 1, // moveto\n    m: 10,\n    L: 2, // lineto\n    l: 20,\n    H: 3, // horizontal lineto\n    h: 30,\n    V: 4, // vertical lineto\n    v: 40,\n    C: 5, // curveto\n    c: 50,\n    S: 6, // smooth curveto\n    s: 60,\n    Q: 7, // quadratic Belzier curve\n    q: 70,\n    T: 8, // smooth quadratic Belzier curveto\n    t: 80,\n    A: 9, //e lliptical Arc\n    a: 90,\n    Z: 11, // closepath\n    z: 11,\n\n    R: 12,  // Catmull Rom\n\n    // canvas\n    ...CanvasCommandOnlyMap\n}\n\nexport const PathCommandLengthMap: INumberMap = {\n\n    M: 3, //moveto\n    m: 3,\n    L: 3, //lineto\n    l: 3,\n    H: 2, //horizontal lineto\n    h: 2,\n    V: 2, //vertical lineto\n    v: 2,\n    C: 7, //curveto\n    c: 7,\n    S: 5, //smooth curveto\n    s: 5,\n    Q: 5, //quadratic Belzier curve\n    q: 5,\n    T: 3, //smooth quadratic Belzier curveto\n    t: 3,\n    A: 8, //elliptical Arc\n    a: 8,\n    Z: 1, //closepath\n    z: 1,\n\n    // canvas\n\n    N: 5, // rect\n    D: 9, // roundRect\n    X: 6, // simple roundRect\n    G: 9, // ellipse\n    F: 5, // simple ellipse\n    O: 7, // arc\n    P: 4, // simple arc\n    U: 6 // arcTo\n\n}\n\nexport const NeedConvertToCanvasCommandMap: INumberMap = { // convert to:  M L C Q Z\n\n    // M: 1, //moveto\n    m: 10,\n    // L: 2, //lineto\n    l: 20,\n    H: 3, //horizontal lineto\n    h: 30,\n    V: 4, //vertical lineto\n    v: 40,\n    // C: 5, //curveto\n    c: 50,\n    S: 6, //smooth curveto\n    s: 60,\n    // Q: 7, //quadratic Belzier curve\n    q: 70,\n    T: 8, //smooth quadratic Belzier curveto\n    t: 80,\n    A: 9, //elliptical Arc\n    a: 90,\n    // Z: 11, //closepath\n    // z: 11\n\n}\n\n\nexport const NeedConvertToCurveCommandMap: INumberMap = {\n    ...NeedConvertToCanvasCommandMap,\n    ...CanvasCommandOnlyMap\n}\n\nconst P = PathCommandMap\n\nexport const PathNumberCommandMap: IStringMap = {}\nfor (let key in P) {\n    PathNumberCommandMap[P[key]] = key\n}\n// {1: 'M'}\n\nexport const PathNumberCommandLengthMap: INumberMap = {}\nfor (let key in P) {\n    PathNumberCommandLengthMap[P[key]] = PathCommandLengthMap[key]\n}\n// {1: 3}","import { IPathDrawer } from '@leafer/interface'\nimport { MathHelper } from '@leafer/math'\n\nexport const RectHelper = {\n\n    drawRoundRect(drawer: IPathDrawer, x: number, y: number, width: number, height: number, cornerRadius: number | number[]): void {\n        const data = MathHelper.fourNumber(cornerRadius, Math.min(width / 2, height / 2))\n\n        const right = x + width\n        const bottom = y + height\n\n        data[0] ? drawer.moveTo(x + data[0], y) : drawer.moveTo(x, y)\n        data[1] ? drawer.arcTo(right, y, right, bottom, data[1]) : drawer.lineTo(right, y)\n        data[2] ? drawer.arcTo(right, bottom, x, bottom, data[2]) : drawer.lineTo(right, bottom)\n        data[3] ? drawer.arcTo(x, bottom, x, y, data[3]) : drawer.lineTo(x, bottom)\n        data[0] ? drawer.arcTo(x, y, right, y, data[0]) : drawer.lineTo(x, y)\n    }\n\n}","import { IPointData, ITwoPointBoundsData, IPathCommandData } from '@leafer/interface'\nimport { OneRadian, PI2, PI_2, PointHelper, TwoPointBoundsHelper } from '@leafer/math'\n\nimport { PathCommandMap } from './PathCommandMap'\nimport { RectHelper } from './RectHelper'\nimport { PathHelper } from './PathHelper'\n\n\nconst { sin, cos, hypot, atan2, ceil, abs, PI, sqrt, pow } = Math\nconst { setPoint, addPoint } = TwoPointBoundsHelper\nconst { set, toNumberPoints } = PointHelper\nconst { M, L, C, Q, Z } = PathCommandMap\nconst tempPoint = {} as IPointData\n\nexport const BezierHelper = {\n\n    points(data: IPathCommandData, originPoints: number[] | IPointData[], curve?: boolean | number, close?: boolean): void {\n\n        let points = toNumberPoints(originPoints)\n\n        data.push(M, points[0], points[1])\n\n        if (curve && points.length > 5) {\n\n            let aX: number, aY: number, bX: number, bY: number, cX: number, cY: number, c1X: number, c1Y: number, c2X: number, c2Y: number\n            let baX: number, baY: number, ba: number, cb: number, d: number, len = points.length\n            const t = curve === true ? 0.5 : curve as number\n\n            if (close) {\n                points = [points[len - 2], points[len - 1], ...points, points[0], points[1], points[2], points[3]]\n                len = points.length\n            }\n\n            for (let i = 2; i < len - 2; i += 2) {\n                aX = points[i - 2]\n                aY = points[i - 1]\n\n                bX = points[i]\n                bY = points[i + 1]\n\n                cX = points[i + 2]\n                cY = points[i + 3]\n\n                baX = bX - aX\n                baY = bY - aY\n\n                ba = sqrt(pow(baX, 2) + pow(baY, 2))\n                cb = sqrt(pow(cX - bX, 2) + pow(cY - bY, 2))\n\n                if (!ba && !cb) continue\n\n                d = ba + cb\n                ba = (t * ba) / d\n                cb = (t * cb) / d\n\n                cX -= aX\n                cY -= aY\n\n                c1X = bX - ba * cX\n                c1Y = bY - ba * cY\n\n                if (i === 2) {\n                    if (!close) data.push(Q, c1X, c1Y, bX, bY)\n                } else {\n                    if (baX || baY) data.push(C, c2X, c2Y, c1X, c1Y, bX, bY) // 当前点与上一个点距离为0时，需要过滤\n                }\n\n                c2X = bX + cb * cX\n                c2Y = bY + cb * cY\n            }\n\n            if (!close) data.push(Q, c2X, c2Y, points[len - 2], points[len - 1])\n\n        } else {\n\n            for (let i = 2, len = points.length; i < len; i += 2) {\n                data.push(L, points[i], points[i + 1])\n            }\n\n        }\n\n        if (close) data.push(Z)\n    },\n\n    rect(data: IPathCommandData, x: number, y: number, width: number, height: number) {\n        PathHelper.creator.path = data\n        PathHelper.creator.moveTo(x, y).lineTo(x + width, y).lineTo(x + width, y + height).lineTo(x, y + height).lineTo(x, y)\n    },\n\n    roundRect(data: IPathCommandData, x: number, y: number, width: number, height: number, radius: number | number[]): void {\n        PathHelper.creator.path = []\n        RectHelper.drawRoundRect(PathHelper.creator, x, y, width, height, radius)\n        data.push(...PathHelper.convertToCanvasData(PathHelper.creator.path, true))\n    },\n\n    arcTo(data: IPathCommandData | null | void, fromX: number, fromY: number, x1: number, y1: number, toX: number, toY: number, radius: number, setPointBounds?: ITwoPointBoundsData, setEndPoint?: IPointData, setStartPoint?: IPointData): void {\n        const BAx = x1 - fromX\n        const BAy = y1 - fromY\n        const CBx = toX - x1\n        const CBy = toY - y1\n\n        let startRadian = atan2(BAy, BAx)\n        let endRadian = atan2(CBy, CBx)\n\n        const lenBA = hypot(BAx, BAy)\n        const lenCB = hypot(CBx, CBy)\n\n        let totalRadian = endRadian - startRadian\n        if (totalRadian < 0) totalRadian += PI2\n\n        if (lenBA < 1e-12 || lenCB < 1e-12 || totalRadian < 1e-12 || abs(totalRadian - PI) < 1e-12) {\n            if (data) data.push(L, x1, y1)\n            if (setPointBounds) {\n                setPoint(setPointBounds, fromX, fromY)\n                addPoint(setPointBounds, x1, y1)\n            }\n            if (setStartPoint) set(setStartPoint, fromX, fromY)\n            if (setEndPoint) set(setEndPoint, x1, y1)\n            return\n        }\n\n        const anticlockwise = BAx * CBy - CBx * BAy < 0\n        const sign = anticlockwise ? -1 : 1\n        const c = radius / cos(totalRadian / 2)\n\n        const centerX = x1 + c * cos(startRadian + totalRadian / 2 + PI_2 * sign)\n        const centerY = y1 + c * sin(startRadian + totalRadian / 2 + PI_2 * sign)\n        startRadian -= PI_2 * sign\n        endRadian -= PI_2 * sign\n\n        return ellipse(data, centerX, centerY, radius, radius, 0, startRadian / OneRadian, endRadian / OneRadian, anticlockwise, setPointBounds, setEndPoint, setStartPoint)\n    },\n\n    arc(data: IPathCommandData | null | void, x: number, y: number, radius: number, startAngle: number, endAngle: number, anticlockwise?: boolean, setPointBounds?: ITwoPointBoundsData, setEndPoint?: IPointData, setStartPoint?: IPointData): void {\n        return ellipse(data, x, y, radius, radius, 0, startAngle, endAngle, anticlockwise, setPointBounds, setEndPoint, setStartPoint)\n    },\n\n    ellipse(data: IPathCommandData | null | void, cx: number, cy: number, radiusX: number, radiusY: number, rotation: number, startAngle: number, endAngle: number, anticlockwise?: boolean, setPointBounds?: ITwoPointBoundsData, setEndPoint?: IPointData, setStartPoint?: IPointData): void {\n        const rotationRadian = rotation * OneRadian\n        const rotationSin = sin(rotationRadian)\n        const rotationCos = cos(rotationRadian)\n\n        let startRadian = startAngle * OneRadian\n        let endRadian = endAngle * OneRadian\n\n        if (startRadian > PI) startRadian -= PI2\n        if (endRadian < 0) endRadian += PI2\n\n        let totalRadian = endRadian - startRadian\n        if (totalRadian < 0) totalRadian += PI2\n        else if (totalRadian > PI2) totalRadian -= PI2\n\n        if (anticlockwise) totalRadian -= PI2\n\n\n        const parts = ceil(abs(totalRadian / PI_2))\n        const partRadian = totalRadian / parts\n        const partRadian4Sin = sin(partRadian / 4)\n        const control = 8 / 3 * partRadian4Sin * partRadian4Sin / sin(partRadian / 2)\n\n        endRadian = startRadian + partRadian\n\n        let startCos = cos(startRadian)\n        let startSin = sin(startRadian)\n        let endCos: number, endSin: number\n\n        let x: number, y: number, x1: number, y1: number, x2: number, y2: number\n\n        let startX = x = rotationCos * radiusX * startCos - rotationSin * radiusY * startSin\n        let startY = y = rotationSin * radiusX * startCos + rotationCos * radiusY * startSin\n\n        let fromX = cx + x, fromY = cy + y\n\n        if (data) data.push(data.length ? L : M, fromX, fromY)\n        if (setPointBounds) setPoint(setPointBounds, fromX, fromY)\n        if (setStartPoint) set(setStartPoint, fromX, fromY)\n\n        for (let i = 0; i < parts; i++) {\n\n            endCos = cos(endRadian)\n            endSin = sin(endRadian)\n\n            x = rotationCos * radiusX * endCos - rotationSin * radiusY * endSin\n            y = rotationSin * radiusX * endCos + rotationCos * radiusY * endSin\n            x1 = cx + startX - control * (rotationCos * radiusX * startSin + rotationSin * radiusY * startCos)\n            y1 = cy + startY - control * (rotationSin * radiusX * startSin - rotationCos * radiusY * startCos)\n            x2 = cx + x + control * (rotationCos * radiusX * endSin + rotationSin * radiusY * endCos)\n            y2 = cy + y + control * (rotationSin * radiusX * endSin - rotationCos * radiusY * endCos)\n\n            if (data) data.push(C, x1, y1, x2, y2, cx + x, cy + y)\n            if (setPointBounds) toTwoPointBounds(cx + startX, cy + startY, x1, y1, x2, y2, cx + x, cy + y, setPointBounds, true)\n\n            startX = x\n            startY = y\n            startCos = endCos\n            startSin = endSin\n            startRadian = endRadian\n            endRadian += partRadian\n        }\n\n        if (setEndPoint) set(setEndPoint, cx + x, cy + y)\n\n    },\n\n    quadraticCurveTo(data: IPathCommandData, fromX: number, fromY: number, x1: number, y1: number, toX: number, toY: number): void {\n        data.push(C, (fromX + 2 * x1) / 3, (fromY + 2 * y1) / 3, (toX + 2 * x1) / 3, (toY + 2 * y1) / 3, toX, toY)\n    },\n\n    toTwoPointBoundsByQuadraticCurve(fromX: number, fromY: number, x1: number, y1: number, toX: number, toY: number, pointBounds: ITwoPointBoundsData, addMode?: boolean): void {\n        toTwoPointBounds(fromX, fromY, (fromX + 2 * x1) / 3, (fromY + 2 * y1) / 3, (toX + 2 * x1) / 3, (toY + 2 * y1) / 3, toX, toY, pointBounds, addMode)\n    },\n\n    toTwoPointBounds(fromX: number, fromY: number, x1: number, y1: number, x2: number, y2: number, toX: number, toY: number, pointBounds: ITwoPointBoundsData, addMode?: boolean): void {\n\n        const tList = []\n        let a, b, c, t, t1, t2, v, sqrtV\n        let f = fromX, z1 = x1, z2 = x2, o = toX\n\n        for (let i = 0; i < 2; ++i) {\n\n            if (i == 1) {\n                f = fromY, z1 = y1, z2 = y2, o = toY\n            }\n\n            a = -3 * f + 9 * z1 - 9 * z2 + 3 * o\n            b = 6 * f - 12 * z1 + 6 * z2\n            c = 3 * z1 - 3 * f\n\n            if (Math.abs(a) < 1e-12) {\n                if (Math.abs(b) < 1e-12) continue\n                t = -c / b\n                if (0 < t && t < 1) tList.push(t)\n                continue\n            }\n\n            v = b * b - 4 * c * a\n            sqrtV = Math.sqrt(v)\n            if (v < 0) continue\n\n            t1 = (-b + sqrtV) / (2 * a)\n            if (0 < t1 && t1 < 1) tList.push(t1)\n            t2 = (-b - sqrtV) / (2 * a)\n            if (0 < t2 && t2 < 1) tList.push(t2)\n        }\n\n        addMode ? addPoint(pointBounds, fromX, fromY) : setPoint(pointBounds, fromX, fromY)\n        addPoint(pointBounds, toX, toY)\n\n        for (let i = 0, len = tList.length; i < len; i++) {\n            getPointAndSet(tList[i], fromX, fromY, x1, y1, x2, y2, toX, toY, tempPoint)\n            addPoint(pointBounds, tempPoint.x, tempPoint.y)\n        }\n\n    },\n\n    getPointAndSet(t: number, fromX: number, fromY: number, x1: number, y1: number, x2: number, y2: number, toX: number, toY: number, setPoint: IPointData): void {\n        const o = 1 - t, a = o * o * o, b = 3 * o * o * t, c = 3 * o * t * t, d = t * t * t\n        setPoint.x = a * fromX + b * x1 + c * x2 + d * toX\n        setPoint.y = a * fromY + b * y1 + c * y2 + d * toY\n    },\n\n    getPoint(t: number, fromX: number, fromY: number, x1: number, y1: number, x2: number, y2: number, toX: number, toY: number): IPointData {\n        const point = {} as IPointData\n        getPointAndSet(t, fromX, fromY, x1, y1, x2, y2, toX, toY, point)\n        return point\n    },\n\n    getDerivative(t: number, fromV: number, v1: number, v2: number, toV: number): number { // 导数\n        const o = 1 - t\n        return 3 * o * o * (v1 - fromV) + 6 * o * t * (v2 - v1) + 3 * t * t * (toV - v2)\n    },\n\n}\n\nconst { getPointAndSet, toTwoPointBounds, ellipse } = BezierHelper","import { IPathCommandData } from '@leafer/interface'\nimport { OneRadian, PI2 } from '@leafer/math'\nimport { Platform } from '@leafer/platform'\n\nimport { PathCommandMap } from './PathCommandMap'\nimport { BezierHelper } from './BezierHelper'\n\n\nconst { sin, cos, sqrt, atan2 } = Math\nconst { ellipse } = BezierHelper\n\nexport const EllipseHelper = {\n\n    // svg \n    ellipticalArc(data: IPathCommandData, fromX: number, fromY: number, radiusX: number, radiusY: number, rotation: number, largeFlag: number, sweepFlag: number, toX: number, toY: number, curveMode?: boolean): void {\n\n        const halfX = (toX - fromX) / 2\n        const halfY = (toY - fromY) / 2\n\n        const rotationRadian = rotation * OneRadian\n        const rotationSin = sin(rotationRadian)\n        const rotationCos = cos(rotationRadian)\n\n        const px = -rotationCos * halfX - rotationSin * halfY\n        const py = -rotationCos * halfY + rotationSin * halfX\n        const rxSquare = radiusX * radiusX\n        const rySquare = radiusY * radiusY\n        const pySquare = py * py\n        const pxSquare = px * px\n\n        const a = rxSquare * rySquare - rxSquare * pySquare - rySquare * pxSquare\n        let s = 0\n\n        if (a < 0) {\n            const t = sqrt(1 - a / (rxSquare * rySquare))\n            radiusX *= t\n            radiusY *= t\n        } else {\n            s = (largeFlag === sweepFlag ? -1 : 1) * sqrt(a / (rxSquare * pySquare + rySquare * pxSquare))\n        }\n\n        const cx = s * radiusX * py / radiusY\n        const cy = -s * radiusY * px / radiusX\n\n        const startRadian = atan2((py - cy) / radiusY, (px - cx) / radiusX)\n        const endRadian = atan2((-py - cy) / radiusY, (-px - cx) / radiusX)\n\n        let totalRadian = endRadian - startRadian\n\n        if (sweepFlag === 0 && totalRadian > 0) {\n            totalRadian -= PI2\n        } else if (sweepFlag === 1 && totalRadian < 0) {\n            totalRadian += PI2\n        }\n\n        const centerX = fromX + halfX + rotationCos * cx - rotationSin * cy\n        const centerY = fromY + halfY + rotationSin * cx + rotationCos * cy\n\n        const anticlockwise = totalRadian < 0 ? 1 : 0\n\n        if (curveMode || Platform.ellipseToCurve) {\n            ellipse(data, centerX, centerY, radiusX, radiusY, rotation, startRadian / OneRadian, endRadian / OneRadian, anticlockwise as unknown as boolean)\n        } else {\n            if (radiusX === radiusY && !rotation) {\n                data.push(PathCommandMap.O, centerX, centerY, radiusX, startRadian / OneRadian, endRadian / OneRadian, anticlockwise)\n            } else {\n                data.push(PathCommandMap.G, centerX, centerY, radiusX, radiusY, rotation, startRadian / OneRadian, endRadian / OneRadian, anticlockwise)\n            }\n        }\n    }\n\n}\n","import { IPathCommandNode, IPathCommandData, IPathNodeBase } from '@leafer/interface'\n\n// 路径节点辅助(适合可视化编辑)，提供接口（需重写）\nexport const PathCommandNodeHelper = {\n    toCommand(_nodes: IPathCommandNode[] | IPathNodeBase[]): IPathCommandData {\n        return []\n    },\n    toNode(_data: IPathCommandData): IPathCommandNode[] {\n        return []\n    }\n}","import { IPathCommandData, IPathCommandNode, IPathCommandObject, IPointData } from '@leafer/interface'\nimport { MathHelper, StringNumberMap } from '@leafer/math'\nimport { Debug } from '@leafer/debug'\n\nimport { PathCommandMap as Command, NeedConvertToCanvasCommandMap, NeedConvertToCurveCommandMap, PathCommandLengthMap, PathNumberCommandMap, PathNumberCommandLengthMap } from './PathCommandMap'\nimport { BezierHelper } from './BezierHelper'\nimport { EllipseHelper } from './EllipseHelper'\nimport { PathCommandNodeHelper } from './PathCommandNodeHelper'\n\n\ninterface ICurrentCommand {\n    name?: number\n    length?: number\n    index?: number\n    dot?: number\n}\n\n\nconst { M, m, L, l, H, h, V, v, C, c, S, s, Q, q, T, t, A, a, Z, z, N, D, X, G, F, O, P, U } = Command\nconst { rect, roundRect, arcTo, arc, ellipse, quadraticCurveTo } = BezierHelper\nconst { ellipticalArc } = EllipseHelper\nconst debug = Debug.get('PathConvert')\n\nconst setEndPoint = {} as IPointData\n\nexport const PathConvert = {\n\n    current: { dot: 0 } as ICurrentCommand,\n\n    stringify(data: IPathCommandData, floatLength?: number): string {\n        let i = 0, len = data.length, count: number, str: string = '', command: number, lastCommand: number\n        while (i < len) {\n            command = data[i]\n            count = PathNumberCommandLengthMap[command]\n            if (command === lastCommand) {\n                str += ' ' // 重复的命令可以省略\n            } else {\n                str += PathNumberCommandMap[command]\n            }\n\n            for (let j = 1; j < count; j++) {\n                str += MathHelper.float(data[i + j], floatLength);\n                (j === count - 1) || (str += ' ')\n            }\n\n            lastCommand = command\n            i += count\n        }\n        return str\n    },\n\n    parse(pathString: string, curveMode?: boolean): IPathCommandData {\n\n        let needConvert: boolean, char: string, lastChar: string, num = ''\n        const data: IPathCommandData = []\n        const convertCommand = curveMode ? NeedConvertToCurveCommandMap : NeedConvertToCanvasCommandMap\n\n        for (let i = 0, len = pathString.length; i < len; i++) {\n\n            char = pathString[i]\n\n            if (StringNumberMap[char]) {\n\n                if (char === '.') {\n                    if (current.dot) { pushData(data, num); num = '' } //  .375.375\n                    current.dot++\n                }\n\n                if (num === '0' && char !== '.') { pushData(data, num); num = '' } //  00 01\n\n                num += char\n\n            } else if (Command[char]) {\n\n                if (num) { pushData(data, num); num = '' }\n\n                current.name = Command[char]\n                current.length = PathCommandLengthMap[char]\n                current.index = 0\n                pushData(data, current.name)\n\n                if (!needConvert && convertCommand[char]) needConvert = true\n\n            } else {\n\n                if (char === '-' || char === '+') {\n\n                    if (lastChar === 'e' || lastChar === 'E') { // L45e-12  21e+22\n                        num += char\n                    } else {\n                        if (num) pushData(data, num) // L-34-35 L+12+28\n                        num = char\n                    }\n\n                } else {\n                    if (num) { pushData(data, num); num = '' }\n                }\n\n            }\n\n            lastChar = char\n\n        }\n\n        if (num) pushData(data, num)\n\n        return needConvert ? PathConvert.toCanvasData(data, curveMode) : data\n    },\n\n    toCanvasData(old: IPathCommandData, curveMode?: boolean): IPathCommandData {\n\n        let x = 0, y = 0, x1 = 0, y1 = 0, i = 0, len = old.length, controlX: number, controlY: number, command: number, lastCommand: number, smooth: boolean\n        const data: IPathCommandData = []\n\n        while (i < len) {\n\n            command = old[i]\n\n            switch (command) {\n                //moveto(x, y)\n                case m:\n                    old[i + 1] += x\n                    old[i + 2] += y\n                case M:\n                    x = old[i + 1]\n                    y = old[i + 2]\n                    data.push(M, x, y)\n                    i += 3\n                    break\n\n                //horizontal lineto(x)\n                case h:\n                    old[i + 1] += x\n                case H:\n                    x = old[i + 1]\n                    data.push(L, x, y)\n                    i += 2\n                    break\n\n                //vertical lineto(y)\n                case v:\n                    old[i + 1] += y\n                case V:\n                    y = old[i + 1]\n                    data.push(L, x, y)\n                    i += 2\n                    break\n\n                //lineto(x,y)\n                case l:\n                    old[i + 1] += x\n                    old[i + 2] += y\n                case L:\n                    x = old[i + 1]\n                    y = old[i + 2]\n                    data.push(L, x, y)\n                    i += 3\n                    break\n\n                //smooth bezierCurveTo(x2, y2, x, y)\n                case s:  //smooth\n                    old[i + 1] += x\n                    old[i + 2] += y\n                    old[i + 3] += x\n                    old[i + 4] += y\n                    command = S\n                case S:\n                    smooth = (lastCommand === C) || (lastCommand === S)\n                    x1 = smooth ? (x * 2 - controlX) : old[i + 1]\n                    y1 = smooth ? (y * 2 - controlY) : old[i + 2]\n                    controlX = old[i + 1]\n                    controlY = old[i + 2]\n                    x = old[i + 3]\n                    y = old[i + 4]\n                    data.push(C, x1, y1, controlX, controlY, x, y)\n                    i += 5\n                    break\n\n                //bezierCurveTo(x1, y1, x2, y2, x, y)\n                case c:\n                    old[i + 1] += x\n                    old[i + 2] += y\n                    old[i + 3] += x\n                    old[i + 4] += y\n                    old[i + 5] += x\n                    old[i + 6] += y\n                    command = C\n                case C:\n                    controlX = old[i + 3]\n                    controlY = old[i + 4]\n                    x = old[i + 5]\n                    y = old[i + 6]\n                    data.push(C, old[i + 1], old[i + 2], controlX, controlY, x, y)\n                    i += 7\n                    break\n\n                //smooth quadraticCurveTo(x, y)\n                case t:\n                    old[i + 1] += x\n                    old[i + 2] += y\n                    command = T\n                case T:  //smooth\n                    smooth = (lastCommand === Q) || (lastCommand === T)\n                    controlX = smooth ? (x * 2 - controlX) : old[i + 1]\n                    controlY = smooth ? (y * 2 - controlY) : old[i + 2]\n                    curveMode ? quadraticCurveTo(data, x, y, controlX, controlY, old[i + 1], old[i + 2]) : data.push(Q, controlX, controlY, old[i + 1], old[i + 2])\n                    x = old[i + 1]\n                    y = old[i + 2]\n                    i += 3\n                    break\n\n                //quadraticCurveTo(x1, y1, x, y)\n                case q:\n                    old[i + 1] += x\n                    old[i + 2] += y\n                    old[i + 3] += x\n                    old[i + 4] += y\n                    command = Q\n                case Q:\n                    controlX = old[i + 1]\n                    controlY = old[i + 2]\n                    curveMode ? quadraticCurveTo(data, x, y, controlX, controlY, old[i + 3], old[i + 4]) : data.push(Q, controlX, controlY, old[i + 3], old[i + 4])\n                    x = old[i + 3]\n                    y = old[i + 4]\n                    i += 5\n                    break\n\n                //ellipticalArc(rx, ry, x-axis-rotation, large-arc-flag, sweep-flag, x, y)\n                case a:\n                    old[i + 6] += x\n                    old[i + 7] += y\n                case A:\n                    ellipticalArc(data, x, y, old[i + 1], old[i + 2], old[i + 3], old[i + 4], old[i + 5], old[i + 6], old[i + 7], curveMode) // convert to canvas ellipse or curve\n                    x = old[i + 6]\n                    y = old[i + 7]\n                    i += 8\n                    break\n                case z:\n                case Z:\n                    data.push(Z)\n                    i++\n                    break\n\n\n                // canvas command\n\n                case N: // rect(x, y, width, height)\n                    x = old[i + 1]\n                    y = old[i + 2]\n                    curveMode ? rect(data, x, y, old[i + 3], old[i + 4]) : copyData(data, old, i, 5)\n                    i += 5\n                    break\n                case D: // roundRect(x, y, width, height, radius1, radius2, radius3, radius4)\n                    x = old[i + 1]\n                    y = old[i + 2]\n                    curveMode ? roundRect(data, x, y, old[i + 3], old[i + 4], [old[i + 5], old[i + 6], old[i + 7], old[i + 8]]) : copyData(data, old, i, 9)\n                    i += 9\n                    break\n                case X: // simple roundRect(x, y, width, height, radius)\n                    x = old[i + 1]\n                    y = old[i + 2]\n                    curveMode ? roundRect(data, x, y, old[i + 3], old[i + 4], old[i + 5]) : copyData(data, old, i, 6)\n                    i += 6\n                    break\n                case G: // ellipse(x, y, radiusX, radiusY, rotation, startAngle, endAngle, anticlockwise)\n                    ellipse(curveMode ? data : copyData(data, old, i, 9), old[i + 1], old[i + 2], old[i + 3], old[i + 4], old[i + 5], old[i + 6], old[i + 7], old[i + 8] as unknown as boolean, null, setEndPoint)\n                    x = setEndPoint.x\n                    y = setEndPoint.y\n                    i += 9\n                    break\n                case F: // simple ellipse(x, y, radiusX, radiusY)\n                    curveMode ? ellipse(data, old[i + 1], old[i + 2], old[i + 3], old[i + 4], 0, 0, 360, false) : copyData(data, old, i, 5)\n                    x = old[i + 1] + old[i + 3]\n                    y = old[i + 2]\n                    i += 5\n                    break\n                case O: // arc(x, y, radius, startAngle, endAngle, anticlockwise)\n                    arc(curveMode ? data : copyData(data, old, i, 7), old[i + 1], old[i + 2], old[i + 3], old[i + 4], old[i + 5], old[i + 6] as unknown as boolean, null, setEndPoint)\n                    x = setEndPoint.x\n                    y = setEndPoint.y\n                    i += 7\n                    break\n                case P: //  simple arc(x, y, radius)\n                    curveMode ? arc(data, old[i + 1], old[i + 2], old[i + 3], 0, 360, false) : copyData(data, old, i, 4)\n                    x = old[i + 1] + old[i + 3]\n                    y = old[i + 2]\n                    i += 4\n                    break\n                case U: // arcTo(x1, y1, x2, y2, radius)\n                    arcTo(curveMode ? data : copyData(data, old, i, 6), x, y, old[i + 1], old[i + 2], old[i + 3], old[i + 4], old[i + 5], null, setEndPoint)\n                    x = setEndPoint.x\n                    y = setEndPoint.y\n                    i += 6\n                    break\n                default:\n                    debug.error(`command: ${command} [index:${i}]`, old)\n                    return data\n            }\n\n            lastCommand = command\n        }\n\n        return data\n\n    },\n\n    objectToCanvasData(list: IPathCommandNode[] | IPathCommandObject[]): IPathCommandData {\n        if (list[0].name.length > 1) { // nodes\n            return PathCommandNodeHelper.toCommand(list as IPathCommandNode[])\n        } else {\n            const data: IPathCommandData = []\n            list.forEach(item => {\n                switch (item.name) {\n                    case 'M': data.push(M, item.x, item.y); break\n                    case 'L': data.push(L, item.x, item.y); break\n                    case 'C': data.push(C, item.x1, item.y1, item.x2, item.y2, item.x, item.y); break\n                    case 'Q': data.push(Q, item.x1, item.y1, item.x, item.y); break\n                    case 'Z': data.push(Z)\n                }\n            })\n            return data\n        }\n    },\n\n    copyData(data: IPathCommandData, old: IPathCommandData, index: number, count: number): void {\n        for (let i = index, end = index + count; i < end; i++) {\n            data.push(old[i])\n        }\n    },\n\n    pushData(data: IPathCommandData, strNum: string | number) {\n        if (current.index === current.length) { // 单个命令，多个数据的情况\n            current.index = 1\n            data.push(current.name)\n        }\n\n        data.push(Number(strNum))\n        current.index++\n        current.dot = 0\n    }\n\n}\n\nconst { current, pushData, copyData } = PathConvert","import { IPathCommandData, IPointData } from '@leafer/interface'\nimport { MathHelper, PointHelper } from '@leafer/math'\nimport { isNumber, isUndefined, isNull } from '@leafer/data'\n\nimport { PathCommandMap } from './PathCommandMap'\nimport { BezierHelper } from './BezierHelper'\n\n\nconst { M, L, C, Q, Z, N, D, X, G, F, O, P, U } = PathCommandMap\nconst { getMinDistanceFrom, getRadianFrom } = PointHelper\nconst { tan, min, abs } = Math\nconst startPoint = {} as IPointData\n\nexport const PathCommandDataHelper = {\n\n    beginPath(data: IPathCommandData): void {\n        data.length = 0\n    },\n\n    // svg and canvas\n\n    moveTo(data: IPathCommandData, x: number, y: number): void {\n        data.push(M, x, y)\n    },\n\n    lineTo(data: IPathCommandData, x: number, y: number): void {\n        data.push(L, x, y)\n    },\n\n    bezierCurveTo(data: IPathCommandData, x1: number, y1: number, x2: number, y2: number, x: number, y: number): void {\n        data.push(C, x1, y1, x2, y2, x, y)\n    },\n\n    quadraticCurveTo(data: IPathCommandData, x1: number, y1: number, x: number, y: number): void {\n        data.push(Q, x1, y1, x, y)\n    },\n\n    closePath(data: IPathCommandData): void {\n        data.push(Z)\n    },\n\n    // canvas\n\n    rect(data: IPathCommandData, x: number, y: number, width: number, height: number): void {\n        data.push(N, x, y, width, height)\n    },\n\n    roundRect(data: IPathCommandData, x: number, y: number, width: number, height: number, cornerRadius: number | number[]): void {\n        if (isNumber(cornerRadius)) {\n            data.push(X, x, y, width, height, cornerRadius)\n        } else {\n            const fourCorners = MathHelper.fourNumber(cornerRadius)\n            if (fourCorners) {\n                data.push(D, x, y, width, height, ...fourCorners)\n            } else {\n                data.push(N, x, y, width, height)\n            }\n        }\n    },\n\n    ellipse(data: IPathCommandData, x: number, y: number, radiusX: number, radiusY: number, rotation?: number, startAngle?: number, endAngle?: number, anticlockwise?: boolean): void {\n        if (radiusX === radiusY) return arc(data, x, y, radiusX, startAngle, endAngle, anticlockwise)\n        if (isNull(rotation)) {\n            data.push(F, x, y, radiusX, radiusY)\n        } else {\n            if (isNull(startAngle)) startAngle = 0\n            if (isNull(endAngle)) endAngle = 360\n            data.push(G, x, y, radiusX, radiusY, rotation, startAngle, endAngle, anticlockwise ? 1 : 0)\n        }\n    },\n\n    arc(data: IPathCommandData, x: number, y: number, radius: number, startAngle?: number, endAngle?: number, anticlockwise?: boolean): void {\n        if (isNull(startAngle)) {\n            data.push(P, x, y, radius)\n        } else {\n            if (isNull(startAngle)) startAngle = 0\n            if (isNull(endAngle)) endAngle = 360\n            data.push(O, x, y, radius, startAngle, endAngle, anticlockwise ? 1 : 0)\n        }\n    },\n\n    arcTo(data: IPathCommandData, x1: number, y1: number, x2: number, y2: number, radius: number, lastX?: number, lastY?: number): void {\n        if (!isUndefined(lastX)) {\n            const d = getMinDistanceFrom(lastX, lastY, x1, y1, x2, y2)\n            radius = min(radius, min(d / 2, d / 2 * abs(tan(getRadianFrom(lastX, lastY, x1, y1, x2, y2) / 2))))\n        }\n        data.push(U, x1, y1, x2, y2, radius)\n    },\n\n    // new\n\n    drawEllipse(data: IPathCommandData, x: number, y: number, radiusX: number, radiusY: number, rotation?: number, startAngle?: number, endAngle?: number, anticlockwise?: boolean): void {\n        BezierHelper.ellipse(null, x, y, radiusX, radiusY, isNull(rotation) ? 0 : rotation, isNull(startAngle) ? 0 : startAngle, isNull(endAngle) ? 360 : endAngle, anticlockwise, null, null, startPoint)\n        data.push(M, startPoint.x, startPoint.y)\n        ellipse(data, x, y, radiusX, radiusY, rotation, startAngle, endAngle, anticlockwise)\n    },\n\n    drawArc(data: IPathCommandData, x: number, y: number, radius: number, startAngle?: number, endAngle?: number, anticlockwise?: boolean): void {\n        BezierHelper.arc(null, x, y, radius, isNull(startAngle) ? 0 : startAngle, isNull(endAngle) ? 360 : endAngle, anticlockwise, null, null, startPoint)\n        data.push(M, startPoint.x, startPoint.y)\n        arc(data, x, y, radius, startAngle, endAngle, anticlockwise)\n    },\n\n    drawPoints(data: IPathCommandData, points: number[] | IPointData[], curve?: boolean | number, close?: boolean): void {\n        BezierHelper.points(data, points, curve, close)\n    }\n\n}\n\nconst { ellipse, arc } = PathCommandDataHelper\n","import { IPathCommandData, IPathCreator, IPathString, IPointData } from '@leafer/interface'\nimport { isString } from '@leafer/data'\n\nimport { PathCommandDataHelper } from './PathCommandDataHelper'\nimport { PathHelper } from './PathHelper'\n\n\nconst { moveTo, lineTo, quadraticCurveTo, bezierCurveTo, closePath, beginPath, rect, roundRect, ellipse, arc, arcTo, drawEllipse, drawArc, drawPoints } = PathCommandDataHelper\n\nexport class PathCreator implements IPathCreator { //  tip: rewrited Pen\n\n    public set path(value: IPathCommandData) { this.__path = value }\n    public get path() { return this.__path }\n\n    public __path: IPathCommandData // 提供一个更安全的内部变量（比如覆盖给Pen时需要用到，避免与原有属性冲突）\n\n    constructor(path?: IPathCommandData | IPathString) {\n        this.set(path)\n    }\n\n    public set(path?: IPathCommandData | IPathString): PathCreator {\n        this.__path = path ? (isString(path) ? PathHelper.parse(path) : path) : []\n        return this\n    }\n\n    public beginPath(): PathCreator {\n        beginPath(this.__path)\n        this.paint()\n        return this\n    }\n\n    // svg and canvas\n\n    public moveTo(x: number, y: number): PathCreator {\n        moveTo(this.__path, x, y)\n        this.paint()\n        return this\n    }\n\n    public lineTo(x: number, y: number): PathCreator {\n        lineTo(this.__path, x, y)\n        this.paint()\n        return this\n    }\n\n    public bezierCurveTo(x1: number, y1: number, x2: number, y2: number, x: number, y: number): PathCreator {\n        bezierCurveTo(this.__path, x1, y1, x2, y2, x, y)\n        this.paint()\n        return this\n    }\n\n    public quadraticCurveTo(x1: number, y1: number, x: number, y: number): PathCreator {\n        quadraticCurveTo(this.__path, x1, y1, x, y)\n        this.paint()\n        return this\n    }\n\n    public closePath(): PathCreator {\n        closePath(this.__path)\n        this.paint()\n        return this\n    }\n\n    // canvas\n\n    public rect(x: number, y: number, width: number, height: number): PathCreator {\n        rect(this.__path, x, y, width, height)\n        this.paint()\n        return this\n    }\n\n    public roundRect(x: number, y: number, width: number, height: number, cornerRadius: number | number[]): PathCreator {\n        roundRect(this.__path, x, y, width, height, cornerRadius)\n        this.paint()\n        return this\n    }\n\n    public ellipse(x: number, y: number, radiusX: number, radiusY: number, rotation?: number, startAngle?: number, endAngle?: number, anticlockwise?: boolean): PathCreator {\n        ellipse(this.__path, x, y, radiusX, radiusY, rotation, startAngle, endAngle, anticlockwise)\n        this.paint()\n        return this\n    }\n\n    public arc(x: number, y: number, radius: number, startAngle?: number, endAngle?: number, anticlockwise?: boolean): PathCreator {\n        arc(this.__path, x, y, radius, startAngle, endAngle, anticlockwise)\n        this.paint()\n        return this\n    }\n\n    public arcTo(x1: number, y1: number, x2: number, y2: number, radius: number): PathCreator {\n        arcTo(this.__path, x1, y1, x2, y2, radius)\n        this.paint()\n        return this\n    }\n\n    // moveTo, then draw\n\n    public drawEllipse(x: number, y: number, radiusX: number, radiusY: number, rotation?: number, startAngle?: number, endAngle?: number, anticlockwise?: boolean): PathCreator {\n        drawEllipse(this.__path, x, y, radiusX, radiusY, rotation, startAngle, endAngle, anticlockwise)\n        this.paint()\n        return this\n    }\n\n    public drawArc(x: number, y: number, radius: number, startAngle?: number, endAngle?: number, anticlockwise?: boolean): PathCreator {\n        drawArc(this.__path, x, y, radius, startAngle, endAngle, anticlockwise)\n        this.paint()\n        return this\n    }\n\n    public drawPoints(points: number[] | IPointData[], curve?: boolean | number, close?: boolean): PathCreator {\n        drawPoints(this.__path, points, curve, close)\n        this.paint()\n        return this\n    }\n\n    public clearPath(): PathCreator {\n        return this.beginPath()\n    }\n\n    public paint(): void { }\n\n}\n","import { IPathDrawer, IPathCommandData } from '@leafer/interface'\nimport { OneRadian, PI2 } from '@leafer/math'\nimport { Debug } from '@leafer/debug'\n\nimport { PathCommandMap as Command } from './PathCommandMap'\n\n\nconst { M, L, C, Q, Z, N, D, X, G, F, O, P, U } = Command\nconst debug = Debug.get('PathDrawer')\n\nexport const PathDrawer = {\n\n    drawPathByData(drawer: IPathDrawer, data: IPathCommandData): void {\n        if (!data) return\n\n        let command: number\n        let i = 0, len = data.length\n\n        while (i < len) {\n            command = data[i]\n            switch (command) {\n                case M:  //moveto(x, y)\n                    drawer.moveTo(data[i + 1], data[i + 2])\n                    i += 3\n                    break\n                case L:  //lineto(x, y)\n                    drawer.lineTo(data[i + 1], data[i + 2])\n                    i += 3\n                    break\n                case C:  //bezierCurveTo(x1, y1, x2, y2, x, y)\n                    drawer.bezierCurveTo(data[i + 1], data[i + 2], data[i + 3], data[i + 4], data[i + 5], data[i + 6])\n                    i += 7\n                    break\n                case Q:  //quadraticCurveTo(x1, y1, x, y)\n                    drawer.quadraticCurveTo(data[i + 1], data[i + 2], data[i + 3], data[i + 4])\n                    i += 5\n                    break\n                case Z:  //closepath()\n                    drawer.closePath()\n                    i += 1\n                    break\n\n                // canvas command\n\n                case N: // rect(x, y, width, height)\n                    drawer.rect(data[i + 1], data[i + 2], data[i + 3], data[i + 4])\n                    i += 5\n                    break\n                case D: // roundRect(x, y, width, height, radius1, radius2, radius3, radius4)\n                    drawer.roundRect(data[i + 1], data[i + 2], data[i + 3], data[i + 4], [data[i + 5], data[i + 6], data[i + 7], data[i + 8]])\n                    i += 9\n                    break\n                case X: // simple roundRect(x, y, width, height, radius)\n                    drawer.roundRect(data[i + 1], data[i + 2], data[i + 3], data[i + 4], data[i + 5])\n                    i += 6\n                    break\n                case G: // ellipse(x, y, radiusX, radiusY, rotation, startAngle, endAngle, anticlockwise)\n                    drawer.ellipse(data[i + 1], data[i + 2], data[i + 3], data[i + 4], data[i + 5] * OneRadian, data[i + 6] * OneRadian, data[i + 7] * OneRadian, data[i + 8] as unknown as boolean)\n                    i += 9\n                    break\n                case F: // simple ellipse(x, y, radiusX, radiusY)\n                    drawer.ellipse(data[i + 1], data[i + 2], data[i + 3], data[i + 4], 0, 0, PI2, false)\n                    i += 5\n                    break\n                case O: // arc(x, y, radius, startAngle, endAngle, anticlockwise)\n                    drawer.arc(data[i + 1], data[i + 2], data[i + 3], data[i + 4] * OneRadian, data[i + 5] * OneRadian, data[i + 6] as unknown as boolean)\n                    i += 7\n                    break\n                case P: // simple arc(x, y, radius)\n                    drawer.arc(data[i + 1], data[i + 2], data[i + 3], 0, PI2, false)\n                    i += 4\n                    break\n                case U: // arcTo(x1, y1, x2, y2, radius)\n                    drawer.arcTo(data[i + 1], data[i + 2], data[i + 3], data[i + 4], data[i + 5])\n                    i += 6\n                    break\n                default:\n                    debug.error(`command: ${command} [index:${i}]`, data)\n                    return\n            }\n        }\n\n    }\n\n}","import { ITwoPointBoundsData, IPathCommandData, IBoundsData, IPointData } from '@leafer/interface'\nimport { TwoPointBoundsHelper } from '@leafer/math'\nimport { Debug } from '@leafer/debug'\n\nimport { BezierHelper } from './BezierHelper'\nimport { PathCommandMap as Command } from './PathCommandMap'\n\n\nconst { M, L, C, Q, Z, N, D, X, G, F, O, P, U } = Command\nconst { toTwoPointBounds, toTwoPointBoundsByQuadraticCurve, arcTo, arc, ellipse } = BezierHelper\nconst { addPointBounds, copy, addPoint, setPoint, addBounds, toBounds } = TwoPointBoundsHelper\nconst debug = Debug.get('PathBounds')\n\nlet radius: number, radiusX: number, radiusY: number\nconst tempPointBounds = {} as ITwoPointBoundsData\nconst setPointBounds = {} as ITwoPointBoundsData\nconst setEndPoint = {} as IPointData\n\nexport const PathBounds = {\n\n    toBounds(data: IPathCommandData, setBounds: IBoundsData): void {\n        PathBounds.toTwoPointBounds(data, setPointBounds)\n        toBounds(setPointBounds, setBounds)\n    },\n\n    toTwoPointBounds(data: IPathCommandData, setPointBounds: ITwoPointBoundsData): void {\n        if (!data || !data.length) return setPoint(setPointBounds, 0, 0)\n\n        let i = 0, x = 0, y = 0, x1: number, y1: number, toX: number, toY: number, command: number\n\n        const len = data.length\n\n        while (i < len) {\n            command = data[i]\n\n            if (i === 0) {\n                if (command === Z || command === C || command === Q) {\n                    setPoint(setPointBounds, x, y)\n                } else {\n                    setPoint(setPointBounds, data[i + 1], data[i + 2])\n                }\n            }\n\n            switch (command) {\n                case M: //moveto(x, y)\n                case L: //lineto(x, y)\n                    x = data[i + 1]\n                    y = data[i + 2]\n                    addPoint(setPointBounds, x, y)\n                    i += 3\n                    break\n                case C: //bezierCurveTo(x1, y1, x2, y2, x,y)\n                    toX = data[i + 5]\n                    toY = data[i + 6]\n                    toTwoPointBounds(x, y, data[i + 1], data[i + 2], data[i + 3], data[i + 4], toX, toY, tempPointBounds)\n                    addPointBounds(setPointBounds, tempPointBounds)\n                    x = toX\n                    y = toY\n                    i += 7\n                    break\n                case Q: //quadraticCurveTo(x1, y1, x, y)\n                    x1 = data[i + 1]\n                    y1 = data[i + 2]\n                    toX = data[i + 3]\n                    toY = data[i + 4]\n                    toTwoPointBoundsByQuadraticCurve(x, y, x1, y1, toX, toY, tempPointBounds)\n                    addPointBounds(setPointBounds, tempPointBounds)\n                    x = toX\n                    y = toY\n                    i += 5\n                    break\n                case Z: //closepath()\n                    i += 1\n                    break\n\n                // canvas command\n\n                case N: // rect(x, y, width, height)\n                    x = data[i + 1]\n                    y = data[i + 2]\n                    addBounds(setPointBounds, x, y, data[i + 3], data[i + 4])\n                    i += 5\n                    break\n                case D: // roundRect(x, y, width, height, radius1, radius2, radius3, radius4)\n                case X: // simple roundRect(x, y, width, height, radius)\n                    x = data[i + 1]\n                    y = data[i + 2]\n                    addBounds(setPointBounds, x, y, data[i + 3], data[i + 4])\n                    i += (command === D ? 9 : 6)\n                    break\n                case G: // ellipse(x, y, radiusX, radiusY, rotation, startAngle, endAngle, anticlockwise)\n                    ellipse(null, data[i + 1], data[i + 2], data[i + 3], data[i + 4], data[i + 5], data[i + 6], data[i + 7], data[i + 8] as unknown as boolean, tempPointBounds, setEndPoint)\n                    i === 0 ? copy(setPointBounds, tempPointBounds) : addPointBounds(setPointBounds, tempPointBounds)\n                    x = setEndPoint.x\n                    y = setEndPoint.y\n                    i += 9\n                    break\n                case F: // simple ellipse(x, y, radiusX, radiusY)\n                    x = data[i + 1]\n                    y = data[i + 2]\n                    radiusX = data[i + 3]\n                    radiusY = data[i + 4]\n                    addBounds(setPointBounds, x - radiusX, y - radiusY, radiusX * 2, radiusY * 2)\n                    x += radiusX\n                    i += 5\n                    break\n                case O: // arc(x, y, radius, startAngle, endAngle, anticlockwise)\n                    arc(null, data[i + 1], data[i + 2], data[i + 3], data[i + 4], data[i + 5], data[i + 6] as unknown as boolean, tempPointBounds, setEndPoint)\n                    i === 0 ? copy(setPointBounds, tempPointBounds) : addPointBounds(setPointBounds, tempPointBounds)\n                    x = setEndPoint.x\n                    y = setEndPoint.y\n                    i += 7\n                    break\n                case P: // simple arc(x, y, radius)\n                    x = data[i + 1]\n                    y = data[i + 2]\n                    radius = data[i + 3]\n                    addBounds(setPointBounds, x - radius, y - radius, radius * 2, radius * 2)\n                    x += radius\n                    i += 4\n                    break\n                case U: // arcTo(x1, y1, x2, y2, radius)\n                    arcTo(null, x, y, data[i + 1], data[i + 2], data[i + 3], data[i + 4], data[i + 5], tempPointBounds, setEndPoint)\n                    i === 0 ? copy(setPointBounds, tempPointBounds) : addPointBounds(setPointBounds, tempPointBounds)\n                    x = setEndPoint.x\n                    y = setEndPoint.y\n                    i += 6\n                    break\n                default:\n                    debug.error(`command: ${command} [index:${i}]`, data)\n                    return\n            }\n        }\n\n    }\n\n}","import { IPathCommandData } from '@leafer/interface'\nimport { PointHelper } from '@leafer/math'\nimport { isArray } from '@leafer/data'\n\nimport { PathCommandMap as Command, PathNumberCommandLengthMap } from './PathCommandMap'\nimport { PathCommandDataHelper } from './PathCommandDataHelper'\n\n\nconst { M, L, Z } = Command\nconst { getCenterX, getCenterY } = PointHelper\nconst { arcTo } = PathCommandDataHelper\n\nexport const PathCorner = {\n\n    smooth(data: IPathCommandData, cornerRadius: number, _cornerSmoothing?: number): IPathCommandData {\n\n        let command: number, lastCommand: number, commandLen\n        let i = 0, x = 0, y = 0, startX = 0, startY = 0, secondX = 0, secondY = 0, lastX = 0, lastY = 0\n        if (isArray(cornerRadius)) cornerRadius = cornerRadius[0] || 0\n\n        const len = data.length\n        const smooth: IPathCommandData = []\n\n        while (i < len) {\n            command = data[i]\n            switch (command) {\n                case M:  //moveto(x, y)\n                    startX = lastX = data[i + 1]\n                    startY = lastY = data[i + 2]\n                    i += 3\n                    if (data[i] === L) { // next lineTo\n                        secondX = data[i + 1]\n                        secondY = data[i + 2]\n                        smooth.push(M, getCenterX(startX, secondX), getCenterY(startY, secondY))\n                    } else {\n                        smooth.push(M, startX, startY)\n                    }\n                    break\n                case L:  //lineto(x, y)\n                    x = data[i + 1]\n                    y = data[i + 2]\n                    i += 3\n                    switch (data[i]) { // next command\n                        case L: // lineTo()\n                            arcTo(smooth, x, y, data[i + 1], data[i + 2], cornerRadius, lastX, lastY) // use arcTo(x1, y1, x2, y2, radius)\n                            break\n                        case Z: // closePath()\n                            arcTo(smooth, x, y, startX, startY, cornerRadius, lastX, lastY) // use arcTo(x1, y1, x2, y2, radius)\n                            break\n                        default:\n                            smooth.push(L, x, y)\n                    }\n                    lastX = x\n                    lastY = y\n                    break\n                case Z:  //closepath()\n                    if (lastCommand !== Z) { // fix: 重复的 Z 导致的问题\n                        arcTo(smooth, startX, startY, secondX, secondY, cornerRadius, lastX, lastY) // use arcTo(x1, y1, x2, y2, radius)\n                        smooth.push(Z)\n                    }\n                    i += 1\n                    break\n                default:\n                    commandLen = PathNumberCommandLengthMap[command]\n                    for (let j = 0; j < commandLen; j++) smooth.push(data[i + j])\n                    i += commandLen\n            }\n            lastCommand = command\n        }\n\n        if (command !== Z) {\n            smooth[1] = startX\n            smooth[2] = startY\n        }\n\n        return smooth\n    }\n\n}","export { PathHelper } from './PathHelper'\nexport { PathConvert } from './PathConvert'\nexport { PathCreator } from './PathCreator'\nexport { PathCommandDataHelper } from './PathCommandDataHelper'\nexport { PathCommandNodeHelper } from './PathCommandNodeHelper'\nexport { PathDrawer } from './PathDrawer'\nexport { PathBounds } from './PathBounds'\nexport { PathCorner } from './PathCorner'\nexport { BezierHelper } from './BezierHelper'\nexport { EllipseHelper } from './EllipseHelper'\nexport { RectHelper } from './RectHelper'\nexport { PathCommandMap, NeedConvertToCanvasCommandMap, PathNumberCommandMap, PathNumberCommandLengthMap } from './PathCommandMap'\n\n// rewrite, prevent circular references\n\nimport { PathConvert } from './PathConvert'\nimport { PathCreator } from './PathCreator'\nimport { PathHelper } from './PathHelper'\n\nimport { IPathCommandData, IPathString } from '@leafer/interface'\n\n\nexport function path(path?: IPathCommandData | IPathString): PathCreator {\n    return new PathCreator(path)\n}\n\nexport const pen = path()\n\nPathHelper.creator = path()\nPathHelper.parse = PathConvert.parse\nPathHelper.convertToCanvasData = PathConvert.toCanvasData","import { IPathDrawer } from '@leafer/interface'\nimport { RectHelper } from '@leafer/path'\n\n\nconst { drawRoundRect } = RectHelper\n\nexport function roundRect(drawer: IPathDrawer): void {\n\n    if (drawer && !drawer.roundRect) {\n\n        drawer.roundRect = function (x: number, y: number, width: number, height: number, cornerRadius: number | number[]): void {\n\n            drawRoundRect(this as IPathDrawer, x, y, width, height, cornerRadius)\n        }\n    }\n\n}\n\n","import { IPathDrawer } from '@leafer/interface'\n\nimport { roundRect } from './roundRect'\n\nexport function canvasPatch(drawer: IPathDrawer): void {\n    roundRect(drawer)\n}","import { IExportFileType, IStringMap, IExportOptions } from '@leafer/interface'\n\nexport const FileHelper = {\n\n    alphaPixelTypes: ['png', 'webp', 'svg'] as IExportFileType[],\n\n    upperCaseTypeMap: {} as IStringMap,\n\n    mineType(type: string): string {\n        if (!type || type.startsWith('image')) return type\n        if (type === 'jpg') type = 'jpeg'\n        return 'image/' + type\n    },\n\n    fileType(filename: string): string {\n        const l = filename.split('.')\n        return l[l.length - 1]\n    },\n\n    isOpaqueImage(filename: string): boolean {\n        const type = F.fileType(filename)\n        return ['jpg', 'jpeg'].some(item => item === type)\n    },\n\n    getExportOptions(options?: IExportOptions | number | boolean): IExportOptions {\n        switch (typeof options) {\n            case 'object': return options\n            case 'number': return { quality: options }\n            case 'boolean': return { blob: options }\n            default: return {}\n        }\n    }\n\n}\n\nconst F = FileHelper\n\nF.alphaPixelTypes.forEach(type => F.upperCaseTypeMap[type] = type.toUpperCase())","import { IFunction, ITaskItem } from '@leafer/interface'\nimport { IncrementId } from '@leafer/math'\nimport { Debug } from '@leafer/debug'\n\nimport { TaskProcessor } from './TaskProcessor'\n\n\nconst debug = Debug.get('TaskProcessor')\nexport class TaskItem implements ITaskItem {\n\n    readonly id: number\n\n    public parent: TaskProcessor\n\n    public parallel = true\n    public time = 1 // 预估任务需要运行的时间， 毫秒为单位\n\n    public isComplete: boolean\n    public isCancel: boolean\n    public runing: boolean\n\n    public canUse?: IFunction\n\n    public task: IFunction\n\n    constructor(task?: IFunction) {\n        this.id = IncrementId.create(IncrementId.TASK)\n        this.task = task\n    }\n\n    async run(): Promise<void> {\n        try {\n            if (this.isComplete || this.runing) return\n            this.runing = true\n            if (this.canUse && !this.canUse()) return this.cancel()\n            if (this.task) await this.task()\n        } catch (error) {\n            debug.error(error)\n        }\n    }\n\n    public complete(): void {\n        this.isComplete = true\n        this.parent = this.task = this.canUse = null\n    }\n\n    public cancel(): void {\n        this.isCancel = true\n        this.complete()\n    }\n\n}","import { IFunction, ITaskProcessor, ITaskProcessorConfig, ITaskOptions, ITaskItem } from '@leafer/interface'\nimport { DataHelper, isNumber, isUndefined } from '@leafer/data'\n\nimport { TaskItem } from './TaskItem'\n\n\nexport class TaskProcessor implements ITaskProcessor {\n\n    public config: ITaskProcessorConfig = { parallel: 6 }\n\n    protected list: ITaskItem[] = []\n\n    protected parallelList: ITaskItem[]\n    protected parallelSuccessNumber: number\n\n    public running = false\n    public isComplete = true\n\n    protected timer: any\n\n    public get total(): number { return this.list.length + this.delayNumber }\n\n    public index = 0\n\n    public delayNumber = 0 // 延迟执行任务\n\n    public get finishedIndex(): number {\n        return this.isComplete ? 0 : this.index + this.parallelSuccessNumber\n    }\n\n    public get remain(): number {\n        return this.isComplete ? this.total : this.total - this.finishedIndex\n    }\n\n    public get percent(): number {\n        const { total } = this\n        let totalTime = 0, runTime = 0\n\n        for (let i = 0; i < total; i++) {\n            if (i <= this.finishedIndex) {\n                runTime += this.list[i].time\n                if (i === this.finishedIndex) totalTime = runTime\n            } else {\n                totalTime += this.list[i].time\n            }\n        }\n\n        return this.isComplete ? 1 : (runTime / totalTime)\n    }\n\n\n    constructor(config?: ITaskProcessorConfig) {\n        if (config) DataHelper.assign(this.config, config)\n        this.empty()\n    }\n\n    // list\n\n    public add(taskCallback: IFunction, options?: ITaskOptions | number, canUse?: IFunction): ITaskItem {\n        let start: boolean, parallel: boolean, time: number, delay: number\n\n        const task = new TaskItem(taskCallback)\n        task.parent = this\n\n        if (isNumber(options)) {\n            delay = options\n        } else if (options) {\n            parallel = options.parallel\n            start = options.start\n            time = options.time\n            delay = options.delay\n            if (!canUse) canUse = options.canUse\n        }\n\n        if (time) task.time = time\n        if (parallel === false) task.parallel = false\n        if (canUse) task.canUse = canUse\n\n        if (isUndefined(delay)) {\n            this.push(task, start)\n        } else {\n            this.delayNumber++\n            setTimeout(() => {\n                if (this.delayNumber) {\n                    this.delayNumber--\n                    this.push(task, start)\n                }\n            }, delay)\n        }\n\n        this.isComplete = false\n\n        return task\n    }\n\n    protected push(task: ITaskItem, start?: boolean): void {\n        this.list.push(task)\n        if (start !== false && !this.timer) {\n            this.timer = setTimeout(() => this.start())\n        }\n    }\n\n    protected empty(): void {\n        this.index = 0\n        this.parallelSuccessNumber = 0\n        this.list = []\n        this.parallelList = []\n        this.delayNumber = 0\n    }\n\n    // control\n\n    public start(): void {\n        if (!this.running) {\n            this.running = true\n            this.isComplete = false\n            this.run()\n        }\n    }\n\n    public pause(): void {\n        clearTimeout(this.timer)\n        this.timer = null\n        this.running = false\n    }\n\n    public resume(): void {\n        this.start()\n    }\n\n    public skip(): void {\n        this.index++\n        this.resume()\n    }\n\n    public stop(): void {\n        this.isComplete = true\n        this.list.forEach(task => { if (!task.isComplete) task.run() })\n        this.pause()\n        this.empty()\n    }\n\n    // run \n\n    protected run(): void {\n        if (!this.running) return\n\n        this.setParallelList()\n\n        if (this.parallelList.length > 1) {\n\n            this.runParallelTasks()\n\n        } else {\n\n            this.remain ? this.runTask() : this.onComplete()\n\n        }\n    }\n\n    protected runTask(): void {\n        const task = this.list[this.index]\n        if (!task) {\n            this.timer = setTimeout(() => this.nextTask())  // 存在延时任务\n            return\n        }\n\n        task.run().then(() => {\n\n            this.onTask(task)\n\n            this.index++\n            task.isCancel ? this.runTask() : this.nextTask()\n\n        }).catch(error => {\n            this.onError(error)\n        })\n    }\n\n    protected runParallelTasks(): void {\n        this.parallelList.forEach(task => this.runParallelTask(task))\n    }\n\n    protected runParallelTask(task: ITaskItem): void {\n        task.run().then(() => {\n\n            this.onTask(task)\n            this.fillParallelTask()\n\n        }).catch(error => {\n            this.onParallelError(error)\n        })\n    }\n\n    private nextTask(): void {\n        if (this.total === this.finishedIndex) {\n            this.onComplete()\n        } else {\n            this.timer = setTimeout(() => this.run())\n        }\n    }\n\n    protected setParallelList(): void {\n        let task: ITaskItem\n        const { config, list, index } = this\n\n        this.parallelList = []\n        this.parallelSuccessNumber = 0\n        let end = index + config.parallel\n\n        if (end > list.length) end = list.length\n\n        if (config.parallel > 1) {\n            for (let i = index; i < end; i++) {\n                task = list[i]\n                if (task.parallel) this.parallelList.push(task)\n                else break\n            }\n        }\n    }\n\n\n    protected fillParallelTask(): void {\n        let task: ITaskItem\n        const parallelList = this.parallelList\n\n        // 完成一个任务\n        this.parallelSuccessNumber++\n        parallelList.pop()\n\n        // 找到下一个可以并行的任务\n        const parallelWaitNumber = parallelList.length\n        const nextIndex = this.finishedIndex + parallelWaitNumber\n\n        if (parallelList.length) {\n\n            if (!this.running) return\n\n            if (nextIndex < this.total) {\n\n                task = this.list[nextIndex]\n\n                if (task && task.parallel) {\n                    parallelList.push(task)\n                    this.runParallelTask(task)\n                }\n\n            }\n\n        } else {\n\n            this.index += this.parallelSuccessNumber\n            this.parallelSuccessNumber = 0\n            this.nextTask()\n\n        }\n    }\n\n    // event\n\n    protected onComplete(): void {\n        this.stop()\n        if (this.config.onComplete) this.config.onComplete()\n    }\n\n    protected onTask(task: ITaskItem): void {\n        task.complete()\n        if (this.config.onTask) this.config.onTask()\n    }\n\n    protected onParallelError(error: unknown): void {\n        // 并行变串行, 以便下次重试\n        this.parallelList.forEach(task => {\n            task.parallel = false\n        })\n        this.parallelList.length = 0\n        this.parallelSuccessNumber = 0\n\n        this.onError(error)\n    }\n\n    protected onError(error: unknown): void {\n        this.pause()\n        if (this.config.onError) this.config.onError(error)\n    }\n\n    public destroy(): void {\n        this.stop()\n    }\n}","import { ILeaferImage, IResource, IObject, ILeaferCanvas, IExportFileType, ILeaferImageConfig } from '@leafer/interface'\n\nimport { Creator } from '@leafer/platform'\nimport { TaskProcessor } from '@leafer/task'\nimport { isString } from '@leafer/data'\nimport { Debug } from '@leafer/debug'\n\n\nconst debug = Debug.get('Resource')\n\nexport const Resource: IResource = {\n\n    tasker: new TaskProcessor(),\n\n    map: {},\n\n    get isComplete() { return R.tasker.isComplete },\n\n    // 通用\n\n    set(key: string, value: any): void {\n        if (R.map[key]) debug.repeat(key)\n        R.map[key] = value\n    },\n\n    get(key: string): any {\n        return R.map[key]\n    },\n\n    remove(key: string) {\n        const r = R.map[key]\n        if (r) {\n            if (r.destroy) r.destroy()\n            delete R.map[key]\n        }\n    },\n\n    // image\n\n    loadImage(key: string, format?: IExportFileType): Promise<ILeaferImage> {\n        return new Promise((resolve, reject) => {\n            const image = this.setImage(key, key, format)\n            image.load(() => resolve(image), (e: any) => reject(e))\n        })\n    },\n\n    setImage(key: string, value: string | IObject | ILeaferImage | ILeaferCanvas, format?: IExportFileType): ILeaferImage {\n        let config: ILeaferImageConfig\n        if (isString(value)) config = { url: value }\n        else if (!value.url) config = { url: key, view: value }\n        if (config) format && (config.format = format), value = Creator.image(config)\n        R.set(key, value)\n        return value as ILeaferImage\n    },\n\n\n    destroy(): void {\n        R.map = {}\n    }\n\n}\n\nconst R = Resource","import { IImageManager, ILeaferImageConfig, ILeaferImage, IExportFileType } from '@leafer/interface'\nimport { Creator, Platform } from '@leafer/platform'\nimport { FileHelper, Resource } from '@leafer/file'\nimport { TaskProcessor } from '@leafer/task'\n\n\nexport const ImageManager: IImageManager = {\n\n    maxRecycled: 10,\n\n    recycledList: [],\n\n    patternTasker: new TaskProcessor({ parallel: 1 }),\n\n    get(config: ILeaferImageConfig): ILeaferImage {\n        let image: ILeaferImage = Resource.get(config.url)\n        if (!image) Resource.set(config.url, image = Creator.image(config))\n        image.use++\n        return image\n    },\n\n    recycle(image: ILeaferImage): void {\n        image.use--\n        setTimeout(() => {\n            if (!image.use) {\n                if (Platform.image.isLarge(image)) {\n                    if (image.url) Resource.remove(image.url)\n                } else {\n                    image.clearLevels()\n                    I.recycledList.push(image)\n                }\n            }\n        })\n    },\n\n    // maybe rewrite\n    recyclePaint(paint: any): void {\n        I.recycle(paint.image)\n    },\n\n    clearRecycled(force?: boolean): void {\n        const list = I.recycledList\n        if (list.length > I.maxRecycled || force) {\n            list.forEach(image => ((!image.use || force) && image.url) && Resource.remove(image.url))\n            list.length = 0\n        }\n    },\n\n    // need rewrite\n    clearLevels(): void { },\n\n    hasAlphaPixel(config: ILeaferImageConfig): boolean {\n        return FileHelper.alphaPixelTypes.some(item => I.isFormat(item, config))\n    },\n\n    isFormat(format: IExportFileType, config: ILeaferImageConfig): boolean {\n        if (config.format) return config.format === format\n        const { url } = config\n        if (url.startsWith('data:')) {\n            if (url.startsWith('data:' + FileHelper.mineType(format))) return true\n        } else {\n            if (url.includes('.' + format) || url.includes('.' + FileHelper.upperCaseTypeMap[format])) return true\n            else if (format === 'png' && !url.includes('.')) return true // blob: 等无后缀名协议的图片无法分析类型，直接当透明图片处理\n        }\n        return false\n    },\n\n    destroy(): void {\n        this.clearRecycled(true)\n    }\n\n}\n\nconst I = ImageManager","import { ILeaferImage, ILeaferImageConfig, IFunction, IObject, InnerId, IMatrixData, ICanvasPattern, ILeaferImageCacheCanvas, ILeaferImagePatternPaint, ILeaferImageLevel, ISizeData, IImageCrossOrigin, IImageLOD, IInterlace } from '@leafer/interface'\nimport { Platform } from '@leafer/platform'\nimport { Resource } from '@leafer/file'\nimport { IncrementId } from '@leafer/math'\nimport { isUndefined } from '@leafer/data'\n\nimport { ImageManager } from './ImageManager'\n\n\nconst { IMAGE, create } = IncrementId\n\nexport class LeaferImage implements ILeaferImage {\n\n    public readonly innerId: InnerId\n    public get url() { return this.config.url }\n    public lod?: IImageLOD\n    public get crossOrigin(): IImageCrossOrigin { const { crossOrigin } = this.config; return isUndefined(crossOrigin) ? Platform.image.crossOrigin : crossOrigin }\n\n    public view: any\n\n    public width: number\n    public height: number\n\n    public isSVG: boolean\n    public hasAlphaPixel: boolean // check png / svg / webp\n\n    public get completed() { return this.ready || !!this.error }\n\n    public ready: boolean\n    public error: IObject\n    public loading: boolean\n\n    public use = 0\n\n    public config: ILeaferImageConfig\n\n    protected waitComplete: IFunction[] = []\n\n    protected cache: ILeaferImageCacheCanvas\n\n    constructor(config: ILeaferImageConfig) {\n        this.innerId = create(IMAGE)\n        this.config = config || (config = { url: '' })\n        if (config.view) {\n            const { view } = config\n            this.setView(view.config ? view.view : view)\n        }\n\n        ImageManager.isFormat('svg', config) && (this.isSVG = true)\n        ImageManager.hasAlphaPixel(config) && (this.hasAlphaPixel = true)\n    }\n\n    public load(onSuccess?: IFunction, onError?: IFunction, thumbSize?: ISizeData): number {\n        if (!this.loading) {\n            this.loading = true\n            Resource.tasker.add(async () => await Platform.origin.loadImage(this.getLoadUrl(thumbSize), this.crossOrigin, this).then(img => {\n                if (thumbSize) this.setThumbView(img)\n                this.setView(img)\n            }).catch((e) => {\n                this.error = e\n                this.onComplete(false)\n            }))\n        }\n        this.waitComplete.push(onSuccess, onError)\n        return this.waitComplete.length - 2\n    }\n\n    public unload(index: number, stopEvent?: boolean): void {\n        const l = this.waitComplete\n        if (stopEvent) {\n            const error = l[index + 1]\n            if (error) error({ type: 'stop' })\n        }\n        l[index] = l[index + 1] = undefined\n    }\n\n    protected setView(img: any): void {\n        this.ready = true\n        if (!this.width) {\n            this.width = img.width\n            this.height = img.height\n            this.view = img\n        }\n        this.onComplete(true)\n    }\n\n    protected onComplete(isSuccess: boolean): void {\n        let odd: number\n        this.waitComplete.forEach((item, index) => {\n            odd = index % 2\n            if (item) {\n                if (isSuccess) {\n                    if (!odd) item(this)\n                } else {\n                    if (odd) item(this.error)\n                }\n            }\n        })\n        this.waitComplete.length = 0\n        this.loading = false\n    }\n\n    public getFull(_filters?: IObject): any {\n        return this.view\n    }\n\n    public getCanvas(width: number, height: number, opacity?: number, filters?: IObject, xGap?: number, yGap?: number, smooth?: boolean, interlace?: IInterlace): any {\n        width || (width = this.width)\n        height || (height = this.height)\n\n        if (this.cache) { // when use > 1, check cache\n            let { params, data } = this.cache\n            for (let i in params) { if (params[i] !== arguments[i]) { data = null; break } }\n            if (data) return data\n        }\n\n        const canvas = Platform.image.resize(this.view, width, height, xGap, yGap, undefined, smooth, opacity, filters, interlace)\n\n        this.cache = this.use > 1 ? { data: canvas, params: arguments } : null\n\n        return canvas\n    }\n\n    public getPattern(canvas: any, repeat: string | null, transform?: IMatrixData, paint?: ILeaferImagePatternPaint): ICanvasPattern {\n        const pattern = Platform.canvas.createPattern(canvas, repeat)\n        Platform.image.setPatternTransform(pattern, transform, paint)\n        return pattern\n    }\n\n    // need rewrite\n    public getLoadUrl(_thumbSize?: ISizeData): string { return this.url }\n    public setThumbView(_view: number): void { }\n    public getThumbSize(_lod?: IImageLOD): ISizeData { return undefined }\n\n    public getMinLevel(): number { return undefined }\n    public getLevelData(_level: number, _width?: number, _height?: number,): ILeaferImageLevel { return undefined }\n    public clearLevels(_checkUse?: boolean): void { }\n\n    public destroy(): void {\n        this.clearLevels()\n\n        const { view } = this\n        if (view && view.close) view.close() // 可能为 ImageBitmap\n        this.config = { url: '' }\n        this.cache = this.view = null\n        this.waitComplete.length = 0\n    }\n\n}","import { IObject, IValue } from '@leafer/interface'\n\nexport function defineKey<T>(target: T, key: string, descriptor: IObject & ThisType<T>, noConfigurable?: boolean): void {\n    if (!noConfigurable) descriptor.configurable = descriptor.enumerable = true\n    Object.defineProperty(target, key, descriptor)\n}\n\nexport function getDescriptor(object: IObject, name: string) {\n    return Object.getOwnPropertyDescriptor(object, name)\n}\n\nexport function createDescriptor(key: string, defaultValue?: IValue) {\n    const privateKey = '_' + key\n    return {\n        get() { const v = (this as IObject)[privateKey]; return v == null ? defaultValue : v },\n        set(value: IValue) { (this as IObject)[privateKey] = value }\n    }\n}\n\nexport function getNames(object: IObject): string[] {\n    return Object.getOwnPropertyNames(object)\n}\n\n","import { ILeafData, ILeaf, IObject, IValue, ILeafAttrDescriptor, ILeafAttrDescriptorFn, IValueFunction, IMatrixWithBoundsScaleData } from '@leafer/interface'\nimport { DataHelper, isEmptyData, isObject, isUndefined } from '@leafer/data'\nimport { Debug } from '@leafer/debug'\n\nimport { defineKey, getDescriptor, createDescriptor } from './object'\n\n\n// name\n\nexport function decorateLeafAttr(defaultValue?: IValue, descriptorFn?: ILeafAttrDescriptorFn) {\n    return (target: ILeaf, key: string) => defineLeafAttr(target, key, defaultValue, descriptorFn && descriptorFn(key))\n}\n\nexport function attr(partDescriptor?: ILeafAttrDescriptor): ILeafAttrDescriptor {\n    return partDescriptor\n}\n\n\nexport function defineLeafAttr(target: ILeaf, key: string, defaultValue?: IValue, partDescriptor?: ILeafAttrDescriptor): void {\n    const defaultDescriptor: ILeafAttrDescriptor = {\n        get() { return this.__getAttr(key) },\n        set(value: IValue) { this.__setAttr(key, value) }\n    }\n    defineKey(target, key, Object.assign(defaultDescriptor, partDescriptor || {}))\n    defineDataProcessor(target, key, defaultValue)\n}\n\n\nexport function dataType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue)\n}\n\nexport function positionType(defaultValue?: IValue, checkFiniteNumber?: boolean) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            this.__setAttr(key, value, checkFiniteNumber) && (this.__layout.matrixChanged || this.__layout.matrixChange())\n        }\n    }))\n}\n\nexport function scrollType(defaultValue?: IValue, checkFiniteNumber?: boolean) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            if (this.__setAttr(key, value, checkFiniteNumber)) {\n                this.__layout.matrixChanged || this.__layout.matrixChange()\n                this.__scrollWorld || (this.__scrollWorld = {} as IMatrixWithBoundsScaleData)\n            }\n        }\n    }))\n}\n\nexport function autoLayoutType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            if (this.__setAttr(key, value)) {\n                this.__hasAutoLayout = !!(this.origin || this.around || this.flow)\n                if (!this.__local) this.__layout.createLocal()\n                doBoundsType(this)\n            }\n        }\n    }))\n}\n\nexport function scaleType(defaultValue?: IValue, checkFiniteNumber?: boolean) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            this.__setAttr(key, value, checkFiniteNumber) && (this.__layout.scaleChanged || this.__layout.scaleChange())\n\n        }\n    }))\n}\n\nexport function rotationType(defaultValue?: IValue, checkFiniteNumber?: boolean) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            this.__setAttr(key, value, checkFiniteNumber) && (this.__layout.rotationChanged || this.__layout.rotationChange())\n        }\n\n    }))\n}\n\nexport function boundsType(defaultValue?: IValue, checkFiniteNumber?: boolean) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            this.__setAttr(key, value, checkFiniteNumber) && doBoundsType(this)\n        }\n    }))\n}\n\nexport function naturalBoundsType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            this.__setAttr(key, value) && (doBoundsType(this), this.__.__removeNaturalSize())\n        }\n    }))\n}\n\nexport function doBoundsType(leaf: ILeaf): void {\n    leaf.__layout.boxChanged || leaf.__layout.boxChange()\n    if (leaf.__hasAutoLayout) leaf.__layout.matrixChanged || leaf.__layout.matrixChange()\n}\n\nexport function pathInputType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            const data = this.__\n            if (data.__pathInputed !== 2) data.__pathInputed = value ? 1 : 0\n            if (!value) data.__pathForRender = undefined\n            this.__setAttr(key, value)\n            doBoundsType(this)\n        }\n    }))\n}\n\nexport const pathType = boundsType\n\n\nexport function affectStrokeBoundsType(defaultValue?: IValue, useStroke?: boolean) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            if (this.__setAttr(key, value)) {\n                doStrokeType(this)\n                if (useStroke) this.__.__useStroke = true\n            }\n        }\n    }))\n}\n\nexport function doStrokeType(leaf: ILeaf): void {\n    leaf.__layout.strokeChanged || leaf.__layout.strokeChange()\n    if (leaf.__.__useArrow) doBoundsType(leaf)\n}\n\nexport const strokeType = affectStrokeBoundsType\n\nexport function affectRenderBoundsType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            this.__setAttr(key, value)\n            this.__layout.renderChanged || this.__layout.renderChange()\n        }\n    }))\n}\n\nexport function surfaceType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            this.__setAttr(key, value) && (this.__layout.surfaceChanged || this.__layout.surfaceChange())\n        }\n    }))\n}\n\nexport function dimType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            if (this.__setAttr(key, value)) {\n                const data = this.__\n                DataHelper.stintSet(data, '__useDim', (data.dim || data.bright || data.dimskip) as boolean)\n                this.__layout.surfaceChange()\n            }\n        }\n    }))\n}\n\nexport function opacityType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            this.__setAttr(key, value) && (this.__layout.opacityChanged || this.__layout.opacityChange())\n            if (this.mask) checkMask(this)\n        }\n    }))\n}\n\nexport function visibleType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            const oldValue = this.visible\n            if (oldValue === true && value === 0) {\n                if (this.animationOut) return this.__runAnimation('out', () => doVisible(this, key, value, oldValue)) // hide\n            } else if (oldValue === 0 && value === true) {\n                if (this.animation) this.__runAnimation('in') // show\n            }\n            doVisible(this, key, value, oldValue)\n            if (this.mask) checkMask(this)\n        }\n    }))\n}\n\nfunction checkMask(leaf: ILeaf): void { // mask 的透明度和可见性变更，会影响parent\n    const { parent } = leaf\n    if (parent) {\n        const { __hasMask } = parent\n        parent.__updateMask()\n        if (__hasMask !== parent.__hasMask) parent.forceUpdate()\n    }\n}\n\nfunction doVisible(leaf: ILeaf, key: string, value: IValue, oldValue: IValue): void {\n    if (leaf.__setAttr(key, value)) {\n        leaf.__layout.opacityChanged || leaf.__layout.opacityChange()\n        if (oldValue === 0 || value === 0) doBoundsType(leaf) // 0 = display: none\n    }\n}\n\nexport function sortType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            if (this.__setAttr(key, value)) {\n                this.__layout.surfaceChange()\n                this.waitParent(() => { this.parent.__layout.childrenSortChange() })\n            }\n        }\n    }))\n}\n\nexport function maskType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: boolean) {\n            if (this.__setAttr(key, value)) {\n                this.__layout.boxChanged || this.__layout.boxChange()\n                this.waitParent(() => { this.parent.__updateMask(value) })\n            }\n        }\n    }))\n}\n\nexport function eraserType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: boolean) {\n            this.__setAttr(key, value) && this.waitParent(() => { this.parent.__updateEraser(value) })\n        }\n    }))\n}\n\nexport function hitType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            if (this.__setAttr(key, value)) {\n                this.__layout.hitCanvasChanged = true\n                if (Debug.showBounds === 'hit') this.__layout.surfaceChange()\n                if (this.leafer) this.leafer.updateCursor()\n            }\n        }\n    }))\n}\n\nexport function cursorType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            this.__setAttr(key, value)\n            if (this.leafer) this.leafer.updateCursor()\n        }\n    }))\n}\n\n\n// get\n\nexport function dataProcessor(processor: IObject) {\n    return (target: IObject, _key?: string) => {\n        defineKey(target, '__DataProcessor', {\n            get() { return processor }\n        })\n    }\n}\n\nexport function layoutProcessor(processor: IObject) {\n    return (target: IObject, _key?: string) => {\n        defineKey(target, '__LayoutProcessor', {\n            get() { return processor }\n        })\n    }\n}\n\n\n// other \n\nfunction getSetMethodName(key: string): string {\n    return 'set' + key.charAt(0).toUpperCase() + key.slice(1)\n}\n\n\n// define leaf.__[key] getter/setter\nexport function defineDataProcessor(target: ILeaf, key: string, defaultValue?: IValue | IValueFunction): void {\n\n    const data = target.__DataProcessor.prototype\n    const computedKey = '_' + key\n    const setMethodName = getSetMethodName(key)\n\n    const property: IObject & ThisType<ILeafData> = createDescriptor(key, defaultValue)\n\n    if (isUndefined(defaultValue)) {\n        property.get = function () { return this[computedKey] }\n    } else if (typeof defaultValue === 'function') {\n        property.get = function () {\n            const v = this[computedKey]\n            return v == null ? defaultValue((this as ILeafData).__leaf) : v\n        }\n    } else if (isObject(defaultValue)) {\n        const isEmpty = isEmptyData(defaultValue)\n        property.get = function () {\n            const v = this[computedKey]\n            return v == null ? this[computedKey] = isEmpty ? {} : DataHelper.clone(defaultValue) : v\n        }\n    }\n\n    const isBox = target.isBranchLeaf // 仅用于 width / height\n    if (key === 'width') {\n        property.get = function () {\n            const v = this[computedKey]\n            if (v == null) {\n                const t = this as ILeafData, naturalWidth = t.__naturalWidth, leaf = t.__leaf\n                if (!defaultValue || leaf.pathInputed) return leaf.boxBounds.width\n                if (naturalWidth) return (t as IObject)._height && t.__useNaturalRatio ? (t as IObject)._height * naturalWidth / t.__naturalHeight : naturalWidth\n                return (isBox && leaf.children.length) ? leaf.boxBounds.width : defaultValue // 返回 Box / Group / Text 等的实际宽度\n            } else return v\n        }\n    } else if (key === 'height') {\n        property.get = function () {\n            const v = this[computedKey]\n            if (v == null) {\n                const t = this as ILeafData, naturalHeight = t.__naturalHeight, leaf = t.__leaf\n                if (!defaultValue || leaf.pathInputed) return leaf.boxBounds.height\n                if (naturalHeight) return (t as IObject)._width && t.__useNaturalRatio ? (t as IObject)._width * naturalHeight / t.__naturalWidth : naturalHeight\n                return (isBox && leaf.children.length) ? leaf.boxBounds.height : defaultValue // 返回 Box / Group / Text 等的实际高度\n            } else return v\n        }\n    }\n\n    // find parent proto\n    let descriptor, find = data\n    while (!descriptor && find) {\n        descriptor = getDescriptor(find, key)\n        find = find.__proto__\n    }\n\n    if (descriptor && descriptor.set) property.set = descriptor.set // use exist set\n\n    if (data[setMethodName]) {\n        property.set = data[setMethodName] // first use custom setKey(value)\n        delete data[setMethodName]\n    }\n\n    defineKey(data, key, property)\n\n}\n\n","import { IObject, IFunction } from '@leafer/interface'\nimport { Debug } from '@leafer/debug'\nimport { getDescriptor, getNames } from './object'\n\ninterface IRewriteItem {\n    name: string\n    run: IFunction\n}\n\nconst debug = new Debug('rewrite')\n\nconst list: IRewriteItem[] = []\nconst excludeNames = ['destroy', 'constructor']\n\n\n// method\n\nexport function rewrite(method: IFunction) {\n    return (target: IObject, key: string) => {\n        list.push({ name: target.constructor.name + '.' + key, run: () => { target[key] = method } })\n    }\n}\n\nexport function rewriteAble() {\n    return (_target: IObject) => {\n        doRewrite()\n    }\n}\n\nfunction doRewrite(error?: boolean): void {\n    if (list.length) {\n        list.forEach(item => {\n            if (error) debug.error(item.name, '需在Class上装饰@rewriteAble()')\n            item.run()\n        })\n        list.length = 0\n    }\n}\n\nsetTimeout(() => doRewrite(true))\n\n\n// class\n\nexport function useModule(module: IObject, exclude?: string[]) {\n    return (target: IObject) => {\n        const names = module.prototype ? getNames(module.prototype) : Object.keys(module)\n        names.forEach(name => {\n            if (!excludeNames.includes(name) && (!exclude || !exclude.includes(name))) {\n                if (module.prototype) {\n                    const d = getDescriptor(module.prototype, name)\n                    if (d.writable) target.prototype[name] = module.prototype[name]\n                } else {\n                    target.prototype[name] = module[name]\n                }\n            }\n        })\n    }\n}","import { IObject } from '@leafer/interface'\nimport { EventCreator, UICreator } from '@leafer/platform'\n\nexport function registerUI() {\n    return (target: IObject) => {\n        UICreator.register(target)\n    }\n}\n\nexport function registerUIEvent() {\n    return (target: IObject) => {\n        EventCreator.register(target)\n    }\n}","import { IAlign, ILeaf, IMatrixData, IPointData, IAxis, ITransition, ILeaferCanvas, IBoundsData, IMatrixWithBoundsData } from '@leafer/interface'\nimport { MathHelper, MatrixHelper, PointHelper, AroundHelper, getMatrixData, BoundsHelper } from '@leafer/math'\nimport { Platform } from '@leafer/platform'\nimport { isObject, isNumber } from '@leafer/data'\n\n\nconst { copy, toInnerPoint, toOuterPoint, scaleOfOuter, rotateOfOuter, skewOfOuter, multiplyParent, divideParent, getLayout } = MatrixHelper\nconst matrix = {} as IMatrixData, { round } = Math\n\nexport const LeafHelper = {\n\n    updateAllMatrix(leaf: ILeaf, checkAutoLayout?: boolean, waitAutoLayout?: boolean): void {\n        if (checkAutoLayout && leaf.__hasAutoLayout && leaf.__layout.matrixChanged) waitAutoLayout = true\n\n        updateMatrix(leaf, checkAutoLayout, waitAutoLayout)\n\n        if (leaf.isBranch) {\n            const { children } = leaf\n            for (let i = 0, len = children.length; i < len; i++) {\n                updateAllMatrix(children[i], checkAutoLayout, waitAutoLayout)\n            }\n        }\n    },\n\n    updateMatrix(leaf: ILeaf, checkAutoLayout?: boolean, waitAutoLayout?: boolean): void {\n        const layout = leaf.__layout\n\n        if (checkAutoLayout) {\n            if (waitAutoLayout) {\n                layout.waitAutoLayout = true\n                if (leaf.__hasAutoLayout) layout.matrixChanged = false // wait updateAutoLayout\n            }\n        } else if (layout.waitAutoLayout) {\n            layout.waitAutoLayout = false\n        }\n\n        if (layout.matrixChanged) leaf.__updateLocalMatrix()\n        if (!layout.waitAutoLayout) leaf.__updateWorldMatrix()\n    },\n\n    updateBounds(leaf: ILeaf): void {\n        const layout = leaf.__layout\n        if (layout.boundsChanged) leaf.__updateLocalBounds()\n        if (!layout.waitAutoLayout) leaf.__updateWorldBounds()\n    },\n\n    updateAllWorldOpacity(leaf: ILeaf): void {\n        leaf.__updateWorldOpacity()\n\n        if (leaf.isBranch) {\n            const { children } = leaf\n            for (let i = 0, len = children.length; i < len; i++) {\n                updateAllWorldOpacity(children[i])\n            }\n        }\n    },\n\n    updateChange(leaf: ILeaf): void {\n        const layout = leaf.__layout\n        if (layout.stateStyleChanged) leaf.updateState()\n        if (layout.opacityChanged) updateAllWorldOpacity(leaf)\n        leaf.__updateChange()\n    },\n\n    updateAllChange(leaf: ILeaf): void {\n        updateChange(leaf)\n        if (leaf.isBranch) {\n            const { children } = leaf\n            for (let i = 0, len = children.length; i < len; i++) {\n                updateAllChange(children[i])\n            }\n        }\n    },\n\n    worldHittable(t: ILeaf): boolean {\n        while (t) {\n            if (!t.__.hittable) return false\n            t = t.parent\n        }\n        return true\n    },\n\n    draggable(t: ILeaf): boolean {\n        return (t.draggable || t.editable) && t.hitSelf && !t.locked\n    },\n\n    copyCanvasByWorld(leaf: ILeaf, currentCanvas: ILeaferCanvas, fromCanvas: ILeaferCanvas, fromWorld?: IBoundsData, blendMode?: string, onlyResetTransform?: boolean): void {\n        if (!fromWorld) fromWorld = leaf.__nowWorld\n        if (leaf.__worldFlipped || Platform.fullImageShadow) currentCanvas.copyWorldByReset(fromCanvas, fromWorld, leaf.__nowWorld, blendMode, onlyResetTransform)\n        else currentCanvas.copyWorldToInner(fromCanvas, fromWorld as IMatrixWithBoundsData, leaf.__layout.renderBounds, blendMode)\n    },\n\n    // transform\n\n    moveWorld(t: ILeaf, x: number | IPointData, y = 0, isInnerPoint?: boolean, transition?: ITransition): void {\n        const local = isObject(x) ? { ...x } : { x, y }\n        isInnerPoint ? toOuterPoint(t.localTransform, local, local, true) : (t.parent && toInnerPoint(t.parent.scrollWorldTransform, local, local, true))\n        L.moveLocal(t, local.x, local.y, transition)\n    },\n\n    moveLocal(t: ILeaf, x: number | IPointData, y = 0, transition?: ITransition): void {\n        if (isObject(x)) y = x.y, x = x.x\n        x += t.x\n        y += t.y\n        if (t.leafer && t.leafer.config.pointSnap) x = round(x), y = round(y)\n        transition ? t.animate({ x, y }, transition) : (t.x = x, t.y = y)\n    },\n\n    zoomOfWorld(t: ILeaf, origin: IPointData, scaleX: number, scaleY?: number | ITransition, resize?: boolean, transition?: ITransition): void {\n        L.zoomOfLocal(t, getTempLocal(t, origin), scaleX, scaleY, resize, transition)\n    },\n\n    zoomOfLocal(t: ILeaf, origin: IPointData, scaleX: number, scaleY: number | ITransition = scaleX, resize?: boolean, transition?: ITransition): void {\n        const o = t.__localMatrix\n        if (!isNumber(scaleY)) {\n            if (scaleY) transition = scaleY\n            scaleY = scaleX\n        }\n        copy(matrix, o)\n        scaleOfOuter(matrix, origin, scaleX, scaleY)\n        if (L.hasHighPosition(t)) {\n            L.setTransform(t, matrix, resize, transition)\n        } else {\n            const x = t.x + matrix.e - o.e, y = t.y + matrix.f - o.f\n            if (transition && !resize) t.animate({ x, y, scaleX: t.scaleX * scaleX, scaleY: t.scaleY * scaleY }, transition)\n            else t.x = x, t.y = y, t.scaleResize(scaleX, scaleY, resize !== true)\n        }\n    },\n\n    rotateOfWorld(t: ILeaf, origin: IPointData, angle: number, transition?: ITransition): void {\n        L.rotateOfLocal(t, getTempLocal(t, origin), angle, transition)\n    },\n\n    rotateOfLocal(t: ILeaf, origin: IPointData, angle: number, transition?: ITransition): void {\n        const o = t.__localMatrix\n        copy(matrix, o)\n        rotateOfOuter(matrix, origin, angle)\n        if (L.hasHighPosition(t)) L.setTransform(t, matrix, false, transition)\n        else t.set({ x: t.x + matrix.e - o.e, y: t.y + matrix.f - o.f, rotation: MathHelper.formatRotation(t.rotation + angle) }, transition)\n    },\n\n    skewOfWorld(t: ILeaf, origin: IPointData, skewX: number, skewY?: number, resize?: boolean, transition?: ITransition): void {\n        L.skewOfLocal(t, getTempLocal(t, origin), skewX, skewY, resize, transition)\n    },\n\n    skewOfLocal(t: ILeaf, origin: IPointData, skewX: number, skewY: number = 0, resize?: boolean, transition?: ITransition): void {\n        copy(matrix, t.__localMatrix)\n        skewOfOuter(matrix, origin, skewX, skewY)\n        L.setTransform(t, matrix, resize, transition)\n    },\n\n    transformWorld(t: ILeaf, transform: IMatrixData, resize?: boolean, transition?: ITransition): void {\n        copy(matrix, t.worldTransform)\n        multiplyParent(matrix, transform)\n        if (t.parent) divideParent(matrix, t.parent.scrollWorldTransform)\n        L.setTransform(t, matrix, resize, transition)\n    },\n\n    transform(t: ILeaf, transform: IMatrixData, resize?: boolean, transition?: ITransition): void {\n        copy(matrix, t.localTransform)\n        multiplyParent(matrix, transform)\n        L.setTransform(t, matrix, resize, transition)\n    },\n\n    setTransform(t: ILeaf, transform: IMatrixData, resize?: boolean, transition?: ITransition): void {\n        const data = t.__, originPoint = data.origin && L.getInnerOrigin(t, data.origin)\n        const layout = getLayout(transform, originPoint, data.around && L.getInnerOrigin(t, data.around))\n\n        if (L.hasOffset(t)) {\n            layout.x -= data.offsetX\n            layout.y -= data.offsetY\n        }\n\n        if (resize) {\n            const scaleX = layout.scaleX / t.scaleX, scaleY = layout.scaleY / t.scaleY\n            delete layout.scaleX, delete layout.scaleY\n\n            if (originPoint) { // fix origin: resize 方式下 boxBounds 会变化，导致 originPoint 不准确，需偏移至正确的位置\n                BoundsHelper.scale(t.boxBounds, Math.abs(scaleX), Math.abs(scaleY))\n                const changedPoint = L.getInnerOrigin(t, data.origin)\n                PointHelper.move(layout, originPoint.x - changedPoint.x, originPoint.y - changedPoint.y)\n            }\n\n            t.set(layout)\n            t.scaleResize(scaleX, scaleY, false)\n\n        } else t.set(layout, transition)\n    },\n\n    getFlipTransform(t: ILeaf, axis: IAxis): IMatrixData {\n        const m = getMatrixData()\n        const sign = axis === 'x' ? 1 : -1\n        scaleOfOuter(m, L.getLocalOrigin(t, 'center'), -1 * sign, 1 * sign)\n        return m\n    },\n\n    getLocalOrigin(t: ILeaf, origin: IPointData | IAlign): IPointData {\n        return PointHelper.tempToOuterOf(L.getInnerOrigin(t, origin), t.localTransform)\n    },\n\n    getInnerOrigin(t: ILeaf, origin: IPointData | IAlign): IPointData {\n        const innerOrigin = {} as IPointData\n        AroundHelper.toPoint(origin, t.boxBounds, innerOrigin)\n        return innerOrigin\n    },\n\n    getRelativeWorld(t: ILeaf, relative: ILeaf, temp?: boolean): IMatrixData {\n        copy(matrix, t.worldTransform)\n        divideParent(matrix, relative.scrollWorldTransform)\n        return temp ? matrix : { ...matrix }\n    },\n\n    drop(t: ILeaf, parent: ILeaf, index?: number, resize?: boolean): void {\n        t.setTransform(L.getRelativeWorld(t, parent, true), resize)\n        parent.add(t, index)\n    },\n\n    hasHighPosition(t: ILeaf): boolean {\n        return (t.origin || t.around || L.hasOffset(t)) as unknown as boolean\n    },\n\n    hasOffset(t: ILeaf): boolean {\n        return (t.offsetX || t.offsetY) as unknown as boolean\n    },\n\n    hasParent(p: ILeaf, parent: ILeaf): boolean | void {\n        if (!parent) return false\n        while (p) {\n            if (parent === p) return true\n            p = p.parent\n        }\n    },\n\n    // 简单动画操作\n\n    animateMove(t: ILeaf, move: IPointData, speed = 0.3) {\n        if (!move.x && !move.y) return\n        if (Math.abs(move.x) < 1 && Math.abs(move.y) < 1) {\n            t.move(move)\n        } else {\n            const x = move.x * speed, y = move.y * speed\n            move.x -= x, move.y -= y\n            t.move(x, y)\n            Platform.requestRender(() => L.animateMove(t, move, speed))\n        }\n    }\n\n}\n\nconst L = LeafHelper\nconst { updateAllMatrix, updateMatrix, updateAllWorldOpacity, updateAllChange, updateChange } = L\n\nfunction getTempLocal(t: ILeaf, worldPoint: IPointData): IPointData {\n    t.updateLayout() // must\n    return t.parent ? PointHelper.tempToInnerOf(worldPoint, t.parent.scrollWorldTransform) : worldPoint\n}","import { ILeaf, IBoundsData, IRenderOptions } from '@leafer/interface'\n\n\nexport const LeafBoundsHelper = {\n\n    worldBounds(target: ILeaf): IBoundsData {\n        return target.__world\n    },\n\n    localBoxBounds(target: ILeaf): IBoundsData {\n        return target.__.eraser || target.__.visible === 0 ? null : (target.__local || target.__layout)\n    },\n\n    localStrokeBounds(target: ILeaf): IBoundsData {\n        return target.__.eraser || target.__.visible === 0 ? null : target.__layout.localStrokeBounds\n    },\n\n    localRenderBounds(target: ILeaf): IBoundsData {\n        return target.__.eraser || target.__.visible === 0 ? null : target.__layout.localRenderBounds\n    },\n\n    maskLocalBoxBounds(target: ILeaf, index: number): IBoundsData {\n        return checkMask(target, index) && target.__localBoxBounds\n    },\n\n    maskLocalStrokeBounds(target: ILeaf, index: number): IBoundsData {\n        return checkMask(target, index) && target.__layout.localStrokeBounds\n    },\n\n    maskLocalRenderBounds(target: ILeaf, index: number): IBoundsData {\n        return checkMask(target, index) && target.__layout.localRenderBounds\n    },\n\n    excludeRenderBounds(child: ILeaf, options: IRenderOptions): boolean {\n        if (options.bounds && !options.bounds.hit(child.__world, options.matrix)) return true\n        if (options.hideBounds && options.hideBounds.includes(child.__world, options.matrix)) return true\n        return false\n    }\n\n}\n\n\nlet findMask: number\n\nfunction checkMask(target: ILeaf, index: number): boolean {\n    if (!index) findMask = 0\n    if (target.__.mask) findMask = 1\n    return findMask < 0 ? null : (findMask && (findMask = -1), true) // 第一个 mask 元素之后的元素 bounds 可以忽略，返回 null\n}","import { ILeaf, ILeafLevelList, ILeafList, IMatrixWithBoundsData, IMatrixWithBoundsScaleData } from '@leafer/interface'\nimport { isUndefined } from '@leafer/data'\nimport { LeafHelper } from './LeafHelper'\n\nconst { updateBounds } = LeafHelper\n\nexport const BranchHelper = {\n\n    sort(a: ILeaf, b: ILeaf): number {\n        return (a.__.zIndex === b.__.zIndex) ? (a.__tempNumber - b.__tempNumber) : (a.__.zIndex - b.__.zIndex)\n    },\n\n    // push\n\n    pushAllChildBranch(branch: ILeaf, leafList: ILeafList | ILeafLevelList): void {\n        branch.__tempNumber = 1   // 标识需要更新子Leaf元素的WorldBounds分支 Layouter需使用\n\n        if (branch.__.__childBranchNumber) {\n            const { children } = branch\n            for (let i = 0, len = children.length; i < len; i++) {\n                branch = children[i]\n                if (branch.isBranch) {\n                    branch.__tempNumber = 1\n                    leafList.add(branch)\n                    pushAllChildBranch(branch, leafList)\n                }\n            }\n        }\n    },\n\n    pushAllParent(leaf: ILeaf, leafList: ILeafList | ILeafLevelList): void {\n        const { keys } = (leafList as ILeafList)\n        if (keys) {\n            while (leaf.parent) {\n                if (isUndefined(keys[leaf.parent.innerId])) {\n                    leafList.add(leaf.parent)\n                    leaf = leaf.parent\n                } else {\n                    break\n                }\n            }\n        } else {\n            while (leaf.parent) {\n                leafList.add(leaf.parent)\n                leaf = leaf.parent\n            }\n        }\n    },\n\n    pushAllBranchStack(branch: ILeaf, pushList: ILeaf[]): void {\n        let start = pushList.length\n        const { children } = branch\n        for (let i = 0, len = children.length; i < len; i++) {\n            if (children[i].isBranch) {\n                pushList.push(children[i])\n            }\n        }\n\n        // 找子级\n        for (let i = start, len = pushList.length; i < len; i++) {\n            pushAllBranchStack(pushList[i], pushList)\n        }\n    },\n\n    updateBounds(branch: ILeaf, exclude?: ILeaf): void {\n        const branchStack: ILeaf[] = [branch]\n        pushAllBranchStack(branch, branchStack)\n        updateBoundsByBranchStack(branchStack, exclude)\n    },\n\n    updateBoundsByBranchStack(branchStack: ILeaf[], exclude?: ILeaf): void {\n        let branch: ILeaf, children: ILeaf[]\n        for (let i = branchStack.length - 1; i > -1; i--) {\n            branch = branchStack[i]\n            children = branch.children\n            for (let j = 0, len = children.length; j < len; j++) {\n                updateBounds(children[j])\n            }\n            if (exclude && exclude === branch) continue\n            updateBounds(branch)\n        }\n    },\n\n    move(branch: ILeaf, x: number, y: number): void {\n        let w: IMatrixWithBoundsData\n        const { children } = branch\n        for (let i = 0, len = children.length; i < len; i++) {\n            branch = children[i]\n            w = branch.__world\n\n            w.e += x\n            w.f += y\n            w.x += x\n            w.y += y\n\n            if (branch.isBranch) move(branch, x, y)\n        }\n    },\n\n    scale(branch: ILeaf, x: number, y: number, scaleX: number, scaleY: number, a: number, b: number): void {\n        let w: IMatrixWithBoundsScaleData\n        const { children } = branch\n        const changeScaleX = scaleX - 1\n        const changeScaleY = scaleY - 1\n\n        for (let i = 0, len = children.length; i < len; i++) {\n            branch = children[i]\n            w = branch.__world\n\n            w.a *= scaleX\n            w.d *= scaleY\n\n            if (w.b || w.c) {\n                w.b *= scaleX\n                w.c *= scaleY\n            }\n\n            if (w.e === w.x && w.f === w.y) {\n                w.x = w.e += (w.e - a) * changeScaleX + x\n                w.y = w.f += (w.f - b) * changeScaleY + y\n            } else {\n                w.e += (w.e - a) * changeScaleX + x\n                w.f += (w.f - b) * changeScaleY + y\n\n                w.x += (w.x - a) * changeScaleX + x\n                w.y += (w.y - b) * changeScaleY + y\n            }\n\n            w.width *= scaleX\n            w.height *= scaleY\n\n            w.scaleX *= scaleX\n            w.scaleY *= scaleY\n\n            if (branch.isBranch) scale(branch, x, y, scaleX, scaleY, a, b)\n        }\n    }\n}\n\nconst { pushAllChildBranch, pushAllBranchStack, updateBoundsByBranchStack, move, scale } = BranchHelper","import { IFunction } from '@leafer/interface'\n\nexport const WaitHelper = {\n    run(wait: IFunction[]): void {\n        if (wait && wait.length) {\n            const len = wait.length\n            for (let i = 0; i < len; i++) { wait[i]() }\n            wait.length === len ? wait.length = 0 : wait.splice(0, len)\n        }\n    }\n}","import { ILeaf, ILeafLayout, ILocationType, IBoundsType, IBoundsData, IMatrixData, ILayoutBoundsData, IPointData } from '@leafer/interface'\nimport { Bounds, BoundsHelper, MatrixHelper, PointHelper } from '@leafer/math'\nimport { isUndefined } from '@leafer/data'\nimport { LeafHelper } from '@leafer/helper'\nimport { Platform } from '@leafer/platform'\n\n\nconst { getRelativeWorld, updateBounds } = LeafHelper\nconst { toOuterOf, getPoints, copy } = BoundsHelper\nconst localContent = '_localContentBounds'\nconst worldContent = '_worldContentBounds', worldBox = '_worldBoxBounds', worldStroke = '_worldStrokeBounds'\n\nexport class LeafLayout implements ILeafLayout {\n\n    public leaf: ILeaf\n\n    public proxyZoom: boolean\n\n    // inner\n\n    public get contentBounds(): IBoundsData { return this._contentBounds || this.boxBounds }\n    public set contentBounds(bounds: IBoundsData) { this._contentBounds = bounds }\n    public boxBounds: IBoundsData\n    public get strokeBounds(): IBoundsData { return this._strokeBounds || this.boxBounds }\n    public get renderBounds(): IBoundsData { return this._renderBounds || this.boxBounds }\n    public set renderBounds(bounds: IBoundsData) { this._renderBounds = bounds }\n\n    public _contentBounds: IBoundsData\n    public _strokeBounds: IBoundsData\n    public _renderBounds: IBoundsData\n\n    // local\n\n    public get localContentBounds(): IBoundsData { toOuterOf(this.contentBounds, this.leaf.__localMatrix, this[localContent] || (this[localContent] = {} as IBoundsData)); return this[localContent] }\n    // localBoxBounds: IBoundsData // use leaf.__localBoxBounds\n    public get localStrokeBounds(): IBoundsData { return this._localStrokeBounds || this }\n    public get localRenderBounds(): IBoundsData { return this._localRenderBounds || this }\n\n    protected _localContentBounds?: IBoundsData\n    protected _localStrokeBounds?: IBoundsData\n    protected _localRenderBounds?: IBoundsData\n\n    // world\n\n    public get worldContentBounds(): IBoundsData { toOuterOf(this.contentBounds, this.leaf.__world, this[worldContent] || (this[worldContent] = {} as IBoundsData)); return this[worldContent] }\n    public get worldBoxBounds(): IBoundsData { toOuterOf(this.boxBounds, this.leaf.__world, this[worldBox] || (this[worldBox] = {} as IBoundsData)); return this[worldBox] }\n    public get worldStrokeBounds(): IBoundsData { toOuterOf(this.strokeBounds, this.leaf.__world, this[worldStroke] || (this[worldStroke] = {} as IBoundsData)); return this[worldStroke] }\n    // worldRenderBounds: IBoundsData // use leaf.__world\n\n    protected _worldContentBounds: IBoundsData\n    protected _worldBoxBounds: IBoundsData\n    protected _worldStrokeBounds: IBoundsData\n\n    // state\n\n    public resized: 'scale' | 'inner' | 'local'\n    public waitAutoLayout: boolean\n\n    // matrix changed\n    public matrixChanged: boolean\n    public scaleChanged: boolean\n    public rotationChanged: boolean\n\n    // bounds\n    public boundsChanged: boolean\n\n    public boxChanged: boolean\n    public strokeChanged: boolean\n    public renderChanged: boolean\n\n    public localBoxChanged: boolean\n\n    // face\n    public surfaceChanged: boolean\n    public opacityChanged: boolean\n\n    public hitCanvasChanged: boolean\n\n    public childrenSortChanged?: boolean\n    public stateStyleChanged?: boolean\n\n    // keep state\n    public affectScaleOrRotation: boolean\n    public affectRotation: boolean\n    public affectChildrenSort?: boolean\n\n    public strokeSpread: number\n    public strokeBoxSpread: number\n    public renderSpread: number\n    public renderShapeSpread: number\n\n    // temp local\n    public get a() { return 1 }\n    public get b() { return 0 }\n    public get c() { return 0 }\n    public get d() { return 1 }\n    public get e() { return this.leaf.__.x }\n    public get f() { return this.leaf.__.y }\n    public get x() { return this.e + this.boxBounds.x }\n    public get y() { return this.f + this.boxBounds.y }\n    public get width() { return this.boxBounds.width }\n    public get height() { return this.boxBounds.height }\n\n\n    constructor(leaf: ILeaf) {\n        this.leaf = leaf\n        if (this.leaf.__local) this._localRenderBounds = this._localStrokeBounds = this.leaf.__local\n        if (leaf.__world) {\n            this.boxBounds = { x: 0, y: 0, width: 0, height: 0 }\n            this.boxChange()\n            this.matrixChange()\n        }\n    }\n\n    public createLocal(): void {\n        const local = this.leaf.__local = { a: 1, b: 0, c: 0, d: 1, e: 0, f: 0, x: 0, y: 0, width: 0, height: 0 }\n        if (!this._localStrokeBounds) this._localStrokeBounds = local\n        if (!this._localRenderBounds) this._localRenderBounds = local\n    }\n\n    public update(): void {\n        const { leaf } = this, { leafer } = leaf\n        if (leaf.isApp) return updateBounds(leaf)\n        if (leafer) {\n            if (leafer.ready) leafer.watcher.changed && leafer.layouter.layout()\n            else leafer.start()\n        } else {\n            let root = leaf\n            while (root.parent && !root.parent.leafer) { root = root.parent }\n            const r = root as any\n            if (r.__fullLayouting) return // fix: 循环\n            r.__fullLayouting = true\n            Platform.layout(r)\n            delete r.__fullLayouting\n        }\n    }\n\n    public getTransform(relative: ILocationType | ILeaf = 'world'): IMatrixData {\n        this.update()\n        const { leaf } = this\n        switch (relative) {\n            case 'world':\n                return leaf.__world\n            case 'local':\n                return leaf.__localMatrix\n            case 'inner':\n                return MatrixHelper.defaultMatrix\n            case 'page':\n                relative = leaf.zoomLayer\n            default:\n                return getRelativeWorld(leaf, relative)\n        }\n    }\n\n    public getBounds(type?: IBoundsType, relative: ILocationType | ILeaf = 'world'): IBoundsData {\n        this.update()\n        switch (relative) {\n            case 'world':\n                return this.getWorldBounds(type)\n            case 'local':\n                return this.getLocalBounds(type)\n            case 'inner':\n                return this.getInnerBounds(type)\n            case 'page':\n                relative = this.leaf.zoomLayer\n            default:\n                return new Bounds(this.getInnerBounds(type)).toOuterOf(this.getTransform(relative))\n        }\n    }\n\n    public getInnerBounds(type: IBoundsType = 'box'): IBoundsData {\n        switch (type) {\n            case 'render':\n                return this.renderBounds\n            case 'content':\n                if (this.contentBounds) return this.contentBounds\n            case 'box':\n                return this.boxBounds\n            case 'stroke':\n                return this.strokeBounds\n        }\n    }\n\n    public getLocalBounds(type: IBoundsType = 'box'): IBoundsData {\n        switch (type) {\n            case 'render':\n                return this.localRenderBounds\n            case 'stroke':\n                return this.localStrokeBounds\n            case 'content':\n                if (this.contentBounds) return this.localContentBounds\n            case 'box':\n                return this.leaf.__localBoxBounds\n        }\n    }\n\n    public getWorldBounds(type: IBoundsType = 'box'): IBoundsData {\n        switch (type) {\n            case 'render':\n                return this.leaf.__world\n            case 'stroke':\n                return this.worldStrokeBounds\n            case 'content':\n                if (this.contentBounds) return this.worldContentBounds\n            case 'box':\n                return this.worldBoxBounds\n        }\n    }\n\n    public getLayoutBounds(type?: IBoundsType, relative: ILocationType | ILeaf = 'world', unscale?: boolean): ILayoutBoundsData {\n        const { leaf } = this\n        let point: IPointData, matrix: IMatrixData, layoutBounds: ILayoutBoundsData, bounds: IBoundsData = this.getInnerBounds(type)\n\n        switch (relative) {\n            case 'world':\n                point = leaf.getWorldPoint(bounds)\n                matrix = leaf.__world\n                break\n            case 'local':\n                const { scaleX, scaleY, rotation, skewX, skewY } = leaf.__\n                layoutBounds = { scaleX, scaleY, rotation, skewX, skewY } as ILayoutBoundsData // 更精准，务必保留\n                point = leaf.getLocalPointByInner(bounds)\n                break\n            case 'inner':\n                point = bounds\n                matrix = MatrixHelper.defaultMatrix\n                break\n            case 'page':\n                relative = leaf.zoomLayer\n            default:\n                point = leaf.getWorldPoint(bounds, relative)\n                matrix = getRelativeWorld(leaf, relative, true)\n        }\n\n        if (!layoutBounds) layoutBounds = MatrixHelper.getLayout(matrix) as ILayoutBoundsData\n        copy(layoutBounds, bounds)\n        PointHelper.copy(layoutBounds, point)\n\n        if (unscale) {\n            const { scaleX, scaleY } = layoutBounds\n            const uScaleX = Math.abs(scaleX)\n            const uScaleY = Math.abs(scaleY)\n            if (uScaleX !== 1 || uScaleY !== 1) {\n                layoutBounds.scaleX /= uScaleX\n                layoutBounds.scaleY /= uScaleY\n                layoutBounds.width *= uScaleX\n                layoutBounds.height *= uScaleY\n            }\n        }\n\n        return layoutBounds\n    }\n\n    public getLayoutPoints(type?: IBoundsType, relative: ILocationType | ILeaf = 'world'): IPointData[] {\n        const { leaf } = this\n        const points = getPoints(this.getInnerBounds(type))\n        let relativeLeaf: ILeaf\n        switch (relative) {\n            case 'world':\n                relativeLeaf = null\n                break\n            case 'local':\n                relativeLeaf = leaf.parent\n                break\n            case 'inner':\n                break\n            case 'page':\n                relative = leaf.zoomLayer\n            default:\n                relativeLeaf = relative\n        }\n        if (!isUndefined(relativeLeaf)) points.forEach(point => leaf.innerToWorld(point, null, false, relativeLeaf))\n        return points\n    }\n\n    // 独立 / 引用 boxBounds\n\n    public shrinkContent(): void {\n        const { x, y, width, height } = this.boxBounds\n        this._contentBounds = { x, y, width, height }\n    }\n\n    public spreadStroke(): void {\n        const { x, y, width, height } = this.strokeBounds\n        this._strokeBounds = { x, y, width, height }\n        this._localStrokeBounds = { x, y, width, height }\n        if (!this.renderSpread) this.spreadRenderCancel()\n    }\n    public spreadRender(): void {\n        const { x, y, width, height } = this.renderBounds\n        this._renderBounds = { x, y, width, height }\n        this._localRenderBounds = { x, y, width, height }\n    }\n\n    public shrinkContentCancel(): void {\n        this._contentBounds = undefined\n    }\n\n    public spreadStrokeCancel(): void {\n        const same = this.renderBounds === this.strokeBounds\n        this._strokeBounds = this.boxBounds\n        this._localStrokeBounds = this.leaf.__localBoxBounds\n        if (same) this.spreadRenderCancel()\n    }\n    public spreadRenderCancel(): void {\n        this._renderBounds = this._strokeBounds\n        this._localRenderBounds = this._localStrokeBounds\n    }\n\n\n    // bounds\n\n    public boxChange(): void {\n        this.boxChanged = true\n        this.localBoxChanged ? (this.boundsChanged || (this.boundsChanged = true)) : this.localBoxChange() // fix: boundsChanged未更新的问题\n        this.hitCanvasChanged = true\n    }\n\n    public localBoxChange(): void {\n        this.localBoxChanged = true\n        this.boundsChanged = true\n    }\n\n    public strokeChange(): void {\n        this.strokeChanged = true\n        this.strokeSpread || (this.strokeSpread = 1)\n        this.boundsChanged = true\n        this.hitCanvasChanged = true\n    }\n\n    public renderChange(): void {\n        this.renderChanged = true\n        this.renderSpread || (this.renderSpread = 1)\n        this.boundsChanged = true\n    }\n\n\n    // matrix\n\n    public scaleChange(): void {\n        this.scaleChanged = true\n        this._scaleOrRotationChange()\n    }\n\n    public rotationChange(): void {\n        this.rotationChanged = true\n        this.affectRotation = true\n        this._scaleOrRotationChange()\n    }\n\n    protected _scaleOrRotationChange() {\n        this.affectScaleOrRotation = true\n        this.matrixChange()\n        if (!this.leaf.__local) this.createLocal()\n    }\n\n    public matrixChange(): void {\n        this.matrixChanged = true\n        this.localBoxChanged ? (this.boundsChanged || (this.boundsChanged = true)) : this.localBoxChange() // fix: boundsChanged未更新的问题\n    }\n\n\n    // face\n\n    public surfaceChange(): void {\n        this.surfaceChanged = true\n    }\n\n    public opacityChange(): void {\n        this.opacityChanged = true\n        this.surfaceChanged || this.surfaceChange()\n    }\n\n    public childrenSortChange(): void {\n        if (!this.childrenSortChanged) {\n            this.childrenSortChanged = this.affectChildrenSort = true\n            this.leaf.forceUpdate('surface')\n        }\n    }\n\n    public destroy(): void { }\n\n}","import { IEvent, IEventTarget, IObject } from '@leafer/interface'\nimport { Platform } from '@leafer/platform'\n\n\nexport class Event implements IEvent {\n\n    readonly origin: IObject\n\n    readonly type: string\n    readonly target: IEventTarget\n    readonly current: IEventTarget\n\n    readonly bubbles: boolean = false\n    readonly phase: number\n\n    public isStopDefault: boolean\n    public isStop: boolean\n    public isStopNow: boolean\n\n    constructor(type: string, target?: IEventTarget) {\n        this.type = type\n        if (target) this.target = target\n    }\n\n    public stopDefault(): void {\n        this.isStopDefault = true\n        if (this.origin) Platform.event.stopDefault(this.origin)\n    }\n\n    public stopNow(): void {\n        this.isStopNow = true\n        this.isStop = true\n        if (this.origin) Platform.event.stopNow(this.origin)\n    }\n\n    public stop(): void {\n        this.isStop = true\n        if (this.origin) Platform.event.stop(this.origin)\n    }\n}","import { IChildEvent, ILeaf } from '@leafer/interface'\n\nimport { Event } from './Event'\n\n\nexport class ChildEvent extends Event implements IChildEvent {\n\n    static ADD = 'child.add'\n    static REMOVE = 'child.remove'\n\n    static CREATED = 'created'\n    static MOUNTED = 'mounted'\n    static UNMOUNTED = 'unmounted'\n    static DESTROY = 'destroy'\n\n    readonly parent?: ILeaf\n    readonly child?: ILeaf\n\n    constructor(type: string, child?: ILeaf, parent?: ILeaf) {\n        super(type, child)\n        this.parent = parent\n        this.child = child\n    }\n\n}","import { IPropertyEvent, IEventTarget, IStringMap } from '@leafer/interface'\n\nimport { Event } from './Event'\n\n\nconst SCROLL = 'property.scroll'\n\nexport class PropertyEvent extends Event implements IPropertyEvent {\n\n    static CHANGE = 'property.change'\n    static LEAFER_CHANGE = 'property.leafer_change'\n\n    static SCROLL = SCROLL\n\n    readonly attrName: string\n    readonly oldValue: unknown\n    readonly newValue: unknown\n\n    constructor(type: string, target: IEventTarget, attrName: string, oldValue: unknown, newValue: unknown) {\n        super(type, target)\n        this.attrName = attrName\n        this.oldValue = oldValue\n        this.newValue = newValue\n    }\n\n}\n\n// 额外派发的属性事件\nexport const extraPropertyEventMap: IStringMap = {\n    scrollX: SCROLL,\n    scrollY: SCROLL\n}","import { IImageEvent, IObject, ILeaferImage } from '@leafer/interface'\n\nimport { Event } from './Event'\n\nexport class ImageEvent extends Event implements IImageEvent {\n\n    static LOAD = 'image.load'\n    static LOADED = 'image.loaded'\n    static ERROR = 'image.error'\n\n    readonly image: ILeaferImage\n    readonly error: string | IObject\n\n    readonly attrName: string\n    readonly attrValue: IObject\n\n    constructor(type: string, data: IImageEvent) {\n        super(type)\n        Object.assign(this, data)\n    }\n\n}","import { IBoundsEvent, IEventTarget, ILeaf, IObject } from '@leafer/interface'\n\nimport { Event } from './Event'\n\n\nexport class BoundsEvent extends Event implements IBoundsEvent {\n\n    static RESIZE = 'bounds.resize'\n\n    static INNER = 'bounds.inner'\n\n    static LOCAL = 'bounds.local'\n\n    static WORLD = 'bounds.world'\n\n\n    static checkHas(leaf: IEventTarget, type: string, mode: 'on' | 'off') {\n        if (mode === 'on') {\n            type === WORLD ? leaf.__hasWorldEvent = true : leaf.__hasLocalEvent = true\n        } else {\n            leaf.__hasLocalEvent = leaf.hasEvent(RESIZE) || leaf.hasEvent(INNER) || leaf.hasEvent(LOCAL)\n            leaf.__hasWorldEvent = leaf.hasEvent(WORLD)\n        }\n    }\n\n    static emitLocal(leaf: ILeaf) {\n        if (leaf.leaferIsReady) {\n            const { resized } = leaf.__layout\n            if (resized !== 'local') {\n                leaf.emit(RESIZE, leaf) //  inner / scale\n                if (resized === 'inner') leaf.emit(INNER, leaf)\n            }\n            leaf.emit(LOCAL, leaf)\n        }\n    }\n\n    static emitWorld(leaf: ILeaf) {\n        if (leaf.leaferIsReady) leaf.emit(WORLD, this)\n    }\n\n}\n\nconst { RESIZE, INNER, LOCAL, WORLD } = BoundsEvent\n\n\nexport const boundsEventMap: IObject = {};\n\n[RESIZE, INNER, LOCAL, WORLD].forEach(key => boundsEventMap[key] = 1)","import { ILeaf, INumberMap, IResizeEvent, IScreenSizeData } from '@leafer/interface'\nimport { isObject, isUndefined } from '@leafer/data'\n\nimport { Event } from './Event'\n\n\nexport class ResizeEvent extends Event implements IResizeEvent {\n\n    static RESIZE: string = 'resize'\n\n    static resizingKeys: INumberMap // resize编辑中的元素 LeafList 键表\n\n    readonly width: number\n    readonly height: number\n    readonly pixelRatio: number\n\n    public get bigger(): boolean {\n        if (!this.old) return true\n        const { width, height } = this.old\n        return this.width >= width && this.height >= height\n    }\n\n    public get smaller(): boolean {\n        return !this.bigger\n    }\n\n    public get samePixelRatio(): boolean {\n        if (!this.old) return true\n        return this.pixelRatio === this.old.pixelRatio\n    }\n\n    readonly old: IScreenSizeData\n\n    constructor(size: IScreenSizeData | string, oldSize?: IScreenSizeData) {\n        if (isObject(size)) {\n            super(ResizeEvent.RESIZE)\n            Object.assign(this, size)\n        } else {\n            super(size)\n        }\n        this.old = oldSize\n    }\n\n    static isResizing(leaf: ILeaf): boolean {\n        return this.resizingKeys && !isUndefined(this.resizingKeys[leaf.innerId])\n    }\n\n}","import { IWatchEvent, IWatchEventData } from '@leafer/interface'\n\nimport { Event } from './Event'\n\n\nexport class WatchEvent extends Event implements IWatchEvent {\n\n    static REQUEST = 'watch.request'\n    static DATA = 'watch.data'\n\n    readonly data: IWatchEventData\n\n    constructor(type: string, data?: IWatchEventData) {\n        super(type)\n        this.data = data\n    }\n\n}","import { ILayoutEvent, ILayoutBlockData } from '@leafer/interface'\n\nimport { Event } from './Event'\n\n\nexport class LayoutEvent extends Event implements ILayoutEvent {\n\n    static REQUEST = 'layout.request'\n\n    static START = 'layout.start'\n\n    static BEFORE = 'layout.before'\n    static LAYOUT = 'layout'\n    static AFTER = 'layout.after'\n\n    static AGAIN = 'layout.again'\n\n    static END = 'layout.end'\n\n    readonly data: ILayoutBlockData[]\n    readonly times: number\n\n    constructor(type: string, data?: ILayoutBlockData[], times?: number) {\n        super(type)\n        if (data) {\n            this.data = data\n            this.times = times\n        }\n\n    }\n\n}","import { IBounds, IRenderEvent, IRenderOptions } from '@leafer/interface'\n\nimport { Event } from './Event'\n\n\nexport class RenderEvent extends Event implements IRenderEvent {\n\n    static REQUEST = 'render.request'\n\n    static CHILD_START = 'render.child_start' // app 专用\n    static CHILD_END = 'render.child_end'\n\n    static START = 'render.start'\n\n    static BEFORE = 'render.before'\n    static RENDER = 'render'\n    static AFTER = 'render.after'\n\n    static AGAIN = 'render.again'\n\n    static END = 'render.end'\n\n    static NEXT = 'render.next'\n\n    readonly renderBounds: IBounds\n    readonly renderOptions: IRenderOptions\n    readonly times: number\n\n    constructor(type: string, times?: number, bounds?: IBounds, options?: IRenderOptions) {\n        super(type)\n        if (times) this.times = times\n        if (bounds) {\n            this.renderBounds = bounds\n            this.renderOptions = options\n        }\n    }\n\n}","import { ILeaferEvent, IStringMap } from '@leafer/interface'\n\nimport { Event } from './Event'\n\n\nexport class LeaferEvent extends Event implements ILeaferEvent {\n\n    static START = 'leafer.start'\n\n    static BEFORE_READY = 'leafer.before_ready'\n    static READY = 'leafer.ready'\n    static AFTER_READY = 'leafer.after_ready'\n\n    static VIEW_READY = 'leafer.view_ready'\n\n    static VIEW_COMPLETED = 'leafer.view_completed'\n\n    static STOP = 'leafer.stop'\n    static RESTART = 'leafer.restart'\n\n    static END = 'leafer.end'\n\n    static UPDATE_MODE = 'leafer.update_mode'\n\n    // 变换操作\n    static TRANSFORM = 'leafer.transform'\n    static MOVE = 'leafer.move'\n    static SCALE = 'leafer.scale'\n    static ROTATE = 'leafer.rotate'\n    static SKEW = 'leafer.skew'\n}\n\n\nconst { MOVE, SCALE, ROTATE, SKEW } = LeaferEvent\n\nexport const leaferTransformAttrMap: IStringMap = {\n    x: MOVE,\n    y: MOVE,\n    scaleX: SCALE,\n    scaleY: SCALE,\n    rotation: ROTATE,\n    skewX: SKEW,\n    skewY: SKEW\n}","import { IEventListener, IEventListenerMap, IEventListenerItem, IEventListenerId, IEvent, IObject, IEventTarget, IEventOption, IEventer, IEventParamsMap, InnerId, IEventParams, IFunction } from '@leafer/interface'\nimport { EventCreator } from '@leafer/platform'\nimport { isArray, isObject, isString, isUndefined } from '@leafer/data'\n\nimport { BoundsEvent, boundsEventMap } from './BoundsEvent'\n\n\nconst empty = {}\n\n\nexport class Eventer implements IEventer {\n\n    public readonly innerId: InnerId\n\n    public __captureMap?: IEventListenerMap\n\n    public __bubbleMap?: IEventListenerMap\n\n    public __hasLocalEvent?: boolean\n    public __hasWorldEvent?: boolean\n\n    public syncEventer?: IEventer // 同步触发一样事件的元素\n\n    public set event(map: IEventParamsMap) { this.on(map) }\n\n\n    public on(type: string | string[] | IEventParams[] | IEventParamsMap, listener?: IEventListener, options?: IEventOption): void {\n\n        if (!listener) {\n            let event: IFunction | [IFunction, IEventOption]\n            if (isArray(type)) (type as IEventParams[]).forEach(item => this.on(item[0], item[1], item[2]))\n            else for (let key in type as IEventParamsMap) isArray(event = (type as IEventParamsMap)[key]) ? this.on(key, event[0], event[1]) : this.on(key, event)\n            return\n        }\n\n        let capture: boolean, once: boolean\n        if (options) {\n            if (options === 'once') {\n                once = true\n            } else if (typeof options === 'boolean') {\n                capture = options\n            } else {\n                capture = options.capture\n                once = options.once\n            }\n        }\n\n        let events: IEventListenerItem[]\n        const map = __getListenerMap(this, capture, true)\n        const typeList = isString(type) ? type.split(' ') : type as string[]\n        const item = once ? { listener, once } : { listener }\n\n        typeList.forEach(type => {\n            if (type) {\n                events = map[type]\n                if (events) {\n                    if (events.findIndex(item => item.listener === listener) === -1) events.push(item)\n                } else {\n                    map[type] = [item]\n                }\n\n                if (boundsEventMap[type]) BoundsEvent.checkHas(this, type, 'on')\n            }\n        })\n    }\n\n    public off(type?: string | string[], listener?: IEventListener, options?: IEventOption): void {\n        if (type) {\n\n            const typeList = isString(type) ? type.split(' ') : type\n\n            if (listener) {\n\n                let capture: boolean\n                if (options) capture = typeof options === 'boolean' ? options : (options === 'once' ? false : options.capture)\n\n                let events: IEventListenerItem[], index: number\n                const map = __getListenerMap(this, capture)\n\n                typeList.forEach(type => {\n                    if (type) {\n                        events = map[type]\n                        if (events) {\n                            index = events.findIndex(item => item.listener === listener)\n                            if (index > -1) events.splice(index, 1)\n                            if (!events.length) delete map[type]\n                            if (boundsEventMap[type]) BoundsEvent.checkHas(this, type, 'off')\n                        }\n                    }\n                })\n\n            } else {\n\n                // off type\n                const { __bubbleMap: b, __captureMap: c } = this\n                typeList.forEach(type => {\n                    if (b) delete b[type]\n                    if (c) delete c[type]\n                })\n\n            }\n\n        } else {\n\n            this.__bubbleMap = this.__captureMap = undefined  // off all\n\n        }\n\n    }\n\n    public on_(type: string | string[] | IEventParams[], listener?: IEventListener, bind?: IObject, options?: IEventOption): IEventListenerId {\n        if (!listener) isArray(type) && (type as IEventParams[]).forEach(item => this.on(item[0], item[2] ? item[1] = item[1].bind(item[2]) : item[1], item[3]))\n        else this.on(type, bind ? listener = listener.bind(bind) : listener, options)\n        return { type, current: this as any, listener, options }\n    }\n\n    public off_(id: IEventListenerId | IEventListenerId[]): void {\n        if (!id) return\n        const list = isArray(id) ? id : [id]\n        list.forEach(item => {\n            if (item) {\n                if (!item.listener) isArray(item.type) && (item.type as IEventParams[]).forEach(v => item.current.off(v[0], v[1], v[3]))\n                else item.current.off(item.type as string | string[], item.listener, item.options)\n            }\n        })\n        list.length = 0\n    }\n\n    public once(type: string | string[] | IEventParams[], listener?: IEventListener, captureOrBind?: boolean | IObject, capture?: boolean): void {\n        if (!listener) return isArray(type) && (type as IEventParams[]).forEach(item => this.once(item[0], item[1], item[2], item[3]))\n        if (isObject(captureOrBind)) listener = listener.bind(captureOrBind)\n        else capture = captureOrBind\n        this.on(type, listener, { once: true, capture })\n    }\n\n    public emit(type: string, event?: IEvent | IObject, capture?: boolean): void {\n        if (!event && EventCreator.has(type)) event = EventCreator.get(type, { type, target: this, current: this } as IEvent)\n\n        const map = __getListenerMap(this, capture)\n        const list = map[type]\n        if (list) {\n            let item: IEventListenerItem\n            for (let i = 0, len = list.length; i < len; i++) {\n                if (item = list[i]) { // 防止 list 变化造成的空值\n                    item.listener(event)\n                    if (item.once) {\n                        this.off(type, item.listener, capture)\n                        i--, len--\n                    }\n                    if (event && event.isStopNow) break\n                }\n            }\n        }\n\n        this.syncEventer && this.syncEventer.emitEvent(event, capture)\n    }\n\n    public emitEvent(event: IEvent, capture?: boolean): void {\n        event.current = this\n        this.emit(event.type, event, capture)\n    }\n\n    public hasEvent(type: string, capture?: boolean): boolean {\n        if (this.syncEventer && this.syncEventer.hasEvent(type, capture)) return true\n\n        const { __bubbleMap: b, __captureMap: c } = this\n        const hasB = b && b[type], hasC = c && c[type]\n        return !!(isUndefined(capture) ? (hasB || hasC) : (capture ? hasC : hasB))\n    }\n\n    public destroy(): void {\n        this.__captureMap = this.__bubbleMap = this.syncEventer = null\n    }\n}\n\n\nfunction __getListenerMap(eventer: IEventTarget, capture?: boolean, create?: boolean): IEventListenerMap {\n    if (capture) {\n\n        const { __captureMap: c } = eventer\n        if (c) {\n            return c\n        } else {\n            return create ? eventer.__captureMap = {} : empty\n        }\n\n    } else {\n\n        const { __bubbleMap: b } = eventer\n        if (b) {\n            return b\n        } else {\n            return create ? eventer.__bubbleMap = {} : empty\n        }\n\n    }\n}","import { ILeafEventerModule } from '@leafer/interface'\nimport { Eventer } from '@leafer/event'\n\nconst { on, on_, off, off_, once, emit, emitEvent, hasEvent, destroy } = Eventer.prototype\n\nexport const LeafEventer: ILeafEventerModule = { on, on_, off, off_, once, emit, emitEvent, hasEvent, destroyEventer: destroy }","import { ILeafDataProxyModule, IObject, IValue } from '@leafer/interface'\nimport { PropertyEvent, extraPropertyEventMap, LeaferEvent, leaferTransformAttrMap } from '@leafer/event'\nimport { isObject, isFinite, isUndefined } from '@leafer/data'\nimport { Debug } from '@leafer/debug'\n\n\nconst debug = Debug.get('setAttr')\n\nexport const LeafDataProxy: ILeafDataProxyModule = {\n\n    __setAttr(name: string, newValue: IValue, checkFiniteNumber?: boolean): boolean {\n        if (this.leaferIsCreated) {\n\n            const oldValue = this.__.__getInput(name)\n\n            if (checkFiniteNumber && !isFinite(newValue) && !isUndefined(newValue)) { // 警告 NaN、Infinity、-Infinity、null、非有效数字\n                debug.warn(this.innerName, name, newValue)\n                newValue = undefined // must\n            }\n\n            if (isObject(newValue) || oldValue !== newValue) {\n\n                this.__realSetAttr(name, newValue)\n\n                if (this.isLeafer) {\n                    this.emitEvent(new PropertyEvent(PropertyEvent.LEAFER_CHANGE, this, name, oldValue, newValue))\n\n                    const transformEventName = leaferTransformAttrMap[name]\n                    if (transformEventName) {\n                        this.emitEvent(new LeaferEvent(transformEventName, this))\n                        this.emitEvent(new LeaferEvent(LeaferEvent.TRANSFORM, this))\n                    }\n                }\n\n                this.emitPropertyEvent(PropertyEvent.CHANGE, name, oldValue, newValue)\n\n                const extraPropertyEvent = extraPropertyEventMap[name]\n                if (extraPropertyEvent) this.emitPropertyEvent(extraPropertyEvent, name, oldValue, newValue)\n\n                return true\n            } else {\n                return false\n            }\n\n        } else {\n\n            this.__realSetAttr(name, newValue)\n\n            return true\n\n        }\n    },\n\n    emitPropertyEvent(type: string, name: string, oldValue: unknown, newValue: unknown): void {\n        const event = new PropertyEvent(type, this, name, oldValue, newValue)\n        this.isLeafer || (this.hasEvent(type) && this.emitEvent(event))\n        this.leafer.emitEvent(event)\n    },\n\n    __realSetAttr(name: string, newValue: IValue): void {\n        const data = this.__ as IObject\n        data[name] = newValue\n        if (this.__proxyData) this.setProxyAttr(name, newValue)\n        if (data.normalStyle) this.lockNormalStyle || isUndefined(data.normalStyle[name]) || (data.normalStyle[name] = newValue)\n    },\n\n\n    __getAttr(name: string): IValue {\n        if (this.__proxyData) return this.getProxyAttr(name)\n        return this.__.__get(name)\n    }\n}","import { ILeafMatrixModule, ILayoutData } from '@leafer/interface'\nimport { AroundHelper, MatrixHelper } from '@leafer/math'\n\n\nconst { setLayout, multiplyParent, translateInner, defaultWorld } = MatrixHelper\nconst { toPoint, tempPoint } = AroundHelper\n\nexport const LeafMatrix: ILeafMatrixModule = {\n\n    __updateWorldMatrix(): void {\n\n        const { parent, __layout, __world, __scrollWorld, __ } = this\n        multiplyParent(this.__local || __layout, parent ? (parent.__scrollWorld || parent.__world) : defaultWorld, __world, !!__layout.affectScaleOrRotation, __ as ILayoutData)\n\n        if (__scrollWorld) translateInner(Object.assign(__scrollWorld, __world), __.scrollX, __.scrollY)\n    },\n\n    __updateLocalMatrix(): void {\n\n        if (this.__local) {\n\n            const layout = this.__layout, local = this.__local, data = this.__\n\n            if (layout.affectScaleOrRotation) {\n\n                if ((layout.scaleChanged && (layout.resized || (layout.resized = 'scale'))) || layout.rotationChanged) {\n                    setLayout(local, data as ILayoutData, null, null, layout.affectRotation)\n                    layout.scaleChanged = layout.rotationChanged = undefined\n                }\n\n            }\n\n            local.e = data.x + data.offsetX\n            local.f = data.y + data.offsetY\n\n            if (data.around || data.origin) {\n                toPoint(data.around || data.origin, layout.boxBounds, tempPoint)\n                translateInner(local, -tempPoint.x, -tempPoint.y, !data.around)\n            }\n\n        }\n\n        this.__layout.matrixChanged = undefined\n\n    }\n\n}\n\n\n","import { ILeafBoundsModule, IBoundsData } from '@leafer/interface'\nimport { BoundsHelper } from '@leafer/math'\nimport { PathBounds } from '@leafer/path'\nimport { BranchHelper, LeafHelper } from '@leafer/helper'\nimport { BoundsEvent } from '@leafer/event'\nimport { isNumber } from '@leafer/data'\n\n\nconst { updateMatrix, updateAllMatrix } = LeafHelper\nconst { updateBounds } = BranchHelper\nconst { toOuterOf, copyAndSpread, copy } = BoundsHelper\nconst { toBounds } = PathBounds\n\nexport const LeafBounds: ILeafBoundsModule = {\n\n    __updateWorldBounds(): void {\n\n        const { __layout, __world } = this\n        toOuterOf(__layout.renderBounds, __world, __world)\n\n        if (__layout.resized) {\n            if (__layout.resized === 'inner') this.__onUpdateSize() // scale变化不用更新\n            if (this.__hasLocalEvent) BoundsEvent.emitLocal(this)\n            __layout.resized = undefined\n        }\n\n        if (this.__hasWorldEvent) BoundsEvent.emitWorld(this)\n\n    },\n\n    __updateLocalBounds(): void {\n\n        const layout = this.__layout\n\n        if (layout.boxChanged) {\n\n            if (!this.__.__pathInputed) this.__updatePath()\n            this.__updateRenderPath()\n\n            this.__updateBoxBounds()\n            layout.resized = 'inner'\n        }\n\n\n        if (layout.localBoxChanged) { // position change\n\n            if (this.__local) this.__updateLocalBoxBounds()\n            layout.localBoxChanged = undefined\n\n            if (layout.strokeSpread) layout.strokeChanged = true\n            if (layout.renderSpread) layout.renderChanged = true\n            if (this.parent) this.parent.__layout.boxChange()\n        }\n\n\n        layout.boxChanged = undefined // must after updateLocalBoxBounds()\n\n\n        if (layout.strokeChanged) {\n\n            layout.strokeSpread = this.__updateStrokeSpread()\n\n            if (layout.strokeSpread) {\n\n                if (layout.strokeBounds === layout.boxBounds) layout.spreadStroke()\n\n                this.__updateStrokeBounds()\n                this.__updateLocalStrokeBounds()\n\n            } else {\n                layout.spreadStrokeCancel()\n            }\n\n            layout.strokeChanged = undefined\n            if (layout.renderSpread || layout.strokeSpread !== layout.strokeBoxSpread) layout.renderChanged = true\n\n            if (this.parent) this.parent.__layout.strokeChange()\n            layout.resized = 'inner'\n        }\n\n\n        if (layout.renderChanged) {\n\n            layout.renderSpread = this.__updateRenderSpread()\n\n            if (layout.renderSpread) {\n\n                if (layout.renderBounds === layout.boxBounds || layout.renderBounds === layout.strokeBounds) layout.spreadRender()\n\n                this.__updateRenderBounds()\n                this.__updateLocalRenderBounds()\n\n            } else {\n                layout.spreadRenderCancel()\n            }\n\n            layout.renderChanged = undefined\n\n            if (this.parent) this.parent.__layout.renderChange()\n        }\n\n        layout.resized || (layout.resized = 'local')\n        layout.boundsChanged = undefined\n\n    },\n\n    __updateLocalBoxBounds(): void {\n        if (this.__hasMotionPath) this.__updateMotionPath()\n        if (this.__hasAutoLayout) this.__updateAutoLayout() //  origin / around / flow\n        toOuterOf(this.__layout.boxBounds, this.__local, this.__local)\n    },\n\n    __updateLocalStrokeBounds(): void {\n        toOuterOf(this.__layout.strokeBounds, this.__localMatrix, this.__layout.localStrokeBounds)\n    },\n\n    __updateLocalRenderBounds(): void {\n        toOuterOf(this.__layout.renderBounds, this.__localMatrix, this.__layout.localRenderBounds)\n    },\n\n\n    __updateBoxBounds(_secondLayout?: boolean, _bounds?: IBoundsData): void {\n        const b = this.__layout.boxBounds\n        const data = this.__\n        if (data.__usePathBox) {\n            toBounds(data.path, b)\n        } else {\n            b.x = 0\n            b.y = 0\n            b.width = data.width\n            b.height = data.height\n        }\n    },\n\n\n    __updateAutoLayout(): void {\n        this.__layout.matrixChanged = true\n        if (this.isBranch) {\n\n            this.__extraUpdate()\n\n            if (this.__.flow) {\n\n                if (this.__layout.boxChanged) this.__updateFlowLayout()\n\n                updateAllMatrix(this)\n                updateBounds(this, this)\n\n                if (this.__.__autoSide) this.__updateBoxBounds(true)\n\n            } else {\n\n                updateAllMatrix(this)\n                updateBounds(this, this)\n\n            }\n\n        } else {\n            updateMatrix(this)\n        }\n    },\n\n    __updateNaturalSize(): void {\n        const { __: data, __layout: layout } = this\n        data.__naturalWidth = layout.boxBounds.width\n        data.__naturalHeight = layout.boxBounds.height\n    },\n\n    __updateStrokeBounds(_bounds?: IBoundsData): void {\n        const layout = this.__layout\n        copyAndSpread(layout.strokeBounds, layout.boxBounds, layout.strokeBoxSpread)\n    },\n\n    __updateRenderBounds(_bounds?: IBoundsData): void {\n        const layout = this.__layout, { renderSpread } = layout\n        isNumber(renderSpread) && renderSpread <= 0 ? copy(layout.renderBounds, layout.strokeBounds) : copyAndSpread(layout.renderBounds, layout.boxBounds, renderSpread) // Box use -1\n    }\n\n}","import { ILeaferCanvas, IRenderOptions, ILeafRenderModule } from '@leafer/interface'\nimport { LeafHelper } from '@leafer/helper'\nimport { Debug } from '@leafer/debug'\n\n\nexport const LeafRender: ILeafRenderModule = {\n\n    __render(canvas: ILeaferCanvas, options: IRenderOptions): void {\n\n        if (options.shape) return this.__renderShape(canvas, options)\n        if (options.cellList && !options.cellList.has(this)) return\n\n        if (this.__worldOpacity) {\n\n            const data = this.__\n\n            if (data.bright && !options.topRendering) return options.topList.add(this)\n\n            canvas.setWorld(this.__nowWorld = this.__getNowWorld(options))\n            canvas.opacity = options.dimOpacity && !data.dimskip ? data.opacity * options.dimOpacity : data.opacity\n\n            if (this.__.__single) {\n\n                if (data.eraser === 'path') return this.__renderEraser(canvas, options)\n\n                const tempCanvas = canvas.getSameCanvas(true, true)\n                this.__draw(tempCanvas, options, canvas)\n\n                LeafHelper.copyCanvasByWorld(this, canvas, tempCanvas, this.__nowWorld, data.__blendMode, true)\n\n                tempCanvas.recycle(this.__nowWorld)\n\n            } else {\n\n                this.__draw(canvas, options)\n\n            }\n\n            if (Debug.showBounds) Debug.drawBounds(this, canvas, options)\n\n        }\n    },\n\n    __renderShape(canvas: ILeaferCanvas, options: IRenderOptions): void {\n        if (this.__worldOpacity) {\n            canvas.setWorld(this.__nowWorld = this.__getNowWorld(options))\n\n            this.__drawShape(canvas, options)\n        }\n    },\n\n    __clip(canvas: ILeaferCanvas, options: IRenderOptions): void {\n        if (this.__worldOpacity) {\n            canvas.setWorld(this.__nowWorld = this.__getNowWorld(options))\n            this.__drawRenderPath(canvas)\n            canvas.clipUI(this)\n        }\n    },\n\n    __updateWorldOpacity(): void {\n        this.__worldOpacity = this.__.visible ? (this.parent ? this.parent.__worldOpacity * this.__.opacity : this.__.opacity) : 0\n        if (this.__layout.opacityChanged) this.__layout.opacityChanged = false\n    }\n\n}","import { ILeaferCanvas, IRenderOptions, IBranchRenderModule } from '@leafer/interface'\nimport { BoundsHelper } from '@leafer/math'\nimport { LeafBoundsHelper } from '@leafer/helper'\n\n\nconst { excludeRenderBounds } = LeafBoundsHelper, { hasSize } = BoundsHelper\n\nexport const BranchRender: IBranchRenderModule = {\n\n    __updateChange(): void {\n        const { __layout: layout } = this\n        if (layout.childrenSortChanged) {\n            this.__updateSortChildren()\n            layout.childrenSortChanged = false\n        }\n\n        this.__.__checkSingle()\n    },\n\n\n    __render(canvas: ILeaferCanvas, options: IRenderOptions): void {\n\n        const nowWorld = this.__nowWorld = this.__getNowWorld(options)\n\n        if (this.__worldOpacity && hasSize(nowWorld)) { // 无宽高时渲染 mask 会有问题\n\n            const data = this.__\n\n            if (data.__useDim) {\n                if (data.dim) options.dimOpacity = data.dim === true ? 0.2 : data.dim\n                else if (data.bright && !options.topRendering) return options.topList.add(this)\n                else if (data.dimskip) options.dimOpacity && (options.dimOpacity = 0)\n            }\n\n            if (data.__single && !this.isBranchLeaf) { // Frame / Box 不能走 single 逻辑渲染组，需用 drawAfterFill 渲染成一个整体， 关联设置 BoxData.__drawAfterFill\n\n                if (data.eraser === 'path') return this.__renderEraser(canvas, options)\n\n                const tempCanvas = canvas.getSameCanvas(false, true)\n\n                this.__renderBranch(tempCanvas, options)\n\n                canvas.opacity = options.dimOpacity ? data.opacity * options.dimOpacity : data.opacity\n                canvas.copyWorldByReset(tempCanvas, nowWorld, nowWorld, data.__blendMode, true)\n\n                tempCanvas.recycle(nowWorld)\n\n            } else {\n\n                this.__renderBranch(canvas, options)\n\n            }\n\n        }\n\n    },\n\n    __renderBranch(canvas: ILeaferCanvas, options: IRenderOptions): void {\n        if (this.__hasMask) {\n\n            this.__renderMask(canvas, options)\n\n        } else {\n\n            const { children } = this\n            for (let i = 0, len = children.length; i < len; i++) {\n                excludeRenderBounds(children[i], options) || children[i].__render(canvas, options)\n            }\n\n        }\n    },\n\n\n    __clip(canvas: ILeaferCanvas, options: IRenderOptions): void {\n        if (this.__worldOpacity) {\n            const { children } = this\n            for (let i = 0, len = children.length; i < len; i++) {\n                excludeRenderBounds(children[i], options) || children[i].__clip(canvas, options)\n            }\n        }\n    }\n}","import { ILeaferBase, ILeaf, ILeafInputData, ILeafData, ILeaferCanvas, IRenderOptions, IBoundsType, ILocationType, IMatrixWithBoundsData, ILayoutBoundsData, IValue, ILeafLayout, InnerId, IHitCanvas, IRadiusPointData, IEventListenerMap, IEventListener, IEventListenerId, IEvent, IObject, IFunction, IPointData, IBoundsData, IBranch, IFindMethod, IMatrixData, IAttrDecorator, IMatrixWithBoundsScaleData, IMatrixWithScaleData, IAlign, IJSONOptions, IEventParamsMap, IEventOption, IAxis, IMotionPathData, IUnitData, IRotationPointData, ITransition, IValueFunction, IEventParams, IScaleData, IScaleFixed, IFourNumber } from '@leafer/interface'\nimport { BoundsHelper, IncrementId, MatrixHelper, PointHelper } from '@leafer/math'\nimport { LeafData, isUndefined, DataHelper } from '@leafer/data'\nimport { LeafLayout } from '@leafer/layout'\nimport { LeafDataProxy, LeafMatrix, LeafBounds, LeafEventer, LeafRender } from '@leafer/display-module'\nimport { boundsType, useModule, defineDataProcessor } from '@leafer/decorator'\nimport { LeafHelper } from '@leafer/helper'\nimport { ChildEvent } from '@leafer/event'\nimport { ImageManager } from '@leafer/image'\nimport { Plugin } from '@leafer/debug'\n\n\nconst tempScaleData = {} as IScaleData\nconst { LEAF, create } = IncrementId\nconst { stintSet } = DataHelper\nconst { toInnerPoint, toOuterPoint, multiplyParent } = MatrixHelper\nconst { toOuterOf } = BoundsHelper\nconst { copy, move } = PointHelper\nconst { moveLocal, zoomOfLocal, rotateOfLocal, skewOfLocal, moveWorld, zoomOfWorld, rotateOfWorld, skewOfWorld, transform, transformWorld, setTransform, getFlipTransform, getLocalOrigin, getRelativeWorld, drop } = LeafHelper\n\n@useModule(LeafDataProxy)\n@useModule(LeafMatrix)\n@useModule(LeafBounds)\n@useModule(LeafEventer)\n@useModule(LeafRender)\nexport class Leaf<TInputData = ILeafInputData> implements ILeaf {\n\n    public get tag(): string { return this.__tag }\n    public set tag(_value: string) { }\n\n    public get __tag(): string { return 'Leaf' }\n\n    public readonly innerId: InnerId  // 内部唯一标识\n    public get innerName(): string { return this.__.name || this.tag + this.innerId }\n\n    public get __DataProcessor() { return LeafData }\n    public get __LayoutProcessor() { return LeafLayout }\n\n    public leafer?: ILeaferBase\n    public parent?: ILeaf\n\n    public get leaferIsCreated(): boolean { return this.leafer && this.leafer.created }\n    public get leaferIsReady(): boolean { return this.leafer && this.leafer.ready }\n\n    public get isLeafer(): boolean { return false }\n    public get isBranch(): boolean { return false }\n    public get isBranchLeaf(): boolean { return false }\n\n    public syncEventer?: ILeaf // 同步触发一样事件的元素\n    public lockNormalStyle?: boolean\n\n    public __: ILeafData\n    public __layout: ILeafLayout\n\n    public __world: IMatrixWithBoundsScaleData\n    public __local?: IMatrixWithBoundsData // and localStrokeBounds? localRenderBounds?\n\n    public __nowWorld?: IMatrixWithBoundsScaleData // use __world or __cameraWorld render\n    public __cameraWorld?: IMatrixWithBoundsScaleData // use camera matrix render  \n\n    public get __localMatrix(): IMatrixData { return this.__local || this.__layout }\n    public get __localBoxBounds(): IBoundsData { return this.__local || this.__layout }\n\n    public __worldOpacity: number\n\n    // now transform\n    public get worldTransform(): IMatrixWithScaleData { return this.__layout.getTransform('world') as IMatrixWithScaleData }\n    public get localTransform(): IMatrixData { return this.__layout.getTransform('local') }\n\n    public __scrollWorld?: IMatrixWithBoundsScaleData\n    public get scrollWorldTransform(): IMatrixWithScaleData { this.updateLayout(); return this.__scrollWorld || this.__world }\n\n    // now bounds\n    public get boxBounds(): IBoundsData { return this.getBounds('box', 'inner') }\n    public get renderBounds(): IBoundsData { return this.getBounds('render', 'inner') }\n    public get worldBoxBounds(): IBoundsData { return this.getBounds('box') }\n    public get worldStrokeBounds(): IBoundsData { return this.getBounds('stroke') }\n    public get worldRenderBounds(): IBoundsData { return this.getBounds('render') }\n\n    // now opacity\n    public get worldOpacity(): number { this.updateLayout(); return this.__worldOpacity }\n\n    public __level: number // layer level  0 -> branch -> branch -> deep\n    public __tempNumber: number // temp sort\n\n    public get __worldFlipped(): boolean { return this.__world.scaleX < 0 || this.__world.scaleY < 0 }\n\n    public __hasAutoLayout?: boolean\n    public __hasMask?: boolean\n    public __hasEraser?: boolean\n    public __hitCanvas?: IHitCanvas\n\n    public get __onlyHitMask(): boolean { return this.__hasMask && !this.__.hitChildren }\n    public get __ignoreHitWorld(): boolean { return (this.__hasMask || this.__hasEraser) && this.__.hitChildren }\n    public get __inLazyBounds(): boolean { return this.leaferIsCreated && this.leafer.lazyBounds.hit(this.__world) }\n\n    public get pathInputed(): boolean { return this.__.__pathInputed as unknown as boolean }\n\n    // event\n    public set event(map: IEventParamsMap) { this.on(map) }\n\n    public __captureMap?: IEventListenerMap\n    public __bubbleMap?: IEventListenerMap\n\n    public __hasLocalEvent?: boolean\n    public __hasWorldEvent?: boolean\n\n    // branch \n    public children?: ILeaf[]\n    public topChildren?: ILeaf[]\n\n    public destroyed: boolean\n\n\n    constructor(data?: TInputData) {\n        this.innerId = create(LEAF)\n        this.reset(data)\n        if (this.__bubbleMap) this.__emitLifeEvent(ChildEvent.CREATED)\n    }\n\n\n    public reset(data?: ILeafInputData): void {\n        if (this.leafer) this.leafer.forceRender(this.__world) // fix: add old bounds rendering\n\n        if (data as any !== 0) {  // 设为 0 时可用于 text boxStyle 节省开销\n            this.__world = { a: 1, b: 0, c: 0, d: 1, e: 0, f: 0, x: 0, y: 0, width: 0, height: 0, scaleX: 1, scaleY: 1 }\n            if (data !== null) this.__local = { a: 1, b: 0, c: 0, d: 1, e: 0, f: 0, x: 0, y: 0, width: 0, height: 0 }\n        }\n\n        this.__worldOpacity = 1\n\n        this.__ = new this.__DataProcessor(this)\n        this.__layout = new this.__LayoutProcessor(this)\n\n        if (this.__level) this.resetCustom()\n        if (data) {\n            if ((data as ILeaf).__) data = (data as ILeaf).toJSON()\n            data.children ? this.set(data) : Object.assign(this, data)\n        }\n    }\n\n    public resetCustom(): void {\n        this.__hasMask = this.__hasEraser = null\n        this.forceUpdate()\n    }\n\n\n    public waitParent(item: IFunction, bind?: IObject): void {\n        if (bind) item = item.bind(bind)\n        this.parent ? item() : this.on(ChildEvent.ADD, item, 'once')\n    }\n\n    public waitLeafer(item: IFunction, bind?: IObject): void {\n        if (bind) item = item.bind(bind)\n        this.leafer ? item() : this.on(ChildEvent.MOUNTED, item, 'once')\n    }\n\n    public nextRender(item: IFunction, bind?: IObject, off?: 'off'): void {\n        this.leafer ? this.leafer.nextRender(item, bind, off) : this.waitLeafer(() => this.leafer.nextRender(item, bind, off))\n    }\n\n    public removeNextRender(item: IFunction): void {\n        this.nextRender(item, null, 'off')\n    }\n\n    public __bindLeafer(leafer: ILeaferBase | null): void {\n        if (this.isLeafer && leafer !== null) leafer = this as unknown as ILeaferBase\n\n        if (this.leafer && !leafer) this.leafer.leafs--\n\n        this.leafer = leafer\n\n        if (leafer) {\n            leafer.leafs++\n            this.__level = this.parent ? this.parent.__level + 1 : 1\n            if ((this as ILeaf).animation) this.__runAnimation('in')\n            if (this.__bubbleMap) this.__emitLifeEvent(ChildEvent.MOUNTED)\n        } else {\n            this.__emitLifeEvent(ChildEvent.UNMOUNTED)\n        }\n\n        if (this.isBranch) {\n            const { children } = this\n            for (let i = 0, len = children.length; i < len; i++) {\n                children[i].__bindLeafer(leafer)\n            }\n        }\n    }\n\n    // data\n\n    public set(_data: IObject, _isTemp?: boolean): void { }\n\n    public get<K extends keyof this>(_name?: K | K[] | ILeafInputData): ILeafInputData | this[K] { return undefined }\n\n    public setAttr(name: string, value: any): void { (this as IObject)[name] = value }\n    public getAttr(name: string): any { return (this as IObject)[name] }\n\n    public getComputedAttr(name: string): any { return (this.__ as IObject)[name] }\n\n    public toJSON(options?: IJSONOptions): IObject {\n        if (options) this.__layout.update()\n        return this.__.__getInputData(null, options)\n    }\n\n    public toString(options?: IJSONOptions): string {\n        return JSON.stringify(this.toJSON(options))\n    }\n\n    public toSVG(): string { return undefined }\n\n    public __SVG(_data: IObject): void { }\n\n    public toHTML(): string { return undefined }\n\n    // LeafDataProxy rewrite\n\n    public __setAttr(_attrName: string, _newValue: IValue): boolean { return true }\n\n    public __getAttr(_attrName: string): IValue { return undefined }\n\n    public setProxyAttr(_attrName: string, _newValue: IValue): void { }\n\n    public getProxyAttr(_attrName: string): IValue { return undefined }\n\n    // ---\n\n\n    // find\n\n    public find(_condition: number | string | IFindMethod, _options?: any): ILeaf[] { return undefined }\n\n    public findTag(_tag: string | string[]): ILeaf[] { return undefined }\n\n    public findOne(_condition: number | string | IFindMethod, _options?: any): ILeaf | undefined { return undefined }\n\n    public findId(_id: number | string): ILeaf | undefined { return undefined }\n\n    // ---\n\n\n    // @leafer-in/state rewrite\n\n    public focus(_value?: boolean): void { }\n\n    public updateState(): void { }\n\n    // ---\n\n\n    public updateLayout(): void {\n        this.__layout.update()\n    }\n\n    public forceUpdate(attrName?: string): void {\n        if (isUndefined(attrName)) attrName = 'width'\n        else if (attrName === 'surface') attrName = 'blendMode'\n        const value = this.__.__getInput(attrName);\n        (this.__ as any)[attrName] = isUndefined(value) ? null : undefined;\n        (this as any)[attrName] = value\n    }\n\n    public forceRender(_bounds?: IBoundsData, _sync?: boolean): void {\n        this.forceUpdate('surface')\n    }\n\n    public __extraUpdate(): void {\n        if (this.leaferIsReady) this.leafer.layouter.addExtra(this) // add part 额外更新元素\n    }\n\n    // LeafMatrix rewrite\n\n    public __updateWorldMatrix(): void { }\n\n    public __updateLocalMatrix(): void { }\n\n    // ---\n\n    // LeafBounds rewrite\n\n    public __updateWorldBounds(): void { }\n\n    public __updateLocalBounds(): void { }\n\n\n    public __updateLocalBoxBounds(): void { }\n\n    public __updateLocalStrokeBounds(): void { }\n\n    public __updateLocalRenderBounds(): void { }\n\n    // box\n\n    public __updateBoxBounds(_secondLayout?: boolean, _bounds?: IBoundsData): void { }\n\n    public __updateContentBounds(): void { }\n\n    public __updateStrokeBounds(_bounds?: IBoundsData): void { }\n\n    public __updateRenderBounds(_bounds?: IBoundsData): void { }\n\n\n    public __updateAutoLayout(): void { }\n\n    public __updateFlowLayout(): void { }\n\n    public __updateNaturalSize(): void { }\n\n\n    public __updateStrokeSpread(): IFourNumber { return 0 }\n\n    public __updateRenderSpread(): IFourNumber { return 0 }\n\n    public __onUpdateSize(): void { }\n\n    // ---\n\n\n    public __updateEraser(value?: boolean): void {\n        this.__hasEraser = value ? true : this.children.some(item => item.__.eraser)\n    }\n\n    public __renderEraser(canvas: ILeaferCanvas, options: IRenderOptions): void {  // path eraser\n        canvas.save()\n        this.__clip(canvas, options)\n        const { renderBounds: r } = this.__layout\n        canvas.clearRect(r.x, r.y, r.width, r.height)\n        canvas.restore()\n    }\n\n    public __updateMask(_value?: boolean): void {\n        this.__hasMask = this.children.some(item => item.__.mask && item.__.visible && item.__.opacity)\n    }\n\n    // LeafMask rewrite\n\n    public __renderMask(_canvas: ILeaferCanvas, _options: IRenderOptions): void { }\n\n\n    // ---\n\n\n    // convert\n\n    public __getNowWorld(options: IRenderOptions): IMatrixWithBoundsScaleData {\n        if (options.matrix) {\n            if (!this.__cameraWorld) this.__cameraWorld = {} as IMatrixWithBoundsScaleData\n            const cameraWorld = this.__cameraWorld, world = this.__world\n            multiplyParent(world, options.matrix, cameraWorld, undefined, world)\n            toOuterOf(this.__layout.renderBounds, cameraWorld, cameraWorld)\n            stintSet(cameraWorld, 'half', world.half)\n            stintSet(cameraWorld, 'ignorePixelSnap', world.ignorePixelSnap)\n            return cameraWorld\n        } else {\n            return this.__world\n        }\n    }\n\n    public getClampRenderScale(): number {\n        let { scaleX } = this.__nowWorld || this.__world\n        if (scaleX < 0) scaleX = -scaleX\n        return scaleX > 1 ? scaleX : 1\n    }\n\n    public getRenderScaleData(abs?: boolean, scaleFixed?: IScaleFixed): IScaleData {\n        let { scaleX, scaleY } = ImageManager.patternLocked ? this.__world : this.__nowWorld\n        if (abs) scaleX < 0 && (scaleX = -scaleX), scaleY < 0 && (scaleY = -scaleY)\n        if (scaleFixed === true || (scaleFixed === 'zoom-in' && scaleX > 1 && scaleY > 1)) scaleX = scaleY = 1\n        tempScaleData.scaleX = scaleX\n        tempScaleData.scaleY = scaleY\n        return tempScaleData\n    }\n\n    public getTransform(relative?: ILocationType | ILeaf): IMatrixData {\n        return this.__layout.getTransform(relative || 'local')\n    }\n\n\n    public getBounds(type?: IBoundsType, relative?: ILocationType | ILeaf): IBoundsData {\n        return this.__layout.getBounds(type, relative)\n    }\n\n    public getLayoutBounds(type?: IBoundsType, relative?: ILocationType | ILeaf, unscale?: boolean): ILayoutBoundsData {\n        return this.__layout.getLayoutBounds(type, relative, unscale)\n    }\n\n    public getLayoutPoints(type?: IBoundsType, relative?: ILocationType | ILeaf): IPointData[] {\n        return this.__layout.getLayoutPoints(type, relative)\n    }\n\n\n    public getWorldBounds(inner: IBoundsData, relative?: ILeaf, change?: boolean): IBoundsData {\n        const matrix = relative ? getRelativeWorld(this, relative) : this.worldTransform\n        const to = change ? inner : {} as IBoundsData\n        toOuterOf(inner, matrix, to)\n        return to\n    }\n\n\n    public worldToLocal(world: IPointData, to?: IPointData, distance?: boolean, relative?: ILeaf): void {\n        if (this.parent) {\n            this.parent.worldToInner(world, to, distance, relative)\n        } else {\n            if (to) copy(to, world)\n        }\n    }\n\n    public localToWorld(local: IPointData, to?: IPointData, distance?: boolean, relative?: ILeaf): void {\n        if (this.parent) {\n            this.parent.innerToWorld(local, to, distance, relative)\n        } else {\n            if (to) copy(to, local)\n        }\n    }\n\n    public worldToInner(world: IPointData, to?: IPointData, distance?: boolean, relative?: ILeaf): void {\n        if (relative) {\n            relative.innerToWorld(world, to, distance)\n            world = to ? to : world\n        }\n        toInnerPoint(this.scrollWorldTransform, world, to, distance)\n    }\n\n    public innerToWorld(inner: IPointData, to?: IPointData, distance?: boolean, relative?: ILeaf): void {\n        toOuterPoint(this.scrollWorldTransform, inner, to, distance)\n        if (relative) relative.worldToInner(to ? to : inner, null, distance)\n    }\n\n    // simple\n\n    public getBoxPoint(world: IPointData, relative?: ILeaf, distance?: boolean, change?: boolean): IPointData {\n        return this.getBoxPointByInner(this.getInnerPoint(world, relative, distance, change), null, null, true)\n    }\n\n    public getBoxPointByInner(inner: IPointData, _relative?: ILeaf, _distance?: boolean, change?: boolean): IPointData {\n        const point = change ? inner : { ...inner } as IPointData, { x, y } = this.boxBounds\n        move(point, -x, -y)\n        return point\n    }\n\n    public getInnerPoint(world: IPointData, relative?: ILeaf, distance?: boolean, change?: boolean): IPointData {\n        const point = change ? world : {} as IPointData\n        this.worldToInner(world, point, distance, relative)\n        return point\n    }\n\n    public getInnerPointByBox(box: IPointData, _relative?: ILeaf, _distance?: boolean, change?: boolean): IPointData {\n        const point = change ? box : { ...box } as IPointData, { x, y } = this.boxBounds\n        move(point, x, y)\n        return point\n    }\n\n    public getInnerPointByLocal(local: IPointData, _relative?: ILeaf, distance?: boolean, change?: boolean): IPointData {\n        return this.getInnerPoint(local, this.parent, distance, change)\n    }\n\n    public getLocalPoint(world: IPointData, relative?: ILeaf, distance?: boolean, change?: boolean): IPointData {\n        const point = change ? world : {} as IPointData\n        this.worldToLocal(world, point, distance, relative)\n        return point\n    }\n\n    public getLocalPointByInner(inner: IPointData, _relative?: ILeaf, distance?: boolean, change?: boolean): IPointData {\n        return this.getWorldPoint(inner, this.parent, distance, change)\n    }\n\n    public getPagePoint(world: IPointData, relative?: ILeaf, distance?: boolean, change?: boolean): IPointData {\n        const layer = this.leafer ? this.leafer.zoomLayer : this\n        return layer.getInnerPoint(world, relative, distance, change)\n    }\n\n    public getWorldPoint(inner: IPointData, relative?: ILeaf, distance?: boolean, change?: boolean): IPointData {\n        const point = change ? inner : {} as IPointData\n        this.innerToWorld(inner, point, distance, relative)\n        return point\n    }\n\n    public getWorldPointByBox(box: IPointData, relative?: ILeaf, distance?: boolean, change?: boolean): IPointData {\n        return this.getWorldPoint(this.getInnerPointByBox(box, null, null, change), relative, distance, true)\n    }\n\n    public getWorldPointByLocal(local: IPointData, relative?: ILeaf, distance?: boolean, change?: boolean): IPointData {\n        const point = change ? local : {} as IPointData\n        this.localToWorld(local, point, distance, relative)\n        return point\n    }\n\n    public getWorldPointByPage(page: IPointData, relative?: ILeaf, distance?: boolean, change?: boolean): IPointData {\n        const layer = this.leafer ? this.leafer.zoomLayer : this\n        return layer.getWorldPoint(page, relative, distance, change)\n    }\n\n\n    // transform \n\n    public setTransform(matrix: IMatrixData, resize?: boolean, transition?: ITransition): void {\n        setTransform(this, matrix, resize, transition)\n    }\n\n    public transform(matrix: IMatrixData, resize?: boolean, transition?: ITransition): void {\n        transform(this, matrix, resize, transition)\n    }\n\n    public move(x: number | IPointData, y?: number, transition?: ITransition): void {\n        moveLocal(this, x, y, transition)\n    }\n\n\n    public moveInner(x: number | IPointData, y?: number, transition?: ITransition): void {\n        moveWorld(this, x, y, true, transition)\n    }\n\n    public scaleOf(origin: IPointData | IAlign, scaleX: number, scaleY?: number | ITransition, resize?: boolean, transition?: ITransition): void {\n        zoomOfLocal(this, getLocalOrigin(this, origin), scaleX, scaleY, resize, transition)\n    }\n\n    public rotateOf(origin: IPointData | IAlign, rotation: number, transition?: ITransition): void {\n        rotateOfLocal(this, getLocalOrigin(this, origin), rotation, transition)\n    }\n\n    public skewOf(origin: IPointData | IAlign, skewX: number, skewY?: number, resize?: boolean, transition?: ITransition): void {\n        skewOfLocal(this, getLocalOrigin(this, origin), skewX, skewY, resize, transition)\n    }\n\n\n    public transformWorld(worldTransform?: IMatrixData, resize?: boolean, transition?: ITransition): void {\n        transformWorld(this, worldTransform, resize, transition)\n    }\n\n    public moveWorld(x: number | IPointData, y?: number, transition?: ITransition): void {\n        moveWorld(this, x, y, false, transition)\n    }\n\n    public scaleOfWorld(worldOrigin: IPointData, scaleX: number, scaleY?: number | ITransition, resize?: boolean, transition?: ITransition): void {\n        zoomOfWorld(this, worldOrigin, scaleX, scaleY, resize, transition)\n    }\n\n    public rotateOfWorld(worldOrigin: IPointData, rotation: number): void {\n        rotateOfWorld(this, worldOrigin, rotation)\n    }\n\n    public skewOfWorld(worldOrigin: IPointData, skewX: number, skewY?: number, resize?: boolean, transition?: ITransition): void {\n        skewOfWorld(this, worldOrigin, skewX, skewY, resize, transition)\n    }\n\n    public flip(axis: IAxis, transition?: ITransition): void {\n        transform(this, getFlipTransform(this, axis), false, transition)\n    }\n\n\n    // @leafer-in/resize rewrite\n\n    public scaleResize(scaleX: number, scaleY = scaleX, _noResize?: boolean): void {\n        (this as ILeaf).scaleX *= scaleX;\n        (this as ILeaf).scaleY *= scaleY\n    }\n\n    public __scaleResize(_scaleX: number, _scaleY: number): void { }\n\n\n    public resizeWidth(_width: number): void { }\n\n    public resizeHeight(_height: number): void { }\n\n\n    // @leafer-ui/hit LeafHit rewrite\n\n    public hit(_world: IPointData, _hitRadius?: number): boolean { return true }\n\n    public __hitWorld(_point: IRadiusPointData, _forceHitFill?: boolean): boolean { return true }\n\n    public __hit(_local: IRadiusPointData, _forceHitFill?: boolean): boolean { return true }\n\n    public __hitFill(_inner: IRadiusPointData): boolean { return true }\n\n    public __hitStroke(_inner: IRadiusPointData, _strokeWidth: number): boolean { return true }\n\n    public __hitPixel(_inner: IRadiusPointData): boolean { return true }\n\n    public __drawHitPath(_canvas: ILeaferCanvas): void { }\n\n    public __updateHitCanvas(): void { }\n\n    // ---\n\n\n    // LeafRender rewrite\n\n    public __render(_canvas: ILeaferCanvas, _options: IRenderOptions): void { }\n\n    public __drawFast(_canvas: ILeaferCanvas, _options: IRenderOptions): void { }\n\n    public __draw(_canvas: ILeaferCanvas, _options: IRenderOptions, _originCanvas?: ILeaferCanvas): void { }\n\n\n    public __clip(_canvas: ILeaferCanvas, _options: IRenderOptions): void { }\n\n    public __renderShape(_canvas: ILeaferCanvas, _options: IRenderOptions): void { }\n\n    public __drawShape(_canvas: ILeaferCanvas, _options: IRenderOptions): void { }\n\n\n    public __updateWorldOpacity(): void { }\n\n    public __updateChange(): void { }\n\n    // ---\n\n\n    // path\n\n    public __drawPath(_canvas: ILeaferCanvas): void { }\n\n    public __drawRenderPath(_canvas: ILeaferCanvas): void { }\n\n    public __updatePath(): void { }\n\n    public __updateRenderPath(): void { }\n\n    // ---\n\n\n    // @leafer-in/motion-path rewrite\n\n    public getMotionPathData(): IMotionPathData {\n        return Plugin.need('path')\n    }\n\n    public getMotionPoint(_motionDistance: number | IUnitData): IRotationPointData {\n        return Plugin.need('path')\n    }\n\n    public getMotionTotal(): number {\n        return 0\n    }\n\n    public __updateMotionPath(): void { }\n\n    // ---\n\n\n    // @leafer-in/animate rewrite\n    public __runAnimation(_type: 'in' | 'out', _complete?: IFunction): void { }\n\n\n    // Branch rewrite\n\n    public __updateSortChildren(): void { }\n\n    public add(_child: ILeaf | ILeaf[] | ILeafInputData | ILeafInputData[], _index?: number): void { }\n\n    public remove(_child?: ILeaf | number | string | IFindMethod, destroy?: boolean): void {\n        if (this.parent) this.parent.remove(this, destroy)\n    }\n\n    public dropTo(parent: ILeaf, index?: number, resize?: boolean): void {\n        drop(this, parent, index, resize)\n    }\n\n    // ---\n\n\n    // LeafEventer rewrite\n\n    public on(_type: string | string[] | IEventParams[] | IEventParamsMap, _listener?: IEventListener, _options?: IEventOption): void { }\n\n    public off(_type?: string | string[], _listener?: IEventListener, _options?: IEventOption): void { }\n\n    public on_(_type: string | string[] | IEventParams[], _listener?: IEventListener, _bind?: IObject, _options?: IEventOption): IEventListenerId { return undefined }\n\n    public off_(_id: IEventListenerId | IEventListenerId[]): void { }\n\n    public once(_type: string | string[] | IEventParams[], _listener?: IEventListener, _captureOrBind?: boolean | IObject, _capture?: boolean): void { }\n\n    public emit(_type: string, _event?: IEvent | IObject, _capture?: boolean): void { }\n\n    public emitEvent(_event?: IEvent, _capture?: boolean): void { }\n\n    public hasEvent(_type: string, _capture?: boolean): boolean { return false }\n\n    // ---\n\n    static changeAttr(attrName: string, defaultValue: IValue | IValueFunction, fn?: IAttrDecorator): void {\n        fn ? this.addAttr(attrName, defaultValue, fn) : defineDataProcessor(this.prototype, attrName, defaultValue)\n    }\n\n    static addAttr(attrName: string, defaultValue: IValue | IValueFunction, fn?: IAttrDecorator, helpValue?: IValue): void {\n        if (!fn) fn = boundsType\n        fn(defaultValue, helpValue)(this.prototype, attrName)\n    }\n\n\n    public __emitLifeEvent(type: string): void {\n        if (this.hasEvent(type)) this.emitEvent(new ChildEvent(type, this, this.parent))\n    }\n\n\n    public destroy(): void {\n        if (!this.destroyed) {\n            if (this.parent) this.remove()\n            if (this.children) (this as unknown as IBranch).clear()\n\n            this.__emitLifeEvent(ChildEvent.DESTROY)\n\n            this.__.destroy()\n            this.__layout.destroy();\n\n            (this as ILeaf).destroyEventer()\n            this.destroyed = true\n        }\n    }\n\n}\n","import { IBoundsData, IFourNumber, ILeaf } from '@leafer/interface'\nimport { ChildEvent } from '@leafer/event'\nimport { BoundsHelper } from '@leafer/math'\nimport { BranchHelper, LeafBoundsHelper } from '@leafer/helper'\nimport { useModule } from '@leafer/decorator'\nimport { BranchRender } from '@leafer/display-module'\nimport { UICreator } from '@leafer/platform'\nimport { isArray, isUndefined } from '@leafer/data'\nimport { Debug } from '@leafer/debug'\n\nimport { Leaf } from './Leaf'\n\n\nconst { setListWithFn } = BoundsHelper\nconst { sort } = BranchHelper\nconst { localBoxBounds, localStrokeBounds, localRenderBounds, maskLocalBoxBounds, maskLocalStrokeBounds, maskLocalRenderBounds } = LeafBoundsHelper\nconst debug = new Debug('Branch')\n\n@useModule(BranchRender)\nexport class Branch extends Leaf { // tip: rewrited Group\n\n    // overwrite\n\n    public __updateStrokeSpread(): IFourNumber {\n        const { children } = this\n        for (let i = 0, len = children.length; i < len; i++) {\n            if (children[i].__layout.strokeSpread) return 1\n        }\n        return 0\n    }\n\n    public __updateRenderSpread(): IFourNumber {\n        const { children } = this\n        for (let i = 0, len = children.length; i < len; i++) {\n            if (children[i].__layout.renderSpread) return 1\n        }\n        return 0\n    }\n\n    public __updateBoxBounds(_secondLayout?: boolean, bounds?: IBoundsData): void {\n        setListWithFn(bounds || this.__layout.boxBounds, this.children, this.__hasMask ? maskLocalBoxBounds : localBoxBounds)\n    }\n\n    public __updateStrokeBounds(bounds?: IBoundsData): void {\n        setListWithFn(bounds || this.__layout.strokeBounds, this.children, this.__hasMask ? maskLocalStrokeBounds : localStrokeBounds)\n    }\n\n    public __updateRenderBounds(bounds?: IBoundsData): void {\n        setListWithFn(bounds || this.__layout.renderBounds, this.children, this.__hasMask ? maskLocalRenderBounds : localRenderBounds)\n    }\n\n\n    // own\n\n    public __updateSortChildren(): void {\n        let affectSort: boolean\n        const { children } = this\n        if (children.length > 1) {\n            for (let i = 0, len = children.length; i < len; i++) {\n                children[i].__tempNumber = i\n                if (children[i].__.zIndex) affectSort = true\n            }\n            children.sort(sort)\n            this.__layout.affectChildrenSort = affectSort\n        }\n    }\n\n    public add(child: ILeaf, index?: number): void {\n        if (child === this || child.destroyed) return debug.warn('add self or destroyed')\n\n        const noIndex = isUndefined(index)\n        if (!child.__) {\n            if (isArray(child)) return child.forEach(item => { this.add(item, index); noIndex || index++ }) // add []\n            else child = UICreator.get(child.tag, child) // add JSON\n        }\n\n        if (child.parent) child.parent.remove(child)\n        child.parent = this\n\n        noIndex ? this.children.push(child) : this.children.splice(index, 0, child)\n        if (child.isBranch) this.__.__childBranchNumber = (this.__.__childBranchNumber || 0) + 1\n\n        const childLayout = child.__layout\n        childLayout.boxChanged || childLayout.boxChange() // layouted(removed), need update\n        childLayout.matrixChanged || childLayout.matrixChange() // layouted(removed), need update\n\n        if (child.__bubbleMap) child.__emitLifeEvent(ChildEvent.ADD)\n\n        if (this.leafer) {\n            child.__bindLeafer(this.leafer)\n            if (this.leafer.created) this.__emitChildEvent(ChildEvent.ADD, child)\n        }\n\n        this.__layout.affectChildrenSort && this.__layout.childrenSortChange()\n    }\n\n    public addMany(...children: ILeaf[]): void { this.add(children as any) }\n\n    public remove(child?: ILeaf, destroy?: boolean): void {\n        if (child) {\n\n            if (child.__) {\n\n                if ((child as ILeaf).animationOut) child.__runAnimation('out', () => this.__remove(child, destroy))\n                else this.__remove(child, destroy)\n\n            } else this.find(child as any).forEach(item => this.remove(item, destroy)) // \n\n        } else if (isUndefined(child)) {\n            super.remove(null, destroy)\n        }\n    }\n\n    public removeAll(destroy?: boolean): void {\n        const { children } = this\n        if (children.length) {\n            this.children = []\n            this.__preRemove()\n            this.__.__childBranchNumber = 0\n            children.forEach(child => {\n                this.__realRemoveChild(child)\n                if (destroy) child.destroy()\n            })\n        }\n    }\n\n    public clear(): void {\n        this.removeAll(true)\n    }\n\n    protected __remove(child?: ILeaf, destroy?: boolean): void {\n        const index = this.children.indexOf(child)\n        if (index > -1) {\n            this.children.splice(index, 1)\n            if (child.isBranch) this.__.__childBranchNumber = (this.__.__childBranchNumber || 1) - 1\n            this.__preRemove()\n            this.__realRemoveChild(child)\n            if (destroy) child.destroy()\n        }\n    }\n\n    protected __preRemove(): void {\n        if (this.__hasMask) this.__updateMask()\n        if (this.__hasEraser) this.__updateEraser()\n        this.__layout.boxChange()\n        this.__layout.affectChildrenSort && this.__layout.childrenSortChange()\n    }\n\n    protected __realRemoveChild(child: ILeaf): void {\n        child.__emitLifeEvent(ChildEvent.REMOVE)\n        child.parent = null\n        if (this.leafer) {\n            child.__bindLeafer(null)\n            if (this.leafer.created) {\n                this.__emitChildEvent(ChildEvent.REMOVE, child)\n                if (this.leafer.hitCanvasManager) this.leafer.hitCanvasManager.clear()\n            }\n        }\n    }\n\n    protected __emitChildEvent(type: string, child: ILeaf): void {\n        const event = new ChildEvent(type, child, this)\n        if (this.hasEvent(type) && !this.isLeafer) this.emitEvent(event)\n        this.leafer.emitEvent(event)\n    }\n\n}","import { ILeaf, ILeafList, ILeafListItemCallback, INumberMap } from '@leafer/interface'\nimport { isArray, isUndefined } from '@leafer/data'\n\nexport class LeafList implements ILeafList {\n\n    public list: ILeaf[]\n    public keys: INumberMap\n\n    public get length(): number { return this.list.length }\n\n    constructor(item?: ILeaf | ILeaf[]) {\n        this.reset()\n        if (item) isArray(item) ? this.addList(item) : this.add(item)\n    }\n\n    public has(leaf: ILeaf): boolean {\n        return leaf && !isUndefined(this.keys[leaf.innerId])\n    }\n\n    public indexAt(index: number): ILeaf {\n        return this.list[index]\n    }\n\n    public indexOf(leaf: ILeaf): number {\n        const index = this.keys[leaf.innerId]\n        return isUndefined(index) ? -1 : index\n    }\n\n\n    public add(leaf: ILeaf): void {\n        const { list, keys } = this\n        if (isUndefined(keys[leaf.innerId])) {\n            list.push(leaf)\n            keys[leaf.innerId] = list.length - 1\n        }\n    }\n\n    public addAt(leaf: ILeaf, index = 0): void {\n        const { keys } = this\n        if (isUndefined(keys[leaf.innerId])) {\n            const { list } = this\n            for (let i = index, len = list.length; i < len; i++)  keys[list[i].innerId]++\n            if (index === 0) {\n                list.unshift(leaf)\n            } else {\n                if (index > list.length) index = list.length\n                list.splice(index, 0, leaf)\n            }\n            keys[leaf.innerId] = index\n        }\n    }\n\n    public addList(list: ILeaf[]): void {\n        for (let i = 0; i < list.length; i++) this.add(list[i])\n    }\n\n\n    public remove(leaf: ILeaf): void {\n        const { list } = this\n        let findIndex: number\n        for (let i = 0, len = list.length; i < len; i++) {\n            if (!isUndefined(findIndex)) {\n                this.keys[list[i].innerId] = i - 1 // update rest keys\n            } else if (list[i].innerId === leaf.innerId) {\n                findIndex = i\n                delete this.keys[leaf.innerId]\n            }\n        }\n\n        if (!isUndefined(findIndex)) list.splice(findIndex, 1)\n    }\n\n\n    public sort(reverse?: boolean): void {\n        const { list } = this\n        if (reverse) {\n            list.sort((a, b) => b.__level - a.__level) // 倒序\n        } else {\n            list.sort((a, b) => a.__level - b.__level) // 顺序\n        }\n    }\n\n    public forEach(itemCallback: ILeafListItemCallback): void {\n        this.list.forEach(itemCallback)\n    }\n\n    public clone(): ILeafList {\n        const list = new LeafList()\n        list.list = [...this.list]\n        list.keys = { ...this.keys }\n        return list\n    }\n\n\n    public update(): void {\n        this.keys = {}\n        const { list, keys } = this\n        for (let i = 0, len = list.length; i < len; i++)    keys[list[i].innerId] = i\n    }\n\n    public reset(): void {\n        this.list = []\n        this.keys = {}\n    }\n\n    public destroy(): void {\n        this.reset()\n    }\n}\n","import { ILeaf, ILeafArrayMap, ILeafLevelList, ILeafListItemCallback, INumberMap } from '@leafer/interface'\nimport { isArray, isUndefined } from '@leafer/data'\n\nexport class LeafLevelList implements ILeafLevelList {\n\n    public levelMap: ILeafArrayMap\n    public keys: INumberMap\n    public levels: number[]\n\n    public get length(): number { return this._length }\n    private _length = 0\n\n    constructor(item?: ILeaf | ILeaf[]) {\n        this.reset()\n        if (item) isArray(item) ? this.addList(item) : this.add(item)\n    }\n\n    public has(leaf: ILeaf): boolean {\n        return !isUndefined(this.keys[leaf.innerId])\n    }\n\n    public without(leaf: ILeaf): boolean {\n        return isUndefined(this.keys[leaf.innerId])\n    }\n\n    public sort(reverse?: boolean): void {\n        const { levels } = this\n        if (reverse) {\n            levels.sort((a, b) => b - a) // 倒序\n        } else {\n            levels.sort((a, b) => a - b) // 顺序\n        }\n    }\n\n    public addList(list: ILeaf[]): void {\n        list.forEach(leaf => { this.add(leaf) })\n    }\n\n    public add(leaf: ILeaf): void {\n        const { keys, levelMap } = this\n        if (!keys[leaf.innerId]) {\n            keys[leaf.innerId] = 1\n            if (!levelMap[leaf.__level]) {\n                levelMap[leaf.__level] = [leaf]\n                this.levels.push(leaf.__level)\n            } else {\n                levelMap[leaf.__level].push(leaf)\n            }\n            this._length++\n        }\n    }\n\n    public forEach(itemCallback: ILeafListItemCallback): void {\n        let list: ILeaf[]\n        this.levels.forEach(level => {\n            list = this.levelMap[level]\n            for (let i = 0, len = list.length; i < len; i++) {\n                itemCallback(list[i])\n            }\n        })\n    }\n\n    public reset(): void {\n        this.levelMap = {}\n        this.keys = {}\n        this.levels = []\n        this._length = 0\n    }\n\n    public destroy(): void {\n        this.levelMap = null\n    }\n\n}","export * from '@leafer/canvas'\nexport * from '@leafer/image'\n\nexport * from '@leafer/data'\nexport * from '@leafer/debug'\nexport * from '@leafer/decorator'\nexport * from '@leafer/display'\nexport * from '@leafer/display-module'\n\nexport * from '@leafer/event'\n\nexport * from '@leafer/file'\nexport * from '@leafer/helper'\nexport * from '@leafer/layout'\nexport * from '@leafer/list'\nexport * from '@leafer/math'\n\nexport * from '@leafer/path'\nexport * from '@leafer/platform'\n\nexport * from '@leafer/task'\n\nexport const version = \"2.0.0\"","import { IAutoBounds, ISizeData, IScreenSizeData, IResizeEventListener, IFunction } from '@leafer/interface'\nimport { LeaferCanvasBase, canvasSizeAttrs, ResizeEvent, DataHelper, Platform, Debug, isString, isUndefined } from '@leafer/core'\n\n\nconst debug = Debug.get('LeaferCanvas')\n\nexport class LeaferCanvas extends LeaferCanvasBase {\n\n    declare public view: HTMLCanvasElement\n    declare public parentView: HTMLElement\n\n    public set zIndex(zIndex: number) {\n        const { style } = this.view\n        style.zIndex = zIndex as unknown as string\n        this.setAbsolute(this.view)\n    }\n\n    public set childIndex(index: number) {\n        const { view, parentView } = this\n        if (view && parentView) {\n            const beforeNode = parentView.children[index]\n            if (beforeNode) {\n                this.setAbsolute(beforeNode as HTMLCanvasElement)\n                parentView.insertBefore(view, beforeNode)\n            } else {\n                parentView.appendChild(beforeNode)\n            }\n        }\n    }\n\n    protected resizeObserver: ResizeObserver\n    protected autoBounds: IAutoBounds\n    protected resizeListener: IResizeEventListener\n    protected windowListener: IFunction\n\n    public init(): void {\n        const { config } = this\n        const view = config.view || config.canvas\n\n        view ? this.__createViewFrom(view) : this.__createView()\n        const { style } = this.view\n        style.display || (style.display = 'block')\n        this.parentView = this.view.parentElement\n\n        if (this.parentView) {\n            const pStyle = this.parentView.style\n            pStyle.webkitUserSelect = pStyle.userSelect = 'none' // fix safari: use webkitUserSelect\n            this.view.classList.add('leafer-canvas-view')\n        }\n\n        if (Platform.syncDomFont && !this.parentView) { // fix: firefox default font\n            style.display = 'none'\n            if (document.body) document.body.appendChild(this.view)\n        }\n\n        this.__createContext()\n\n        if (!this.autoLayout) this.resize(config as IScreenSizeData)\n    }\n\n    public set backgroundColor(color: string) { this.view.style.backgroundColor = color }\n    public get backgroundColor(): string { return this.view.style.backgroundColor }\n\n    public set hittable(hittable: boolean) { this.view.style.pointerEvents = hittable ? 'auto' : 'none' }\n    public get hittable() { return this.view.style.pointerEvents !== 'none' }\n\n    protected __createView(): void {\n        this.view = document.createElement('canvas')\n    }\n\n    protected __createViewFrom(inputView: string | object): void {\n        let find: unknown = isString(inputView) ? document.getElementById(inputView) : inputView as HTMLElement\n        if (find) {\n            if (find instanceof HTMLCanvasElement) {\n\n                this.view = find\n\n            } else {\n\n                let parent = find as HTMLDivElement\n                if (find === window || find === document) {\n                    const div = document.createElement('div')\n                    const { style } = div\n                    style.position = 'absolute'\n                    style.top = style.bottom = style.left = style.right = '0px'\n                    document.body.appendChild(div)\n                    parent = div\n                }\n\n                this.__createView()\n                const view = this.view\n\n                if (parent.hasChildNodes()) {\n                    this.setAbsolute(view)\n                    parent.style.position || (parent.style.position = 'relative')\n                }\n\n                parent.appendChild(view)\n            }\n        } else {\n            debug.error(`no id: ${inputView}`)\n            this.__createView()\n        }\n    }\n\n    protected setAbsolute(view: HTMLCanvasElement): void {\n        const { style } = view\n        style.position = 'absolute'\n        style.top = style.left = '0px'\n    }\n\n    public updateViewSize(): void {\n        const { width, height, pixelRatio } = this\n        const { style } = this.view\n\n        style.width = width + 'px'\n        style.height = height + 'px'\n\n        if (!this.unreal) {\n            this.view.width = Math.ceil(width * pixelRatio)\n            this.view.height = Math.ceil(height * pixelRatio)\n        }\n    }\n\n\n    public updateClientBounds(): void {\n        if (this.view.parentElement) this.clientBounds = this.view.getBoundingClientRect()\n    }\n\n    public startAutoLayout(autoBounds: IAutoBounds, listener: IResizeEventListener): void {\n        this.resizeListener = listener\n\n        if (autoBounds) {  // check auto layout\n\n            this.autoBounds = autoBounds\n\n            if (this.resizeObserver) return\n\n            try {\n\n                this.resizeObserver = new ResizeObserver((entries) => {\n                    this.updateClientBounds()\n                    for (const entry of entries) this.checkAutoBounds(entry.contentRect)\n                })\n\n                const parent = this.parentView\n                if (parent) {\n                    this.resizeObserver.observe(parent)\n                    this.checkAutoBounds(parent.getBoundingClientRect())\n                } else {\n                    this.checkAutoBounds(this.view)\n                    debug.warn('no parent')\n                }\n\n            } catch {\n\n                this.imitateResizeObserver()\n\n            }\n\n            this.stopListenPixelRatio()\n\n        } else {\n\n            this.listenPixelRatio()\n            if (this.unreal) this.updateViewSize() // must update\n\n        }\n\n    }\n\n    protected imitateResizeObserver(): void {\n        if (this.autoLayout) {\n            if (this.parentView) this.checkAutoBounds(this.parentView.getBoundingClientRect())\n            Platform.requestRender(this.imitateResizeObserver.bind(this))\n        }\n    }\n\n    // check devicePixelRatio change\n\n    protected listenPixelRatio() {\n        if (!this.windowListener) window.addEventListener('resize', this.windowListener = () => {\n            const pixelRatio = Platform.devicePixelRatio\n            if (!this.config.pixelRatio && this.pixelRatio !== pixelRatio) {\n                const { width, height } = this\n                this.emitResize({ width, height, pixelRatio })\n            }\n        })\n    }\n\n    protected stopListenPixelRatio() {\n        if (this.windowListener) {\n            window.removeEventListener('resize', this.windowListener)\n            this.windowListener = null\n        }\n    }\n\n    protected checkAutoBounds(parentSize: ISizeData): void {\n        const view = this.view\n        const { x, y, width, height } = this.autoBounds.getBoundsFrom(parentSize)\n        const size = { width, height, pixelRatio: this.config.pixelRatio ? this.pixelRatio : Platform.devicePixelRatio } as IScreenSizeData\n        if (!this.isSameSize(size)) {\n            const { style } = view\n            style.marginLeft = x + 'px'\n            style.marginTop = y + 'px'\n            this.emitResize(size)\n        }\n    }\n\n    public stopAutoLayout(): void {\n        this.autoLayout = false\n        if (this.resizeObserver) this.resizeObserver.disconnect()\n        this.resizeListener = this.resizeObserver = null\n    }\n\n    protected emitResize(size: IScreenSizeData): void {\n        const oldSize = {} as IScreenSizeData\n        DataHelper.copyAttrs(oldSize, this, canvasSizeAttrs)\n        this.resize(size)\n        if (this.resizeListener && !isUndefined(this.width)) this.resizeListener(new ResizeEvent(size, oldSize))\n    }\n\n\n    public unrealCanvas(): void { // App needs to use\n        if (!this.unreal && this.parentView) { // canvas 替换成 div, 方便放入子canvas\n            let view = this.view\n            if (view) view.remove()\n\n            view = this.view = document.createElement('div') as any\n            this.parentView.appendChild(this.view)\n            view.classList.add('leafer-app-view')\n\n            this.unreal = true\n        }\n    }\n\n    public destroy(): void {\n        const { view } = this\n        if (view) {\n            this.stopAutoLayout()\n            this.stopListenPixelRatio()\n            if (view.parentElement) view.remove()\n            super.destroy()\n        }\n    }\n\n}","import { canvasPatch } from '@leafer/core'\n\nexport { LeaferCanvas } from './LeaferCanvas'\n\ncanvasPatch(CanvasRenderingContext2D.prototype)\ncanvasPatch(Path2D.prototype)","export * from '@leafer/core'\n\nexport * from '@leafer/canvas-web'\nexport * from '@leafer/image-web'\n\nimport { ICreator, IFunction, IExportImageType, IExportFileType, IObject, ICanvasType } from '@leafer/interface'\nimport { Platform, Creator, FileHelper, defineKey } from '@leafer/core'\n\nimport { LeaferCanvas } from '@leafer/canvas-web'\nimport { LeaferImage } from '@leafer/image-web'\n\n\nconst { mineType, fileType } = FileHelper\n\nObject.assign(Creator, {\n    canvas: (options?, manager?) => new LeaferCanvas(options, manager),\n    image: (options) => new LeaferImage(options)\n} as ICreator)\n\n\nexport function useCanvas(_canvasType: ICanvasType, _power?: IObject): void {\n    Platform.origin = {\n        createCanvas(width: number, height: number): HTMLCanvasElement {\n            const canvas = document.createElement('canvas')\n            canvas.width = width\n            canvas.height = height\n            return canvas\n        },\n        canvasToDataURL: (canvas: HTMLCanvasElement, type?: IExportImageType, quality?: number) => {\n            const imageType = mineType(type), url = canvas.toDataURL(imageType, quality)\n            return imageType === 'image/bmp' ? url.replace('image/png;', 'image/bmp;') : url\n        },\n        canvasToBolb: (canvas: HTMLCanvasElement, type?: IExportFileType, quality?: number) => new Promise((resolve) => canvas.toBlob(resolve, mineType(type), quality)),\n        canvasSaveAs: (canvas: HTMLCanvasElement, filename: string, quality?: any) => {\n            const url = canvas.toDataURL(mineType(fileType(filename)), quality)\n            return Platform.origin.download(url, filename)\n        },\n        download(url: string, filename: string): Promise<void> {\n            return new Promise((resolve) => {\n                let el = document.createElement('a')\n                el.href = url\n                el.download = filename\n                document.body.appendChild(el)\n                el.click()\n                document.body.removeChild(el)\n                resolve()\n            })\n        },\n        loadImage(src: any): Promise<HTMLImageElement> {\n            return new Promise((resolve, reject) => {\n                const img = new Platform.origin.Image()\n                const { crossOrigin } = Platform.image\n                if (crossOrigin) {\n                    img.setAttribute('crossOrigin', crossOrigin)\n                    img.crossOrigin = crossOrigin\n                }\n                img.onload = () => { resolve(img) }\n                img.onerror = (e: any) => { reject(e) }\n                img.src = Platform.image.getRealURL(src)\n            })\n        },\n        Image,\n        PointerEvent,\n        DragEvent\n    }\n\n    Platform.event = {\n        stopDefault(origin: Event): void { origin.preventDefault() },\n        stopNow(origin: Event): void { origin.stopImmediatePropagation() },\n        stop(origin: Event): void { origin.stopPropagation() }\n    }\n\n    Platform.canvas = Creator.canvas()\n    Platform.conicGradientSupport = !!Platform.canvas.context.createConicGradient\n}\n\nPlatform.name = 'web'\nPlatform.isMobile = 'ontouchstart' in window\nPlatform.requestRender = function (render: IFunction): void { window.requestAnimationFrame(render) }\ndefineKey(Platform, 'devicePixelRatio', { get() { return devicePixelRatio } })\n\n\n// same as worker\n\nconst { userAgent } = navigator\n\nif (userAgent.indexOf(\"Firefox\") > -1) {\n    Platform.conicGradientRotate90 = true\n    Platform.intWheelDeltaY = true\n    Platform.syncDomFont = true\n} else if (/iPhone|iPad|iPod/.test(navigator.userAgent) || (/Macintosh/.test(navigator.userAgent) && /Version\\/[\\d.]+.*Safari/.test(navigator.userAgent))) {\n    Platform.fullImageShadow = true // 苹果内核渲染阴影\n}\n\nif (userAgent.indexOf('Windows') > -1) {\n    Platform.os = 'Windows'\n    Platform.intWheelDeltaY = true\n} else if (userAgent.indexOf('Mac') > -1) {\n    Platform.os = 'Mac'\n} else if (userAgent.indexOf('Linux') > -1) {\n    Platform.os = 'Linux'\n}","import { ILeaf, IWatcher, IEventListenerId, ILeafList, IWatcherConfig } from '@leafer/interface'\nimport { PropertyEvent, ChildEvent, RenderEvent, WatchEvent, LeafList, DataHelper } from '@leafer/core'\n\n\nexport class Watcher implements IWatcher {\n\n    public target: ILeaf\n\n    public totalTimes: number = 0\n\n    public disabled: boolean\n    public running: boolean\n    public changed: boolean\n\n    public hasVisible: boolean\n    public hasAdd: boolean\n    public hasRemove: boolean\n    public get childrenChanged() { return this.hasAdd || this.hasRemove || this.hasVisible }\n\n    public config: IWatcherConfig = {}\n\n    public get updatedList(): ILeafList {\n        if (this.hasRemove && this.config.usePartLayout) {\n            const updatedList = new LeafList()\n            this.__updatedList.list.forEach(item => { if (item.leafer) updatedList.add(item) })\n            return updatedList\n        } else {\n            return this.__updatedList\n        }\n    }\n\n    protected __eventIds: IEventListenerId[]\n    protected __updatedList: ILeafList = new LeafList()\n\n    constructor(target: ILeaf, userConfig?: IWatcherConfig) {\n        this.target = target\n        if (userConfig) this.config = DataHelper.default(userConfig, this.config)\n        this.__listenEvents()\n    }\n\n    public start(): void {\n        if (this.disabled) return\n        this.running = true\n    }\n\n    public stop(): void {\n        this.running = false\n    }\n\n    public disable(): void {\n        this.stop()\n        this.__removeListenEvents()\n        this.disabled = true\n    }\n\n    public update(): void {\n        this.changed = true\n        if (this.running) this.target.emit(RenderEvent.REQUEST)\n    }\n\n    protected __onAttrChange(event: PropertyEvent): void {\n        if (this.config.usePartLayout) this.__updatedList.add(event.target as ILeaf)\n        this.update()\n    }\n\n    protected __onChildEvent(event: ChildEvent): void {\n        if (this.config.usePartLayout) {\n            if (event.type === ChildEvent.ADD) {\n                this.hasAdd = true\n                this.__pushChild(event.child)\n            } else {\n                this.hasRemove = true\n                this.__updatedList.add(event.parent)\n            }\n        }\n        this.update()\n    }\n\n    protected __pushChild(child: ILeaf): void {\n        this.__updatedList.add(child)\n        if (child.isBranch) this.__loopChildren(child)\n    }\n\n    protected __loopChildren(parent: ILeaf): void {\n        const { children } = parent\n        for (let i = 0, len = children.length; i < len; i++) this.__pushChild(children[i])\n    }\n\n    public __onRquestData(): void {\n        this.target.emitEvent(new WatchEvent(WatchEvent.DATA, { updatedList: this.updatedList }))\n        this.__updatedList = new LeafList()\n        this.totalTimes++\n        this.changed = this.hasVisible = this.hasRemove = this.hasAdd = false\n    }\n\n    protected __listenEvents(): void {\n        this.__eventIds = [\n            this.target.on_([\n                [PropertyEvent.CHANGE, this.__onAttrChange, this],\n                [[ChildEvent.ADD, ChildEvent.REMOVE], this.__onChildEvent, this],\n                [WatchEvent.REQUEST, this.__onRquestData, this]\n            ])\n        ]\n    }\n\n    protected __removeListenEvents(): void {\n        this.target.off_(this.__eventIds)\n    }\n\n    public destroy(): void {\n        if (this.target) {\n            this.stop()\n            this.__removeListenEvents()\n            this.target = this.__updatedList = null\n        }\n    }\n\n}","import { ILeafLayout, ILeafLevelList, ILeafList, ILeaf } from '@leafer/interface'\nimport { BranchHelper, LeafHelper } from '@leafer/core'\n\n\nconst { updateAllMatrix, updateBounds: updateOneBounds, updateChange: updateOneChange } = LeafHelper\nconst { pushAllChildBranch, pushAllParent } = BranchHelper\n\n\nexport function updateMatrix(updateList: ILeafList, levelList: ILeafLevelList): void {\n\n    let layout: ILeafLayout\n    updateList.list.forEach(leaf => {  // 更新矩阵, 所有子元素，和父元素都需要更新bounds\n        layout = leaf.__layout\n        if (levelList.without(leaf) && !layout.proxyZoom) { // 防止重复， 子元素可能已经被父元素更新过\n\n            if (layout.matrixChanged) {\n\n                updateAllMatrix(leaf, true)\n\n                levelList.add(leaf)\n                if (leaf.isBranch) pushAllChildBranch(leaf, levelList)\n                pushAllParent(leaf, levelList)\n\n            } else if (layout.boundsChanged) {\n\n                levelList.add(leaf)\n                if (leaf.isBranch) leaf.__tempNumber = 0  // 标识需要更新子Leaf元素的WorldBounds分支, 0表示不需要更新\n                pushAllParent(leaf, levelList)\n            }\n        }\n    })\n\n}\n\nexport function updateBounds(boundsList: ILeafLevelList): void {\n    let list: ILeaf[], branch: ILeaf, children: ILeaf[]\n    boundsList.sort(true)\n    boundsList.levels.forEach(level => {\n        list = boundsList.levelMap[level]\n        for (let i = 0, len = list.length; i < len; i++) {\n            branch = list[i]\n\n            // 标识了需要更新子元素\n            if (branch.isBranch && branch.__tempNumber) {\n                children = branch.children\n                for (let j = 0, jLen = children.length; j < jLen; j++) {\n                    if (!children[j].isBranch) {\n                        updateOneBounds(children[j])\n                    }\n                }\n            }\n            updateOneBounds(branch)\n        }\n    })\n}\n\n\nexport function updateChange(updateList: ILeafList): void {\n    updateList.list.forEach(updateOneChange)\n}","import { IBounds, ILayoutBlockData, ILeafList, ILeaf } from '@leafer/interface'\nimport { Bounds, LeafBoundsHelper, LeafList, isArray } from '@leafer/core'\n\n\nconst { worldBounds } = LeafBoundsHelper\n\nexport class LayoutBlockData implements ILayoutBlockData {\n\n    public updatedList: ILeafList\n    public updatedBounds: IBounds = new Bounds()\n\n    public beforeBounds: IBounds = new Bounds()\n    public afterBounds: IBounds = new Bounds()\n\n    constructor(list: ILeafList | ILeaf[]) {\n        if (isArray(list)) list = new LeafList(list)\n        this.updatedList = list\n    }\n\n    public setBefore(): void {\n        this.beforeBounds.setListWithFn(this.updatedList.list, worldBounds)\n    }\n\n    public setAfter(): void {\n        this.afterBounds.setListWithFn(this.updatedList.list, worldBounds)\n        this.updatedBounds.setList([this.beforeBounds, this.afterBounds])\n    }\n\n    public merge(data: ILayoutBlockData): void {\n        this.updatedList.addList(data.updatedList.list)\n        this.beforeBounds.add(data.beforeBounds)\n        this.afterBounds.add(data.afterBounds)\n        this.updatedBounds.add(data.updatedBounds)\n    }\n\n    public destroy(): void {\n        this.updatedList = null\n    }\n\n}","import { ILayouter, ILeaf, ILayoutBlockData, IEventListenerId, ILayouterConfig, ILeafList } from '@leafer/interface'\nimport { LayoutEvent, WatchEvent, LeafLevelList, LeafList, BranchHelper, LeafHelper, DataHelper, Run, Debug } from '@leafer/core'\n\nimport { updateMatrix, updateBounds, updateChange } from './LayouterHelper'\nimport { LayoutBlockData } from './LayoutBlockData'\n\n\nconst { updateAllMatrix, updateAllChange } = LeafHelper\n\nconst debug = Debug.get('Layouter')\n\nexport class Layouter implements ILayouter {\n\n    public target: ILeaf\n    public layoutedBlocks: ILayoutBlockData[]\n    public extraBlock: ILayoutBlockData // around / autoLayout\n\n    public totalTimes: number = 0\n    public times: number\n\n    public disabled: boolean\n    public running: boolean\n    public layouting: boolean\n\n    public waitAgain: boolean\n\n    public config: ILayouterConfig = { usePartLayout: true }\n\n    protected __updatedList: ILeafList\n    protected __levelList: LeafLevelList = new LeafLevelList()\n    protected __eventIds: IEventListenerId[]\n\n    constructor(target: ILeaf, userConfig?: ILayouterConfig) {\n        this.target = target\n        if (userConfig) this.config = DataHelper.default(userConfig, this.config)\n        this.__listenEvents()\n    }\n\n    public start(): void {\n        if (this.disabled) return\n        this.running = true\n    }\n\n    public stop(): void {\n        this.running = false\n    }\n\n    public disable(): void {\n        this.stop()\n        this.__removeListenEvents()\n        this.disabled = true\n    }\n\n    public layout(): void {\n        if (this.layouting || !this.running) return\n        const { target } = this\n        this.times = 0\n\n        try {\n            target.emit(LayoutEvent.START)\n            this.layoutOnce()\n            target.emitEvent(new LayoutEvent(LayoutEvent.END, this.layoutedBlocks, this.times))\n        } catch (e) {\n            debug.error(e)\n        }\n\n        this.layoutedBlocks = null\n    }\n\n    public layoutAgain(): void {\n        if (this.layouting) {\n            this.waitAgain = true\n        } else {\n            this.layoutOnce()\n        }\n    }\n\n    public layoutOnce(): void {\n        if (this.layouting) return debug.warn('layouting')\n        if (this.times > 3) return debug.warn('layout max times')\n\n        this.times++\n        this.totalTimes++\n\n        this.layouting = true\n\n        this.target.emit(WatchEvent.REQUEST)\n\n        if (this.totalTimes > 1 && this.config.usePartLayout) {\n            this.partLayout()\n        } else {\n            this.fullLayout()\n        }\n\n        this.layouting = false\n\n        if (this.waitAgain) {\n            this.waitAgain = false\n            this.layoutOnce()\n        }\n    }\n\n    public partLayout(): void {\n        if (!this.__updatedList?.length) return\n\n        const t = Run.start('PartLayout')\n        const { target, __updatedList: updateList } = this\n        const { BEFORE, LAYOUT, AFTER } = LayoutEvent\n\n        const blocks = this.getBlocks(updateList)\n        blocks.forEach(item => item.setBefore())\n        target.emitEvent(new LayoutEvent(BEFORE, blocks, this.times))\n\n        this.extraBlock = null\n        updateList.sort()\n        updateMatrix(updateList, this.__levelList)\n        updateBounds(this.__levelList)\n        updateChange(updateList)\n\n        if (this.extraBlock) blocks.push(this.extraBlock)\n        blocks.forEach(item => item.setAfter())\n\n        target.emitEvent(new LayoutEvent(LAYOUT, blocks, this.times))\n        target.emitEvent(new LayoutEvent(AFTER, blocks, this.times))\n\n        this.addBlocks(blocks)\n\n        this.__levelList.reset()\n        this.__updatedList = null\n        Run.end(t)\n    }\n\n    public fullLayout(): void {\n        const t = Run.start('FullLayout')\n\n        const { target } = this\n        const { BEFORE, LAYOUT, AFTER } = LayoutEvent\n\n        const blocks = this.getBlocks(new LeafList(target))\n        target.emitEvent(new LayoutEvent(BEFORE, blocks, this.times))\n\n        Layouter.fullLayout(target)\n\n        blocks.forEach(item => { item.setAfter() })\n        target.emitEvent(new LayoutEvent(LAYOUT, blocks, this.times))\n        target.emitEvent(new LayoutEvent(AFTER, blocks, this.times))\n\n        this.addBlocks(blocks)\n\n        Run.end(t)\n    }\n\n    static fullLayout(target: ILeaf): void {\n        updateAllMatrix(target, true)\n\n        if (target.isBranch) BranchHelper.updateBounds(target)\n        else LeafHelper.updateBounds(target)\n\n        updateAllChange(target)\n    }\n\n    public addExtra(leaf: ILeaf): void {\n        if (!this.__updatedList.has(leaf)) {\n            const { updatedList, beforeBounds } = this.extraBlock || (this.extraBlock = new LayoutBlockData([]))\n            updatedList.length ? beforeBounds.add(leaf.__world) : beforeBounds.set(leaf.__world)\n            updatedList.add(leaf)\n        }\n    }\n\n    public createBlock(data: ILeafList | ILeaf[]): ILayoutBlockData {\n        return new LayoutBlockData(data)\n    }\n\n    public getBlocks(list: ILeafList): ILayoutBlockData[] {\n        return [this.createBlock(list)]\n    }\n\n    public addBlocks(current: ILayoutBlockData[]) {\n        this.layoutedBlocks ? this.layoutedBlocks.push(...current) : this.layoutedBlocks = current\n    }\n\n    protected __onReceiveWatchData(event: WatchEvent): void {\n        this.__updatedList = event.data.updatedList\n    }\n\n    protected __listenEvents(): void {\n        this.__eventIds = [\n            this.target.on_([\n                [LayoutEvent.REQUEST, this.layout, this],\n                [LayoutEvent.AGAIN, this.layoutAgain, this],\n                [WatchEvent.DATA, this.__onReceiveWatchData, this]\n            ])\n        ]\n    }\n\n    protected __removeListenEvents(): void {\n        this.target.off_(this.__eventIds)\n    }\n\n    public destroy(): void {\n        if (this.target) {\n            this.stop()\n            this.__removeListenEvents()\n            this.target = this.config = null\n        }\n    }\n\n}\n\n\n","import { ILeaf, ILeaferBase, ILeaferCanvas, IRenderer, IRendererConfig, IEventListenerId, IBounds, IFunction, IRenderOptions, ILeafList } from '@leafer/interface'\nimport { LayoutEvent, RenderEvent, ResizeEvent, ImageManager, Bounds, DataHelper, Platform, Debug, Run } from '@leafer/core'\n\n\nconst debug = Debug.get('Renderer')\n\nexport class Renderer implements IRenderer {\n\n    public target: ILeaf\n    public canvas: ILeaferCanvas\n    public updateBlocks: IBounds[]\n\n    public FPS = 60\n    public totalTimes = 0\n    public times: number = 0\n\n    public running: boolean\n    public rendering: boolean\n\n    public waitAgain: boolean\n    public changed: boolean\n    public ignore: boolean\n\n    public config: IRendererConfig = {\n        usePartRender: true,\n        ceilPartPixel: true,\n        maxFPS: 120\n    }\n\n    static clipSpread = 10\n\n    protected renderBounds: IBounds\n    protected renderOptions: IRenderOptions\n    protected totalBounds: IBounds\n\n    protected requestTime: number\n    protected frameTime: number\n    protected frames: number[] = []\n    protected __eventIds: IEventListenerId[]\n\n    protected get needFill(): boolean { return !!(!this.canvas.allowBackgroundColor && this.config.fill) }\n\n    constructor(target: ILeaf, canvas: ILeaferCanvas, userConfig?: IRendererConfig) {\n        this.target = target\n        this.canvas = canvas\n        if (userConfig) this.config = DataHelper.default(userConfig, this.config)\n        this.__listenEvents()\n    }\n\n    public start(): void {\n        this.running = true\n        this.update(false)\n    }\n\n    public stop(): void {\n        this.running = false\n    }\n\n    public update(change = true): void {\n        if (!this.changed) this.changed = change\n        if (!this.requestTime) this.__requestRender()\n    }\n\n    public requestLayout(): void {\n        this.target.emit(LayoutEvent.REQUEST)\n    }\n\n    public checkRender(): void {\n        if (this.running) {\n            const { target } = this\n            if (target.isApp) {\n                target.emit(RenderEvent.CHILD_START, target);\n                (target.children as ILeaferBase[]).forEach(leafer => {\n                    leafer.renderer.FPS = this.FPS\n                    leafer.renderer.checkRender()\n                })\n                target.emit(RenderEvent.CHILD_END, target)\n            }\n\n            if (this.changed && this.canvas.view) this.render()\n            this.target.emit(RenderEvent.NEXT)\n        }\n    }\n\n    public render(callback?: IFunction): void {\n        if (!(this.running && this.canvas.view)) return this.update()\n\n        const { target } = this\n        this.times = 0\n        this.totalBounds = new Bounds()\n\n        debug.log(target.innerName, '--->')\n\n        try {\n            this.emitRender(RenderEvent.START)\n            this.renderOnce(callback)\n            this.emitRender(RenderEvent.END, this.totalBounds)\n\n            ImageManager.clearRecycled()\n        } catch (e) {\n            this.rendering = false\n            debug.error(e)\n        }\n\n        debug.log('-------------|')\n    }\n\n    public renderAgain(): void {\n        if (this.rendering) {\n            this.waitAgain = true\n        } else {\n            this.renderOnce()\n        }\n    }\n\n    public renderOnce(callback?: IFunction): void {\n        if (this.rendering) return debug.warn('rendering')\n        if (this.times > 3) return debug.warn('render max times')\n\n        this.times++\n        this.totalTimes++\n\n        this.rendering = true\n        this.changed = false\n        this.renderBounds = new Bounds()\n        this.renderOptions = {}\n\n        if (callback) {\n            this.emitRender(RenderEvent.BEFORE)\n            callback()\n        } else {\n            this.requestLayout()\n\n            if (this.ignore) {\n                this.ignore = this.rendering = false // 仍保留 updateBlocks 用于下次渲染\n                return\n            }\n\n            this.emitRender(RenderEvent.BEFORE)\n\n            if (this.config.usePartRender && this.totalTimes > 1) {\n                this.partRender()\n            } else {\n                this.fullRender()\n            }\n        }\n\n        this.emitRender(RenderEvent.RENDER, this.renderBounds, this.renderOptions)\n        this.emitRender(RenderEvent.AFTER, this.renderBounds, this.renderOptions)\n\n        this.updateBlocks = null\n        this.rendering = false\n\n        if (this.waitAgain) {\n            this.waitAgain = false\n            this.renderOnce()\n        }\n    }\n\n    public partRender(): void {\n        const { canvas, updateBlocks: list } = this\n        if (!list) return // debug.warn('PartRender: need update attr')\n\n        this.mergeBlocks()\n        list.forEach(block => { if (canvas.bounds.hit(block) && !block.isEmpty()) this.clipRender(block) })\n    }\n\n    public clipRender(block: IBounds): void {\n        const t = Run.start('PartRender')\n        const { canvas } = this, bounds = block.getIntersect(canvas.bounds), realBounds = new Bounds(bounds)\n\n        canvas.save()\n\n        bounds.spread(Renderer.clipSpread).ceil() // 局部渲染区域需扩大一些，避免出现残影\n\n        const { ceilPartPixel } = this.config\n        canvas.clipWorld(bounds, ceilPartPixel)\n        canvas.clearWorld(bounds, ceilPartPixel)\n\n        this.__render(bounds, realBounds)\n        canvas.restore()\n\n        Run.end(t)\n    }\n\n    public fullRender(): void {\n        const t = Run.start('FullRender')\n        const { canvas } = this\n\n        canvas.save()\n        canvas.clear()\n        this.__render(canvas.bounds)\n        canvas.restore()\n\n        Run.end(t)\n    }\n\n    protected __render(bounds: IBounds, realBounds?: IBounds): void {\n        const { canvas, target } = this, includes = bounds.includes(target.__world), options: IRenderOptions = includes ? { includes } : { bounds, includes }\n\n        if (this.needFill) canvas.fillWorld(bounds, this.config.fill)\n        if (Debug.showRepaint) Debug.drawRepaint(canvas, bounds)\n\n        if (this.config.useCellRender) options.cellList = this.getCellList()\n\n        Platform.render(target, canvas, options)\n\n        this.renderBounds = realBounds = realBounds || bounds\n        this.renderOptions = options\n        this.totalBounds.isEmpty() ? this.totalBounds = realBounds : this.totalBounds.add(realBounds)\n\n        canvas.updateRender(realBounds)\n    }\n\n    // need rewrite\n    getCellList(): ILeafList {\n        return undefined\n    }\n\n    public addBlock(block: IBounds): void {\n        if (!this.updateBlocks) this.updateBlocks = []\n        this.updateBlocks.push(block)\n    }\n\n    public mergeBlocks(): void {\n        const { updateBlocks: list } = this\n        if (list) {\n            const bounds = new Bounds()\n            bounds.setList(list)\n            list.length = 0\n            list.push(bounds)\n        }\n    }\n\n    protected __requestRender(): void {\n        const target = this.target as ILeaferBase\n        if (this.requestTime || !target) return\n        if (target.parentApp) return target.parentApp.requestRender(false) // App 模式下统一走 app 控制渲染帧\n\n        this.requestTime = this.frameTime || Date.now()\n\n        const render = () => {\n\n            const nowFPS = 1000 / ((this.frameTime = Date.now()) - this.requestTime)\n\n            const { maxFPS } = this.config\n            if (maxFPS && nowFPS > maxFPS) return Platform.requestRender(render)\n\n            const { frames } = this\n            if (frames.length > 30) frames.shift()\n            frames.push(nowFPS)\n            this.FPS = Math.round(frames.reduce((a, b) => a + b, 0) / frames.length) // 帧率采样\n            this.requestTime = 0\n\n            this.checkRender()\n\n        }\n\n        Platform.requestRender(render)\n    }\n\n    protected __onResize(e: ResizeEvent): void {\n        if (this.canvas.unreal) return\n        if (e.bigger || !e.samePixelRatio) {\n            const { width, height } = e.old\n            const bounds = new Bounds(0, 0, width, height)\n            if (!bounds.includes(this.target.__world) || this.needFill || !e.samePixelRatio) {\n                this.addBlock(this.canvas.bounds)\n                this.target.forceUpdate('surface')\n                return\n            }\n        }\n\n        // 需要象征性派发一下渲染事件\n        this.addBlock(new Bounds(0, 0, 1, 1))\n        this.update()\n    }\n\n    protected __onLayoutEnd(event: LayoutEvent): void {\n        if (event.data) event.data.map(item => {\n            let empty: boolean\n            if (item.updatedList) item.updatedList.list.some(leaf => {\n                empty = (!leaf.__world.width || !leaf.__world.height)\n                if (empty) {\n                    if (!leaf.isLeafer) debug.tip(leaf.innerName, ': empty')\n                    empty = (!leaf.isBranch || leaf.isBranchLeaf) // render object\n                }\n                return empty\n            })\n            this.addBlock(empty ? this.canvas.bounds : item.updatedBounds)\n        })\n    }\n\n    protected emitRender(type: string, bounds?: IBounds, options?: IRenderOptions): void {\n        this.target.emitEvent(new RenderEvent(type, this.times, bounds, options))\n    }\n\n    protected __listenEvents(): void {\n        this.__eventIds = [\n            this.target.on_([\n                [RenderEvent.REQUEST, this.update, this],\n                [LayoutEvent.END, this.__onLayoutEnd, this],\n                [RenderEvent.AGAIN, this.renderAgain, this],\n                [ResizeEvent.RESIZE, this.__onResize, this]\n            ])\n        ]\n    }\n\n    protected __removeListenEvents(): void {\n        this.target.off_(this.__eventIds)\n    }\n\n    public destroy(): void {\n        if (this.target) {\n            this.stop()\n            this.__removeListenEvents()\n            this.config = {}\n            this.target = this.canvas = null\n        }\n    }\n}","import { ILeaf, ILeafList, IPointData, IRadiusPointData, IPickResult, IPickOptions, ISelector, IPickBottom, IPicker, ILeaferBase, ILeafData } from '@leafer/interface'\nimport { BoundsHelper, LeafList, LeafHelper, PointHelper } from '@leafer/core'\n\n\nconst tempPoint = {} as IRadiusPointData\nconst { copyRadiusPoint } = PointHelper\nconst { hitRadiusPoint } = BoundsHelper\n\n\nexport class Picker implements IPicker {\n\n    protected target?: ILeaf\n    protected selector: ISelector\n\n    protected findList: ILeafList\n    protected exclude: ILeafList\n\n    protected point: IRadiusPointData\n\n    constructor(target: ILeaf, selector: ISelector) {\n        this.target = target\n        this.selector = selector\n    }\n\n    public getByPoint(hitPoint: IPointData, hitRadius: number, options?: IPickOptions): IPickResult {\n        if (!hitRadius) hitRadius = 0\n        if (!options) options = {}\n\n        const through = options.through || false\n        const ignoreHittable = options.ignoreHittable || false\n        const target = options.target || this.target\n        this.exclude = options.exclude || null\n\n        this.point = { x: hitPoint.x, y: hitPoint.y, radiusX: hitRadius, radiusY: hitRadius }\n        this.findList = new LeafList(options.findList)\n\n        // path\n        if (!options.findList) this.hitBranch(target.isBranchLeaf ? { children: [target] } as ILeaf : target)  // 包含through元素\n\n        const { list } = this.findList\n        const leaf = this.getBestMatchLeaf(list, options.bottomList, ignoreHittable, !!options.findList)\n        const path = ignoreHittable ? this.getPath(leaf) : this.getHitablePath(leaf)\n\n        this.clear()\n\n        return through ? { path, target: leaf, throughPath: list.length ? this.getThroughPath(list) : path } : { path, target: leaf }\n    }\n\n    public hitPoint(hitPoint: IPointData, hitRadius: number, options?: IPickOptions): boolean {\n        return !!this.getByPoint(hitPoint, hitRadius, options).target // 后期需进行优化 ！！！\n    }\n\n    public getBestMatchLeaf(list: ILeaf[], bottomList: IPickBottom[], ignoreHittable: boolean, allowNull?: boolean): ILeaf {\n        const findList = this.findList = new LeafList()\n\n        if (list.length) {\n            let find: ILeaf\n            const { x, y } = this.point\n            const point = { x, y, radiusX: 0, radiusY: 0 }\n            for (let i = 0, len = list.length; i < len; i++) {\n                find = list[i]\n                if (ignoreHittable || LeafHelper.worldHittable(find)) {\n                    this.hitChild(find, point)\n                    if (findList.length) {\n                        if (find.isBranchLeaf && list.some(item => item !== find && LeafHelper.hasParent(item, find))) {\n                            findList.reset()\n                            break // Frame / Box 同时碰撞到子元素时，忽略自身，优先选中子元素\n                        }\n                        return findList.list[0]\n                    }\n                }\n            }\n        }\n\n        if (bottomList) { // 底部虚拟元素，一般为编辑器的虚拟框\n            for (let i = 0, len = bottomList.length; i < len; i++) {\n                this.hitChild(bottomList[i].target, this.point, bottomList[i].proxy)\n                if (findList.length) return findList.list[0]\n            }\n        }\n\n        if (allowNull) return null\n        return ignoreHittable ? list[0] : list.find(item => LeafHelper.worldHittable(item))\n    }\n\n    public getPath(leaf: ILeaf): LeafList {\n        const path = new LeafList(), syncList = [], { target } = this\n\n        while (leaf) {\n            if (leaf.syncEventer) syncList.push(leaf.syncEventer)\n            path.add(leaf)\n            leaf = leaf.parent\n            if (leaf === target) break\n        }\n\n        // 存在同步触发\n        if (syncList.length) {\n            syncList.forEach(item => {\n                while (item) {\n                    if (item.__.hittable) path.add(item)\n                    item = item.parent\n                    if (item === target) break\n                }\n            })\n        }\n\n        if (target) path.add(target)\n        return path\n    }\n\n    public getHitablePath(leaf: ILeaf): LeafList {\n        const path = this.getPath(leaf && leaf.hittable ? leaf : null)\n        let item: ILeaf, hittablePath = new LeafList()\n        for (let i = path.list.length - 1; i > -1; i--) {\n            item = path.list[i]\n            if (!item.__.hittable) break\n            hittablePath.addAt(item, 0)\n            if (!item.__.hitChildren || (item.isLeafer && (item as ILeaferBase).mode === 'draw')) break\n        }\n        return hittablePath\n    }\n\n    public getThroughPath(list: ILeaf[]): LeafList {\n        const throughPath = new LeafList()\n        const pathList: ILeafList[] = []\n\n        for (let i = list.length - 1; i > -1; i--) {\n            pathList.push(this.getPath(list[i]))\n        }\n\n        let path: ILeafList, nextPath: ILeafList, leaf: ILeaf\n        for (let i = 0, len = pathList.length; i < len; i++) {\n            path = pathList[i], nextPath = pathList[i + 1]\n            for (let j = 0, jLen = path.length; j < jLen; j++) {\n                leaf = path.list[j]\n                if (nextPath && nextPath.has(leaf)) break\n                throughPath.add(leaf)\n            }\n        }\n\n        return throughPath\n    }\n\n    protected hitBranch(branch: ILeaf): void {\n        this.eachFind(branch.children, branch.__onlyHitMask)\n    }\n\n    protected eachFind(children: ILeaf[], hitMask: boolean): void {\n        let child: ILeaf, hit: boolean, data: ILeafData\n        const { point } = this, len = children.length\n        for (let i = len - 1; i > -1; i--) {\n            child = children[i], data = child.__\n            if (!data.visible || (hitMask && !data.mask)) continue\n            hit = hitRadiusPoint(child.__world, data.hitRadius ? copyRadiusPoint(tempPoint, point, data.hitRadius) : point)\n\n            if (child.isBranch) {\n                if (hit || child.__ignoreHitWorld) {\n                    if (child.isBranchLeaf && data.__clipAfterFill && !child.__hitWorld(point, true)) continue // 裁剪的Box需要先检测自身是否碰撞到\n                    if (child.topChildren) this.eachFind(child.topChildren, false) // 滚动条等覆盖物\n                    this.eachFind(child.children, child.__onlyHitMask)\n                    if (child.isBranchLeaf) this.hitChild(child, point) // Box / Frame\n                }\n            } else {\n                if (hit) this.hitChild(child, point)\n            }\n        }\n    }\n\n    protected hitChild(child: ILeaf, point: IRadiusPointData, proxy?: ILeaf): void {\n        if (this.exclude && this.exclude.has(child)) return\n        if (child.__hitWorld(point)) {\n            const { parent } = child\n            if (parent && parent.__hasMask && !child.__.mask) {\n\n                let findMasks: ILeaf[] = [], item: ILeaf\n                const { children } = parent\n\n                for (let i = 0, len = children.length; i < len; i++) {\n                    item = children[i]\n                    if (item.__.mask) findMasks.push(item)\n                    if (item === child) {\n                        if (findMasks && !findMasks.every(value => value.__hitWorld(point))) return // 遮罩上层的元素，与遮罩相交的区域才能响应事件\n                        break\n                    }\n                }\n\n            }\n            this.findList.add(proxy || child)\n        }\n    }\n\n    protected clear(): void {\n        this.point = null\n        this.findList = null\n        this.exclude = null\n    }\n\n    public destroy(): void {\n        this.clear()\n    }\n\n}","import { ILeaf, ISelector, ISelectorProxy, IPickResult, IPickOptions, IPointData, ISelectorConfig, IFinder, IFindMethod, IFindCondition, IPicker } from '@leafer/interface'\nimport { Creator, DataHelper, Plugin, Platform } from '@leafer/core'\n\nimport { Picker } from './Picker'\n\n\nexport class Selector implements ISelector {\n\n    public target?: ILeaf // target 不存在时，为临时选择器（不能缓存数据）\n    public proxy?: ISelectorProxy // editor\n\n    public config: ISelectorConfig = {}\n\n    public picker: IPicker\n    public finder?: IFinder\n\n    constructor(target: ILeaf, userConfig?: ISelectorConfig) {\n        if (userConfig) this.config = DataHelper.default(userConfig, this.config)\n        this.picker = new Picker(this.target = target, this)\n        this.finder = Creator.finder && Creator.finder()\n    }\n\n    public getByPoint(hitPoint: IPointData, hitRadius: number, options?: IPickOptions): IPickResult {\n        const { target, picker } = this\n        if (Platform.backgrounder) target && target.updateLayout()\n        return picker.getByPoint(hitPoint, hitRadius, options)\n    }\n\n    public hitPoint(hitPoint: IPointData, hitRadius: number, options?: IPickOptions): boolean {\n        return this.picker.hitPoint(hitPoint, hitRadius, options)\n    }\n\n    // @leafer-in/find will rewrite\n    public getBy(condition: number | string | IFindCondition | IFindMethod, branch?: ILeaf, one?: boolean, options?: any): ILeaf | ILeaf[] {\n        return this.finder ? this.finder.getBy(condition, branch, one, options) : Plugin.need('find')\n    }\n\n    public destroy(): void {\n        this.picker.destroy()\n        if (this.finder) this.finder.destroy()\n    }\n\n}","import { IValue, IObject } from '@leafer/interface'\nimport { defineKey, decorateLeafAttr, attr, createDescriptor } from '@leafer/core'\n\nimport { ICanvas, IUI, IApp } from '@leafer-ui/interface'\n\n\nexport function effectType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            this.__setAttr(key, value)\n            if (value) (this as IUI).__.__useEffect = true\n            this.__layout.renderChanged || this.__layout.renderChange()\n        }\n    }))\n}\n\nexport function resizeType(defaultValue?: IValue) {\n    return decorateLeafAttr(defaultValue, (key: string) => attr({\n        set(value: IValue) {\n            this.__setAttr(key, value)\n            this.__layout.boxChanged || this.__layout.boxChange();\n            (this as ICanvas).__updateSize()\n        }\n    }))\n}\n\nexport function zoomLayerType() {\n    return (target: IUI, key: string) => {\n        const privateKey = '_' + key\n        defineKey(target, key, {\n            set(value: IUI) { if (this.isLeafer) (this as IObject)[privateKey] = value },\n            get() {\n                return this.isApp\n                    ? (this as IApp).tree.zoomLayer\n                    : (this.isLeafer ? ((this as IObject)[privateKey] || this) : this.leafer && this.leafer.zoomLayer)\n            }\n        })\n    }\n}\n\nexport function createAttr(defaultValue?: IValue) {\n    return (target: IUI, key: string) => {\n        defineKey(target, key, createDescriptor(key, defaultValue))\n    }\n}","// leafer's partner, allow replace\nexport * from '@leafer/watcher'\nexport * from '@leafer/layouter'\nexport * from '@leafer/renderer'\nexport * from '@leafer/selector'\n\nimport { ICreator, ILeaf, ILeaferCanvas, IRenderOptions } from '@leafer/interface'\nimport { Creator, LeafList, Platform } from '@leafer/core'\n\nimport { Watcher } from '@leafer/watcher'\nimport { Layouter } from '@leafer/layouter'\nimport { Renderer } from '@leafer/renderer'\nimport { Selector } from '@leafer/selector'\n\n\nObject.assign(Creator, {\n    watcher: (target, options?) => new Watcher(target, options),\n    layouter: (target, options?) => new Layouter(target, options),\n    renderer: (target, canvas, options?) => new Renderer(target, canvas, options),\n    selector: (target?, options?) => new Selector(target, options)\n} as ICreator)\n\nPlatform.layout = Layouter.fullLayout\nPlatform.render = function (target: ILeaf, canvas: ILeaferCanvas, options: IRenderOptions): void {\n    const topOptions: IRenderOptions = { ...options, topRendering: true }\n    options.topList = new LeafList()\n    target.__render(canvas, options)\n    if (options.topList.length) options.topList.forEach(item => item.__render(canvas, topOptions))\n}","// Implemented in partner\nimport { IPaintModule, IPaintImageModule, IPaintGradientModule, IEffectModule, ITextConvertModule, IExportModule, IColorConvertModule, IPathArrowModule, IStateModule, ITransitionModule, ITransitionFunction, IFilterModule } from \"@leafer-ui/interface\"\nimport { Plugin, UnitConvertHelper } from '@leafer/core'\nimport { hasTransparent } from './color'\n\n\nexport const TextConvert = {} as ITextConvertModule\n\nexport const ColorConvert = {\n    hasTransparent\n} as IColorConvertModule\n\nexport const UnitConvert = UnitConvertHelper\n\nexport const PathArrow = {} as IPathArrowModule\n\n\nexport const Paint = {} as IPaintModule\n\nexport const PaintImage = {} as IPaintImageModule\n\nexport const PaintGradient = {} as IPaintGradientModule\n\nexport const Effect = {} as IEffectModule\n\nexport const Filter = {\n    apply(): void { Plugin.need('filter') }\n} as unknown as IFilterModule\n\nexport const Export = {} as IExportModule\n\nexport const State = {\n    setStyleName(): void { return Plugin.need('state') },\n    set(): void { return Plugin.need('state') }\n} as unknown as IStateModule\n\nexport const Transition = {\n    list: {},\n    register(attrName: string, fn: ITransitionFunction): void { Transition.list[attrName] = fn },\n    get(attrName: string): ITransitionFunction { return Transition.list[attrName] }\n} as ITransitionModule","export function hasTransparent(color?: string): boolean {\n\n    if (!color || color.length === 7 || color.length === 4) return false\n    if (color === 'transparent') return true  // transparent keyword\n\n    const first = color[0]\n\n    if (first === '#') {\n\n        // hex\n        switch (color.length) {\n            case 5: return color[4] !== 'f' && color[4] !== 'F' // #RGBA\n            case 9: return (color[7] !== 'f' && color[7] !== 'F') || (color[8] !== 'f' && color[8] !== 'F') // #RRGGBBAA\n        }\n\n    } else if (first === 'r' || first === 'h') {\n\n        // rgba(...) or hsla(...)\n        if (color[3] === 'a') {\n            const i = color.lastIndexOf(',')\n            if (i > -1) return parseFloat(color.slice(i + 1)) < 1\n        }\n\n    }\n\n    return false\n\n}","import { INumber, IValue, IBoolean, IPathCommandData, IPathString, IPointData, IPathCommandObject, IObject, IFilter, IPathCommandNode } from '@leafer/interface'\nimport { PathConvert, DataHelper, LeafData, Debug, isArray, isObject, isString, isUndefined } from '@leafer/core'\n\nimport { IUI, IUIData, ILeafPaint, IStrokeComputedStyle } from '@leafer-ui/interface'\nimport { Paint, PaintImage, ColorConvert } from '@leafer-ui/external'\n\n\nconst { parse, objectToCanvasData } = PathConvert\nconst { stintSet } = DataHelper, { hasTransparent } = ColorConvert\nconst emptyPaint: ILeafPaint = { originPaint: {} as any }\nconst debug = Debug.get('UIData')\nexport class UIData extends LeafData implements IUIData {\n\n    declare public __leaf: IUI\n\n    public get scale(): INumber | IPointData { const { scaleX, scaleY } = this as IUIData; return scaleX !== scaleY ? { x: scaleX, y: scaleY } : scaleX }\n\n    public __blendLayer?: boolean // 非元素属性必须以两个下划线开头\n\n    public __isFills?: boolean\n    public __isStrokes?: boolean\n\n    public get __strokeWidth(): number { return this.__getRealStrokeWidth() }\n\n    public get __maxStrokeWidth(): number { const t = this as IUIData; return t.__hasMultiStrokeStyle ? Math.max(t.__hasMultiStrokeStyle, t.strokeWidth) : t.strokeWidth }\n\n    public __hasMultiStrokeStyle?: number // 是否存在多个不同的描述样式（同时存储多个描边样式中的最大宽度用于运算）\n\n    public get __hasMultiPaint(): boolean { const t = this as IUIData; return (t.fill && this.__useStroke) || (t.__isFills && t.fill.length > 1) || (t.__isStrokes && t.stroke.length > 1) || t.__useEffect } // fix: opacity\n\n    public __isAlphaPixelFill?: boolean // png / svg / webp\n    public __isAlphaPixelStroke?: boolean\n\n    public __isTransparentFill?: boolean  // 半透明的 \n    public __isTransparentStroke?: boolean\n\n    public get __clipAfterFill(): boolean { const t = this as IUIData; return (t.cornerRadius || t.innerShadow || t.__pathInputed) as unknown as boolean } // 用于 (Box | Canvas | Robot) __drawAfterFill() 时裁剪内容\n    public get __hasSurface(): boolean { const t = this as IUIData; return (t.fill || t.stroke) as unknown as boolean }\n\n    public __needComputePaint: boolean\n\n    protected _visible?: IBoolean\n\n    protected _width?: INumber\n    protected _height?: INumber\n\n    protected _fill?: IValue\n    protected _stroke?: IValue\n\n    protected _path: IPathCommandData\n\n    protected _shadow?: IValue\n    protected _innerShadow?: IValue\n\n    public get __autoWidth() { return !this._width }\n    public get __autoHeight() { return !this._height }\n    public get __autoSide() { return !this._width || !this._height }\n    public get __autoSize() { return !this._width && !this._height }\n\n\n    protected setVisible(value: IBoolean) {\n        this._visible = value\n\n        const { leafer } = this.__leaf\n        if (leafer) leafer.watcher.hasVisible = true\n    }\n\n    protected setWidth(value: INumber) {\n        if (value < 0) {\n            this._width = -value\n            this.__leaf.scaleX *= -1\n            debug.warn('width < 0, instead -scaleX ', this)\n        } else this._width = value\n    }\n\n    protected setHeight(value: INumber) {\n        if (value < 0) {\n            this._height = -value\n            this.__leaf.scaleY *= -1\n            debug.warn('height < 0, instead -scaleY', this)\n        } else this._height = value\n    }\n\n\n    protected setFill(value: IValue) {\n        if (this.__naturalWidth) this.__removeNaturalSize()\n        if (isString(value) || !value) {\n            stintSet(this, '__isTransparentFill', hasTransparent(value as string))\n            this.__isFills && this.__removePaint('fill', true)\n            this._fill = value\n        } else if (isObject(value)) {\n            this.__setPaint('fill', value)\n        }\n    }\n\n    protected setStroke(value: IValue) {\n        if (isString(value) || !value) {\n            stintSet(this, '__isTransparentStroke', hasTransparent(value as string))\n            this.__isStrokes && this.__removePaint('stroke', true)\n            this._stroke = value\n        } else if (isObject(value)) {\n            this.__setPaint('stroke', value)\n        }\n    }\n\n\n    protected setPath(value: IPathCommandData | IPathCommandNode[] | IPathCommandObject[] | IPathString) {\n        const isStr = isString(value)\n        if (isStr || (value && isObject(value[0]))) {\n            this.__setInput('path', value)\n            this._path = isStr ? parse(value) : objectToCanvasData(value as IPathCommandObject[])\n        } else {\n            if (this.__input) this.__removeInput('path')\n            this._path = value as IPathCommandData\n        }\n    }\n\n\n    protected setShadow(value: IValue) {\n        setArray(this, 'shadow', value)\n    }\n\n    protected setInnerShadow(value: IValue) {\n        setArray(this, 'innerShadow', value)\n    }\n\n    protected setFilter(value: IValue) {\n        setArray(this, 'filter', value)\n    }\n\n\n    // custom\n\n    public __computePaint(): void {\n        const { fill, stroke } = this.__input\n        if (fill) Paint.compute('fill', this.__leaf)\n        if (stroke) Paint.compute('stroke', this.__leaf)\n        this.__needComputePaint = undefined\n    }\n\n\n    public __getRealStrokeWidth(childStyle?: IStrokeComputedStyle): number {\n        let { strokeWidth, strokeWidthFixed } = this as IUIData\n        if (childStyle) {\n            if (childStyle.strokeWidth) strokeWidth = childStyle.strokeWidth\n            if (!isUndefined(childStyle.strokeWidthFixed)) strokeWidthFixed = childStyle.strokeWidthFixed\n        }\n        if (strokeWidthFixed) {\n            const scale = this.__leaf.getClampRenderScale()\n            return scale > 1 ? strokeWidth / scale : strokeWidth\n        } else return strokeWidth\n    }\n\n\n    public __setPaint(attrName: 'fill' | 'stroke', value: IValue): void {\n        this.__setInput(attrName, value)\n        const layout = this.__leaf.__layout\n        layout.boxChanged || layout.boxChange()\n        if (isArray(value) && !value.length) {\n            this.__removePaint(attrName)\n        } else {\n            if (attrName === 'fill') this.__isFills = true, this._fill || (this._fill = emptyPaint)\n            else this.__isStrokes = true, this._stroke || (this._stroke = emptyPaint)\n        }\n    }\n\n    public __removePaint(attrName: 'fill' | 'stroke', removeInput?: boolean): void {\n        if (removeInput) this.__removeInput(attrName)\n        PaintImage.recycleImage(attrName, this)\n        if (attrName === 'fill') {\n            stintSet(this, '__isAlphaPixelFill', undefined)\n            this._fill = this.__isFills = undefined\n        } else {\n            stintSet(this, '__isAlphaPixelStroke', undefined)\n            stintSet(this, '__hasMultiStrokeStyle', undefined)\n            this._stroke = this.__isStrokes = undefined\n        }\n    }\n}\n\n\nfunction setArray(data: IUIData, key: string, value: IValue) {\n    data.__setInput(key, value)\n    if (isArray(value)) {\n        if (value.some((item: IFilter) => item.visible === false)) value = value.filter((item: IFilter) => item.visible !== false)\n        value.length || (value = undefined)\n    } else value = value && (value as IFilter).visible !== false ? [value] : undefined;\n    (data as IObject)['_' + key] = value\n}\n","import { IGroupData } from '@leafer-ui/interface'\n\nimport { UIData } from \"./UIData\"\n\n\nexport class GroupData extends UIData implements IGroupData {\n\n}\n","import { IBox, IBoxData } from '@leafer-ui/interface'\n\nimport { GroupData } from \"./GroupData\"\n\n\nexport class BoxData extends GroupData implements IBoxData {\n\n    public get __boxStroke(): boolean { return !(this as IBoxData).__pathInputed }\n\n    // 当成整体处理\n    public get __drawAfterFill(): boolean { const t = this as IBoxData; return t.__single || t.__clipAfterFill }\n\n    public get __clipAfterFill(): boolean { const t = this as IBoxData; return t.overflow !== 'show' && t.__leaf.children.length && ((t.__leaf as IBox).isOverflow || super.__clipAfterFill) as unknown as boolean }\n\n}\n","import { canvasSizeAttrs } from '@leafer/core'\n\nimport { ILeaferData, IObject, IJSONOptions } from '@leafer-ui/interface'\n\nimport { GroupData } from './GroupData'\n\nexport class LeaferData extends GroupData implements ILeaferData {\n\n    public __getInputData(names?: string[] | IObject, options?: IJSONOptions): IObject {\n        const data = super.__getInputData(names, options)\n        canvasSizeAttrs.forEach(key => delete (data as IObject)[key])\n        return data\n    }\n}\n","import { IFrameData } from '@leafer-ui/interface'\n\nimport { BoxData } from './BoxData'\n\n\nexport class FrameData extends BoxData implements IFrameData {\n\n}\n","import { ILineData } from \"@leafer-ui/interface\"\n\nimport { UIData } from \"./UIData\"\n\n\nexport class LineData extends UIData implements ILineData {\n\n    public get __usePathBox(): boolean {\n        return ((this as ILineData).points || (this as ILineData).__pathInputed) as any as boolean\n    }\n\n}\n","import { IRectData } from \"@leafer-ui/interface\"\n\nimport { UIData } from \"./UIData\"\n\n\nexport class RectData extends UIData implements IRectData {\n    get __boxStroke(): boolean { return !(this as IRectData).__pathInputed }\n}","import { IEllipseData } from '@leafer-ui/interface'\n\nimport { UIData } from \"./UIData\"\n\n\nexport class EllipseData extends UIData implements IEllipseData {\n    get __boxStroke(): boolean { return !(this as IEllipseData).__pathInputed }\n}","import { IPolygonData } from '@leafer-ui/interface'\n\nimport { LineData } from './LineData'\n\n\nexport class PolygonData extends LineData implements IPolygonData {\n\n}","import { IStarData } from '@leafer-ui/interface'\n\nimport { UIData } from \"./UIData\"\n\n\nexport class StarData extends UIData implements IStarData {\n\n}","import { IPathData } from '@leafer-ui/interface'\n\nimport { UIData } from \"./UIData\"\n\n\nexport class PathData extends UIData implements IPathData {\n    public get __pathInputed(): number { return 2 }\n}","import { IPenData } from '@leafer-ui/interface'\n\nimport { GroupData } from './GroupData'\n\n\nexport class PenData extends GroupData implements IPenData {\n\n}\n","import { IJSONOptions } from '@leafer/interface'\nimport { UICreator, isString } from '@leafer/core'\n\nimport { IFontWeight, ITextData, IUI, IText, IObject, IBackgroundBoxStyle, IFontWeightNumer, ITextInputData } from '@leafer-ui/interface'\n\nimport { UIData } from \"./UIData\"\n\n\n\nconst fontWeightMap = {\n    'thin': 100,\n    'extra-light': 200,\n    'light': 300,\n    'normal': 400,\n    'medium': 500,\n    'semi-bold': 600,\n    'bold': 700,\n    'extra-bold': 800,\n    'black': 900\n}\n\nexport class TextData extends UIData implements ITextData {\n\n    public get __useNaturalRatio() { return false }\n\n    protected _fontWeight?: number\n    protected _boxStyle?: IBackgroundBoxStyle\n\n    setFontWeight(value: IFontWeight): void {\n        if (isString(value)) {\n            this.__setInput('fontWeight', value)\n            value = fontWeightMap[value] as IFontWeightNumer || 400\n        } else if (this.__input) this.__removeInput('fontWeight')\n        this._fontWeight = value\n    }\n\n    setBoxStyle(value: IUI) {\n        let t = this.__leaf as IText, box = t.__box\n\n        if (value) {\n\n            const { boxStyle } = this as ITextData\n            if (box) for (let key in boxStyle) (box as IObject)[key] = undefined\n            else box = t.__box = UICreator.get('Rect', 0 as any) as IUI // 传递 0 可以优化内存占用\n\n            const layout = t.__layout, boxLayout = box.__layout\n            if (!boxStyle) box.parent = t as any, box.__world = t.__world, boxLayout.boxBounds = layout.boxBounds\n\n            box.set(value)\n            if (boxLayout.strokeChanged) layout.strokeChange()\n\n        } else if (box) {\n            t.__box = box.parent = null\n            box.destroy()\n        }\n\n        this._boxStyle = value\n\n    }\n\n    public __getInputData(names?: string[] | IObject, options?: IJSONOptions): IObject {\n        const data: ITextInputData = super.__getInputData(names, options)\n        if (data.textEditing) delete data.textEditing\n        return data\n    }\n\n}","import { IImageData, IImageInputData, IImage, IObject, IJSONOptions } from '@leafer-ui/interface'\n\nimport { RectData } from './RectData'\n\n\nexport class ImageData extends RectData implements IImageData {\n\n    declare public __leaf: IImage\n\n    protected _url: string\n\n    protected setUrl(value: string) {\n        this.__setImageFill(value)\n        this._url = value\n    }\n\n    public __setImageFill(value: string): void {\n        (this as IImageInputData).fill = value ? { type: 'image', mode: 'stretch', url: value } : undefined\n    }\n\n    public __getData(): IObject {\n        const data: IImageInputData = super.__getData()\n        if (data.url) delete data.fill\n        return data\n    }\n\n    public __getInputData(names?: string[] | IObject, options?: IJSONOptions): IObject {\n        const data: IImageInputData = super.__getInputData(names, options)\n        if (data.url) delete data.fill\n        return data\n    }\n}","import { ICanvas, ICanvasData, ICanvasInputData, IObject, IJSONOptions } from '@leafer-ui/interface'\n\nimport { RectData } from './RectData'\n\n\nexport class CanvasData extends RectData implements ICanvasData {\n\n    public get __isCanvas(): boolean { return true }\n    public get __drawAfterFill(): boolean { return true }\n\n    public __getInputData(names?: string[] | IObject, options?: IJSONOptions): IObject {\n        const data: ICanvasInputData = super.__getInputData(names, options)\n        data.url = (this.__leaf as ICanvas).canvas.toDataURL('image/png') as string\n        return data\n    }\n}","import { IFourNumber } from '@leafer/interface'\nimport { FourNumberHelper } from '@leafer/core'\n\nimport { IUIBoundsModule } from \"@leafer-ui/interface\"\nimport { Effect, Filter } from '@leafer-ui/external'\n\n\nconst { max, add } = FourNumberHelper\n\nexport const UIBounds: IUIBoundsModule = {\n\n    __updateStrokeSpread(): IFourNumber {\n        let spread: IFourNumber = 0, boxSpread = 0\n        const data = this.__, { strokeAlign, __maxStrokeWidth: strokeWidth } = data, box = this.__box\n\n        if ((data.stroke || data.hitStroke === 'all') && strokeWidth && strokeAlign !== 'inside') {\n            boxSpread = spread = strokeAlign === 'center' ? strokeWidth / 2 : strokeWidth\n\n            if (!data.__boxStroke) {\n                const miterLimitAddWidth = data.__isLinePath ? 0 : 10 * spread  // =  Math.sin((miterLimit = 10) * OneRadian / 2) * Math.sqrt(strokeWidth) - width 后期需继续精确优化\n                const storkeCapAddWidth = data.strokeCap === 'none' ? 0 : strokeWidth\n                spread += Math.max(miterLimitAddWidth, storkeCapAddWidth)\n            }\n        }\n\n        if (data.__useArrow) spread += strokeWidth * 5 // 后期需要精细化\n\n        if (box) {\n            spread = max(spread, box.__layout.strokeSpread = box.__updateStrokeSpread())\n            boxSpread = Math.max(boxSpread, box.__layout.strokeBoxSpread)\n        }\n\n        this.__layout.strokeBoxSpread = boxSpread\n\n        return spread\n    },\n\n    __updateRenderSpread(): IFourNumber {\n        let spread: IFourNumber = 0\n        const { shadow, innerShadow, blur, backgroundBlur, filter, renderSpread } = this.__, { strokeSpread } = this.__layout, box = this.__box\n\n        if (shadow) spread = Effect.getShadowRenderSpread(this, shadow)\n\n        if (blur) spread = max(spread, blur)\n\n        if (filter) spread = add(spread, Filter.getSpread(filter))\n\n        if (renderSpread) spread = add(spread, renderSpread)\n\n        if (strokeSpread) spread = add(spread, strokeSpread)\n\n\n        let shapeSpread = spread\n\n        if (innerShadow) shapeSpread = max(shapeSpread, Effect.getInnerShadowSpread(this, innerShadow))\n\n        if (backgroundBlur) shapeSpread = max(shapeSpread, backgroundBlur)\n\n        this.__layout.renderShapeSpread = shapeSpread\n\n        return box ? max(box.__updateRenderSpread(), spread) : spread\n    }\n\n}","import { ILeaferCanvas, IRenderOptions } from '@leafer/interface'\nimport { DataHelper, isArray } from '@leafer/core'\n\nimport { IUIRenderModule, ILeafPaint, ILeafStrokePaint, IUI } from '@leafer-ui/interface'\nimport { Paint, Effect, Filter, ColorConvert } from '@leafer-ui/external'\n\nconst { stintSet } = DataHelper\n\nexport const UIRender: IUIRenderModule = {\n\n    __updateChange(): void {\n        const data = this.__\n\n        if (data.__useStroke) {\n            const useStroke = data.__useStroke = !!(data.stroke && data.strokeWidth)\n            stintSet(this.__world, 'half', useStroke && data.strokeAlign === 'center' && data.strokeWidth % 2)  // 是否存在半逻辑像素渲染（奇数线宽的居中线条），可以半像素为起点绘制，防止模糊\n            stintSet(data, '__fillAfterStroke', useStroke && data.strokeAlign === 'outside' && data.fill && !data.__isTransparentFill)\n        }\n\n        if (data.__useEffect) {\n            const { shadow, fill, stroke } = data, otherEffect = data.innerShadow || data.blur || data.backgroundBlur || data.filter\n            stintSet(data, '__isFastShadow', shadow && !otherEffect && shadow.length < 2 && !shadow[0].spread && !Effect.isTransformShadow(shadow[0]) && fill && !data.__isTransparentFill && !(isArray(fill) && fill.length > 1) && (this.useFastShadow || !stroke || (stroke && data.strokeAlign === 'inside'))) // 高性能阴影条件， @leafer-ui/image check.ts 中的 allowDraw 逻辑需与此处关联\n            data.__useEffect = !!(shadow || otherEffect)\n        }\n\n        data.__checkSingle()\n\n        stintSet(data, '__complex', (data.__isFills || data.__isStrokes || data.cornerRadius || data.__useEffect) as boolean)\n    },\n\n    __drawFast(canvas: ILeaferCanvas, options: IRenderOptions): void {\n        drawFast(this, canvas, options)\n    },\n\n    __draw(canvas: ILeaferCanvas, options: IRenderOptions, originCanvas?: ILeaferCanvas): void {\n        const data = this.__\n\n        if (data.__complex) {\n\n            if (data.__needComputePaint) data.__computePaint()\n\n            const { fill, stroke, __drawAfterFill, __fillAfterStroke, __isFastShadow } = data\n\n            this.__drawRenderPath(canvas)\n\n            if (data.__useEffect && !__isFastShadow) {\n\n                const shape = Paint.shape(this, canvas, options)\n                this.__nowWorld = this.__getNowWorld(options) // restore\n\n                const { shadow, innerShadow, filter } = data\n\n                if (shadow) Effect.shadow(this, canvas, shape)\n\n                if (__fillAfterStroke) data.__isStrokes ? Paint.strokes(stroke as ILeafStrokePaint[], this, canvas, options) : Paint.stroke(stroke as string, this, canvas, options)\n\n                if (fill) data.__isFills ? Paint.fills(fill as ILeafPaint[], this, canvas, options) : Paint.fill(fill as string, this, canvas, options)\n\n                if (__drawAfterFill) this.__drawAfterFill(canvas, options)\n\n                if (innerShadow) Effect.innerShadow(this, canvas, shape)\n\n                if (stroke && !__fillAfterStroke) data.__isStrokes ? Paint.strokes(stroke as ILeafStrokePaint[], this, canvas, options) : Paint.stroke(stroke as string, this, canvas, options)\n\n                if (filter) Filter.apply(filter, this, this.__nowWorld, canvas, originCanvas, shape)\n\n                if (shape.worldCanvas) shape.worldCanvas.recycle()\n                shape.canvas.recycle()\n\n            } else {\n\n                if (__fillAfterStroke) data.__isStrokes ? Paint.strokes(stroke as ILeafStrokePaint[], this, canvas, options) : Paint.stroke(stroke as string, this, canvas, options)\n\n                if (__isFastShadow) {\n                    const shadow = data.shadow[0], { scaleX, scaleY } = this.getRenderScaleData(true, shadow.scaleFixed)\n                    canvas.save(), canvas.setWorldShadow(shadow.x * scaleX, shadow.y * scaleY, shadow.blur * scaleX, ColorConvert.string(shadow.color))\n                }\n\n                if (fill) data.__isFills ? Paint.fills(fill as ILeafPaint[], this, canvas, options) : Paint.fill(fill as string, this, canvas, options)\n\n                if (__isFastShadow) canvas.restore()\n\n                if (__drawAfterFill) this.__drawAfterFill(canvas, options)\n\n                if (stroke && !__fillAfterStroke) data.__isStrokes ? Paint.strokes(stroke as ILeafStrokePaint[], this, canvas, options) : Paint.stroke(stroke as string, this, canvas, options)\n\n            }\n\n        } else {\n\n            if (data.__pathForRender) drawFast(this, canvas, options)\n            else this.__drawFast(canvas, options)\n\n        }\n    },\n\n    __drawShape(canvas: ILeaferCanvas, options: IRenderOptions): void {\n        this.__drawRenderPath(canvas)\n\n        const data = this.__, { fill, stroke } = data\n\n        if (fill && !options.ignoreFill) data.__isAlphaPixelFill ? Paint.fills(fill as ILeafPaint[], this, canvas, options) : Paint.fill('#000000', this, canvas, options)\n        if (data.__isCanvas) this.__drawAfterFill(canvas, options)\n        if (stroke && !options.ignoreStroke) data.__isAlphaPixelStroke ? Paint.strokes(stroke as ILeafStrokePaint[], this, canvas, options) : Paint.stroke('#000000', this, canvas, options)\n    },\n\n    __drawAfterFill(canvas: ILeaferCanvas, options: IRenderOptions): void {\n        if (this.__.__clipAfterFill) {\n            canvas.save()\n            canvas.clipUI(this)\n            this.__drawContent(canvas, options)\n            canvas.restore()\n        } else this.__drawContent(canvas, options)\n    }\n\n}\n\n\nfunction drawFast(ui: IUI, canvas: ILeaferCanvas, options: IRenderOptions): void {\n    const { fill, stroke, __drawAfterFill, __fillAfterStroke } = ui.__\n\n    ui.__drawRenderPath(canvas)\n\n    if (__fillAfterStroke) Paint.stroke(stroke as string, ui, canvas, options)\n\n    if (fill) Paint.fill(fill as string, ui, canvas, options)\n    if (__drawAfterFill) ui.__drawAfterFill(canvas, options)\n\n    if (stroke && !__fillAfterStroke) Paint.stroke(stroke as string, ui, canvas, options)\n}","import { ILeaferCanvas, IRenderOptions } from '@leafer/interface'\n\nimport { IRectRenderModule } from '@leafer-ui/interface'\n\n\nexport const RectRender: IRectRenderModule = {\n\n    __drawFast(canvas: ILeaferCanvas, options: IRenderOptions): void {\n\n        let { x, y, width, height } = this.__layout.boxBounds\n        const { fill, stroke, __drawAfterFill } = this.__\n\n        if (fill) {\n            canvas.fillStyle = fill\n            canvas.fillRect(x, y, width, height)\n        }\n\n        if (__drawAfterFill) this.__drawAfterFill(canvas, options)\n\n        if (stroke) {\n\n            const { strokeAlign, __strokeWidth: strokeWidth } = this.__\n            if (!strokeWidth) return\n\n            canvas.setStroke(stroke, strokeWidth, this.__)\n            const half = strokeWidth / 2\n\n            switch (strokeAlign) {\n                case 'center':\n                    canvas.strokeRect(0, 0, width, height)\n                    break\n                case 'inside':\n                    width -= strokeWidth, height -= strokeWidth\n                    if (width < 0 || height < 0) {\n                        canvas.save()\n                        this.__clip(canvas, options)\n                        canvas.strokeRect(x + half, y + half, width, height)\n                        canvas.restore()\n                    } else canvas.strokeRect(x + half, y + half, width, height)\n                    break\n                case 'outside':\n                    canvas.strokeRect(x - half, y - half, width + strokeWidth, height + strokeWidth)\n                    break\n            }\n\n        }\n\n    }\n}\n","import { ILeaferCanvas, IRenderOptions, IPathDrawer, IPathCommandData, IHitType, INumber, IBoolean, IString, IPathString, IExportFileType, IPointData, ICursorType, IMaskType, IEraserType, IWindingRule, IPathCreator, IFourNumber, IBoundsData, IFlowType, IGap, IFlowWrap, IAxis, IConstraint, IAutoBoxData, IFlowBoxType, IPointGap, IFlowAlign, IFlowAxisAlign, IFindCondition, IAutoSize, IRangeSize, IAlign, IUnitPointData, IObject, IScaleData, IUnitData, IPathCommandObject, ITransition, IFilter, IScaleFixed, IDragBoundsType, IPathCommandNode } from '@leafer/interface'\nimport { Leaf, PathDrawer, surfaceType, dimType, dataType, positionType, scrollType, boundsType, pathType, scaleType, rotationType, opacityType, visibleType, sortType, maskType, dataProcessor, registerUI, useModule, rewrite, rewriteAble, UICreator, PathCorner, hitType, strokeType, PathConvert, eraserType, cursorType, autoLayoutType, pen, naturalBoundsType, pathInputType, MathHelper, Plugin, DataHelper, affectRenderBoundsType, isString, isNumber } from '@leafer/core'\n\nimport { IUI, IShadowEffect, IBlurEffect, IStrokeAlign, IStrokeJoin, IStrokeCap, IBlendMode, IDashPatternString, IShadowString, IGrayscaleEffect, IUIData, IGroup, IStrokeWidthString, ICornerRadiusString, IUIInputData, IExportOptions, IExportResult, IFill, IStroke, IArrowStyle, IFindUIMethod, ILeafer, IEditorConfig, IEditorConfigFunction, IEditToolFunction, IKeyframe, IAnimation, IAnimate, IStates, IStateName, IAnimateType, IStateStyle, IColorString, IAnimateList, ILeafPaint } from '@leafer-ui/interface'\nimport { effectType, zoomLayerType } from '@leafer-ui/decorator'\n\nimport { UIData } from '@leafer-ui/data'\nimport { UIBounds, UIRender } from '@leafer-ui/display-module'\n\nimport { Export, Paint, PathArrow } from '@leafer-ui/external'\n\n\n@useModule(UIBounds)\n@useModule(UIRender)\n@rewriteAble()\nexport class UI<TInputData = IUIInputData> extends Leaf<TInputData> implements IUI { // tip: rewrited Box\n\n    @dataProcessor(UIData)\n    declare public __: IUIData\n\n    declare public proxyData?: IUIInputData // need rewrite getter\n    declare public __proxyData?: IUIInputData\n\n    public get app(): ILeafer { return this.leafer && this.leafer.app }\n\n    declare public leafer?: ILeafer\n    declare public parent?: IGroup\n\n    @zoomLayerType()\n    public zoomLayer: IGroup\n\n    public get isFrame(): boolean { return false }\n\n    declare public children?: IUI[]\n\n    // ---\n\n    // id\n    @dataType('')\n    public id?: IString\n\n    @dataType('')\n    public name?: IString\n\n    @dataType('')\n    public className?: IString\n\n\n    // layer\n    @surfaceType('pass-through')\n    public blendMode?: IBlendMode\n\n    @opacityType(1)\n    public opacity?: INumber\n\n    @visibleType(true)\n    public visible?: IBoolean | 0\n\n\n    @surfaceType(false)\n    public locked?: IBoolean\n\n\n    // @leafer-in/bright will rewrite\n\n    @dimType(false)\n    public dim?: IBoolean | INumber // 是否弱化内容，可设置具体透明度\n\n    @dimType(false)\n    public dimskip?: IBoolean // 跳过弱化，突出显示内容，不受dim影响\n\n    public bright?: IBoolean // 突出显示内容，并置顶渲染，不受dim影响\n\n\n    @sortType(0)\n    public zIndex?: INumber\n\n\n    @maskType(false)\n    public mask?: IBoolean | IMaskType\n\n    @eraserType(false)\n    public eraser?: IBoolean | IEraserType\n\n\n    // position\n    @positionType(0, true)\n    public x?: INumber\n\n    @positionType(0, true)\n    public y?: INumber\n\n    // size\n    @boundsType(100, true)\n    public width?: INumber\n\n    @boundsType(100, true)\n    public height?: INumber\n\n    // scale\n    @scaleType(1, true)\n    public scaleX?: INumber\n\n    @scaleType(1, true)\n    public scaleY?: INumber\n\n    // @leafer-in/scale-fixed will rewrite\n    public scaleFixed?: IScaleFixed\n\n    // rotate\n    @rotationType(0, true)\n    public rotation?: INumber\n\n    // skew\n    @rotationType(0, true)\n    public skewX?: INumber\n\n    @rotationType(0, true)\n    public skewY?: INumber\n\n\n    // offset\n    @positionType(0, true)\n    public offsetX?: INumber\n\n    @positionType(0, true)\n    public offsetY?: INumber\n\n    // scroll\n    @scrollType(0, true)\n    public scrollX?: INumber\n\n    @scrollType(0, true)\n    public scrollY?: INumber\n\n\n    // center\n    @autoLayoutType()\n    public origin?: IAlign | IUnitPointData\n\n    @autoLayoutType()\n    public around?: IAlign | IUnitPointData\n\n\n    // image\n    @dataType(false)\n    public lazy?: IBoolean  // load image / compute paint\n\n    @naturalBoundsType(1)\n    public pixelRatio?: INumber\n\n\n    @affectRenderBoundsType(0)\n    public renderSpread?: IFourNumber // 强行扩大渲染边界\n\n\n    // path\n    @pathInputType()\n    public path?: IPathCommandData | IPathCommandNode[] | IPathCommandObject[] | IPathString\n\n    @pathType()\n    public windingRule?: IWindingRule\n\n    @pathType(true)\n    public closed?: boolean\n\n\n    // @leafer-in/flow rewrite\n    public flow?: IFlowType\n\n    @boundsType(0)\n    public padding?: IFourNumber\n\n    public gap?: IGap | IPointGap\n\n    public flowAlign?: IFlowAlign | IFlowAxisAlign\n\n    public flowWrap?: IFlowWrap\n\n\n    public itemBox?: IFlowBoxType\n\n    public inFlow?: IBoolean\n\n\n    public autoWidth?: IAutoSize\n\n    public autoHeight?: IAutoSize\n\n    @boundsType(false)\n    public lockRatio?: IBoolean\n\n    public autoBox?: IAutoBoxData | IConstraint\n\n    @boundsType()\n    public widthRange?: IRangeSize\n\n    @boundsType()\n    public heightRange?: IRangeSize\n\n\n    // drag\n    @dataType(false)\n    public draggable?: IBoolean | IAxis\n\n    @dataType()\n    public dragBounds?: IBoundsData | 'parent'\n\n    @dataType('auto')\n    dragBoundsType?: IDragBoundsType\n\n\n    @dataType(false)\n    public editable?: IBoolean\n\n\n    // hit\n    @hitType(true)\n    public hittable?: IBoolean\n\n    @hitType('path')\n    public hitFill?: IHitType\n\n    @strokeType('path')\n    public hitStroke?: IHitType\n\n    @hitType(false)\n    public hitBox?: IBoolean\n\n    @hitType(true)\n    public hitChildren?: IBoolean\n\n    @hitType(true)\n    public hitSelf?: IBoolean\n\n    @hitType()\n    public hitRadius?: INumber\n\n    @cursorType('')\n    public cursor?: ICursorType | ICursorType[]\n\n    // ---\n\n\n    // fill\n\n    @surfaceType()\n    public fill?: IFill\n\n    // stroke\n\n    @strokeType(undefined, true)\n    public stroke?: IStroke\n\n    @strokeType('inside')\n    public strokeAlign?: IStrokeAlign\n\n    @strokeType(1, true)\n    public strokeWidth?: IFourNumber | IStrokeWidthString\n\n    @strokeType(false)\n    public strokeWidthFixed?: IScaleFixed\n\n    @strokeType('none')\n    public strokeCap?: IStrokeCap\n\n    @strokeType('miter')\n    public strokeJoin?: IStrokeJoin\n\n    @strokeType()\n    public dashPattern?: INumber[] | IDashPatternString\n\n    @strokeType(0)\n    public dashOffset?: INumber\n\n    @strokeType(10)\n    public miterLimit?: INumber\n\n\n    // @leafer-in/arrow rewrite\n\n    public startArrow?: IArrowStyle\n\n    public endArrow?: IArrowStyle\n\n    // corner\n\n    @pathType(0)\n    public cornerRadius?: IFourNumber | ICornerRadiusString\n\n    @pathType()\n    public cornerSmoothing?: INumber\n\n    // effect\n\n    @effectType()\n    public shadow?: IShadowEffect | IShadowEffect[] | IShadowString\n\n    @effectType()\n    public innerShadow?: IShadowEffect | IShadowEffect[] | IShadowString\n\n    @effectType()\n    public blur?: INumber | IBlurEffect\n\n    @effectType()\n    public backgroundBlur?: INumber | IBlurEffect\n\n    @effectType()\n    public grayscale?: INumber | IGrayscaleEffect\n\n    @effectType()\n    public filter?: IFilter | IFilter[]\n\n\n    // @leafer-in/animate rewrite\n\n    public animation?: IAnimation | IAnimation[]\n\n    public animationOut?: IAnimation | IAnimation[]\n\n\n    public transition?: ITransition\n\n    public transitionOut?: ITransition\n\n\n    // @leafer-in/motion-path rewrite\n\n    public motionPath?: boolean\n\n    public motionPrecision?: INumber\n\n\n    public motion?: INumber | IUnitData\n\n    public motionRotation?: INumber | IBoolean\n\n\n    // @leafer-in/state rewrite\n\n    public states?: IStates\n\n    public state?: IStateName\n\n\n    public selected?: IBoolean\n\n    public disabled?: IBoolean\n\n\n    public normalStyle?: IStateStyle\n\n    public hoverStyle?: IStateStyle\n\n    public pressStyle?: IStateStyle\n\n    public focusStyle?: IStateStyle\n\n    public selectedStyle?: IStateStyle\n\n    public disabledStyle?: IStateStyle\n\n\n    public placeholderStyle?: IStateStyle\n\n    @surfaceType()\n    public placeholderColor?: IColorString\n\n    @dataType(100)\n    public placeholderDelay?: INumber\n\n\n    public button?: IBoolean\n\n\n    //  @leafer-in/editor rewrite\n\n    public editConfig: IEditorConfig\n\n    public editOuter: string\n\n    public editInner: string\n\n\n    // 预留给用户使用的数据对象\n    @dataType({})\n    public data: IObject\n\n\n    public set scale(value: INumber | IPointData) { MathHelper.assignScale(this as IScaleData, value) }\n    public get scale(): INumber | IPointData { return this.__.scale }\n\n    public get isAutoWidth(): boolean { const t = this.__; return t.__autoWidth || t.autoWidth as boolean }\n    public get isAutoHeight(): boolean { const t = this.__; return t.__autoHeight || t.autoHeight as boolean }\n\n    public useFastShadow?: boolean // 将忽略 stroke 产生的阴影，只对单个 fill 有效\n\n    public __box?: IUI // 背景box, 一般用于文本背景框\n    public __animate?: IAnimate | IAnimateList\n\n    public get pen(): IPathCreator {\n        const { path } = this.__\n        pen.set(this.path = path || [])\n        if (!path) this.__drawPathByBox(pen)\n        return pen\n    }\n\n\n    // data\n\n    @rewrite(Leaf.prototype.reset)\n    public reset(_data?: IUIInputData): void { }\n\n\n    // @leafer-in/animate and @leafer-in/state will rewrite\n\n    public set(data: IUIInputData, _transition?: ITransition | 'temp'): void {\n        if (data) Object.assign(this, data)\n    }\n\n    public get<K extends keyof this>(name?: K | K[] | IUIInputData): IUIInputData | this[K] {\n        return isString(name) ? this.__.__getInput(name) : this.__.__getInputData(name as string[] | undefined)\n    }\n\n    public createProxyData(): IUIInputData { return undefined }\n\n\n    // hit rewrite\n\n    public find(_condition: number | string | IFindCondition | IFindUIMethod, _options?: any): IUI[] { return Plugin.need('find') }\n\n    public findTag(tag: string | string[]): IUI[] { return this.find({ tag }) }\n\n    public findOne(_condition: number | string | IFindCondition | IFindUIMethod, _options?: any): IUI | undefined { return Plugin.need('find') }\n\n    public findId(id: number | string): IUI | undefined { return this.findOne({ id }) }\n\n\n    // path\n\n    public getPath(curve?: boolean, pathForRender?: boolean): IPathCommandData {\n        this.__layout.update()\n        let path = pathForRender ? this.__.__pathForRender : this.__.path\n        if (!path) pen.set(path = []), this.__drawPathByBox(pen, !pathForRender)\n        return curve ? PathConvert.toCanvasData(path, true) : path\n    }\n\n    public getPathString(curve?: boolean, pathForRender?: boolean, floatLength?: number): IPathString {\n        return PathConvert.stringify(this.getPath(curve, pathForRender), floatLength)\n    }\n\n\n    public load(): void {\n        this.__.__computePaint() // 手动加载图片\n    }\n\n    public __onUpdateSize(): void {\n        if (this.__.__input) {\n            const data = this.__;\n            (data.lazy && !this.__inLazyBounds && !Export.running) ? data.__needComputePaint = true : data.__computePaint()\n        }\n    }\n\n    public __updateRenderPath(): void {\n        const data = this.__\n        if (data.path) {\n            data.__pathForRender = data.cornerRadius ? PathCorner.smooth(data.path, data.cornerRadius, data.cornerSmoothing) : data.path\n            if (data.__useArrow) PathArrow.addArrows(this)\n        } else data.__pathForRender && (data.__pathForRender = undefined)\n    }\n\n    public __drawRenderPath(canvas: ILeaferCanvas): void {\n        canvas.beginPath()\n        this.__drawPathByData(canvas, this.__.__pathForRender)\n    }\n\n    public __drawPath(canvas: ILeaferCanvas): void {\n        canvas.beginPath()\n        this.__drawPathByData(canvas, this.__.path, true)\n    }\n\n    public __drawPathByData(drawer: IPathDrawer, data: IPathCommandData, ignoreCornerRadius?: boolean): void {\n        data ? PathDrawer.drawPathByData(drawer, data) : this.__drawPathByBox(drawer, ignoreCornerRadius)\n    }\n\n    public __drawPathByBox(drawer: IPathDrawer, ignoreCornerRadius?: boolean): void {\n        const { x, y, width, height } = this.__layout.boxBounds\n        if (this.__.cornerRadius && !ignoreCornerRadius) {\n            const { cornerRadius } = this.__\n            drawer.roundRect(x, y, width, height, isNumber(cornerRadius) ? [cornerRadius] : cornerRadius) // 修复微信浏览器bug, 后续需进一步优化\n        } else drawer.rect(x, y, width, height)\n        drawer.closePath()\n    }\n\n    public drawImagePlaceholder(_paint: ILeafPaint, canvas: ILeaferCanvas, renderOptions: IRenderOptions): void {\n        Paint.fill(this.__.placeholderColor, this, canvas, renderOptions)  // 图片占位符\n    }\n\n    // @leafer-in/animate rewrite\n\n    public animate(keyframe?: IUIInputData | IKeyframe[] | IAnimation | IAnimation[], _options?: ITransition, _type?: IAnimateType, _isTemp?: boolean): IAnimate {\n        this.set(keyframe as IUIInputData)\n        return Plugin.need('animate')\n    }\n\n    public killAnimate(_type?: IAnimateType, _nextStyle?: IUIInputData): void { }\n\n\n    // create\n\n    // @leafer-in/export will rewrite\n    public export(_filename: IExportFileType | string, _options?: IExportOptions | number | boolean): Promise<IExportResult> {\n        return Plugin.need('export')\n    }\n\n    public syncExport(_filename: IExportFileType | string, _options?: IExportOptions | number | boolean): IExportResult {\n        return Plugin.need('export')\n    }\n\n    public clone(data?: IUIInputData): this {\n        const json = DataHelper.clone(this.toJSON())\n        if (data) Object.assign(json, data)\n        return UI.one(json) as this\n    }\n\n    // this 参数定义，在编译的时候会移除\n    static one<T extends UI>(this: new (...args: any[]) => T, data: IUIInputData, x?: number, y?: number, width?: number, height?: number): T {\n        return UICreator.get(data.tag || this.prototype.__tag, data, x, y, width, height) as T\n    }\n\n    static registerUI(): void {\n        registerUI()(this)\n    }\n\n    static registerData(data: IUIData): void {\n        dataProcessor(data)(this.prototype)\n    }\n\n\n    // @leafer-in/editor rewrite\n\n    static setEditConfig(_config: IEditorConfig | IEditorConfigFunction): void { }\n\n    static setEditOuter(_toolName: string | IEditToolFunction): void { }\n\n    static setEditInner(_editorName: string | IEditToolFunction): void { }\n\n\n    public destroy(): void {\n        this.fill = this.stroke = null\n        if (this.__animate) this.killAnimate()\n        super.destroy()\n    }\n\n}\n","import { IJSONOptions, IPickOptions, IPickResult, IPointData, INumber, ITransition } from '@leafer/interface'\nimport { Branch, useModule, dataProcessor, registerUI, boundsType } from '@leafer/core'\n\nimport { IGroup, IGroupData, IGroupInputData, IUI, IUIInputData, IUIJSONData, IFindCondition, IFindUIMethod } from '@leafer-ui/interface'\nimport { GroupData } from '@leafer-ui/data'\n\nimport { UI } from './UI'\n\n\n@useModule(Branch)\n@registerUI()\nexport class Group<TInputData = IGroupInputData> extends UI<TInputData> implements IGroup {   // tip: rewrited Box\n\n    public get __tag() { return 'Group' }\n\n    public get isBranch(): boolean { return true }\n\n    @dataProcessor(GroupData)\n    declare public __: IGroupData\n\n    // size\n    @boundsType(0)\n    declare public width?: INumber\n\n    @boundsType(0)\n    declare public height?: INumber\n\n    declare public children: IUI[]\n\n    declare public topChildren?: IUI[]\n\n    public childlessJSON?: boolean\n\n\n    public reset(data?: IGroupInputData): void {\n        this.__setBranch()\n        super.reset(data)\n    }\n\n    public __setBranch(): void {\n        if (!this.children) this.children = []\n    }\n\n\n    // data\n\n    override set(data: IUIInputData, transition?: ITransition | 'temp'): void {\n        if (data) {\n            if (data.children) {\n                const { children } = data\n\n                delete data.children\n                this.children ? this.clear() : this.__setBranch()\n\n                super.set(data, transition)\n\n                children.forEach(child => this.add(child))\n                data.children = children\n\n            } else super.set(data, transition)\n        }\n    }\n\n    override toJSON(options?: IJSONOptions): IUIJSONData {\n        const data = super.toJSON(options)\n        if (!this.childlessJSON) data.children = this.children.map(child => child.toJSON(options))\n        return data\n    }\n\n\n    // hit rewrite\n\n    public pick(_hitPoint: IPointData, _options?: IPickOptions): IPickResult { return undefined }\n\n\n    // add\n\n    public addAt(child: IUI | IUI[] | IUIInputData | IUIInputData[], index: number): void {\n        this.add(child, index)\n    }\n\n    public addAfter(child: IUI | IUI[] | IUIInputData | IUIInputData[], after: IUI): void {\n        this.add(child, this.children.indexOf(after) + 1)\n    }\n\n    public addBefore(child: IUI | IUI[] | IUIInputData | IUIInputData[], before: IUI): void {\n        this.add(child, this.children.indexOf(before))\n    }\n\n    // Branch rewrite\n\n    public add(_child: IUI | IUI[] | IUIInputData | IUIInputData[], _index?: number): void { }\n\n    public addMany(..._children: IUI[] | IUIInputData[]): void { }\n\n    public remove(_child?: IUI | number | string | IFindCondition | IFindUIMethod, _destroy?: boolean): void { }\n\n    public removeAll(_destroy?: boolean): void { }\n\n    public clear(): void { }\n\n}","import { ILeaferCanvas, IRenderer, ILayouter, ISelector, IWatcher, IInteraction, ILeaferConfig, ICanvasManager, IHitCanvasManager, IAutoBounds, IScreenSizeData, IResizeEvent, IEventListenerId, ITimer, IValue, IObject, IControl, IPointData, ILeaferType, ICursorType, IBoundsData, INumber, IZoomType, IZoomOptions, IFourNumber, IBounds, IClientPointData, ITransition, ICanvasSizeAttr, ILeaferMode } from '@leafer/interface'\nimport { AutoBounds, LayoutEvent, ResizeEvent, LeaferEvent, CanvasManager, ImageManager, Resource, DataHelper, Creator, Run, Debug, RenderEvent, registerUI, boundsType, canvasSizeAttrs, dataProcessor, WaitHelper, WatchEvent, Bounds, LeafList, Plugin, getBoundsData, dataType } from '@leafer/core'\n\nimport { ILeaferInputData, ILeaferData, IFunction, IUIInputData, ILeafer, IApp, IEditorBase } from '@leafer-ui/interface'\nimport { LeaferData } from '@leafer-ui/data'\n\nimport { Group } from './Group'\n\n\nconst debug = Debug.get('Leafer')\n\n@registerUI()\nexport class Leafer extends Group implements ILeafer {\n\n    static list = new LeafList() // 所有leafer实例\n\n\n    public get __tag() { return 'Leafer' }\n\n    @dataProcessor(LeaferData)\n    declare public __: ILeaferData\n\n    @boundsType()\n    declare public pixelRatio?: INumber\n\n    @dataType('normal')\n    public mode: ILeaferMode\n\n    public get isApp(): boolean { return false }\n    public get app(): ILeafer { return this.parent || this }\n\n    public get isLeafer(): boolean { return true }\n\n    public parentApp?: IApp\n    declare public parent?: IApp\n\n    public running: boolean\n    public created: boolean\n    public ready: boolean\n    public viewReady: boolean\n    public viewCompleted: boolean\n    public get imageReady(): boolean { return this.viewReady && Resource.isComplete }\n    public get layoutLocked() { return !this.layouter.running }\n\n    public transforming: boolean\n\n    public get view(): unknown { return this.canvas && this.canvas.view }\n\n    //  manager\n    public canvas: ILeaferCanvas\n    public renderer: IRenderer\n\n    public watcher: IWatcher\n    public layouter: ILayouter\n\n    public selector?: ISelector\n    public interaction?: IInteraction\n\n    public canvasManager: ICanvasManager\n    public hitCanvasManager?: IHitCanvasManager\n\n    // plugin\n    public editor: IEditorBase\n\n    public userConfig: ILeaferConfig\n    public config: ILeaferConfig = {\n        start: true,\n        hittable: true,\n        smooth: true,\n        lazySpeard: 100,\n        // maxFPS: 120, // 最大的运行帧率\n        // pixelSnap: false // 是否对齐像素，避免图片存在浮点坐标导致模糊\n    }\n\n    public autoLayout?: IAutoBounds\n    public lazyBounds: IBounds\n\n    public get FPS(): number { return this.renderer ? this.renderer.FPS : 60 }\n    public get cursorPoint(): IPointData { return (this.interaction && this.interaction.hoverData) || { x: this.width / 2, y: this.height / 2 } }\n    public get clientBounds(): IBoundsData { return (this.canvas && this.canvas.getClientBounds(true)) || getBoundsData() }\n    public leafs = 0\n\n    public __eventIds: IEventListenerId[] = []\n    protected __startTimer: ITimer\n    protected __controllers: IControl[] = []\n\n    protected __initWait: IFunction[] // assign in waitInit()\n    protected __readyWait: IFunction[] = []\n    protected __viewReadyWait: IFunction[] = []\n    protected __viewCompletedWait: IFunction[] = []\n    public __nextRenderWait: IFunction[] = []\n\n    constructor(userConfig?: ILeaferConfig, data?: ILeaferInputData) {\n        super(data)\n        this.userConfig = userConfig\n        if (userConfig && (userConfig.view || userConfig.width)) this.init(userConfig)\n        Leafer.list.add(this)\n    }\n\n    public init(userConfig?: ILeaferConfig, parentApp?: IApp): void {\n        if (this.canvas) return\n\n        let start: boolean\n        const { config } = this\n\n        this.__setLeafer(this)\n\n        if (parentApp) {\n            this.parentApp = parentApp\n            this.__bindApp(parentApp)\n            start = parentApp.running\n        }\n\n        if (userConfig) {\n            this.parent = parentApp\n            this.initType(userConfig.type) // LeaferType\n            this.parent = undefined\n            DataHelper.assign(config, userConfig)\n        }\n\n        // render / layout\n        const canvas = this.canvas = Creator.canvas(config)\n        this.__controllers.push(\n            this.renderer = Creator.renderer(this, canvas, config),\n            this.watcher = Creator.watcher(this, config),\n            this.layouter = Creator.layouter(this, config)\n        )\n\n        if (this.isApp) this.__setApp()\n        this.__checkAutoLayout()\n\n        // interaction / manager\n        if (!parentApp) {\n            this.selector = Creator.selector(this)\n            this.interaction = Creator.interaction(this, canvas, this.selector, config)\n\n            if (this.interaction) {\n                this.__controllers.unshift(this.interaction)\n                this.hitCanvasManager = Creator.hitCanvasManager()\n            }\n\n            this.canvasManager = new CanvasManager()\n\n            start = config.start\n        }\n\n        this.hittable = config.hittable\n        this.fill = config.fill\n        this.canvasManager.add(canvas)\n\n\n        this.__listenEvents()\n\n        if (start) this.__startTimer = setTimeout(this.start.bind(this))\n\n        WaitHelper.run(this.__initWait)\n        this.onInit() // can rewrite init event\n    }\n\n    public onInit(): void { }\n\n    public initType(_type: ILeaferType): void { } // rewrite in @leafer-ui/viewport\n\n    public set(data: IUIInputData, transition?: ITransition | 'temp'): void {\n        this.waitInit(() => { super.set(data, transition) })\n    }\n\n    public start(): void {\n        clearTimeout(this.__startTimer)\n        if (!this.running && this.canvas) {\n            this.running = true\n            this.ready ? this.emitLeafer(LeaferEvent.RESTART) : this.emitLeafer(LeaferEvent.START)\n            this.__controllers.forEach(item => item.start())\n            if (!this.isApp) this.renderer.render()\n        }\n    }\n\n    public stop(): void {\n        clearTimeout(this.__startTimer)\n        if (this.running && this.canvas) {\n            this.__controllers.forEach(item => item.stop())\n            this.running = false\n            this.emitLeafer(LeaferEvent.STOP)\n        }\n    }\n\n    public unlockLayout(): void {\n        this.layouter.start()\n        this.updateLayout()\n    }\n\n    public lockLayout(): void {\n        this.updateLayout()\n        this.layouter.stop()\n    }\n\n    public resize(size: IScreenSizeData): void {\n        const data = DataHelper.copyAttrs({}, size, canvasSizeAttrs)\n        Object.keys(data).forEach(key => (this as any)[key] = data[key])\n    }\n\n    override forceRender(bounds?: IBoundsData, sync?: boolean): void {\n        const { renderer } = this\n        if (renderer) {\n            renderer.addBlock(bounds ? new Bounds(bounds) : this.canvas.bounds)\n            if (this.viewReady) sync ? renderer.render() : renderer.update()\n        }\n    }\n\n    public requestRender(change = false): void {\n        if (this.renderer) this.renderer.update(change)\n    }\n\n    public updateCursor(cursor?: ICursorType): void {\n        const i = this.interaction\n        if (i) cursor ? i.setCursor(cursor) : i.updateCursor()\n    }\n\n    public updateLazyBounds(): void {\n        this.lazyBounds = this.canvas.bounds.clone().spread(this.config.lazySpeard)\n    }\n\n    protected __doResize(size: IScreenSizeData): void {\n        const { canvas } = this\n        if (!canvas || canvas.isSameSize(size)) return\n        const old = DataHelper.copyAttrs({}, this.canvas, canvasSizeAttrs) as IScreenSizeData\n        canvas.resize(size)\n        this.updateLazyBounds()\n        this.__onResize(new ResizeEvent(size, old))\n    }\n\n    protected __onResize(event: IResizeEvent): void {\n        this.emitEvent(event)\n        DataHelper.copyAttrs(this.__, event, canvasSizeAttrs)\n        setTimeout(() => { if (this.canvasManager) this.canvasManager.clearRecycled() }, 0)\n    }\n\n    protected __setApp(): void { }\n\n    protected __bindApp(app: IApp): void {\n        this.selector = app.selector\n        this.interaction = app.interaction\n\n        this.canvasManager = app.canvasManager\n        this.hitCanvasManager = app.hitCanvasManager\n    }\n\n    public __setLeafer(leafer: ILeafer): void {\n        this.leafer = leafer\n        this.__level = 1\n    }\n\n    protected __checkAutoLayout(): void {\n        const { config, parentApp } = this\n        if (!parentApp) {\n            if (!config.width || !config.height) this.autoLayout = new AutoBounds(config)\n            this.canvas.startAutoLayout(this.autoLayout, this.__onResize.bind(this))\n        }\n    }\n\n    override __setAttr(attrName: string, newValue: IValue): boolean {\n        if (this.canvas) {\n            if (canvasSizeAttrs.includes(attrName)) {\n                // if (!newValue) debug.warn(attrName + ' is 0')\n                this.__changeCanvasSize(attrName as ICanvasSizeAttr, newValue as number)\n            } else if (attrName === 'fill') {\n                this.__changeFill(newValue as string)\n            } else if (attrName === 'hittable') {\n                if (!this.parent) this.canvas.hittable = newValue as boolean\n            } else if (attrName === 'zIndex') {\n                this.canvas.zIndex = newValue as any\n                setTimeout(() => this.parent && this.parent.__updateSortChildren())\n            } else if (attrName === 'mode') this.emit(LeaferEvent.UPDATE_MODE, { mode: newValue })\n        }\n        return super.__setAttr(attrName, newValue)\n    }\n\n    override __getAttr(attrName: string): IValue {\n        if (this.canvas && canvasSizeAttrs.includes(attrName)) return this.canvas[attrName]\n        return super.__getAttr(attrName)\n    }\n\n    protected __changeCanvasSize(attrName: ICanvasSizeAttr, newValue: number): void {\n        const { config, canvas } = this\n        const data = DataHelper.copyAttrs({}, canvas, canvasSizeAttrs)\n        data[attrName] = config[attrName] = newValue\n        config.width && config.height ? canvas.stopAutoLayout() : this.__checkAutoLayout()\n        this.__doResize(data as IScreenSizeData)\n    }\n\n    protected __changeFill(newValue: string): void {\n        this.config.fill = newValue as string\n        if (this.canvas.allowBackgroundColor) this.canvas.backgroundColor = newValue as string\n        else this.forceRender()\n    }\n\n    protected __onCreated(): void {\n        this.created = true\n    }\n\n    protected __onReady(): void {\n        this.ready = true\n        this.emitLeafer(LeaferEvent.BEFORE_READY)\n        this.emitLeafer(LeaferEvent.READY)\n        this.emitLeafer(LeaferEvent.AFTER_READY)\n        WaitHelper.run(this.__readyWait)\n    }\n\n    protected __onViewReady(): void {\n        if (this.viewReady) return\n        this.viewReady = true\n        this.emitLeafer(LeaferEvent.VIEW_READY)\n        WaitHelper.run(this.__viewReadyWait)\n    }\n\n    protected __onLayoutEnd(): void {\n        const { grow, width: fixedWidth, height: fixedHeight } = this.config\n        if (grow) {\n            let { width, height, pixelRatio } = this\n            const bounds = grow === 'box' ? this.worldBoxBounds : this.__world\n            if (!fixedWidth) width = Math.max(1, bounds.x + bounds.width)\n            if (!fixedHeight) height = Math.max(1, bounds.y + bounds.height)\n            this.__doResize({ width, height, pixelRatio })\n        }\n\n        if (!this.ready) this.__onReady()\n    }\n\n    protected __onNextRender(): void {\n        if (this.viewReady) {\n            WaitHelper.run(this.__nextRenderWait)\n\n            const { imageReady } = this\n            if (imageReady && !this.viewCompleted) this.__checkViewCompleted()\n            if (!imageReady) {\n                this.viewCompleted = false\n                this.requestRender()\n            }\n        } else this.requestRender() // fix: 小程序等需要异步获取 view 的情况\n    }\n\n    protected __checkViewCompleted(emit: boolean = true): void {\n        this.nextRender(() => {\n            if (this.imageReady) {\n                if (emit) this.emitLeafer(LeaferEvent.VIEW_COMPLETED)\n                WaitHelper.run(this.__viewCompletedWait)\n                this.viewCompleted = true\n            }\n        })\n    }\n\n    protected __onWatchData(): void {\n        if (this.watcher.childrenChanged && this.interaction) {\n            this.nextRender(() => this.interaction.updateCursor())\n        }\n    }\n\n    public waitInit(item: IFunction, bind?: IObject): void {\n        if (bind) item = item.bind(bind)\n        if (!this.__initWait) this.__initWait = [] // set() use\n        this.canvas ? item() : this.__initWait.push(item)\n    }\n\n    public waitReady(item: IFunction, bind?: IObject): void {\n        if (bind) item = item.bind(bind)\n        this.ready ? item() : this.__readyWait.push(item)\n    }\n\n    public waitViewReady(item: IFunction, bind?: IObject): void {\n        if (bind) item = item.bind(bind)\n        this.viewReady ? item() : this.__viewReadyWait.push(item)\n    }\n\n    public waitViewCompleted(item: IFunction, bind?: IObject): void {\n        if (bind) item = item.bind(bind)\n        this.__viewCompletedWait.push(item)\n        if (this.viewCompleted) this.__checkViewCompleted(false)\n        else if (!this.running) this.start()\n    }\n\n    public nextRender(item: IFunction, bind?: IObject, off?: 'off'): void {\n        if (bind) item = item.bind(bind)\n        const list = this.__nextRenderWait\n        if (off) {\n            for (let i = 0; i < list.length; i++) {\n                if (list[i] === item) { list.splice(i, 1); break }\n            }\n        } else list.push(item)\n        this.requestRender()\n    }\n\n    // need view plugin\n    public zoom(_zoomType: IZoomType, _optionsOrPadding?: IZoomOptions | IFourNumber, _scroll?: 'x' | 'y' | boolean, _transition?: ITransition): IBoundsData {\n        return Plugin.need('view')\n    }\n\n\n    // interaction window rewrite\n    public getValidMove(moveX: number, moveY: number, _checkLimit?: boolean): IPointData { return { x: moveX, y: moveY } }\n    public getValidScale(changeScale: number): number { return changeScale }\n\n\n    public getWorldPointByClient(clientPoint: IClientPointData, updateClient?: boolean): IPointData {\n        return this.interaction && this.interaction.getLocal(clientPoint, updateClient)\n    }\n\n    public getPagePointByClient(clientPoint: IClientPointData, updateClient?: boolean): IPointData {\n        return this.getPagePoint(this.getWorldPointByClient(clientPoint, updateClient))\n    }\n\n    public getClientPointByWorld(worldPoint: IPointData): IPointData {\n        const { x, y } = this.clientBounds\n        return { x: x + worldPoint.x, y: y + worldPoint.y }\n    }\n\n    public updateClientBounds(): void {\n        this.canvas && this.canvas.updateClientBounds()\n    }\n\n    // miniapp rewrite\n    public receiveEvent(_event: any): void { }\n\n    protected emitLeafer(type: string): void {\n        this.emitEvent(new LeaferEvent(type, this))\n    }\n\n    protected __listenEvents(): void {\n        const runId = Run.start('FirstCreate ' + this.innerName)\n        this.once([\n            [LeaferEvent.START, () => Run.end(runId)],\n            [LayoutEvent.START, this.updateLazyBounds, this],\n            [RenderEvent.START, this.__onCreated, this],\n            [RenderEvent.END, this.__onViewReady, this]\n        ])\n        this.__eventIds.push(\n            this.on_([\n                [WatchEvent.DATA, this.__onWatchData, this],\n                [LayoutEvent.END, this.__onLayoutEnd, this],\n                [RenderEvent.NEXT, this.__onNextRender, this]\n            ])\n        )\n    }\n\n    protected __removeListenEvents(): void {\n        this.off_(this.__eventIds)\n    }\n\n    override destroy(sync?: boolean): void {\n        const doDestory = () => {\n            if (!this.destroyed) {\n                Leafer.list.remove(this)\n                try {\n                    this.stop()\n                    this.emitLeafer(LeaferEvent.END)\n                    this.__removeListenEvents()\n\n                    this.__controllers.forEach(item => !(this.parent && item === this.interaction) && item.destroy())\n                    this.__controllers.length = 0\n\n                    if (!this.parent) {\n                        if (this.selector) this.selector.destroy()\n                        if (this.hitCanvasManager) this.hitCanvasManager.destroy()\n                        if (this.canvasManager) this.canvasManager.destroy()\n                    }\n\n                    if (this.canvas) this.canvas.destroy()\n\n                    this.config.view = this.parentApp = null\n                    if (this.userConfig) this.userConfig.view = null\n\n                    super.destroy()\n\n                    setTimeout(() => { ImageManager.clearRecycled() }, 100)\n                } catch (e) {\n                    debug.error(e)\n                }\n            }\n        }\n        sync ? doDestory() : setTimeout(doDestory)\n    }\n}\n","import { dataProcessor, registerUI, rewriteAble, useModule } from '@leafer/core'\n\nimport { IRect, IRectInputData, IRectData } from '@leafer-ui/interface'\nimport { RectData } from '@leafer-ui/data'\nimport { RectRender } from '@leafer-ui/display-module'\n\nimport { UI } from './UI'\n\n\n@useModule(RectRender)\n@rewriteAble()\n@registerUI()\nexport class Rect<TInputData = IRectInputData> extends UI<TInputData> implements IRect { // tip: rewrited Box\n\n    public get __tag() { return 'Rect' }\n\n    @dataProcessor(RectData)\n    declare public __: IRectData\n\n}","import { ILeaferCanvas, IRenderOptions, IBoolean, INumber, IScrollPointData, IFourNumber } from '@leafer/interface'\nimport { rewrite, rewriteAble, registerUI, BoundsHelper, dataProcessor, affectRenderBoundsType, dataType, boundsType, DataHelper, getBoundsData } from '@leafer/core'\n\nimport { IBox, IBoxData, IBoxInputData, IOverflow, IScrollConfig, IScroller } from '@leafer-ui/interface'\nimport { BoxData } from '@leafer-ui/data'\n\nimport { Group } from './Group'\nimport { Rect } from './Rect'\n\n\nconst { add, includes, scroll } = BoundsHelper\nconst rect = Rect.prototype, group = Group.prototype\n\n@rewriteAble()\n@registerUI()\nexport class Box<TInputData = IBoxInputData> extends Group<TInputData> implements IBox {\n\n    public get __tag() { return 'Box' }\n\n    public get isBranchLeaf(): boolean { return true }\n\n    @dataProcessor(BoxData)\n    declare public __: IBoxData\n\n    // size\n    @boundsType(100)\n    declare public width?: INumber\n\n    @boundsType(100)\n    declare public height?: INumber\n\n    @dataType(false)\n    public resizeChildren?: IBoolean\n\n    // @leafer-in/editor rewrite\n    public textBox?: IBoolean\n\n    @affectRenderBoundsType('show')\n    declare public overflow?: IOverflow\n\n    public isOverflow?: boolean\n\n    // scroller will rewrite\n    public scrollConfig?: IScrollConfig\n\n    public scroller?: IScroller\n    public hasScroller?: boolean\n\n    constructor(data?: TInputData) {\n        super(data)\n        this.__layout.renderChanged || this.__layout.renderChange()\n    }\n\n    @rewrite(rect.__updateStrokeSpread)\n    public __updateStrokeSpread(): IFourNumber { return 0 }\n\n    @rewrite(rect.__updateRenderSpread)\n    public __updateRectRenderSpread(): IFourNumber { return 0 }\n\n    public __updateRenderSpread(): IFourNumber { return this.__updateRectRenderSpread() || -1 }\n\n\n    @rewrite(rect.__updateBoxBounds)\n    public __updateRectBoxBounds(): void { }\n\n\n    // @leafer-in/flow will rewrite\n    public __updateBoxBounds(_secondLayout?: boolean): void {\n        if (this.children.length && !this.pathInputed) {\n\n            const data = this.__\n\n            if (data.__autoSide) {\n\n                if (data.__hasSurface) this.__extraUpdate() // Box自身存在样式，需要额外更新\n\n                super.__updateBoxBounds()\n\n                const { boxBounds } = this.__layout\n\n                if (!data.__autoSize) {\n                    if (data.__autoWidth) {\n                        boxBounds.width += boxBounds.x, boxBounds.x = 0\n                        boxBounds.height = data.height, boxBounds.y = 0\n                    } else {\n                        boxBounds.height += boxBounds.y, boxBounds.y = 0\n                        boxBounds.width = data.width, boxBounds.x = 0\n                    }\n                }\n\n                this.__updateNaturalSize()\n\n            } else this.__updateRectBoxBounds()\n\n        } else this.__updateRectBoxBounds()\n    }\n\n    @rewrite(rect.__updateStrokeBounds)\n    public __updateStrokeBounds(): void { }\n\n    public __updateRenderBounds(): void {\n        let isOverflow: boolean, isScrollMode: boolean\n\n        if (this.children.length) {\n            const data = this.__, layout = this.__layout, { renderBounds, boxBounds } = layout, { overflow } = data\n\n            const childrenRenderBounds = layout.childrenRenderBounds || (layout.childrenRenderBounds = getBoundsData())\n            super.__updateRenderBounds(childrenRenderBounds)\n\n            if (isScrollMode = overflow && overflow.includes('scroll')) {  // 检查滚动逻辑\n                add(childrenRenderBounds, boxBounds)\n                scroll(childrenRenderBounds, data as IScrollPointData)\n            }\n\n            this.__updateRectRenderBounds()\n\n            isOverflow = !includes(boxBounds, childrenRenderBounds)\n            if (isOverflow && overflow === 'show') add(renderBounds, childrenRenderBounds)\n        } else this.__updateRectRenderBounds()\n\n        DataHelper.stintSet(this, 'isOverflow', isOverflow)\n\n        this.__checkScroll(isScrollMode)\n    }\n\n    @rewrite(rect.__updateRenderBounds)\n    public __updateRectRenderBounds(): void { }\n\n\n    //  scroller will rewrite\n    public __checkScroll(_isScrollMode: boolean): void { }\n\n\n    @rewrite(rect.__updateChange)\n    public __updateRectChange(): void { }\n\n    public __updateChange(): void {\n        super.__updateChange()\n        this.__updateRectChange()\n    }\n\n\n    @rewrite(rect.__render)\n    public __renderRect(_canvas: ILeaferCanvas, _options: IRenderOptions): void { }\n\n    @rewrite(group.__render)\n    public __renderGroup(_canvas: ILeaferCanvas, _options: IRenderOptions): void { }\n\n\n    public __render(canvas: ILeaferCanvas, options: IRenderOptions): void {\n        if (this.__.__drawAfterFill) {\n            this.__renderRect(canvas, options)\n        } else {\n            this.__renderRect(canvas, options)\n            if (this.children.length) this.__renderGroup(canvas, options)\n        }\n        if (this.hasScroller) this.scroller.__render(canvas, options)\n    }\n\n    // in __drawAfterFill()\n    public __drawContent(canvas: ILeaferCanvas, options: IRenderOptions): void {\n        this.__renderGroup(canvas, options)\n\n        if (this.__.__useStroke || this.__.__useEffect) { // 还原绘制路径\n            canvas.setWorld(this.__nowWorld)\n            this.__drawRenderPath(canvas)\n        }\n    }\n\n}\n","import { dataProcessor, registerUI, affectRenderBoundsType, surfaceType } from '@leafer/core'\n\nimport { IFrame, IFrameData, IFrameInputData, IFill, IOverflow } from '@leafer-ui/interface'\nimport { FrameData } from '@leafer-ui/data'\n\nimport { Box } from './Box'\n\n\n@registerUI()\nexport class Frame<TInputData = IFrameInputData> extends Box<TInputData> implements IFrame {\n\n    public get __tag() { return 'Frame' }\n\n    public get isFrame(): boolean { return true }\n\n    @dataProcessor(FrameData)\n    declare public __: IFrameData\n\n    @surfaceType('#FFFFFF')\n    declare public fill?: IFill\n\n    @affectRenderBoundsType('hide')\n    declare public overflow?: IOverflow\n\n}\n","import { INumber } from '@leafer/interface'\nimport { PathCommandDataHelper, Platform, dataProcessor, pathType, registerUI } from '@leafer/core'\n\nimport { IEllipse, IEllipseInputData, IEllipseData } from '@leafer-ui/interface'\nimport { EllipseData } from '@leafer-ui/data'\n\nimport { UI } from './UI'\n\n\nconst { moveTo, closePath, ellipse } = PathCommandDataHelper\n\n@registerUI()\nexport class Ellipse<TInputData = IEllipseInputData> extends UI<TInputData> implements IEllipse {\n\n    public get __tag() { return 'Ellipse' }\n\n    @dataProcessor(EllipseData)\n    declare public __: IEllipseData\n\n    @pathType(0)\n    public innerRadius?: INumber\n\n    @pathType(0)\n    public startAngle?: INumber\n\n    @pathType(0)\n    public endAngle?: INumber\n\n\n    public __updatePath(): void {\n\n        const { width, height, innerRadius, startAngle, endAngle } = this.__\n        const rx = width / 2, ry = height / 2\n\n        const path: number[] = this.__.path = []\n        let open: boolean\n\n        if (innerRadius) {\n\n            if (startAngle || endAngle) {\n                if (innerRadius < 1) ellipse(path, rx, ry, rx * innerRadius, ry * innerRadius, 0, startAngle, endAngle, false)\n                else open = true // 画弧线时，不能闭合路径\n                ellipse(path, rx, ry, rx, ry, 0, endAngle, startAngle, true)\n            } else {\n                if (innerRadius < 1) {\n                    ellipse(path, rx, ry, rx * innerRadius, ry * innerRadius)\n                    moveTo(path, width, ry)\n                }\n                ellipse(path, rx, ry, rx, ry, 0, 360, 0, true)\n            }\n\n        } else {\n\n            if (startAngle || endAngle) {\n                moveTo(path, rx, ry)\n                ellipse(path, rx, ry, rx, ry, 0, startAngle, endAngle, false)\n            } else {\n                ellipse(path, rx, ry, rx, ry)\n            }\n\n        }\n\n        if (!open) closePath(path)\n\n        // fix node\n        if (Platform.ellipseToCurve) this.__.path = this.getPath(true)\n\n    }\n\n}","import { INumber, IPointData } from '@leafer/interface'\nimport { PathCommandDataHelper, dataProcessor, pathType, registerUI, rewriteAble } from '@leafer/core'\n\nimport { IPolygon, IPolygonData, IPolygonInputData } from '@leafer-ui/interface'\nimport { PolygonData } from '@leafer-ui/data'\n\nimport { UI } from './UI'\n\n\nconst { sin, cos, PI } = Math\nconst { moveTo, lineTo, closePath, drawPoints } = PathCommandDataHelper\n\n@rewriteAble()\n@registerUI()\nexport class Polygon<TInputData = IPolygonInputData> extends UI<TInputData> implements IPolygon {\n\n    public get __tag() { return 'Polygon' }\n\n    @dataProcessor(PolygonData)\n    declare public __: IPolygonData\n\n    @pathType(3)\n    public sides?: INumber\n\n    @pathType()\n    public points?: number[] | IPointData[]\n\n    @pathType(0)\n    public curve?: boolean | number\n\n\n    public __updatePath(): void {\n\n        const data = this.__\n        const path: number[] = data.path = []\n\n        if (data.points) {\n\n            drawPoints(path, data.points, data.curve, true)\n\n        } else {\n\n            const { width, height, sides } = data\n            const rx = width / 2, ry = height / 2\n\n            moveTo(path, rx, 0)\n\n            for (let i = 1; i < sides; i++) {\n                lineTo(path, rx + rx * sin((i * 2 * PI) / sides), ry - ry * cos((i * 2 * PI) / sides))\n            }\n\n            closePath(path)\n\n        }\n\n    }\n\n}","import { INumber } from '@leafer/interface'\nimport { PathCommandDataHelper, dataProcessor, pathType, registerUI } from '@leafer/core'\n\nimport { IStar, IStarData, IStarInputData } from '@leafer-ui/interface'\nimport { StarData } from '@leafer-ui/data'\n\nimport { UI } from './UI'\n\n\nconst { sin, cos, PI } = Math\nconst { moveTo, lineTo, closePath } = PathCommandDataHelper\n\n\n@registerUI()\nexport class Star<TInputData = IStarInputData> extends UI<TInputData> implements IStar {\n\n    public get __tag() { return 'Star' }\n\n    @dataProcessor(StarData)\n    declare public __: IStarData\n\n    @pathType(5)\n    public corners?: INumber\n\n    @pathType(0.382)\n    public innerRadius?: INumber\n\n\n    public __updatePath() {\n\n        const { width, height, corners, innerRadius } = this.__\n        const rx = width / 2, ry = height / 2\n\n        const path: number[] = this.__.path = []\n        moveTo(path, rx, 0)\n\n        for (let i = 1; i < corners * 2; i++) {\n            lineTo(path, rx + (i % 2 === 0 ? rx : rx * innerRadius) * sin((i * PI) / corners), ry - (i % 2 === 0 ? ry : ry * innerRadius) * cos((i * PI) / corners))\n        }\n\n        closePath(path)\n\n    }\n\n}","import { IPointData, INumber } from '@leafer/interface'\nimport { PathCommandDataHelper, PointHelper, boundsType, pathType, affectStrokeBoundsType, dataProcessor, registerUI, getPointData } from '@leafer/core'\n\nimport { ILine, ILineData, ILineInputData, IStrokeAlign } from '@leafer-ui/interface'\nimport { LineData } from '@leafer-ui/data'\n\nimport { UI } from './UI'\n\n\nconst { moveTo, lineTo, drawPoints } = PathCommandDataHelper\nconst { rotate, getAngle, getDistance, defaultPoint } = PointHelper\n\n\n@registerUI()\nexport class Line<TInputData = ILineInputData> extends UI<TInputData> implements ILine {\n\n    public get __tag() { return 'Line' }\n\n    @dataProcessor(LineData)\n    declare public __: ILineData\n\n    @affectStrokeBoundsType('center')\n    declare public strokeAlign?: IStrokeAlign\n\n    @boundsType(0)\n    declare public height?: INumber\n\n    @pathType()\n    public points?: number[] | IPointData[]\n\n    @pathType(0)\n    public curve?: boolean | number\n\n    @pathType(false)\n    declare public closed?: boolean\n\n    public get toPoint(): IPointData {\n        const { width, rotation } = this.__\n        const to: IPointData = getPointData()\n\n        if (width) to.x = width\n        if (rotation) rotate(to, rotation)\n\n        return to\n    }\n\n    public set toPoint(value: IPointData) {\n        this.width = getDistance(defaultPoint, value)\n        this.rotation = getAngle(defaultPoint, value)\n        if (this.height) this.height = 0\n    }\n\n\n    public __updatePath(): void {\n\n        const data = this.__\n        const path: number[] = data.path = []\n\n        if (data.points) {\n\n            drawPoints(path, data.points, data.curve, data.closed)\n\n        } else {\n\n            moveTo(path, 0, 0)\n            lineTo(path, this.width, 0)\n        }\n\n    }\n\n}","import { ILeaferImage, IString } from '@leafer/interface'\nimport { boundsType, dataProcessor, registerUI, isArray } from '@leafer/core'\n\nimport { IImage, IImageInputData, IImageData } from '@leafer-ui/interface'\nimport { ImageData } from '@leafer-ui/data'\n\nimport { Rect } from './Rect'\n\n\n@registerUI()\nexport class Image<TInputData = IImageInputData> extends Rect<TInputData> implements IImage {\n\n    public get __tag() { return 'Image' }\n\n    @dataProcessor(ImageData)\n    declare public __: IImageData\n\n    @boundsType('')\n    public url: IString\n\n    public get ready(): boolean { const { image } = this; return image && image.ready }\n\n    public get image(): ILeaferImage { const { fill } = this.__; return isArray(fill) && fill[0].image }\n\n}\n\nexport const MyImage = Image","import { ILeaferCanvas, ILeaferCanvasConfig, INumber, IRenderOptions, IPointData, ICanvasContext2D, ICanvasContext2DSettings, IScreenSizeData } from '@leafer/interface'\nimport { Creator, ImageEvent, LeaferImage, Matrix, dataProcessor, dataType, registerUI, isNumber } from '@leafer/core'\n\nimport { ICanvas, ICanvasData, ICanvasInputData, IUI } from '@leafer-ui/interface'\nimport { CanvasData } from '@leafer-ui/data'\nimport { resizeType } from '@leafer-ui/decorator'\n\nimport { Rect } from './Rect'\n\n\n@registerUI()\nexport class Canvas<TInputData = ICanvasInputData> extends Rect<TInputData> implements ICanvas {\n\n    public get __tag() { return 'Canvas' }\n\n    @dataProcessor(CanvasData)\n    declare public __: ICanvasData\n\n    @resizeType(100)\n    declare public width?: INumber\n\n    @resizeType(100)\n    declare public height?: INumber\n\n    @resizeType(1)\n    declare public pixelRatio?: INumber\n\n    @resizeType(true)\n    public smooth?: boolean\n\n    @dataType(false)\n    public safeResize?: boolean\n\n    @resizeType()\n    public contextSettings?: ICanvasContext2DSettings\n\n    public canvas?: ILeaferCanvas\n\n    public get context(): ICanvasContext2D { return this.canvas.context }\n\n    public get ready(): boolean { return !this.url }\n\n    public url?: string // 用于临时加载canvas的base64数据，完成后会置空\n\n    constructor(data?: TInputData) {\n        super(data)\n        this.canvas = Creator.canvas(this.__ as ILeaferCanvasConfig)\n        if (data && (data as ICanvasInputData).url) this.drawImage((data as ICanvasInputData).url)\n    }\n\n    public drawImage(url: string): void {\n        new LeaferImage({ url }).load((image: LeaferImage) => {\n            this.context.drawImage(image.view, 0, 0)\n            this.url = undefined\n            this.paint()\n            this.emitEvent(new ImageEvent(ImageEvent.LOADED, { image }))\n        })\n    }\n\n    public draw(ui: IUI, offset?: IPointData, scale?: number | IPointData, rotation?: number): void {\n        const matrix = new Matrix(ui.worldTransform).invert()\n\n        const m = new Matrix()\n        if (offset) m.translate(offset.x, offset.y)\n        if (scale) isNumber(scale) ? m.scale(scale) : m.scale(scale.x, scale.y)\n        if (rotation) m.rotate(rotation)\n        matrix.multiplyParent(m)\n\n        ui.__render(this.canvas, { matrix: matrix.withScale() })\n        this.paint()\n    }\n\n    public paint(): void {\n        this.forceRender()\n    }\n\n    // in __drawAfterFill()\n    public __drawContent(canvas: ILeaferCanvas, _options: IRenderOptions): void {\n        const { width, height } = this.__, { view } = this.canvas\n        canvas.drawImage(view, 0, 0, view.width, view.height, 0, 0, width, height)\n    }\n\n    public __updateSize(): void {\n        const { canvas } = this\n        if (canvas) {\n            const { smooth, safeResize } = this.__\n            canvas.resize(this.__ as IScreenSizeData, safeResize)\n            if (canvas.smooth !== smooth) canvas.smooth = smooth\n        }\n    }\n\n    public destroy(): void {\n        if (this.canvas) {\n            this.canvas.destroy()\n            this.canvas = null\n        }\n        super.destroy()\n    }\n\n}","import { ILeaferCanvas, IBoolean, INumber, IString, IBoundsData, IUnitData, IRenderOptions, IFourNumber } from '@leafer/interface'\nimport { BoundsHelper, boundsType, surfaceType, dataProcessor, registerUI, affectStrokeBoundsType, dataType, hitType, MathHelper, DataHelper } from '@leafer/core'\n\nimport { IFill, IText, IFontWeight, ITextCase, ITextDecoration, ITextData, ITextInputData, ITextAlign, IVerticalAlign, ITextDrawData, ITextOverflow, IStrokeAlign, IHitType, ITextWrap, IWritingMode, IBackgroundBoxStyle } from '@leafer-ui/interface'\nimport { TextData } from '@leafer-ui/data'\n\nimport { TextConvert, UnitConvert } from '@leafer-ui/external'\n\nimport { UI } from './UI'\n\n\nconst { copyAndSpread, includes, spread, setList } = BoundsHelper, { stintSet } = DataHelper\n\n@registerUI()\nexport class Text<TConstructorData = ITextInputData> extends UI<TConstructorData> implements IText {\n\n    public get __tag() { return 'Text' }\n\n    @dataProcessor(TextData)\n    declare public __: ITextData\n\n    // size\n    @boundsType(0)\n    declare public width?: INumber\n\n    @boundsType(0)\n    declare public height?: INumber\n\n    @surfaceType()\n    public boxStyle: IBackgroundBoxStyle\n\n    @dataType(false)\n    public resizeFontSize?: IBoolean\n\n    @surfaceType('#000000')\n    declare public fill?: IFill\n\n    @affectStrokeBoundsType('outside')\n    declare public strokeAlign?: IStrokeAlign\n\n    @hitType('all')\n    declare public hitFill?: IHitType\n\n    @boundsType('')\n    public text?: IString | INumber\n\n    @boundsType('')\n    public placeholder?: IString\n\n    @boundsType('caption')\n    public fontFamily?: IString\n\n    @boundsType(12)\n    public fontSize?: INumber\n\n    @boundsType('normal')\n    public fontWeight?: IFontWeight\n\n    @boundsType(false)\n    public italic?: IBoolean\n\n    @boundsType('none')\n    public textCase?: ITextCase\n\n    @boundsType('none')\n    public textDecoration?: ITextDecoration\n\n    @boundsType(0)\n    public letterSpacing?: INumber | IUnitData\n\n    @boundsType({ type: 'percent', value: 1.5 } as IUnitData)\n    public lineHeight?: INumber | IUnitData\n\n    @boundsType(0)\n    public paraIndent?: INumber\n\n    @boundsType(0)\n    public paraSpacing?: INumber\n\n    @boundsType('x')\n    public writingMode?: IWritingMode\n\n    @boundsType('left')\n    public textAlign?: ITextAlign\n\n    @boundsType('top')\n    public verticalAlign?: IVerticalAlign\n\n    @boundsType(true)\n    public autoSizeAlign?: IBoolean\n\n    @boundsType('normal')\n    public textWrap?: ITextWrap\n\n    @boundsType('show')\n    public textOverflow?: ITextOverflow\n\n    @surfaceType(false)\n    public textEditing: boolean\n\n    public isOverflow: boolean\n\n    public get textDrawData(): ITextDrawData { this.updateLayout(); return this.__.__textDrawData }\n\n\n    public __updateTextDrawData(): void {\n        const data = this.__\n        const { lineHeight, letterSpacing, fontFamily, fontSize, fontWeight, italic, textCase, textOverflow, padding, width, height } = data\n\n        data.__lineHeight = UnitConvert.number(lineHeight, fontSize)\n        data.__letterSpacing = UnitConvert.number(letterSpacing, fontSize)\n        data.__baseLine = data.__lineHeight - (data.__lineHeight - fontSize * 0.7) / 2 // 基线位置\n        data.__font = `${italic ? 'italic ' : ''}${textCase === 'small-caps' ? 'small-caps ' : ''}${fontWeight !== 'normal' ? fontWeight + ' ' : ''}${fontSize || 12}px ${fontFamily || 'caption'}`\n\n        stintSet(data, '__padding', padding && MathHelper.fourNumber(padding))\n        stintSet(data, '__clipText', textOverflow !== 'show' && !data.__autoSize)\n        stintSet(data, '__isCharMode', (width || height || data.__letterSpacing || (textCase !== 'none')) as boolean)\n\n        data.__textDrawData = TextConvert.getDrawData((data.__isPlacehold = data.placeholder && data.text === '') ? data.placeholder : data.text, this.__)\n    }\n\n    override __updateBoxBounds(): void {\n\n        const data = this.__\n        const layout = this.__layout\n        const { fontSize, italic, padding, __autoWidth: autoWidth, __autoHeight: autoHeight } = data\n\n        this.__updateTextDrawData() // layout text\n\n        const { bounds: contentBounds } = data.__textDrawData\n        const b = layout.boxBounds\n\n        layout.contentBounds = contentBounds\n\n        if (data.__lineHeight < fontSize) spread(contentBounds, fontSize / 2)\n\n        if (autoWidth || autoHeight) {\n            b.x = autoWidth ? contentBounds.x : 0\n            b.y = autoHeight ? contentBounds.y : 0\n            b.width = autoWidth ? contentBounds.width : data.width\n            b.height = autoHeight ? contentBounds.height : data.height\n\n            if (padding) {\n                const [top, right, bottom, left] = data.__padding\n                if (autoWidth) b.x -= left, b.width += (right + left)\n                if (autoHeight) b.y -= top, b.height += (bottom + top)\n            }\n            this.__updateNaturalSize()\n        } else super.__updateBoxBounds()\n\n        if (italic) b.width += fontSize * 0.16 // 倾斜会导致文本的bounds增大\n\n        DataHelper.stintSet(this, 'isOverflow', !includes(b, contentBounds))\n\n        if (this.isOverflow) setList(data.__textBoxBounds = {} as IBoundsData, [b, contentBounds]), layout.renderChanged = true\n        else data.__textBoxBounds = b\n    }\n\n    override __updateRenderSpread(): IFourNumber {\n        let spread = super.__updateRenderSpread()\n        if (!spread) spread = this.isOverflow ? 1 : 0\n        return spread\n    }\n\n    override __updateRenderBounds(): void {\n        const { renderBounds, renderSpread } = this.__layout\n        copyAndSpread(renderBounds, this.__.__textBoxBounds, renderSpread)\n        if (this.__box) this.__box.__layout.renderBounds = renderBounds\n    }\n\n    override __updateChange(): void {\n        super.__updateChange()\n        const box = this.__box\n        if (box) box.__onUpdateSize(), box.__updateChange()\n    }\n\n    override __drawRenderPath(canvas: ILeaferCanvas): void {\n        canvas.font = this.__.__font\n    }\n\n    override __draw(canvas: ILeaferCanvas, options: IRenderOptions, originCanvas?: ILeaferCanvas): void {\n        const box = this.__box\n        if (box) box.__nowWorld = this.__nowWorld, box.__draw(canvas, options, originCanvas)\n        if (this.textEditing && !options.exporting) return\n        super.__draw(canvas, options, originCanvas)\n    }\n\n    override  __drawShape(canvas: ILeaferCanvas, options: IRenderOptions): void {\n        if (options.shape) this.__box && this.__box.__drawShape(canvas, options)\n        super.__drawShape(canvas, options)\n    }\n\n    override destroy(): void {\n        if (this.boxStyle) this.boxStyle = null\n        super.destroy()\n    }\n\n}","import { dataProcessor, affectStrokeBoundsType, registerUI } from '@leafer/core'\n\nimport { IPath, IPathData, IPathInputData, IStrokeAlign } from '@leafer-ui/interface'\nimport { PathData } from '@leafer-ui/data'\n\nimport { UI } from './UI'\n\n\n@registerUI()\nexport class Path<TInputData = IPathInputData> extends UI<TInputData> implements IPath {\n\n    public get __tag() { return 'Path' }\n\n    @dataProcessor(PathData)\n    declare public __: IPathData\n\n    @affectStrokeBoundsType('center')\n    declare public strokeAlign?: IStrokeAlign\n\n}","import { PathCreator, dataProcessor, defineKey, registerUI, useModule } from '@leafer/core'\n\nimport { IPenData, IPenInputData, IPathInputData, IPathCommandData, IPath, IPen, IPointData } from '@leafer-ui/interface'\nimport { PenData } from '@leafer-ui/data'\n\nimport { Group } from './Group'\nimport { Path } from './Path'\n\n@useModule(PathCreator, ['set', 'path', 'paint'])\n@registerUI()\nexport class Pen<TInputData = IPenInputData> extends Group<TInputData> implements IPen {\n\n    public get __tag() { return 'Pen' }\n\n    @dataProcessor(PenData)\n    declare public __: IPenData\n\n    public pathElement: IPath\n    public pathStyle: IPathInputData\n\n    @penPathType()\n    declare public path: IPathCommandData // use __path, readonly\n\n    public __path: IPathCommandData\n\n\n    public setStyle(data: IPathInputData): Pen {\n        const path = this.pathElement = new Path(data)\n        this.pathStyle = data\n        this.__path = path.path as IPathCommandData || (path.path = [])\n        this.add(path)\n        return this\n    }\n\n    // svg and canvas\n\n    public beginPath(): Pen { return this }\n\n    public moveTo(_x: number, _y: number): Pen { return this }\n\n    public lineTo(_x: number, _y: number): Pen { return this }\n\n    public bezierCurveTo(_x1: number, _y1: number, _x2: number, _y2: number, _x: number, _y: number): Pen { return this }\n\n    public quadraticCurveTo(_x1: number, _y1: number, _x: number, _y: number): Pen { return this }\n\n    public closePath(): Pen { return this }\n\n\n    // canvas\n\n    public rect(_x: number, _y: number, _width: number, _height: number): Pen { return this }\n\n    public roundRect(_x: number, _y: number, _width: number, _height: number, _cornerRadius: number | number[]): Pen { return this }\n\n    public ellipse(_x: number, _y: number, _radiusX: number, _radiusY: number, _rotation?: number, _startAngle?: number, _endAngle?: number, _anticlockwise?: boolean): Pen { return this }\n\n    public arc(_x: number, _y: number, _radius: number, _startAngle?: number, _endAngle?: number, _anticlockwise?: boolean): Pen { return this }\n\n    public arcTo(_x1: number, _y1: number, _x2: number, _y2: number, _radius: number): Pen { return this }\n\n\n    // moveTo, then draw\n\n    public drawEllipse(_x: number, _y: number, _radiusX: number, _radiusY: number, _rotation?: number, _startAngle?: number, _endAngle?: number, _anticlockwise?: boolean): Pen { return this }\n\n    public drawArc(_x: number, _y: number, _radius: number, _startAngle?: number, _endAngle?: number, _anticlockwise?: boolean): Pen { return this }\n\n    public drawPoints(_points: number[] | IPointData[], _curve?: boolean | number, _close?: boolean): Pen { return this }\n\n    public clearPath(): Pen { return this } // = beginPath()\n\n\n    public paint(): void {\n        if (!this.pathElement.__layout.boxChanged) this.pathElement.forceUpdate('path')\n    }\n\n}\n\nfunction penPathType() {\n    return (target: IPen, key: string) => {\n        defineKey(target, key, {\n            get() { return this.__path }\n        })\n    }\n}","import { ILeaferConfig, IResizeEvent, ILeaferCanvas, IRenderOptions, ILeaferBase, IBoundsData } from '@leafer/interface'\nimport { Creator, DataHelper, LayoutEvent, RenderEvent, canvasSizeAttrs, registerUI, isUndefined } from '@leafer/core'\n\nimport { IApp, IAppConfig, IAppForEachFunction, IAppInputData, ILeafer } from '@leafer-ui/interface'\n\nimport { Leafer } from '@leafer-ui/draw'\n\n\n@registerUI()\nexport class App extends Leafer implements IApp {\n\n    public get __tag() { return 'App' }\n\n    public get isApp(): boolean { return true }\n\n    declare public children: ILeafer[]\n\n    public realCanvas: boolean\n\n    public ground: ILeafer\n    public tree: ILeafer\n    public sky: ILeafer\n\n    constructor(userConfig?: IAppConfig, data?: IAppInputData) {\n        super(userConfig, data)\n    }\n\n    override init(userConfig?: IAppConfig, parentApp?: IApp): void {\n        super.init(userConfig, parentApp)\n        if (userConfig) {\n            const { ground, tree, sky, editor } = userConfig\n            if (ground) this.ground = this.addLeafer(ground)\n            if (tree || editor) this.tree = this.addLeafer(tree || { type: userConfig.type || 'design' })\n            if (sky || editor) this.sky = this.addLeafer(sky)\n            if (editor) Creator.editor(editor, this)\n        }\n    }\n\n    protected __setApp(): void {\n        const { canvas } = this\n        const { realCanvas, view } = this.config\n        if (realCanvas || view === this.canvas.view || !canvas.parentView) this.realCanvas = true\n        else canvas.unrealCanvas()\n\n        this.leafer = this\n        this.watcher.disable()\n        this.layouter.disable()\n    }\n\n    override __updateLocalBounds(): void {\n        this.forEach(leafer => leafer.updateLayout())\n        super.__updateLocalBounds()\n    }\n\n    override start(): void {\n        super.start()\n        this.forEach(leafer => leafer.start())\n    }\n\n    override stop(): void {\n        this.forEach(leafer => leafer.stop())\n        super.stop()\n    }\n\n    override unlockLayout(): void {\n        super.unlockLayout()\n        this.forEach(leafer => leafer.unlockLayout())\n    }\n\n    override lockLayout(): void {\n        super.lockLayout()\n        this.forEach(leafer => leafer.lockLayout())\n    }\n\n    override forceRender(bounds?: IBoundsData, sync?: boolean): void {\n        this.forEach(leafer => leafer.forceRender(bounds, sync))\n    }\n\n    public addLeafer(merge?: ILeaferConfig): Leafer {\n        const leafer = new Leafer(merge)\n        this.add(leafer)\n        return leafer\n    }\n\n    override add(leafer: ILeafer, index?: number): void {\n        if (!leafer.view) {\n            if (this.realCanvas && !this.canvas.bounds) { // wait miniapp select canvas\n                setTimeout(() => this.add(leafer, index), 10)\n                return\n            }\n            leafer.init(this.__getChildConfig(leafer.userConfig), this)\n        }\n\n        super.add(leafer, index)\n        if (!isUndefined(index)) leafer.canvas.childIndex = index\n        this.__listenChildEvents(leafer)\n    }\n\n    public forEach(fn: IAppForEachFunction): void {\n        this.children.forEach(fn)\n    }\n\n    protected __onCreated(): void {\n        this.created = this.children.every(child => child.created)\n    }\n\n    protected __onReady(): void {\n        if (this.children.every(child => child.ready)) super.__onReady()\n    }\n\n    protected __onViewReady(): void {\n        if (this.children.every(child => child.viewReady)) super.__onViewReady()\n    }\n\n    protected __onChildRenderEnd(e: RenderEvent): void {\n        this.renderer.addBlock(e.renderBounds)\n        if (this.viewReady) this.renderer.update()\n    }\n\n    override __render(canvas: ILeaferCanvas, options: IRenderOptions): void {\n        if (canvas.context) this.forEach(leafer => options.matrix ? leafer.__render(canvas, options) : canvas.copyWorld(leafer.canvas, options.bounds))\n    }\n\n    public __onResize(event: IResizeEvent): void {\n        this.forEach(leafer => leafer.resize(event))\n        super.__onResize(event)\n    }\n\n    public updateLayout(): void {\n        this.forEach(leafer => leafer.updateLayout())\n    }\n\n    protected __getChildConfig(userConfig?: ILeaferConfig): ILeaferConfig {\n        const config = { ...this.config }\n        config.hittable = config.realCanvas = undefined\n        if (userConfig) DataHelper.assign(config, userConfig)\n\n        // reset\n        if (this.autoLayout) DataHelper.copyAttrs(config, this, canvasSizeAttrs)\n        config.view = this.realCanvas ? undefined : this.view\n        config.fill = undefined\n        return config\n    }\n\n    protected __listenChildEvents(leafer: ILeaferBase): void {\n        leafer.once([\n            [LayoutEvent.END, this.__onReady, this],\n            [RenderEvent.START, this.__onCreated, this],\n            [RenderEvent.END, this.__onViewReady, this]\n        ])\n        if (this.realCanvas) this.__eventIds.push(leafer.on_(RenderEvent.END, this.__onChildRenderEnd, this))\n    }\n\n}","import { IBooleanMap, IShortcutKeyCodes, IShortcutKeys, IShortcutKeysCheck, IUIEvent } from '@leafer/interface'\n\n\nconst downKeyMap: IBooleanMap = {}\n\nexport const Keyboard = {\n\n    isHoldSpaceKey(): boolean {\n        return Keyboard.isHold('Space')\n    },\n\n    isHold(code: IShortcutKeyCodes): boolean {\n        return downKeyMap[code]\n    },\n\n    // 是否按住快捷键，可扩展语义化快捷键组合 ctrl + F || shift + F\n    isHoldKeys(shortcutKeys: IShortcutKeysCheck | IShortcutKeys, e?: IUIEvent): boolean {\n        return e ? (shortcutKeys as IShortcutKeysCheck)(e) : undefined\n    },\n\n    setDownCode(code: string): void {\n        if (!downKeyMap[code]) downKeyMap[code] = true\n    },\n\n    setUpCode(code: string): void {\n        downKeyMap[code] = false\n    }\n\n}","import { IUIEvent } from '@leafer/interface'\n\n\nexport const PointerButton = {\n\n    LEFT: 1,\n\n    RIGHT: 2,\n\n    MIDDLE: 4,\n\n    defaultLeft(event: IUIEvent): void { if (!event.buttons) event.buttons = 1 },\n\n    left(event: IUIEvent): boolean { return event.buttons === 1 },\n\n    right(event: IUIEvent): boolean { return event.buttons === 2 },\n\n    middle(event: IUIEvent): boolean { return event.buttons === 4 }\n\n}","import { ILeaf, ILeafList, IPointData, IUIEvent, IShortcutKeys, IShortcutKeysCheck } from '@leafer/interface'\nimport { Event, EventCreator } from '@leafer/core'\n\nimport { Keyboard } from './Keyboard'\nimport { PointerButton as B } from './PointerButton'\n\n\nexport class UIEvent extends Event implements IUIEvent {\n\n    readonly x: number\n    readonly y: number\n\n    readonly path: ILeafList\n    readonly throughPath?: ILeafList\n\n    readonly altKey: boolean\n    readonly ctrlKey: boolean\n    readonly shiftKey: boolean\n    readonly metaKey: boolean\n    public get spaceKey(): boolean { return Keyboard.isHoldSpaceKey() }\n\n    public get left(): boolean { return B.left(this) }\n    public get right(): boolean { return B.right(this) }\n    public get middle(): boolean { return B.middle(this) }\n    readonly buttons: number\n\n    declare readonly target: ILeaf\n    declare readonly current: ILeaf\n    readonly bubbles: boolean = true\n\n    readonly time: number\n\n    constructor(params: IUIEvent) {\n        super(params.type)\n        Object.assign(this, params)\n    }\n\n\n    public isHoldKeys(shortcutKeys?: IShortcutKeysCheck | IShortcutKeys): boolean {\n        return Keyboard.isHoldKeys(shortcutKeys, this)\n    }\n\n    public getBoxPoint(relative?: ILeaf): IPointData {\n        return (relative || this.current).getBoxPoint(this)\n    }\n\n    public getInnerPoint(relative?: ILeaf): IPointData {\n        return (relative || this.current).getInnerPoint(this)\n    }\n\n    public getLocalPoint(relative?: ILeaf): IPointData {\n        return (relative || this.current).getLocalPoint(this)\n    }\n\n    public getPagePoint(): IPointData {\n        return this.current.getPagePoint(this)\n    }\n\n    // 兼容代码，未来可移除\n    public getInner(relative?: ILeaf): IPointData { return this.getInnerPoint(relative) }\n    public getLocal(relative?: ILeaf): IPointData { return this.getLocalPoint(relative) }\n    public getPage(): IPointData { return this.getPagePoint() }\n    // ---\n\n    static changeName(oldName: string, newName: string): void {\n        EventCreator.changeName(oldName, newName)\n    }\n\n}","import { IPointData, IBoundsData, IDragBoundsType, ILeaf, ISide } from '@leafer/interface'\nimport { Bounds, BoundsHelper, MathHelper, isFinite } from '@leafer/core'\n\n\nconst { min, max, abs } = Math, { float, sign } = MathHelper, { minX, maxX, minY, maxY } = BoundsHelper\nconst tempContent = new Bounds(), tempDragBounds = new Bounds()\n\nexport const DragBoundsHelper = {\n\n    // 拖拽区域内移动\n    limitMove(leaf: ILeaf, move: IPointData): void {\n        const { dragBounds, dragBoundsType } = leaf\n        if (dragBounds) D.getValidMove(leaf.__localBoxBounds, D.getDragBounds(leaf), dragBoundsType, move, true)\n        D.axisMove(leaf, move)\n    },\n\n    // 拖拽区域内缩放\n    limitScaleOf(leaf: ILeaf, origin: IPointData, scale: IPointData, lockRatio?: boolean): void {\n        const { dragBounds, dragBoundsType } = leaf\n        if (dragBounds) D.getValidScaleOf(leaf.__localBoxBounds, D.getDragBounds(leaf), dragBoundsType, leaf.getLocalPointByInner(leaf.getInnerPointByBox(origin)), scale, lockRatio, true)\n    },\n\n    // 按轴移动\n    axisMove(leaf: ILeaf, move: IPointData) {\n        const { draggable } = leaf\n        if (draggable === 'x') move.y = 0\n        if (draggable === 'y') move.x = 0\n    },\n\n    getDragBounds(leaf: ILeaf): IBoundsData {\n        const { dragBounds } = leaf\n        return dragBounds === 'parent' ? leaf.parent.boxBounds : dragBounds\n    },\n\n    isInnerMode(content: IBoundsData, dragBounds: IBoundsData, dragBoundsType: IDragBoundsType, sideType: ISide): boolean {\n        return dragBoundsType === 'inner' || (dragBoundsType === 'auto' && content[sideType] > dragBounds[sideType])\n    },\n\n    getValidMove(content: IBoundsData, dragBounds: IBoundsData, dragBoundsType: IDragBoundsType, move: IPointData, change?: boolean): IPointData {\n        const x = content.x + move.x, y = content.y + move.y, right = x + content.width, bottom = y + content.height\n        const boundsRight = dragBounds.x + dragBounds.width, boundsBottom = dragBounds.y + dragBounds.height\n\n        if (!change) move = { ...move }\n\n        if (D.isInnerMode(content, dragBounds, dragBoundsType, 'width')) {  // inner 模式\n            if (x > dragBounds.x) move.x += dragBounds.x - x\n            else if (right < boundsRight) move.x += boundsRight - right\n        } else { // outer 模式\n            if (x < dragBounds.x) move.x += dragBounds.x - x\n            else if (right > boundsRight) move.x += boundsRight - right\n        }\n\n        if (D.isInnerMode(content, dragBounds, dragBoundsType, 'height')) { // inner 模式\n            if (y > dragBounds.y) move.y += dragBounds.y - y\n            else if (bottom < boundsBottom) move.y += boundsBottom - bottom\n        } else { // outer 模式\n            if (y < dragBounds.y) move.y += dragBounds.y - y\n            else if (bottom > boundsBottom) move.y += boundsBottom - bottom\n        }\n\n        // 避免出现为0的抖动小数\n        move.x = float(move.x)\n        move.y = float(move.y)\n\n        return move\n    },\n\n    getValidScaleOf(content: IBoundsData, dragBounds: IBoundsData, dragBoundsType: IDragBoundsType, origin: IPointData, scale: IPointData, lockRatio?: boolean, change?: boolean): IPointData {\n        if (!change) scale = { ...scale }\n\n        tempDragBounds.set(dragBounds)\n        tempContent.set(content).scaleOf(origin, scale.x, scale.y)\n\n        const originLeftScale = (origin.x - content.x) / content.width, originRightScale = 1 - originLeftScale\n        const originTopScale = (origin.y - content.y) / content.height, originBottomScale = 1 - originTopScale\n\n        let correctScaleX = 1, correctScaleY = 1, aScale: number, bScale: number, aSize: number, bSize: number\n\n        if (D.isInnerMode(content, dragBounds, dragBoundsType, 'width')) {  // inner 模式\n\n            if (scale.x < 0) tempContent.scaleOf(origin, correctScaleX = 1 / scale.x, 1) // 阻止镜像\n\n            aSize = float(tempContent.minX - tempDragBounds.minX)\n            bSize = float(tempDragBounds.maxX - tempContent.maxX)\n\n            aScale = originLeftScale && aSize > 0 ? 1 + aSize / (originLeftScale * tempContent.width) : 1\n            bScale = originRightScale && bSize > 0 ? 1 + bSize / (originRightScale * tempContent.width) : 1\n            correctScaleX *= max(aScale, bScale)\n\n        } else { // outer 模式\n\n            if (scale.x < 0) {\n                if (float(minX(content) - minX(dragBounds)) <= 0 || float(maxX(dragBounds) - maxX(content)) <= 0) tempContent.scaleOf(origin, correctScaleX = 1 / scale.x, 1) // 到达边界时阻止镜像\n                tempContent.unsign()\n            }\n\n            aSize = float(tempDragBounds.minX - tempContent.minX)\n            bSize = float(tempContent.maxX - tempDragBounds.maxX)\n\n            aScale = originLeftScale && aSize > 0 ? 1 - aSize / (originLeftScale * tempContent.width) : 1\n            bScale = originRightScale && bSize > 0 ? 1 - bSize / (originRightScale * tempContent.width) : 1\n            correctScaleX *= min(aScale, bScale)\n\n        }\n\n        if (D.isInnerMode(content, dragBounds, dragBoundsType, 'height')) { // inner 模式\n\n            if (scale.y < 0) tempContent.scaleOf(origin, 1, correctScaleY = 1 / scale.y) // 阻止镜像\n\n            aSize = float(tempContent.minY - tempDragBounds.minY)\n            bSize = float(tempDragBounds.maxY - tempContent.maxY)\n\n            aScale = originTopScale && aSize > 0 ? 1 + aSize / (originTopScale * tempContent.height) : 1\n            bScale = originBottomScale && bSize > 0 ? 1 + bSize / (originBottomScale * tempContent.height) : 1\n\n            correctScaleY *= max(aScale, bScale)\n\n            if (lockRatio) {\n                aScale = max(abs(correctScaleX), abs(correctScaleY))\n                correctScaleX = sign(correctScaleX) * aScale\n                correctScaleY = sign(correctScaleY) * aScale\n            }\n\n        } else { // outer 模式\n\n            if (scale.y < 0) {\n                if (float(minY(content) - minY(dragBounds)) <= 0 || float(maxY(dragBounds) - maxY(content)) <= 0) tempContent.scaleOf(origin, 1, correctScaleY = 1 / scale.y) // 到达边界时阻止镜像\n                tempContent.unsign()\n            }\n\n            aSize = float(tempDragBounds.minY - tempContent.minY)\n            bSize = float(tempContent.maxY - tempDragBounds.maxY)\n\n            aScale = originTopScale && aSize > 0 ? 1 - aSize / (originTopScale * tempContent.height) : 1\n            bScale = originBottomScale && bSize > 0 ? 1 - bSize / (originBottomScale * tempContent.height) : 1\n            correctScaleY *= min(aScale, bScale)\n\n        }\n\n        scale.x *= isFinite(correctScaleX) ? correctScaleX : 1\n        scale.y *= isFinite(correctScaleY) ? correctScaleY : 1\n\n        return scale\n    }\n}\n\nconst D = DragBoundsHelper","import { IPointerEvent, PointerType } from '@leafer/interface'\nimport { registerUIEvent } from '@leafer/core'\n\nimport { UIEvent } from './UIEvent'\n\n\n@registerUIEvent()\nexport class PointerEvent extends UIEvent implements IPointerEvent {\n\n    static POINTER = 'pointer'\n\n    static BEFORE_DOWN = 'pointer.before_down'\n    static BEFORE_MOVE = 'pointer.before_move'\n    static BEFORE_UP = 'pointer.before_up'\n\n    static DOWN = 'pointer.down'\n    static MOVE = 'pointer.move'\n    static UP = 'pointer.up'\n\n    static OVER = 'pointer.over'\n    static OUT = 'pointer.out'\n\n    static ENTER = 'pointer.enter'\n    static LEAVE = 'pointer.leave'\n\n    static TAP = 'tap'\n    static DOUBLE_TAP = 'double_tap'\n\n    static CLICK = 'click'\n    static DOUBLE_CLICK = 'double_click'\n\n    static LONG_PRESS = 'long_press'\n    static LONG_TAP = 'long_tap'\n\n    static MENU = 'pointer.menu'\n    static MENU_TAP = 'pointer.menu_tap'\n\n    public readonly width: number\n    public readonly height: number\n    public readonly pointerType: PointerType\n    public readonly moving?: boolean // 是否处于平移视图状态\n    public readonly dragging?: boolean // 是否处于拖拽状态\n    public readonly multiTouch?: boolean\n    public readonly pressure: number\n    public readonly tangentialPressure?: number\n    public readonly tiltX?: number\n    public readonly tiltY?: number\n    public readonly twist?: number\n\n}\n\nexport const MyPointerEvent = PointerEvent","import { IDragEvent, IPointData, ILeaf, ILeafList, IObject, IBoundsData } from '@leafer/interface'\nimport { registerUIEvent, LeafList, BoundsHelper, PointHelper } from '@leafer/core'\n\nimport { DragBoundsHelper } from './DragBoundsHelper'\nimport { PointerEvent } from './PointerEvent'\n\n\nconst tempMove = {} as IPointData\n\n@registerUIEvent()\nexport class DragEvent extends PointerEvent implements IDragEvent {\n\n    static BEFORE_DRAG = 'drag.before_drag'\n\n    static START = 'drag.start'\n    static DRAG = 'drag'\n    static END = 'drag.end'\n\n    static OVER = 'drag.over'\n    static OUT = 'drag.out'\n\n    static ENTER = 'drag.enter'\n    static LEAVE = 'drag.leave'\n\n    readonly moveX: number\n    readonly moveY: number\n    readonly totalX: number\n    readonly totalY: number\n\n    static list: ILeafList\n    static data: IObject\n\n    static setList(data: ILeaf | ILeaf[] | ILeafList): void {\n        this.list = data instanceof LeafList ? data : new LeafList(data as ILeaf[])\n    }\n\n    static setData(data: IObject): void {\n        this.data = data\n    }\n\n    static getValidMove(leaf: ILeaf, localStart: IPointData, worldTotal: IPointData, checkLimit = true): IPointData {\n        const move = leaf.getLocalPoint(worldTotal, null, true)\n        PointHelper.move(move, localStart.x - leaf.x, localStart.y - leaf.y)\n        if (checkLimit) this.limitMove(leaf, move)\n        DragBoundsHelper.axisMove(leaf, move)\n        return move\n    }\n\n    static limitMove(leaf: ILeaf, move: IPointData): void {\n        DragBoundsHelper.limitMove(leaf, move)\n    }\n\n    public getPageMove(total?: boolean): IPointData {\n        this.assignMove(total)\n        return this.current.getPagePoint(tempMove, null, true)\n    }\n\n    public getInnerMove(relative?: ILeaf, total?: boolean): IPointData {\n        if (!relative) relative = this.current\n        this.assignMove(total)\n        return relative.getInnerPoint(tempMove, null, true)\n    }\n\n    public getLocalMove(relative?: ILeaf, total?: boolean): IPointData {\n        if (!relative) relative = this.current\n        this.assignMove(total)\n        return relative.getLocalPoint(tempMove, null, true)\n    }\n\n    public getPageTotal(): IPointData {\n        return this.getPageMove(true)\n    }\n\n    public getInnerTotal(relative?: ILeaf): IPointData {\n        return this.getInnerMove(relative, true)\n    }\n\n    public getLocalTotal(relative?: ILeaf): IPointData {\n        return this.getLocalMove(relative, true)\n    }\n\n    public getPageBounds(): IBoundsData {\n        const total = this.getPageTotal(), start = this.getPagePoint(), bounds = {} as IBoundsData\n        BoundsHelper.set(bounds, start.x - total.x, start.y - total.y, total.x, total.y)\n        BoundsHelper.unsign(bounds)\n        return bounds\n    }\n\n    protected assignMove(total: boolean): void {\n        tempMove.x = total ? this.totalX : this.moveX\n        tempMove.y = total ? this.totalY : this.moveY\n    }\n\n}\n\nexport const MyDragEvent = DragEvent","import { IDropEvent, ILeaf, ILeafList, IObject } from '@leafer/interface'\nimport { registerUIEvent } from '@leafer/core'\n\nimport { PointerEvent } from './PointerEvent'\nimport { DragEvent } from './DragEvent'\n\n\n@registerUIEvent()\nexport class DropEvent extends PointerEvent implements IDropEvent {\n\n    static DROP = 'drop'\n\n    readonly list: ILeafList\n    readonly data: IObject\n\n    static setList(data: ILeaf | ILeaf[] | ILeafList): void {\n        DragEvent.setList(data)\n    }\n\n    static setData(data: IObject): void {\n        DragEvent.setData(data)\n    }\n\n}","import { IMoveEvent } from '@leafer/interface'\nimport { registerUIEvent } from '@leafer/core'\n\nimport { DragEvent } from './DragEvent'\n\n@registerUIEvent()\nexport class MoveEvent extends DragEvent implements IMoveEvent {\n\n    static BEFORE_MOVE = 'move.before_move'\n\n    static START = 'move.start'\n    static MOVE = 'move'\n    static DRAG_ANIMATE = 'move.drag_animate'\n    static END = 'move.end'\n\n    static PULL_DOWN = 'move.pull_down'\n    static REACH_BOTTOM = 'move.reach_bottom'\n\n    readonly moveType: 'drag' | 'move'\n}","import { ITouchEvent } from '@leafer/interface'\nimport { registerUIEvent } from '@leafer/core'\n\nimport { UIEvent } from './UIEvent'\n\n\n@registerUIEvent()\nexport class TouchEvent extends UIEvent implements ITouchEvent {\n\n}\n\nexport const MyTouchEvent = TouchEvent","import { IRotateEvent } from '@leafer/interface'\nimport { registerUIEvent } from '@leafer/core'\n\nimport { PointerEvent } from './PointerEvent'\n\n\n@registerUIEvent()\nexport class RotateEvent extends PointerEvent implements IRotateEvent {\n\n    static BEFORE_ROTATE = 'rotate.before_rotate'\n\n    static START = 'rotate.start'\n    static ROTATE = 'rotate'\n    static END = 'rotate.end'\n\n    readonly rotation: number\n    readonly totalRotation: number\n\n}","import { ISwipeEvent } from '@leafer/interface'\nimport { registerUIEvent } from '@leafer/core'\n\nimport { DragEvent } from './DragEvent'\n\n\n@registerUIEvent()\nexport class SwipeEvent extends DragEvent implements ISwipeEvent {\n\n    static SWIPE = 'swipe'\n\n    static LEFT = 'swipe.left'\n    static RIGHT = 'swipe.right'\n    static UP = 'swipe.up'\n    static DOWN = 'swipe.down'\n\n    readonly speed: number\n    readonly direction: string\n\n}","import { IZoomEvent } from '@leafer/interface'\nimport { registerUIEvent } from '@leafer/core'\n\nimport { PointerEvent } from './PointerEvent'\n\n@registerUIEvent()\nexport class ZoomEvent extends PointerEvent implements IZoomEvent {\n\n    static BEFORE_ZOOM = 'zoom.before_zoom'\n\n    static START = 'zoom.start'\n    static ZOOM = 'zoom'\n    static END = 'zoom.end'\n\n    readonly scale: number\n    readonly totalScale: number\n\n}","import { IKeyCodes, IKeyEvent } from '@leafer/interface'\nimport { registerUIEvent } from '@leafer/core'\n\nimport { UIEvent } from './UIEvent'\n\n\n@registerUIEvent()\nexport class KeyEvent extends UIEvent implements IKeyEvent {\n\n    static BEFORE_DOWN = 'key.before_down'\n    static BEFORE_UP = 'key.before_up'\n\n    static DOWN = 'key.down'\n    static HOLD = 'key.hold'\n    static UP = 'key.up'\n\n    public readonly code: IKeyCodes\n    public readonly key: string\n\n}","import { IPointerEvent, IDragEvent, ISwipeEvent, IUIEvent, IPointData, ILeafList, IDropEvent, IObject } from '@leafer/interface'\nimport { PointHelper, LeafList, isUndefined, LeafHelper } from '@leafer/core'\n\nimport { SwipeEvent, DragEvent } from '@leafer-ui/event'\n\n\nexport const InteractionHelper = {\n\n    getDragEventData(startPoint: IPointData, lastPoint: IPointData, event: IPointerEvent): IDragEvent {\n        return {\n            ...event,\n            x: event.x,\n            y: event.y,\n            moveX: event.x - lastPoint.x,\n            moveY: event.y - lastPoint.y,\n            totalX: event.x - startPoint.x,\n            totalY: event.y - startPoint.y,\n        } as IDragEvent\n    },\n\n    getDropEventData(event: IPointerEvent, list: ILeafList, data: IObject): IDropEvent {\n        return {\n            ...event,\n            list,\n            data\n        }\n    },\n\n    getSwipeDirection(angle: number): string {\n        if (angle < -45 && angle > -135) return SwipeEvent.UP\n        else if (angle > 45 && angle < 135) return SwipeEvent.DOWN\n        else if (angle <= 45 && angle >= -45) return SwipeEvent.RIGHT\n        else return SwipeEvent.LEFT\n    },\n\n    getSwipeEventData(startPoint: IPointData, lastDragData: IDragEvent, event: IPointerEvent): ISwipeEvent {\n        return {\n            ...event,\n            moveX: lastDragData.moveX,\n            moveY: lastDragData.moveY,\n            totalX: event.x - startPoint.x,\n            totalY: event.y - startPoint.y,\n            type: I.getSwipeDirection(PointHelper.getAngle(startPoint, event)),\n        }\n    },\n\n\n    getBase(e: IObject): IUIEvent {\n        const pointerUpButtons = e.button === 1 ? 4 : e.button // 0: left, 1: middle, 2: right\n        return {\n            altKey: e.altKey,\n            ctrlKey: e.ctrlKey,\n            shiftKey: e.shiftKey,\n            metaKey: e.metaKey,\n            time: Date.now(),\n            buttons: isUndefined(e.buttons) ? 1 : (e.buttons === 0 ? pointerUpButtons : e.buttons), // touchEvent no button and buttons, set default\n            origin: e\n        } as IUIEvent\n    },\n\n    pathHasEventType(path: ILeafList, type: string): boolean {\n        const { list } = path\n        for (let i = 0, len = list.length; i < len; i++) {\n            if (list[i].hasEvent(type)) return true\n        }\n        return false\n    },\n\n    filterPathByEventType(path: ILeafList, type: string): ILeafList {\n        const find = new LeafList()\n        const { list } = path\n        for (let i = 0, len = list.length; i < len; i++) {\n            if (list[i].hasEvent(type)) find.add(list[i])\n        }\n        return find\n    },\n\n    pathCanDrag(path: ILeafList): boolean {\n        return path && path.list.some(item => LeafHelper.draggable(item) || (!item.isLeafer && item.hasEvent(DragEvent.DRAG)))\n    },\n\n    pathHasOutside(path: ILeafList): boolean { // 滚动条元素\n        return path && path.list.some(item => item.isOutside)\n    },\n}\n\nconst I = InteractionHelper","import { IPointerEvent, IDragEvent, ILeaf, ILeafList, ITimer, IFunction, IPointDataMap, IMoveEvent } from '@leafer/interface'\nimport { PointHelper, LeafList, LeafHelper, isNumber, isString } from '@leafer/core'\n\nimport { MoveEvent, DragEvent, DropEvent, PointerButton } from '@leafer-ui/event'\n\nimport { InteractionHelper } from './InteractionHelper'\nimport { InteractionBase } from './Interaction'\n\n\nconst emptyList = new LeafList()\nconst { getDragEventData, getDropEventData, getSwipeEventData } = InteractionHelper\n\nexport class Dragger {\n\n    public interaction: InteractionBase\n\n    public moving: boolean\n    public dragging: boolean\n\n    public dragData: IDragEvent\n    public downData: IPointerEvent\n\n    public dragDataList: IDragEvent[] = [] // 记录列表备用\n\n    public draggableList: ILeafList\n    public realDraggableList: ILeafList\n    protected dragOverPath: ILeafList\n    protected dragEnterPath: ILeafList\n\n    public dragStartPoints: IPointDataMap\n    public autoMoveTimer: ITimer\n\n    public canAnimate: boolean\n    public canDragOut: boolean\n    public animateWait: IFunction\n\n    constructor(interaction: InteractionBase) {\n        this.interaction = interaction\n    }\n\n    public setDragData(data: IPointerEvent): void { // pointer down\n        if (this.animateWait) this.dragEndReal()\n        this.downData = this.interaction.downData\n        this.dragData = getDragEventData(data, data, data)\n        this.canAnimate = this.canDragOut = true\n    }\n\n    public getList(realDraggable?: boolean, hover?: boolean): ILeafList {\n        const { proxy } = this.interaction.selector\n        const hasProxyList = proxy && proxy.list.length, dragList = DragEvent.list || this.draggableList || emptyList\n        return this.dragging && (hasProxyList ? (realDraggable ? emptyList : new LeafList(hover ? [...proxy.list, ...proxy.dragHoverExclude] : proxy.list)) : dragList) // realDraggable 需排除代理选择器，它有自身的拖拽逻辑\n    }\n\n    public checkDrag(data: IPointerEvent, canDrag: boolean): void {\n        const { interaction } = this\n\n        if (this.moving && data.buttons < 1) {\n            this.canAnimate = false // 防止dragEnd动画\n            interaction.pointerCancel() // 按住中键/右键拖出页面后的up事件接收不到\n            return\n        }\n\n        if (!this.moving && canDrag) {\n            if (this.moving = interaction.canMove(this.downData) || interaction.isHoldRightKey || interaction.isMobileDragEmpty) {\n                (this.dragData as IMoveEvent).moveType = 'drag'\n                interaction.emit(MoveEvent.START, this.dragData)\n            }\n        }\n\n        if (!this.moving) this.dragStart(data, canDrag)\n\n        this.drag(data)\n    }\n\n    public dragStart(data: IPointerEvent, canDrag: boolean): void {\n        if (!this.dragging) {\n            this.dragging = canDrag && PointerButton.left(data)\n            if (this.dragging) {\n                this.interaction.emit(DragEvent.START, this.dragData)\n                this.getDraggableList(this.dragData.path)\n                this.setDragStartPoints(this.realDraggableList = this.getList(true))\n            }\n        }\n    }\n\n    protected setDragStartPoints(list: ILeafList | ILeaf[]): void {\n        this.dragStartPoints = {}\n        list.forEach(leaf => this.dragStartPoints[leaf.innerId] = { x: leaf.x, y: leaf.y })\n    }\n\n    protected getDraggableList(path: ILeafList): void {\n        let leaf: ILeaf\n        for (let i = 0, len = path.length; i < len; i++) {\n            leaf = path.list[i]\n            if (LeafHelper.draggable(leaf)) {\n                this.draggableList = new LeafList(leaf)\n                break\n            }\n        }\n    }\n\n    public drag(data: IPointerEvent): void {\n        const { interaction, dragData, downData } = this\n        const { path, throughPath } = downData\n        this.dragData = getDragEventData(downData, dragData, data)\n        if (throughPath) this.dragData.throughPath = throughPath\n        this.dragData.path = path\n\n        this.dragDataList.push(this.dragData)\n\n        if (this.moving) {\n            data.moving = true;\n            (this.dragData as IMoveEvent).moveType = 'drag'\n            interaction.emit(MoveEvent.BEFORE_MOVE, this.dragData)\n            interaction.emit(MoveEvent.MOVE, this.dragData)\n        } else if (this.dragging) {\n            data.dragging = true\n            this.dragReal()\n            interaction.emit(DragEvent.BEFORE_DRAG, this.dragData)\n            interaction.emit(DragEvent.DRAG, this.dragData)\n        }\n    }\n\n    protected dragReal(isDragEnd?: boolean): void {\n        const { interaction } = this, { running } = interaction\n        const list = this.realDraggableList\n        if (list.length && running) {\n            const { totalX, totalY } = this.dragData, { dragLimitAnimate } = interaction.p\n            const checkLimitMove = !dragLimitAnimate || !!isDragEnd\n            list.forEach(leaf => {\n                if (leaf.draggable) {\n                    const axisDrag = isString(leaf.draggable)\n                    const move = DragEvent.getValidMove(leaf, this.dragStartPoints[leaf.innerId], { x: totalX, y: totalY }, checkLimitMove || axisDrag)\n                    if (dragLimitAnimate && !axisDrag && isDragEnd) LeafHelper.animateMove(leaf, move, isNumber(dragLimitAnimate) ? dragLimitAnimate : 0.3)\n                    else leaf.move(move)\n                }\n            })\n        }\n    }\n\n    public dragOverOrOut(data: IPointerEvent): void {\n        const { interaction } = this\n        const { dragOverPath } = this\n        const { path } = data\n        this.dragOverPath = path\n\n        if (dragOverPath) {\n            if (path.indexAt(0) !== dragOverPath.indexAt(0)) {\n                interaction.emit(DragEvent.OUT, data, dragOverPath)\n                interaction.emit(DragEvent.OVER, data, path)\n            }\n        } else interaction.emit(DragEvent.OVER, data, path)\n    }\n\n    public dragEnterOrLeave(data: IPointerEvent): void {\n        const { interaction } = this\n        const { dragEnterPath } = this\n        const { path } = data\n\n        interaction.emit(DragEvent.LEAVE, data, dragEnterPath, path)\n        interaction.emit(DragEvent.ENTER, data, path, dragEnterPath)\n        this.dragEnterPath = path\n    }\n\n    public dragEnd(data: IPointerEvent): void {\n        if (!this.dragging && !this.moving) return\n        if (this.checkDragEndAnimate(data)) return\n        this.dragEndReal(data)\n    }\n\n    public dragEndReal(data?: IPointerEvent): void {\n        const { interaction, downData, dragData } = this\n        if (!data) data = dragData\n        const { path, throughPath } = downData\n        const endDragData = getDragEventData(downData, data, data)\n        if (throughPath) endDragData.throughPath = throughPath\n        endDragData.path = path\n\n        if (this.moving) {\n            this.moving = false;\n            (endDragData as IMoveEvent).moveType = 'drag'\n            interaction.emit(MoveEvent.END, endDragData)\n        }\n\n        if (this.dragging) {\n            const dropList = this.getList()\n\n            this.dragging = false\n            if (interaction.p.dragLimitAnimate) this.dragReal(true)\n            interaction.emit(DragEvent.END, endDragData)\n\n            this.swipe(data, downData, dragData, endDragData)\n            this.drop(data, dropList, this.dragEnterPath)\n        }\n\n        this.autoMoveCancel()\n        this.dragReset()\n        this.animate(null, 'off')\n    }\n\n\n    protected swipe(data: IPointerEvent, downData: IPointerEvent, dragData: IDragEvent, endDragData: IDragEvent): void {\n        const { interaction } = this\n        if (PointHelper.getDistance(downData, data) > interaction.config.pointer.swipeDistance) {\n            const swipeData = getSwipeEventData(downData, dragData, endDragData)\n            this.interaction.emit(swipeData.type, swipeData)\n        }\n    }\n\n    protected drop(data: IPointerEvent, dropList: ILeafList, dragEnterPath: ILeafList): void {\n        const dropData = getDropEventData(data, dropList, DragEvent.data)\n        dropData.path = dragEnterPath\n        this.interaction.emit(DropEvent.DROP, dropData)\n        this.interaction.emit(DragEvent.LEAVE, data, dragEnterPath)\n    }\n\n    protected dragReset(): void {\n        DragEvent.list = DragEvent.data = this.draggableList = this.dragData = this.downData = this.dragOverPath = this.dragEnterPath = null\n        this.dragDataList = []\n    }\n\n\n    // @leafer-in/viewport will rewrite\n\n    public checkDragEndAnimate(_data: IPointerEvent, _speed?: number): boolean | number { return false }\n\n    public animate(_func?: IFunction, _off?: 'off'): void { }  // dragEnd animation\n\n    public stopAnimate(): void { }\n\n    public checkDragOut(_data: IPointerEvent): void { }\n\n    public autoMoveOnDragOut(_data: IPointerEvent): void { }\n\n    public autoMoveCancel(): void { }\n\n    // ---\n\n    public destroy(): void {\n        this.dragReset()\n    }\n}","import { IUIEvent, ILeaf, ILeafList } from '@leafer/interface'\nimport { EventCreator, Debug } from '@leafer/core'\nimport { State } from '@leafer-ui/draw'\n\n\nconst debug = Debug.get('emit')\n\nexport function emit(type: string, data: IUIEvent, path?: ILeafList, excludePath?: ILeafList): void {\n    if (!path && !data.path) return\n\n    let leaf: ILeaf\n    data.type = type\n\n    if (path) data = { ...data, path }\n    else path = data.path\n\n    data.target = path.indexAt(0)\n\n    try {\n\n        // capture\n        for (let i = path.length - 1; i > -1; i--) {\n            leaf = path.list[i]\n            if (emitEvent(leaf, type, data, true, excludePath)) return\n            if (leaf.isApp) emitAppChildren(leaf, type, data, true, excludePath) //  other leafer\n        }\n\n        // bubble\n        for (let i = 0, len = path.length; i < len; i++) {\n            leaf = path.list[i]\n            if (leaf.isApp) emitAppChildren(leaf, type, data, false, excludePath) //  other leafer\n            if (emitEvent(leaf, type, data, false, excludePath)) return\n        }\n\n    } catch (e) {\n        debug.error(e)\n    }\n}\n\nconst allowTypes = ['move', 'zoom', 'rotate', 'key']\nfunction emitAppChildren(leaf: ILeaf, type: string, data: IUIEvent, capture?: boolean, excludePath?: ILeafList): void {\n    if (allowTypes.some(name => type.startsWith(name)) && leaf.__.hitChildren && !exclude(leaf, excludePath)) {\n        let child: ILeaf\n        for (let i = 0, len = leaf.children.length; i < len; i++) {\n            child = leaf.children[i]\n            if (!data.path.has(child) && child.__.hittable) emitEvent(child, type, data, capture, excludePath) //  other leafer\n        }\n    }\n}\n\nfunction emitEvent(leaf: ILeaf, type: string, data: IUIEvent, capture?: boolean, excludePath?: ILeafList): boolean {\n    if (leaf.destroyed) return false\n    if (leaf.__.hitSelf && !exclude(leaf, excludePath)) {\n\n        if (State.updateEventStyle && !capture) State.updateEventStyle(leaf, type) // hoverStyle / pressStyle\n\n        if (leaf.hasEvent(type, capture)) {\n            data.phase = capture ? 1 : ((leaf === data.target) ? 2 : 3)\n            const event = EventCreator.get(type, data)\n            leaf.emitEvent(event, capture)\n            if (event.isStop) return true\n        }\n    }\n    return false\n}\n\nfunction exclude(leaf: ILeaf, excludePath?: ILeafList): boolean {\n    return excludePath && excludePath.has(leaf)\n}","import { IInteractionConfig } from '@leafer/interface'\n\nexport const config: IInteractionConfig = {\n    wheel: {\n        zoomSpeed: 0.5,\n        moveSpeed: 0.5,\n        rotateSpeed: 0.5,\n        delta: { x: 80 / 4, y: 8.0 }, // 基准速度（会影响zoomSpeed)，可根据不同系统、浏览器细化定制\n    },\n    pointer: {\n        type: 'pointer',\n        snap: true,\n        hitRadius: 5,\n        tapTime: 120,\n        longPressTime: 800,\n        transformTime: 500,\n        hover: true,\n        dragHover: true,\n        dragDistance: 2,\n        swipeDistance: 20,\n    },\n    touch: {\n        preventDefault: 'auto'\n    },\n    multiTouch: {},\n    move: { autoDistance: 2 },\n    zoom: {},\n    cursor: true,\n    keyEvent: true\n}","import { IUIEvent, IPointerEvent, ILeaf, IInteraction, IInteractionConfig, ITransformer, ILeafList, IMoveEvent, IZoomEvent, IRotateEvent, IWheelEvent, ISelector, IBounds, IEventListenerId, IInteractionCanvas, ITimer, IKeepTouchData, IKeyEvent, IPickOptions, ICursorType, IBooleanMap, IPickBottom, IClientPointData, IPointData, ILeaferConfig, IMoveConfig, IPointerConfig } from '@leafer/interface'\nimport { LeaferEvent, ResizeEvent, LeafList, Bounds, PointHelper, DataHelper, Platform, isNumber } from '@leafer/core'\n\nimport { IApp } from '@leafer-ui/interface'\nimport { PointerEvent, DropEvent, KeyEvent, PointerButton, Keyboard } from '@leafer-ui/event'\n\nimport { Dragger } from './Dragger'\nimport { emit } from './emit'\nimport { InteractionHelper } from './InteractionHelper'\nimport { config } from './config'\n\n\nconst { pathHasEventType, pathCanDrag, pathHasOutside } = InteractionHelper\nexport class InteractionBase implements IInteraction {\n\n    public target: ILeaf\n    public canvas: IInteractionCanvas\n    public selector: ISelector\n\n    public running: boolean\n\n    public get dragging(): boolean { return this.dragger.dragging }\n    public get transforming(): boolean { return this.transformer.transforming }\n\n    public get moveMode(): boolean { return this.m.drag === true || this.isHoldSpaceKey || this.isHoldMiddleKey || (this.isHoldRightKey && this.dragger.moving) || this.isDragEmpty }\n    public get canHover(): boolean { return this.p.hover && !(this.config as ILeaferConfig).mobile }\n\n    public get isDragEmpty(): boolean { return this.m.dragEmpty && this.isRootPath(this.hoverData) && (!this.downData || this.isRootPath(this.downData)) }\n    public get isMobileDragEmpty(): boolean { return this.m.dragEmpty && !this.canHover && this.downData && this.isTreePath(this.downData) }\n    public get isHoldMiddleKey(): boolean { return this.m.holdMiddleKey && this.downData && PointerButton.middle(this.downData) }\n    public get isHoldRightKey(): boolean { return this.m.holdRightKey && this.downData && PointerButton.right(this.downData) }\n    public get isHoldSpaceKey(): boolean { return this.m.holdSpaceKey && Keyboard.isHoldSpaceKey() }\n\n    public config: IInteractionConfig = DataHelper.clone(config)\n    public get m(): IMoveConfig { return this.config.move }\n    public get p(): IPointerConfig { return this.config.pointer }\n\n    public cursor: ICursorType | ICursorType[]\n    public get hitRadius(): number { return this.p.hitRadius }\n\n    public bottomList?: IPickBottom[]\n\n    public shrinkCanvasBounds: IBounds\n\n    public downData: IPointerEvent\n    public hoverData: IPointerEvent\n    public focusData: ILeaf\n\n    public downTime: number\n\n    protected overPath: LeafList\n    protected enterPath: LeafList\n\n    protected waitMenuTap: boolean\n    protected waitRightTap: boolean\n    protected waitTap: boolean\n    protected longPressTimer: ITimer\n    protected longPressed: boolean\n    protected tapCount = 0\n    protected tapTimer: ITimer\n\n    public dragger: Dragger\n    public transformer: ITransformer\n\n    protected __eventIds: IEventListenerId[]\n    protected defaultPath: ILeafList\n\n    protected downKeyMap: IBooleanMap = {}\n\n    constructor(target: ILeaf, canvas: IInteractionCanvas, selector: ISelector, userConfig?: IInteractionConfig) {\n        this.target = target\n        this.canvas = canvas\n        this.selector = selector\n        this.defaultPath = new LeafList(target)\n\n        this.createTransformer()\n        this.dragger = new Dragger(this)\n\n        if (userConfig) this.config = DataHelper.default(userConfig, this.config)\n        this.__listenEvents()\n    }\n\n\n    public start(): void {\n        this.running = true\n    }\n\n    public stop(): void {\n        this.running = false\n    }\n\n\n    public receive(_event: any): void { }\n\n\n    public pointerDown(data?: IPointerEvent, useDefaultPath?: boolean): void {\n        if (!data) data = this.hoverData\n        if (!data) return\n\n        PointerButton.defaultLeft(data)\n        this.updateDownData(data)\n        this.checkPath(data, useDefaultPath)\n\n        this.downTime = Date.now()\n\n        this.emit(PointerEvent.BEFORE_DOWN, data) // downData maybe changed\n        this.emit(PointerEvent.DOWN, data)\n\n        if (PointerButton.left(data)) {\n            this.tapWait()\n            this.longPressWait(data)\n        }\n\n        this.waitRightTap = PointerButton.right(data)\n\n        this.dragger.setDragData(data) // must after down event\n        if (!this.isHoldRightKey) this.updateCursor(data)\n    }\n\n    public pointerMove(data?: IPointerEvent): void {\n        if (!data) data = this.hoverData\n        if (!data) return\n\n        const { downData } = this\n        if (downData) PointerButton.defaultLeft(data)\n\n        const hit = this.canvas.bounds.hitPoint(data)\n        if (hit || downData) {\n            this.pointerMoveReal(data)\n            if (downData) this.dragger.checkDragOut(data)\n        }\n    }\n\n    public pointerMoveReal(data: IPointerEvent): void {\n        this.emit(PointerEvent.BEFORE_MOVE, data, this.defaultPath)\n\n        if (this.downData) {\n            const canDrag = PointHelper.getDistance(this.downData, data) > this.p.dragDistance\n            if (canDrag) {\n                this.pointerWaitCancel()\n                this.waitRightTap = false\n            }\n\n            this.dragger.checkDrag(data, canDrag)\n        }\n\n        if (!this.dragger.moving) {\n            this.updateHoverData(data)\n            this.checkPath(data)\n\n            this.emit(PointerEvent.MOVE, data)\n\n            this.pointerHover(data)\n\n            if (this.dragging) {\n                this.dragger.dragOverOrOut(data)\n                this.dragger.dragEnterOrLeave(data)\n            }\n        }\n\n        this.updateCursor(this.downData || data)\n    }\n\n    public pointerUp(data?: IPointerEvent): void {\n        const { downData } = this\n        if (!data) data = downData\n        if (!downData) return\n\n        PointerButton.defaultLeft(data)\n        data.multiTouch = downData.multiTouch\n\n        this.findPath(data)\n        const upData = { ...data, path: data.path.clone() }\n\n        data.path.addList(downData.path.list)  // downPath必须触发\n\n        this.checkPath(data)\n\n        this.downData = null // must before pointer.up event\n        this.emit(PointerEvent.BEFORE_UP, data)\n        this.emit(PointerEvent.UP, data)\n\n        this.touchLeave(data)\n\n        if (!data.isCancel) {\n            this.tap(data)\n            this.menuTap(data)\n        }\n\n        this.dragger.dragEnd(data)\n\n        this.updateCursor(upData)\n    }\n\n    public pointerCancel(): void {\n        const data = { ...this.dragger.dragData }\n        data.isCancel = true\n        this.pointerUp(data)\n    }\n\n\n    // context menu\n    public menu(data: IPointerEvent): void {\n        this.findPath(data)\n        this.emit(PointerEvent.MENU, data)\n        this.waitMenuTap = true\n        if (!this.downData && this.waitRightTap) this.menuTap(data) // fix: Windows 触摸屏双击右键菜单事件会在pointer.up之后触发\n    }\n\n    public menuTap(data: IPointerEvent): void {\n        if (this.waitRightTap && this.waitMenuTap) {\n            this.emit(PointerEvent.MENU_TAP, data)\n            this.waitRightTap = this.waitMenuTap = false\n        }\n    }\n\n    // @leafer-in/viewport will rewrite:  transform viewport\n\n    public createTransformer(): void { }\n\n    public move(_data: IMoveEvent): void { }\n\n    public zoom(_data: IZoomEvent): void { }\n\n    public rotate(_data: IRotateEvent): void { }\n\n    public transformEnd(): void { }\n\n    public wheel(_data: IWheelEvent): void { }\n\n    public multiTouch(_data: IUIEvent, _list: IKeepTouchData[]): void { }\n\n    // ---\n\n    // key\n\n    public keyDown(data: IKeyEvent): void {\n        if (!this.config.keyEvent) return\n\n        this.emit(KeyEvent.BEFORE_DOWN, data, this.defaultPath) // 键盘按下前出发，还没有setDownCode\n\n        const { code } = data\n        if (!this.downKeyMap[code]) {\n            this.downKeyMap[code] = true\n            Keyboard.setDownCode(code)\n\n            this.emit(KeyEvent.HOLD, data, this.defaultPath)\n            if (this.moveMode) {\n                this.cancelHover()\n                this.updateCursor()\n            }\n        }\n        this.emit(KeyEvent.DOWN, data, this.defaultPath)\n    }\n\n    public keyUp(data: IKeyEvent): void {\n        if (!this.config.keyEvent) return\n\n        this.emit(KeyEvent.BEFORE_UP, data, this.defaultPath) // 键盘弹起前出发，还没有setUpCode\n\n        const { code } = data\n        this.downKeyMap[code] = false\n        Keyboard.setUpCode(code)\n\n        this.emit(KeyEvent.UP, data, this.defaultPath)\n        if (this.cursor === 'grab') this.updateCursor()\n    }\n\n\n    // helper\n    protected pointerHover(data: IPointerEvent): void {\n        if (this.canHover && !(this.dragging && !this.p.dragHover)) {\n            data.path || (data.path = new LeafList()) // 离开画布的情况\n            this.pointerOverOrOut(data)\n            this.pointerEnterOrLeave(data)\n        }\n    }\n\n    protected pointerOverOrOut(data: IPointerEvent): void {\n        const { path } = data\n        const { overPath } = this\n        this.overPath = path\n\n        if (overPath) {\n            if (path.indexAt(0) !== overPath.indexAt(0)) {\n                this.emit(PointerEvent.OUT, data, overPath)\n                this.emit(PointerEvent.OVER, data, path)\n            }\n        } else {\n            this.emit(PointerEvent.OVER, data, path)\n        }\n    }\n\n    protected pointerEnterOrLeave(data: IPointerEvent): void {\n        let { path } = data\n\n        if (this.downData && !this.moveMode) {\n            path = path.clone()\n            this.downData.path.forEach(leaf => path.add(leaf))\n        }\n\n        const { enterPath } = this\n        this.enterPath = path\n\n        this.emit(PointerEvent.LEAVE, data, enterPath, path)\n        this.emit(PointerEvent.ENTER, data, path, enterPath)\n    }\n\n    protected touchLeave(data: IPointerEvent): void {\n        if (data.pointerType === 'touch') {\n            if (this.enterPath) {\n                this.emit(PointerEvent.LEAVE, data)\n                if (this.dragger.dragging) this.emit(DropEvent.LEAVE, data)\n            }\n        }\n    }\n\n    protected tap(data: IPointerEvent): void {\n        const { pointer } = this.config\n\n        const hasLong = this.longTap(data)\n        if (!pointer.tapMore && hasLong) return // long_press / long_tap\n\n        if (!this.waitTap) return\n        if (pointer.tapMore) this.emitTap(data)\n\n        const useTime = Date.now() - this.downTime\n\n        const hasDouble = [PointerEvent.DOUBLE_TAP, PointerEvent.DOUBLE_CLICK].some(type => pathHasEventType(data.path, type))\n\n        if (useTime < pointer.tapTime + 50 && hasDouble) {\n\n            this.tapCount++\n            if (this.tapCount === 2) {\n                this.tapWaitCancel()\n                this.emitDoubleTap(data)\n            } else {\n                clearTimeout(this.tapTimer)\n                this.tapTimer = setTimeout(() => {\n                    if (!pointer.tapMore) {\n                        this.tapWaitCancel()\n                        this.emitTap(data)\n                    }\n                }, pointer.tapTime)\n            }\n\n        } else {\n\n            if (!pointer.tapMore) {\n                this.tapWaitCancel()\n                this.emitTap(data)\n            }\n        }\n    }\n\n\n    // update\n    public findPath(data: IPointerEvent, options?: IPickOptions): ILeafList {\n        const { hitRadius, through } = this.p\n        const { bottomList, target } = this\n        if (!Platform.backgrounder && !data.origin) target && target.updateLayout() // 模拟交互\n        const find = this.selector.getByPoint(data, hitRadius, { bottomList, name: data.type, ...(options || { through }) })\n        if (find.throughPath) data.throughPath = find.throughPath\n        data.path = find.path\n        return find.path\n    }\n\n    public isRootPath(data: IPointerEvent): boolean {\n        return data && (data.path.list[0] as ILeaf).isLeafer\n    }\n\n    public isTreePath(data: IPointerEvent): boolean {\n        const app = this.target.app as IApp\n        if (!app || !app.isApp) return false\n        return app.editor && (!data.path.has(app.editor) && data.path.has(app.tree) && !(data.target as ILeaf).syncEventer) // 当dragEmpty为true时，在手机端(pointer.hover为false)可以拖动tree层（编辑器选中的元素除外）\n    }\n\n    protected checkPath(data: IPointerEvent, useDefaultPath?: boolean): void {\n        if (useDefaultPath || (this.moveMode && !pathHasOutside(data.path))) data.path = this.defaultPath\n    }\n\n    public canMove(data: IPointerEvent): boolean { // moveMode and path can move\n        return data && (this.moveMode || (this.m.drag === 'auto' && !pathCanDrag(data.path))) && !pathHasOutside(data.path)\n    }\n\n\n    public isDrag(leaf: ILeaf): boolean {\n        return this.dragger.getList().has(leaf)\n    }\n\n    public isPress(leaf: ILeaf): boolean {\n        return this.downData && this.downData.path.has(leaf)\n    }\n\n    public isHover(leaf: ILeaf): boolean {\n        return this.enterPath && this.enterPath.has(leaf)\n    }\n\n    public isFocus(leaf: ILeaf): boolean {\n        return this.focusData === leaf\n    }\n\n\n    public cancelHover(): void {\n        const { hoverData } = this\n        if (hoverData) {\n            hoverData.path = this.defaultPath\n            this.pointerHover(hoverData)\n        }\n    }\n\n    public stopDragAnimate(): void {\n        this.dragger.stopAnimate()\n    }\n\n\n    public updateDownData(data?: IPointerEvent, options?: IPickOptions, merge?: boolean): void {\n        const { downData } = this\n        if (!data && downData) data = downData\n        if (!data) return\n        this.findPath(data, options)\n        if (merge && downData) data.path.addList(downData.path.list)\n        this.downData = data\n    }\n\n    public updateHoverData(data?: IPointerEvent): void {\n        if (!data) data = this.hoverData\n        if (!data) return\n        this.findPath(data, { exclude: this.dragger.getList(false, true), name: PointerEvent.MOVE })\n        this.hoverData = data\n    }\n\n    public updateCursor(data?: IPointerEvent): void {\n        if (!this.config.cursor || !this.canHover) return\n\n        if (!data) {\n            this.updateHoverData()\n            data = this.downData || this.hoverData\n        }\n\n        if (this.dragger.moving) {\n            return this.setCursor('grabbing')\n        } else if (this.canMove(data)) {\n            return this.setCursor(this.downData ? 'grabbing' : 'grab')\n        } else if (!data) return\n\n        let leaf: ILeaf, cursor: ICursorType | ICursorType[]\n\n        const { path } = data\n        for (let i = 0, len = path.length; i < len; i++) {\n            leaf = path.list[i]\n            cursor = (leaf.syncEventer && leaf.syncEventer.cursor) || leaf.cursor\n            if (cursor) break\n        }\n\n        this.setCursor(cursor)\n    }\n\n    public setCursor(cursor: ICursorType | ICursorType[]): void {\n        this.cursor = cursor\n    }\n\n    public getLocal(clientPoint: IClientPointData, updateClient?: boolean): IPointData {\n        const clientBounds = this.canvas.getClientBounds(updateClient)\n        const point = { x: clientPoint.clientX - clientBounds.x, y: clientPoint.clientY - clientBounds.y }\n\n        // 兼容clientBounds进行了transform的情况\n        const { bounds } = this.canvas\n        point.x *= bounds.width / clientBounds.width\n        point.y *= bounds.height / clientBounds.height\n\n        if (this.p.snap) PointHelper.round(point)\n        return point\n    }\n\n\n    protected emitTap(data: IPointerEvent) {\n        this.emit(PointerEvent.TAP, data)\n        this.emit(PointerEvent.CLICK, data)\n    }\n\n    protected emitDoubleTap(data: IPointerEvent) {\n        this.emit(PointerEvent.DOUBLE_TAP, data)\n        this.emit(PointerEvent.DOUBLE_CLICK, data)\n    }\n\n    public pointerWaitCancel(): void {\n        this.tapWaitCancel()\n        this.longPressWaitCancel()\n    }\n\n    protected tapWait(): void {\n        clearTimeout(this.tapTimer)\n        this.waitTap = true\n    }\n\n    protected tapWaitCancel(): void {\n        if (this.waitTap) {\n            clearTimeout(this.tapTimer)\n            this.waitTap = false\n            this.tapCount = 0\n        }\n    }\n\n    protected longPressWait(data: IPointerEvent): void {\n        clearTimeout(this.longPressTimer)\n        this.longPressTimer = setTimeout(() => {\n            this.longPressed = true\n            this.emit(PointerEvent.LONG_PRESS, data)\n        }, this.p.longPressTime)\n    }\n\n    protected longTap(data: IPointerEvent): boolean {\n        let hasLong\n        if (this.longPressed) {\n            this.emit(PointerEvent.LONG_TAP, data)\n            if (pathHasEventType(data.path, PointerEvent.LONG_TAP) || pathHasEventType(data.path, PointerEvent.LONG_PRESS)) hasLong = true\n        }\n        this.longPressWaitCancel()\n        return hasLong\n    }\n\n    protected longPressWaitCancel(): void {\n        if (this.longPressTimer) {\n            clearTimeout(this.longPressTimer)\n            this.longPressed = false\n        }\n    }\n\n    protected __onResize(): void {\n        const { dragOut } = this.m\n        this.shrinkCanvasBounds = new Bounds(this.canvas.bounds)\n        this.shrinkCanvasBounds.spread(-(isNumber(dragOut) ? dragOut : 2))\n    }\n\n    protected __listenEvents(): void {\n        const { target } = this\n        this.__eventIds = [target.on_(ResizeEvent.RESIZE, this.__onResize, this)]\n        target.once(LeaferEvent.READY, () => this.__onResize())\n    }\n\n    protected __removeListenEvents(): void {\n        this.target.off_(this.__eventIds)\n        this.__eventIds.length = 0\n    }\n\n\n    public emit(type: string, data: IUIEvent, path?: ILeafList, excludePath?: ILeafList): void {\n        if (this.running) emit(type, data, path, excludePath)\n    }\n\n\n    public destroy(): void {\n        if (this.__eventIds.length) {\n            this.stop()\n            this.__removeListenEvents()\n            this.dragger.destroy()\n            if (this.transformer) this.transformer.destroy()\n            this.downData = this.overPath = this.enterPath = null\n        }\n    }\n\n}","import { ICursorTypeMap, ICursorType } from '@leafer/interface'\n\n\nexport class Cursor {\n\n    static custom: ICursorTypeMap = {}\n\n    static set(name: string, value: ICursorType | ICursorType[]): void {\n        this.custom[name] = value\n    }\n\n    static get(name: string): ICursorType | ICursorType[] {\n        return this.custom[name]\n    }\n\n}","import { IHitCanvasManager, ILeaf, IHitCanvas, ILeafList, ILeaferCanvasConfig } from '@leafer/interface'\nimport { CanvasManager, LeafList, Creator } from '@leafer/core'\n\n\nexport class HitCanvasManager extends CanvasManager implements IHitCanvasManager {\n\n    public maxTotal = 1000 // 最多缓存多少张画布\n\n    protected pathList: ILeafList = new LeafList()\n    protected pixelList: ILeafList = new LeafList()\n\n    public getPixelType(leaf: ILeaf, config?: ILeaferCanvasConfig): IHitCanvas {\n        this.__autoClear()\n        this.pixelList.add(leaf)\n        return Creator.hitCanvas(config)\n    }\n\n    public getPathType(leaf: ILeaf): IHitCanvas {\n        this.__autoClear()\n        this.pathList.add(leaf)\n        return Creator.hitCanvas()\n    }\n\n    public clearImageType(): void {\n        this.__clearLeafList(this.pixelList)\n    }\n\n    public clearPathType(): void {\n        this.__clearLeafList(this.pathList)\n    }\n\n    protected __clearLeafList(leafList: ILeafList): void {\n        if (leafList.length) {\n            leafList.forEach(leaf => {\n                if (leaf.__hitCanvas) {\n                    leaf.__hitCanvas.destroy()\n                    leaf.__hitCanvas = null\n                }\n            })\n            leafList.reset()\n        }\n    }\n\n    protected __autoClear(): void {\n        if (this.pathList.length + this.pixelList.length > this.maxTotal) this.clear()\n    }\n\n    public clear(): void {\n        this.clearPathType()\n        this.clearImageType()\n    }\n\n}","import { Platform, Creator } from '@leafer/core'\n\nimport { ISelector, ILeaf } from '@leafer-ui/interface'\n\n\nPlatform.getSelector = function (leaf: ILeaf): ISelector {\n    return leaf.leafer ? leaf.leafer.selector : (Platform.selector || (Platform.selector = Creator.selector()))\n}","import { IRadiusPointData, ILeaferCanvas, IPointData, IBranch } from '@leafer/interface'\nimport { Leaf, PointHelper, BoundsHelper, Platform } from '@leafer/core'\n\n\nconst { toInnerRadiusPointOf, copyRadiusPoint } = PointHelper\nconst { hitRadiusPoint, hitPoint } = BoundsHelper\nconst inner = {} as IRadiusPointData, worldRadiusPoint = {} as IRadiusPointData\n\nconst leaf = Leaf.prototype\n\nleaf.hit = function (worldPoint: IPointData, hitRadius: number = 0): boolean {\n    this.updateLayout()\n\n    copyRadiusPoint(worldRadiusPoint, worldPoint, hitRadius)\n\n    const world = this.__world\n    if (hitRadius ? !hitRadiusPoint(world, worldRadiusPoint) : !hitPoint(world, worldRadiusPoint)) return false\n\n    return this.isBranch ? Platform.getSelector(this).hitPoint({ ...worldRadiusPoint }, hitRadius, { target: this as unknown as IBranch }) : this.__hitWorld(worldRadiusPoint)\n}\n\nleaf.__hitWorld = function (point: IRadiusPointData, forceHitFill?: boolean): boolean {\n    const data = this.__\n    if (!data.hitSelf) return false\n\n    const world = this.__world, layout = this.__layout\n    const isSmall = world.width < 10 && world.height < 10\n\n    if (data.hitRadius) {\n        copyRadiusPoint(inner, point, data.hitRadius)\n        point = inner\n    }\n\n    toInnerRadiusPointOf(point, world, inner)\n\n    if (data.hitBox || isSmall) {\n        if (BoundsHelper.hitRadiusPoint(layout.boxBounds, inner)) return true\n        if (isSmall) return false\n    }\n\n    if (layout.hitCanvasChanged || !this.__hitCanvas) {\n        this.__updateHitCanvas()\n        if (!layout.boundsChanged) layout.hitCanvasChanged = false\n    }\n\n    return this.__hit(inner, forceHitFill)\n}\n\nleaf.__hitFill = function (inner: IRadiusPointData): boolean { const h = this.__hitCanvas; return h && h.hitFill(inner, this.__.windingRule) }\n\nleaf.__hitStroke = function (inner: IRadiusPointData, strokeWidth: number): boolean { const h = this.__hitCanvas; return h && h.hitStroke(inner, strokeWidth) }\n\nleaf.__hitPixel = function (inner: IRadiusPointData): boolean { const h = this.__hitCanvas; return h && h.hitPixel(inner, this.__layout.renderBounds, h.hitScale) }\n\nleaf.__drawHitPath = function (canvas: ILeaferCanvas): void { canvas && this.__drawRenderPath(canvas) }","import { IRadiusPointData } from '@leafer/interface'\nimport { Platform, Matrix, ImageManager, tempBounds } from '@leafer/core'\nimport { UI } from '@leafer-ui/draw'\n\n\nconst matrix = new Matrix()\nconst ui = UI.prototype\n\nui.__updateHitCanvas = function (): void {\n\n    if (this.__box) this.__box.__updateHitCanvas()\n\n    const { hitCanvasManager } = this.leafer || (this.parent && this.parent.leafer) || {}// 兼容 boxStyle\n    if (!hitCanvasManager) return\n\n    const data = this.__\n    const isHitPixelFill = (data.__isAlphaPixelFill || data.__isCanvas) && data.hitFill === 'pixel'\n    const isHitPixelStroke = data.__isAlphaPixelStroke && data.hitStroke === 'pixel'\n    const isHitPixel = isHitPixelFill || isHitPixelStroke\n\n    if (!this.__hitCanvas) this.__hitCanvas = isHitPixel ? hitCanvasManager.getPixelType(this, { contextSettings: { willReadFrequently: true } }) : hitCanvasManager.getPathType(this)\n\n    const h = this.__hitCanvas\n\n    if (isHitPixel) {\n        const { renderBounds } = this.__layout\n        const size = Platform.image.hitCanvasSize\n        const scale = h.hitScale = tempBounds.set(0, 0, size, size).getFitMatrix(renderBounds).a\n        const { x, y, width, height } = tempBounds.set(renderBounds).scale(scale)\n        h.resize({ width, height, pixelRatio: 1 })\n        h.clear()\n\n        ImageManager.patternLocked = true\n        this.__renderShape(h, { matrix: matrix.setWith(this.__world).scaleWith(1 / scale).invertWith().translate(-x, -y), snapshot: true, ignoreFill: !isHitPixelFill, ignoreStroke: !isHitPixelStroke }) // 矩阵\n        ImageManager.patternLocked = false\n        h.resetTransform()\n\n        data.__isHitPixel = true\n    } else {\n        data.__isHitPixel && (data.__isHitPixel = false)\n    }\n\n    this.__drawHitPath(h)\n    h.setStrokeOptions(data)\n\n}\n\nui.__hit = function (inner: IRadiusPointData, forceHitFill?: boolean): boolean {\n\n    if (this.__box && this.__box.__hit(inner)) return true\n\n    // hit pixel\n    const data = this.__\n    if (data.__isHitPixel && this.__hitPixel(inner)) return true\n\n    // hit path\n    const { hitFill } = data\n    const needHitFillPath = ((data.fill || data.__isCanvas) && (hitFill === 'path' || (hitFill === 'pixel' && !(data.__isAlphaPixelFill || data.__isCanvas)))) || hitFill === 'all' || forceHitFill\n    if (needHitFillPath && this.__hitFill(inner)) return true\n\n    const { hitStroke, __maxStrokeWidth: strokeWidth } = data\n    const needHitStrokePath = (data.stroke && (hitStroke === 'path' || (hitStroke === 'pixel' && !data.__isAlphaPixelStroke))) || hitStroke === 'all'\n    if (!needHitFillPath && !needHitStrokePath) return false\n\n    const radiusWidth = inner.radiusX * 2\n    let hitWidth = radiusWidth\n\n    if (needHitStrokePath) {\n        switch (data.strokeAlign) {\n            case 'inside':\n                hitWidth += strokeWidth * 2\n                if (!needHitFillPath && this.__hitFill(inner) && this.__hitStroke(inner, hitWidth)) return true\n                hitWidth = radiusWidth\n                break\n            case 'center':\n                hitWidth += strokeWidth\n                break\n            case 'outside':\n                hitWidth += strokeWidth * 2\n                if (!needHitFillPath) {\n                    if (!this.__hitFill(inner) && this.__hitStroke(inner, hitWidth)) return true\n                    hitWidth = radiusWidth\n                }\n                break\n        }\n    }\n\n    return hitWidth ? this.__hitStroke(inner, hitWidth) : false\n}","import { IRadiusPointData } from '@leafer/interface'\nimport { BoundsHelper } from '@leafer/core'\nimport { UI, Rect, Box } from '@leafer-ui/draw'\n\n\nconst ui = UI.prototype, rect = Rect.prototype, box = Box.prototype\n\n// hit \n\nrect.__updateHitCanvas = box.__updateHitCanvas = function () {\n    if (this.stroke || this.cornerRadius || ((this.fill || this.__.__isCanvas) && this.hitFill === 'pixel') || this.hitStroke === 'all') ui.__updateHitCanvas.call(this)\n    else if (this.__hitCanvas) this.__hitCanvas = null\n}\n\nrect.__hitFill = box.__hitFill = function (inner: IRadiusPointData): boolean {\n    return this.__hitCanvas ? ui.__hitFill.call(this, inner) : BoundsHelper.hitRadiusPoint(this.__layout.boxBounds, inner)\n}","import { ILeaferCanvas } from '@leafer/interface'\nimport { Text } from '@leafer-ui/draw'\n\n\nText.prototype.__drawHitPath = function (canvas: ILeaferCanvas): void {\n    const { __lineHeight, fontSize, __baseLine, __letterSpacing, __textDrawData: data } = this.__\n\n    canvas.beginPath()\n\n    if (__letterSpacing < 0) this.__drawPathByBox(canvas)\n    else data.rows.forEach(row => canvas.rect(row.x, row.y - __baseLine, row.width, __lineHeight < fontSize ? fontSize : __lineHeight))\n}\n\n","import { Platform } from '@leafer/core'\n\nimport { IPointData, IPickOptions, IPickResult } from '@leafer-ui/interface'\nimport { Group, emptyData } from '@leafer-ui/draw'\n\n\nGroup.prototype.pick = function (hitPoint: IPointData, options?: IPickOptions): IPickResult {\n    options || (options = emptyData)\n    this.updateLayout()\n    return Platform.getSelector(this).getByPoint(hitPoint, options.hitRadius || 0, { ...options, target: this })\n}","\nimport { IPointData, IRadiusPointData, IWindingRule } from '@leafer/interface'\nimport { LeaferCanvasBase, tempBounds } from '@leafer/core'\n\n\nconst canvas = LeaferCanvasBase.prototype\n\ncanvas.hitFill = function (point: IPointData, fillRule?: IWindingRule): boolean {\n    return fillRule ? this.context.isPointInPath(point.x, point.y, fillRule) : this.context.isPointInPath(point.x, point.y)\n}\n\ncanvas.hitStroke = function (point: IPointData, strokeWidth?: number): boolean {\n    this.strokeWidth = strokeWidth\n    return this.context.isPointInStroke(point.x, point.y)\n}\n\ncanvas.hitPixel = function (radiusPoint: IRadiusPointData, offset?: IPointData, scale = 1): boolean { // 画布必须有alpha通道\n    let { x, y, radiusX, radiusY } = radiusPoint\n    if (offset) x -= offset.x, y -= offset.y\n    tempBounds.set(x - radiusX, y - radiusY, radiusX * 2, radiusY * 2).scale(scale).ceil()\n    const { data } = this.context.getImageData(tempBounds.x, tempBounds.y, tempBounds.width || 1, tempBounds.height || 1)\n    for (let i = 0, len = data.length; i < len; i += 4) { if (data[i + 3] > 0) return true }\n    return data[3] > 0\n}","import { IPointData, IPointerEvent, PointerType } from '@leafer/interface'\nimport { InteractionHelper } from '@leafer-ui/core'\n\n\nexport const PointerEventHelper = {\n\n    convert(e: PointerEvent, local: IPointData): IPointerEvent {\n        const base = InteractionHelper.getBase(e), { x, y } = local\n        const data: IPointerEvent = {\n            ...base,\n            x,\n            y,\n            width: e.width,\n            height: e.height,\n            pointerType: e.pointerType as PointerType,\n            pressure: e.pressure,\n        }\n\n        if (data.pointerType === 'pen') {\n            data.tangentialPressure = e.tangentialPressure\n            data.tiltX = e.tiltX\n            data.tiltY = e.tiltY\n            data.twist = e.twist\n        }\n        return data\n    },\n\n    convertMouse(e: MouseEvent, local: IPointData): IPointerEvent {\n        const base = InteractionHelper.getBase(e), { x, y } = local\n        return {\n            ...base,\n            x,\n            y,\n            width: 1,\n            height: 1,\n            pointerType: 'mouse',\n            pressure: 0.5,\n        }\n    },\n\n    convertTouch(e: TouchEvent, local: IPointData): IPointerEvent {\n        const touch = PointerEventHelper.getTouch(e)\n        const base = InteractionHelper.getBase(e), { x, y } = local\n        return {\n            ...base,\n            x,\n            y,\n            width: 1,\n            height: 1,\n            pointerType: 'touch',\n            multiTouch: e.touches.length > 1,\n            pressure: touch.force,\n        }\n    },\n\n    getTouch(e: TouchEvent): Touch {\n        return e.targetTouches[0] || e.changedTouches[0]\n    }\n\n}","import { IKeyCodes, IKeyEvent } from '@leafer/interface'\nimport { InteractionHelper } from '@leafer-ui/core'\n\n\nexport const KeyEventHelper = {\n\n    convert(e: KeyboardEvent): IKeyEvent {\n        const base = InteractionHelper.getBase(e)\n        const data: IKeyEvent = {\n            ...base,\n            code: e.code as IKeyCodes,\n            key: e.key\n        }\n        return data\n    }\n\n}","import { IObject, IPointData, ITimer, IKeepTouchData, ICursorType, IClientPointData, IZoomEvent, IRotateEvent } from '@leafer/interface'\nimport { MathHelper, isArray, isObject, isString } from '@leafer/core'\nimport { InteractionBase, InteractionHelper, Cursor } from '@leafer-ui/core'\n\nimport { PointerEventHelper } from './PointerEventHelper'\nimport { KeyEventHelper } from './KeyEventHelper'\n\n\ninterface IGestureEvent extends IClientPointData, UIEvent {\n    scale: number\n    rotation: number\n    preventDefault(): void\n}\n\n\nconst { pathCanDrag } = InteractionHelper\n\nexport class Interaction extends InteractionBase {\n\n    protected view: HTMLElement\n\n    protected viewEvents: IObject\n    protected windowEvents: IObject\n\n    protected usePointer: boolean\n    protected useMultiTouch: boolean\n    protected useTouch: boolean\n\n    protected get notPointer(): boolean { const { p } = this; return p.type !== 'pointer' || p.touch || this.useMultiTouch }\n    protected get notTouch(): boolean { const { p } = this; return p.type === 'mouse' || this.usePointer }\n    protected get notMouse(): boolean { return this.usePointer || this.useTouch }\n\n    protected touchTimer: ITimer\n    protected touches?: Touch[]\n    protected lastGestureScale: number\n    protected lastGestureRotation: number\n\n    protected __listenEvents(): void {\n        super.__listenEvents()\n\n        const view = this.view = this.canvas.view as HTMLCanvasElement\n\n        // PointerEvent > TouchEvent > MouseEvent\n        this.viewEvents = {\n            'pointerdown': this.onPointerDown,\n            'mousedown': this.onMouseDown,\n            'touchstart': this.onTouchStart,\n            'pointerleave': this.onPointerLeave,\n\n            'contextmenu': this.onContextMenu,\n\n            'wheel': this.onWheel,\n            'gesturestart': this.onGesturestart,\n            'gesturechange': this.onGesturechange,\n            'gestureend': this.onGestureend\n        }\n\n        this.windowEvents = {\n            'pointermove': this.onPointerMove,\n            'pointerup': this.onPointerUp,\n            'pointercancel': this.onPointerCancel,\n\n            'mousemove': this.onMouseMove,\n            'mouseup': this.onMouseUp,\n\n            // touch / multitouch\n            'touchmove': this.onTouchMove,\n            'touchend': this.onTouchEnd,\n            'touchcancel': this.onTouchCancel,\n\n            'keydown': this.onKeyDown,\n            'keyup': this.onKeyUp,\n\n            'scroll': this.onScroll\n        }\n\n        const { viewEvents, windowEvents } = this\n\n        for (let name in viewEvents) {\n            viewEvents[name] = viewEvents[name].bind(this)\n            view.addEventListener(name, viewEvents[name])\n        }\n\n        for (let name in windowEvents) {\n            windowEvents[name] = windowEvents[name].bind(this)\n            window.addEventListener(name, windowEvents[name])\n        }\n    }\n\n    protected __removeListenEvents(): void {\n        super.__removeListenEvents()\n\n        const { viewEvents, windowEvents } = this\n\n        for (let name in viewEvents) {\n            this.view.removeEventListener(name, viewEvents[name])\n            this.viewEvents = {}\n        }\n\n        for (let name in windowEvents) {\n            window.removeEventListener(name, windowEvents[name])\n            this.windowEvents = {}\n        }\n    }\n\n    protected getTouches(touches: TouchList): Touch[] {\n        const list: Touch[] = []\n        for (let i = 0, len = touches.length; i < len; i++) {\n            list.push(touches[i])\n        }\n        return list\n    }\n\n\n    protected preventDefaultPointer(e: UIEvent): void {\n        const { pointer } = this.config\n        if (pointer.preventDefault) e.preventDefault()\n    }\n\n    protected preventDefaultWheel(e: UIEvent): void {\n        const { wheel } = this.config\n        if (wheel.preventDefault) e.preventDefault()\n    }\n\n    protected preventWindowPointer(e: UIEvent) {\n        return !this.downData && e.target !== this.view\n    }\n\n    // key\n    protected onKeyDown(e: KeyboardEvent): void {\n        this.keyDown(KeyEventHelper.convert(e))\n    }\n\n    protected onKeyUp(e: KeyboardEvent): void {\n        this.keyUp(KeyEventHelper.convert(e))\n    }\n\n    // context menu\n\n    protected onContextMenu(e: PointerEvent): void {\n        if (this.config.pointer.preventDefaultMenu) e.preventDefault()\n        this.menu(PointerEventHelper.convert(e, this.getLocal(e)))\n    }\n\n    protected onScroll(): void {\n        this.canvas.updateClientBounds()\n    }\n\n    // pointer\n    protected onPointerDown(e: PointerEvent): void {\n        this.preventDefaultPointer(e)\n\n        if (this.notPointer) return\n        this.usePointer || (this.usePointer = true)\n        this.pointerDown(PointerEventHelper.convert(e, this.getLocal(e)))\n    }\n\n    protected onPointerMove(e: PointerEvent, isLeave?: boolean): void {\n        if (this.notPointer || this.preventWindowPointer(e)) return\n        this.usePointer || (this.usePointer = true)\n        const data = PointerEventHelper.convert(e, this.getLocal(e, true))\n        isLeave ? this.pointerHover(data) : this.pointerMove(data)\n    }\n\n    protected onPointerLeave(e: PointerEvent): void {\n        this.onPointerMove(e, true)\n    }\n\n    protected onPointerUp(e: PointerEvent): void {\n        if (this.downData) this.preventDefaultPointer(e)\n        if (this.notPointer || this.preventWindowPointer(e)) return\n        this.pointerUp(PointerEventHelper.convert(e, this.getLocal(e)))\n    }\n\n    protected onPointerCancel(): void {\n        if (this.useMultiTouch) return\n        this.pointerCancel()\n    }\n\n\n    // mouse\n    protected onMouseDown(e: MouseEvent): void {\n        this.preventDefaultPointer(e)\n\n        if (this.notMouse) return\n        this.pointerDown(PointerEventHelper.convertMouse(e, this.getLocal(e)))\n    }\n\n    protected onMouseMove(e: MouseEvent): void {\n        if (this.notMouse || this.preventWindowPointer(e)) return\n        this.pointerMove(PointerEventHelper.convertMouse(e, this.getLocal(e, true)))\n    }\n\n    protected onMouseUp(e: MouseEvent): void {\n        if (this.downData) this.preventDefaultPointer(e)\n        if (this.notMouse || this.preventWindowPointer(e)) return\n        this.pointerUp(PointerEventHelper.convertMouse(e, this.getLocal(e)))\n    }\n\n    protected onMouseCancel(): void {\n        if (this.notMouse) return\n        this.pointerCancel()\n    }\n\n\n    // touch\n    protected onTouchStart(e: TouchEvent): void {\n        const touch = PointerEventHelper.getTouch(e)\n        const local = this.getLocal(touch, true)\n        const { preventDefault } = this.config.touch\n        if (preventDefault === true || (preventDefault === 'auto' && pathCanDrag(this.findPath(local)))) e.preventDefault()\n\n        this.multiTouchStart(e)\n\n        if (this.notTouch) return\n        if (this.touchTimer) {\n            window.clearTimeout(this.touchTimer)\n            this.touchTimer = 0\n        }\n        this.useTouch = true\n        this.pointerDown(PointerEventHelper.convertTouch(e, local))\n    }\n\n    protected onTouchMove(e: TouchEvent): void {\n        this.multiTouchMove(e)\n\n        if (this.notTouch || this.preventWindowPointer(e)) return\n        const touch = PointerEventHelper.getTouch(e)\n        this.pointerMove(PointerEventHelper.convertTouch(e, this.getLocal(touch)))\n    }\n\n    protected onTouchEnd(e: TouchEvent): void {\n        this.multiTouchEnd()\n\n        if (this.notTouch || this.preventWindowPointer(e)) return\n        if (this.touchTimer) clearTimeout(this.touchTimer)\n        this.touchTimer = setTimeout(() => {\n            this.useTouch = false\n        }, 500) // stop touch > mouse\n        const touch = PointerEventHelper.getTouch(e)\n        this.pointerUp(PointerEventHelper.convertTouch(e, this.getLocal(touch)))\n    }\n\n    protected onTouchCancel(): void {\n        if (this.notTouch) return\n        this.pointerCancel()\n    }\n\n\n    // multiTouch\n    protected multiTouchStart(e: TouchEvent): void {\n        this.useMultiTouch = (e.touches.length > 1)\n        this.touches = this.useMultiTouch ? this.getTouches(e.touches) : undefined\n        if (this.useMultiTouch) this.pointerCancel()\n    }\n\n    protected multiTouchMove(e: TouchEvent): void {\n        if (!this.useMultiTouch) return\n        if (e.touches.length > 1) {\n            const touches = this.getTouches(e.touches)\n            const list = this.getKeepTouchList(this.touches, touches)\n            if (list.length > 1) {\n                this.multiTouch(InteractionHelper.getBase(e), list)\n                this.touches = touches\n            }\n        }\n    }\n\n    protected multiTouchEnd(): void {\n        this.touches = null\n        this.useMultiTouch = false\n        this.transformEnd()\n    }\n\n    protected getKeepTouchList(old: Touch[], touches: Touch[]): IKeepTouchData[] {\n        let to: Touch\n        const list: IKeepTouchData[] = []\n        old.forEach(from => {\n            to = touches.find(touch => touch.identifier === from.identifier)\n            if (to) list.push({ from: this.getLocal(from), to: this.getLocal(to) })\n        })\n        return list\n    }\n\n    protected getLocalTouchs(points: Touch[]): IPointData[] {\n        return points.map(point => this.getLocal(point))\n    }\n\n\n    // wheel\n    protected onWheel(e: WheelEvent): void {\n        this.preventDefaultWheel(e)\n        this.wheel({\n            ...InteractionHelper.getBase(e),\n            ...this.getLocal(e),\n            deltaX: e.deltaX,\n            deltaY: e.deltaY\n        })\n    }\n\n\n    // safari \n    protected onGesturestart(e: IGestureEvent): void {\n        if (this.useMultiTouch) return\n        this.preventDefaultWheel(e)\n\n        this.lastGestureScale = 1\n        this.lastGestureRotation = 0\n    }\n\n    protected onGesturechange(e: IGestureEvent): void {\n        if (this.useMultiTouch) return\n        this.preventDefaultWheel(e)\n\n        const eventBase = InteractionHelper.getBase(e)\n        Object.assign(eventBase, this.getLocal(e))\n\n        const scale = (e.scale / this.lastGestureScale)\n        const rotation = (e.rotation - this.lastGestureRotation) / Math.PI * 180 * (MathHelper.within(this.config.wheel.rotateSpeed, 0, 1) / 4 + 0.1)\n\n        this.zoom({ ...eventBase, scale: scale * scale } as IZoomEvent)\n        this.rotate({ ...eventBase, rotation } as IRotateEvent)\n\n        this.lastGestureScale = e.scale\n        this.lastGestureRotation = e.rotation\n    }\n\n    protected onGestureend(e: IGestureEvent): void {\n        if (this.useMultiTouch) return\n        this.preventDefaultWheel(e)\n\n        this.transformEnd()\n    }\n\n\n    // cursor\n    public setCursor(cursor: ICursorType | ICursorType[]): void {\n        super.setCursor(cursor)\n        const list: ICursorType[] = []\n        this.eachCursor(cursor, list)\n        if (isObject(list[list.length - 1])) list.push('default')\n        this.canvas.view.style.cursor = list.map(item => (isObject(item)) ? `url(${item.url}) ${item.x || 0} ${item.y || 0}` : item).join(',')\n    }\n\n    protected eachCursor(cursor: ICursorType | ICursorType[], list: ICursorType[], level = 0): void {\n        level++\n        if (isArray(cursor)) {\n            cursor.forEach(item => this.eachCursor(item, list, level))\n        } else {\n            const custom = isString(cursor) && Cursor.get(cursor)\n            if (custom && level < 2) {\n                this.eachCursor(custom, list, level)\n            } else {\n                list.push(cursor)\n            }\n        }\n    }\n\n    public destroy(): void {\n        if (this.view) {\n            super.destroy()\n            this.view = null\n            this.touches = null\n        }\n    }\n\n}","import { ILeaferCanvas, IRenderOptions } from '@leafer/interface'\n\nimport { IImagePaint, ILeafPaint, IUI } from '@leafer-ui/interface'\nimport { PaintImage, Paint } from \"@leafer-ui/draw\"\n\n\nexport function fill(fill: string, ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions): void {\n    canvas.fillStyle = fill\n    fillPathOrText(ui, canvas, renderOptions)\n}\n\n\nexport function fills(fills: ILeafPaint[], ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions): void {\n    let item: ILeafPaint, originPaint: IImagePaint, countImage: number\n    for (let i = 0, len = fills.length; i < len; i++) {\n        item = fills[i], originPaint = item.originPaint as IImagePaint\n\n        if (item.image) {\n\n            countImage ? countImage++ : countImage = 1\n\n            if (PaintImage.checkImage(item, !ui.__.__font, ui, canvas, renderOptions)) continue\n\n            if (!item.style) {\n                if (countImage === 1 && item.image.isPlacehold) ui.drawImagePlaceholder(item, canvas, renderOptions) // 图片加载中或加载失败\n                continue\n            }\n\n        }\n\n        canvas.fillStyle = item.style\n\n        if (item.transform || originPaint.scaleFixed) {\n\n            canvas.save()\n            if (item.transform) canvas.transform(item.transform)\n            if (originPaint.scaleFixed) {\n                const { scaleX, scaleY } = ui.getRenderScaleData(true)\n                if (originPaint.scaleFixed === true || (originPaint.scaleFixed === 'zoom-in' && scaleX > 1 && scaleY > 1)) canvas.scale(1 / scaleX, 1 / scaleY)\n            }\n            if (originPaint.blendMode) canvas.blendMode = originPaint.blendMode\n            fillPathOrText(ui, canvas, renderOptions)\n            canvas.restore()\n\n        } else {\n\n            if (originPaint.blendMode) {\n\n                canvas.saveBlendMode(originPaint.blendMode)\n                fillPathOrText(ui, canvas, renderOptions)\n                canvas.restoreBlendMode()\n\n            } else fillPathOrText(ui, canvas, renderOptions)\n\n        }\n\n    }\n}\n\n\nexport function fillPathOrText(ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions): void {\n    ui.__.__font ? Paint.fillText(ui, canvas, renderOptions) : (ui.__.windingRule ? canvas.fill(ui.__.windingRule) : canvas.fill())\n}","import { ILeaferCanvas, IRenderOptions } from '@leafer/interface'\nimport { LeafHelper, isObject } from \"@leafer/core\"\n\nimport { IUI, ILeafPaint } from '@leafer-ui/interface'\nimport { Paint } from '@leafer-ui/draw'\n\n\nexport function stroke(stroke: string, ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions): void {\n    const data = ui.__\n    if (!data.__strokeWidth) return\n\n    if (data.__font) {\n\n        Paint.strokeText(stroke, ui, canvas, renderOptions)\n\n    } else {\n\n        switch (data.strokeAlign) {\n            case 'center':\n                drawCenter(stroke, 1, ui, canvas, renderOptions)\n                break\n            case 'inside':\n                drawInside(stroke, ui, canvas, renderOptions)\n                break\n            case 'outside':\n                drawOutside(stroke, ui, canvas, renderOptions)\n                break\n        }\n\n    }\n}\n\n\nexport function strokes(strokes: ILeafPaint[], ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions): void {\n    Paint.stroke(strokes as any, ui, canvas, renderOptions)\n}\n\n\nfunction drawCenter(stroke: string | ILeafPaint[], strokeWidthScale: number, ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions) {\n    const data = ui.__\n    if (isObject(stroke)) {\n        Paint.drawStrokesStyle(stroke, strokeWidthScale, false, ui, canvas, renderOptions)\n    } else {\n        canvas.setStroke(stroke, data.__strokeWidth * strokeWidthScale, data)\n        canvas.stroke()\n    }\n\n    if (data.__useArrow) Paint.strokeArrow(stroke, ui, canvas, renderOptions)\n}\n\nfunction drawInside(stroke: string | ILeafPaint[], ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions) {\n    canvas.save()\n    canvas.clipUI(ui)\n\n    drawCenter(stroke, 2, ui, canvas, renderOptions)\n    canvas.restore()\n}\n\nfunction drawOutside(stroke: string | ILeafPaint[], ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions) {\n    const data = ui.__\n    if (data.__fillAfterStroke) {\n\n        drawCenter(stroke, 2, ui, canvas, renderOptions)\n\n    } else {\n        const { renderBounds } = ui.__layout\n        const out = canvas.getSameCanvas(true, true)\n        ui.__drawRenderPath(out)\n\n        drawCenter(stroke, 2, ui, out, renderOptions)\n\n        out.clipUI(data)\n        out.clearWorld(renderBounds)\n\n        LeafHelper.copyCanvasByWorld(ui, canvas, out)\n\n        out.recycle(ui.__nowWorld)\n    }\n}\n","import { ILeaferCanvas, IRenderOptions } from '@leafer/interface'\nimport { LeafHelper, isObject } from \"@leafer/core\"\n\nimport { IUI, ITextRowData, ILeafPaint, IStrokeAlign, ILeafStrokePaint } from '@leafer-ui/interface'\nimport { PaintImage, Paint } from \"@leafer-ui/draw\"\n\n\nexport function strokeText(stroke: string | ILeafPaint[], ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions): void {\n    switch (ui.__.strokeAlign) {\n        case 'center':\n            drawCenter(stroke, 1, ui, canvas, renderOptions)\n            break\n        case 'inside':\n            drawAlign(stroke, 'inside', ui, canvas, renderOptions)\n            break\n        case 'outside':\n            ui.__.__fillAfterStroke ? drawCenter(stroke, 2, ui, canvas, renderOptions) : drawAlign(stroke, 'outside', ui, canvas, renderOptions)\n            break\n    }\n}\n\nfunction drawCenter(stroke: string | ILeafPaint[], strokeWidthScale: number, ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions): void {\n    const data = ui.__\n    if (isObject(stroke)) {\n        Paint.drawStrokesStyle(stroke, strokeWidthScale, true, ui, canvas, renderOptions)\n    } else {\n        canvas.setStroke(stroke, data.__strokeWidth * strokeWidthScale, data)\n        Paint.drawTextStroke(ui, canvas, renderOptions)\n    }\n}\n\nfunction drawAlign(stroke: string | ILeafPaint[], align: IStrokeAlign, ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions): void {\n    const out = canvas.getSameCanvas(true, true)\n    out.font = ui.__.__font\n    drawCenter(stroke, 2, ui, out, renderOptions)\n\n    out.blendMode = align === 'outside' ? 'destination-out' : 'destination-in'\n    Paint.fillText(ui, out, renderOptions)\n    out.blendMode = 'normal'\n\n    LeafHelper.copyCanvasByWorld(ui, canvas, out)\n\n    out.recycle(ui.__nowWorld)\n}\n\n\nexport function drawTextStroke(ui: IUI, canvas: ILeaferCanvas, _renderOptions: IRenderOptions): void {\n\n    let row: ITextRowData, data = ui.__.__textDrawData\n    const { rows, decorationY } = data\n\n    for (let i = 0, len = rows.length; i < len; i++) {\n        row = rows[i]\n\n        if (row.text) canvas.strokeText(row.text, row.x, row.y)\n        else if (row.data) row.data.forEach(charData => { canvas.strokeText(charData.char, charData.x, row.y) })\n    }\n\n    if (decorationY) {\n        const { decorationHeight } = data\n        rows.forEach(row => decorationY.forEach(value => canvas.strokeRect(row.x, row.y + value, row.width, decorationHeight)))\n    }\n\n}\n\nexport function drawStrokesStyle(strokes: ILeafStrokePaint[], strokeWidthScale: number, isText: boolean, ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions): void {\n    let item: ILeafStrokePaint\n    const data = ui.__, { __hasMultiStrokeStyle } = data\n    __hasMultiStrokeStyle || canvas.setStroke(undefined, data.__strokeWidth * strokeWidthScale, data)\n\n    for (let i = 0, len = strokes.length; i < len; i++) {\n        item = strokes[i]\n\n        if (item.image && PaintImage.checkImage(item, false, ui, canvas, renderOptions)) continue\n\n        if (item.style) {\n            if (__hasMultiStrokeStyle) {\n                const { strokeStyle } = item\n                strokeStyle ? canvas.setStroke(item.style, data.__getRealStrokeWidth(strokeStyle) * strokeWidthScale, data, strokeStyle) : canvas.setStroke(item.style, data.__strokeWidth * strokeWidthScale, data)\n            } else canvas.strokeStyle = item.style\n\n            if (item.originPaint.blendMode) {\n                canvas.saveBlendMode(item.originPaint.blendMode)\n                isText ? Paint.drawTextStroke(ui, canvas, renderOptions) : canvas.stroke()\n                canvas.restoreBlendMode()\n            } else {\n                isText ? Paint.drawTextStroke(ui, canvas, renderOptions) : canvas.stroke()\n            }\n        }\n    }\n}","import { IBoundsData, ILeaferCanvas, IRenderOptions, IMatrix } from '@leafer/interface'\nimport { BoundsHelper, FourNumberHelper, Matrix, Platform } from '@leafer/core'\n\nimport { IUI, ICachedShape } from '@leafer-ui/interface'\n\n\nconst { getSpread, copyAndSpread, toOuterOf, getOuterOf, getByMove, move, getIntersectData } = BoundsHelper\nconst tempBounds = {} as IBoundsData\n\nexport function shape(ui: IUI, current: ILeaferCanvas, options: IRenderOptions): ICachedShape {\n    const canvas = current.getSameCanvas()\n    const currentBounds = current.bounds, nowWorld = ui.__nowWorld, layout = ui.__layout\n    const nowWorldShapeBounds = ui.__nowWorldShapeBounds || (ui.__nowWorldShapeBounds = {} as IBoundsData)\n\n    toOuterOf(layout.strokeSpread ? (copyAndSpread(tempBounds, layout.boxBounds, layout.strokeSpread), tempBounds) : layout.boxBounds, nowWorld, nowWorldShapeBounds)\n\n    let bounds: IBoundsData, renderBounds: IBoundsData, matrix: IMatrix, fitMatrix: IMatrix, shapeBounds: IBoundsData, worldCanvas: ILeaferCanvas\n\n    let { scaleX, scaleY } = ui.getRenderScaleData(true)\n\n    if (currentBounds.includes(nowWorldShapeBounds)) {\n\n        worldCanvas = canvas\n        bounds = shapeBounds = nowWorldShapeBounds\n        renderBounds = nowWorld\n\n    } else {\n\n        let worldClipBounds: IBoundsData // 作为绘制阴影的裁剪形状\n\n        if (Platform.fullImageShadow) { // fix: iOS Safari 18.5 以上, 只裁剪部分区域渲染阴影会有问题\n            worldClipBounds = nowWorldShapeBounds\n        } else {\n\n            const spreadBounds = layout.renderShapeSpread ? getSpread(currentBounds, FourNumberHelper.swapAndScale(layout.renderShapeSpread, scaleX, scaleY)) : currentBounds  // spread需要反向交换值\n            worldClipBounds = getIntersectData(spreadBounds, nowWorldShapeBounds)\n        }\n\n        fitMatrix = currentBounds.getFitMatrix(worldClipBounds)\n        let { a: fitScaleX, d: fitScaleY } = fitMatrix\n\n        if (fitMatrix.a < 1) {\n            worldCanvas = current.getSameCanvas()\n            ui.__renderShape(worldCanvas, options)\n\n            scaleX *= fitScaleX\n            scaleY *= fitScaleY\n        }\n\n\n        shapeBounds = getOuterOf(nowWorldShapeBounds, fitMatrix)\n        bounds = getByMove(shapeBounds, -fitMatrix.e, -fitMatrix.f)\n\n        renderBounds = getOuterOf(nowWorld, fitMatrix)\n        move(renderBounds, -fitMatrix.e, -fitMatrix.f)\n\n\n        const userMatrix = options.matrix\n        if (userMatrix) {\n            matrix = new Matrix(fitMatrix) // 仅用于渲染\n            matrix.multiply(userMatrix)\n            fitScaleX *= userMatrix.scaleX\n            fitScaleY *= userMatrix.scaleY\n        } else matrix = fitMatrix\n\n        matrix.withScale(fitScaleX, fitScaleY)\n        options = { ...options, matrix }\n    }\n\n    ui.__renderShape(canvas, options)\n\n    return {\n        canvas, matrix, fitMatrix, bounds, renderBounds,\n        worldCanvas, shapeBounds, scaleX, scaleY\n    }\n}","import { DataHelper, isArray, isObject, isString, isUndefined } from '@leafer/core'\n\nimport { IUI, IPaint, ILeafPaint, IRGB, IBooleanMap, IObject, IPaintAttr, IStrokeComputedStyle } from '@leafer-ui/interface'\nimport { ColorConvert, PaintImage, PaintGradient } from '@leafer-ui/draw'\n\n\nlet recycleMap: IBooleanMap\nconst { stintSet } = DataHelper, { hasTransparent } = ColorConvert\n\nexport function compute(attrName: IPaintAttr, ui: IUI): void {\n    const data = ui.__, leafPaints: ILeafPaint[] = []\n\n    let paints: IPaint[] = data.__input[attrName], isAlphaPixel: boolean, isTransparent: boolean\n    if (!isArray(paints)) paints = [paints]\n\n    recycleMap = PaintImage.recycleImage(attrName, data)\n\n    let maxChildStrokeWidth: number\n\n    for (let i = 0, len = paints.length, item: ILeafPaint; i < len; i++) {\n        if (item = getLeafPaint(attrName, paints[i], ui)) {\n            leafPaints.push(item)\n\n            // 检测多个子描边样式和宽度\n            if (item.strokeStyle) {\n                maxChildStrokeWidth || (maxChildStrokeWidth = 1)\n                if (item.strokeStyle.strokeWidth) maxChildStrokeWidth = Math.max(maxChildStrokeWidth, item.strokeStyle.strokeWidth as number)\n            }\n        }\n    }\n\n    (data as IObject)['_' + attrName] = leafPaints.length ? leafPaints : undefined\n\n    if (leafPaints.length) {\n\n        if (leafPaints.every(item => item.isTransparent)) {\n            if (leafPaints.some(item => item.image)) isAlphaPixel = true\n            isTransparent = true\n        }\n\n        if (attrName === 'fill') {\n            stintSet(data, '__isAlphaPixelFill', isAlphaPixel)\n            stintSet(data, '__isTransparentFill', isTransparent)\n        } else {\n            stintSet(data, '__isAlphaPixelStroke', isAlphaPixel)\n            stintSet(data, '__isTransparentStroke', isTransparent)\n            stintSet(data, '__hasMultiStrokeStyle', maxChildStrokeWidth)\n        }\n\n    } else {\n        data.__removePaint(attrName, false)\n    }\n\n}\n\n\nfunction getLeafPaint(attrName: string, paint: IPaint, ui: IUI): ILeafPaint {\n    if (!isObject(paint) || paint.visible === false || paint.opacity === 0) return undefined\n\n    let leafPaint: ILeafPaint\n    const { boxBounds } = ui.__layout\n\n    switch (paint.type) {\n        case 'image':\n            if (!paint.url) return undefined\n            leafPaint = PaintImage.image(ui, attrName, paint, boxBounds, !recycleMap || !recycleMap[paint.url])\n            break\n        case 'linear':\n            leafPaint = PaintGradient.linearGradient(paint, boxBounds)\n            break\n        case 'radial':\n            leafPaint = PaintGradient.radialGradient(paint, boxBounds)\n            break\n        case 'angular':\n            leafPaint = PaintGradient.conicGradient(paint, boxBounds)\n            break\n        case 'solid':\n            const { type, color, opacity } = paint\n            leafPaint = { type, style: ColorConvert.string(color, opacity) }\n            break\n        default:\n            if (!isUndefined((paint as IRGB).r)) leafPaint = { type: 'solid', style: ColorConvert.string(paint) }\n    }\n\n    if (leafPaint) {\n        // 原始paint\n        leafPaint.originPaint = paint\n\n        // 描边样式\n        if (isString(leafPaint.style) && hasTransparent(leafPaint.style)) leafPaint.isTransparent = true\n        if (paint.style) {\n            if (paint.style.strokeWidth === 0) return undefined\n            leafPaint.strokeStyle = paint.style as IStrokeComputedStyle\n        }\n    }\n\n    return leafPaint\n}","import { IPaintModule } from '@leafer-ui/interface'\n\nimport { fill, fills, fillPathOrText } from './Fill'\nimport { fillText } from './FillText'\nimport { stroke, strokes } from './Stroke'\nimport { strokeText, drawTextStroke, drawStrokesStyle } from './StrokeText'\nimport { shape } from './Shape'\nimport { compute } from './Compute'\n\n\nexport const PaintModule: IPaintModule = {\n    compute,\n\n    fill,\n    fills,\n    fillPathOrText,\n    fillText,\n\n    stroke,\n    strokes,\n    strokeText,\n    drawTextStroke,\n    drawStrokesStyle,\n\n    shape\n}","import { ILeaferCanvas, IRenderOptions } from '@leafer/interface'\n\nimport { ITextRowData, IText } from '@leafer-ui/interface'\n\n\nexport function fillText(ui: IText, canvas: ILeaferCanvas, _renderOptions: IRenderOptions): void {\n\n    const data = ui.__, { rows, decorationY } = data.__textDrawData\n    if (data.__isPlacehold && data.placeholderColor) canvas.fillStyle = data.placeholderColor\n\n    let row: ITextRowData\n\n    for (let i = 0, len = rows.length; i < len; i++) {\n        row = rows[i]\n\n        if (row.text) canvas.fillText(row.text, row.x, row.y)\n        else if (row.data) row.data.forEach(charData => { canvas.fillText(charData.char, charData.x, row.y) })\n    }\n\n    if (decorationY) {\n        const { decorationColor, decorationHeight } = data.__textDrawData\n        if (decorationColor) canvas.fillStyle = decorationColor\n        rows.forEach(row => decorationY.forEach(value => canvas.fillRect(row.x, row.y + value, row.width, decorationHeight)))\n    }\n\n}\n","import { IBoundsData, IImageEvent, ILeaferImage, IObject } from '@leafer/interface'\nimport { Bounds, BoundsHelper, ImageEvent, ImageManager } from '@leafer/core'\n\nimport { IUI, IImagePaint, ILeafPaint } from '@leafer-ui/interface'\nimport { PaintImage } from \"@leafer-ui/draw\"\n\n\ninterface IImagePaintCache {\n    leafPaint: ILeafPaint\n    paint: IImagePaint\n    boxBounds: IBoundsData\n}\n\nlet cache: IImagePaintCache, box = new Bounds()\nconst { isSame } = BoundsHelper\n\nexport function image(ui: IUI, attrName: string, paint: IImagePaint, boxBounds: IBoundsData, firstUse: boolean): ILeafPaint {\n    let leafPaint: ILeafPaint, event: IImageEvent\n    const image = ImageManager.get(paint)\n\n    if (cache && paint === cache.paint && isSame(boxBounds, cache.boxBounds)) {\n        leafPaint = cache.leafPaint\n    } else {\n        leafPaint = { type: paint.type, image }\n        if (image.hasAlphaPixel) leafPaint.isTransparent = true\n\n        cache = image.use > 1 ? { leafPaint, paint, boxBounds: box.set(boxBounds) } : null // 只保留最后一个cache\n    }\n\n    if (firstUse || image.loading) event = { image, attrName, attrValue: paint }\n\n    if (image.ready) {\n\n        checkSizeAndCreateData(ui, attrName, paint, image, leafPaint, boxBounds)\n\n        if (firstUse) {\n            onLoad(ui, event)\n            onLoadSuccess(ui, event)\n        }\n\n    } else if (image.error) {\n\n        if (firstUse) onLoadError(ui, event, image.error)\n\n    } else { // need load\n\n        if (firstUse) {\n            ignoreRender(ui, true) // wait loaded\n            onLoad(ui, event)\n        }\n\n        leafPaint.loadId = image.load(\n            () => {\n                ignoreRender(ui, false)\n                if (!ui.destroyed) {\n                    if (checkSizeAndCreateData(ui, attrName, paint, image, leafPaint, boxBounds)) {\n                        if (image.hasAlphaPixel) ui.__layout.hitCanvasChanged = true\n                        ui.forceUpdate('surface')\n                    }\n                    onLoadSuccess(ui, event)\n                }\n                leafPaint.loadId = undefined\n            },\n            (error) => {\n                ignoreRender(ui, false)\n                onLoadError(ui, event, error)\n                leafPaint.loadId = undefined\n            },\n            paint.lod && image.getThumbSize(paint.lod)\n        )\n\n        if (ui.placeholderColor) {\n            if (!ui.placeholderDelay) image.isPlacehold = true\n            else setTimeout(() => {\n                if (!image.ready) {\n                    image.isPlacehold = true\n                    ui.forceUpdate('surface')\n                }\n            }, ui.placeholderDelay)\n        }\n\n    }\n\n    return leafPaint\n}\n\n\nfunction checkSizeAndCreateData(ui: IUI, attrName: string, paint: IImagePaint, image: ILeaferImage, leafPaint: ILeafPaint, boxBounds: IBoundsData): boolean {\n    if (attrName === 'fill' && !ui.__.__naturalWidth) {\n        const data = ui.__\n        data.__naturalWidth = image.width / data.pixelRatio\n        data.__naturalHeight = image.height / data.pixelRatio\n        if (data.__autoSide) {\n            ui.forceUpdate('width')\n            if (ui.__proxyData) {\n                ui.setProxyAttr('width', data.width)\n                ui.setProxyAttr('height', data.height)\n            }\n            return false\n        }\n    }\n\n    if (!leafPaint.data) PaintImage.createData(leafPaint, image, paint, boxBounds)\n    return true\n}\n\n\n\nfunction onLoad(ui: IUI, event: IImageEvent): void {\n    emit(ui, ImageEvent.LOAD, event)\n}\n\n\nfunction onLoadSuccess(ui: IUI, event: IImageEvent): void {\n    emit(ui, ImageEvent.LOADED, event)\n}\n\n\nfunction onLoadError(ui: IUI, event: IImageEvent, error: string | IObject,): void {\n    event.error = error\n    ui.forceUpdate('surface')\n    emit(ui, ImageEvent.ERROR, event)\n}\n\n\nfunction emit(ui: IUI, type: string, data: IImageEvent): void {\n    if (ui.hasEvent(type)) ui.emitEvent(new ImageEvent(type, data))\n}\n\nfunction ignoreRender(ui: IUI, value: boolean): void {\n    const { leafer } = ui\n    if (leafer && leafer.viewReady) leafer.renderer.ignore = value // prevent blink on hover\n}","import { IBoundsData, IGap, ILeaferImage, IPointData, IPointGap, IScaleData } from '@leafer/interface'\nimport { MatrixHelper, MathHelper, Bounds, AlignHelper, BoundsHelper, PointHelper, isObject, isString, isNumber } from '@leafer/core'\n\nimport { IImagePaint, ILeafPaint, ILeafPaintPatternData } from '@leafer-ui/interface'\nimport { PaintImage } from \"@leafer-ui/draw\"\n\n\nconst { get, translate } = MatrixHelper\nconst tempBox = new Bounds()\nconst tempScaleData = {} as IScaleData\nconst tempImage = {} as IBoundsData\n\nexport function createData(leafPaint: ILeafPaint, image: ILeaferImage, paint: IImagePaint, box: IBoundsData): void {\n    leafPaint.data = PaintImage.getPatternData(paint, box, image)\n}\n\nexport function getPatternData(paint: IImagePaint, box: IBoundsData, image: ILeaferImage): ILeafPaintPatternData {\n    if (paint.padding) box = tempBox.set(box).shrink(paint.padding)\n    if (paint.mode === 'strench' as string) paint.mode = 'stretch' // 兼容代码，后续可移除\n\n    const { width, height } = image\n    const { opacity, mode, align, offset, scale, size, rotation, skew, clipSize, repeat, gap, filters, interlace } = paint\n    const sameBox = box.width === width && box.height === height\n\n    const data: ILeafPaintPatternData = { mode }\n    const swapSize = align !== 'center' && (rotation || 0) % 180 === 90\n    BoundsHelper.set(tempImage, 0, 0, swapSize ? height : width, swapSize ? width : height)\n\n    let scaleX: number, scaleY: number\n\n    if (!mode || mode === 'cover' || mode === 'fit') { // mode 默认值为 cover\n        if (!sameBox || rotation) {\n            scaleX = scaleY = BoundsHelper.getFitScale(box, tempImage, mode !== 'fit')\n            BoundsHelper.put(box, image, align, scaleX, false, tempImage)\n            BoundsHelper.scale(tempImage, scaleX, scaleY, true)\n        }\n    } else {\n        if (scale || size) {\n            MathHelper.getScaleData(scale, size, image, tempScaleData)\n            scaleX = tempScaleData.scaleX\n            scaleY = tempScaleData.scaleY\n        }\n\n        if (align || gap || repeat) {\n            if (scaleX) BoundsHelper.scale(tempImage, scaleX, scaleY, true)\n            if (align) AlignHelper.toPoint(align, tempImage, box, tempImage, true, true)\n        }\n    }\n\n    if (offset) PointHelper.move(tempImage, offset)\n\n    switch (mode) {\n        case 'stretch':\n            if (!sameBox) {\n                scaleX = box.width / width, scaleY = box.height / height\n                PaintImage.stretchMode(data, box, scaleX, scaleY)\n            } else if (scaleX) scaleX = scaleY = undefined\n            break\n        case 'normal':\n        case 'clip':\n            if (tempImage.x || tempImage.y || scaleX || clipSize || rotation || skew) {\n                let clipScaleX: number, clipScaleY: number\n                if (clipSize) clipScaleX = box.width / clipSize.width, clipScaleY = box.height / clipSize.height\n                PaintImage.clipMode(data, box, tempImage.x, tempImage.y, scaleX, scaleY, rotation, skew, clipScaleX, clipScaleY)\n                if (clipScaleX) scaleX = scaleX ? scaleX * clipScaleX : clipScaleX, scaleY = scaleY ? scaleY * clipScaleY : clipScaleY\n            }\n            break\n        case 'repeat':\n            if (!sameBox || scaleX || rotation || skew) PaintImage.repeatMode(data, box, width, height, tempImage.x, tempImage.y, scaleX, scaleY, rotation, skew, align, paint.freeTransform)\n            if (!repeat) data.repeat = 'repeat'\n            const count = isObject(repeat)\n            if (gap || count) data.gap = getGapData(gap, count && repeat, tempImage.width, tempImage.height, box)\n            break\n        case 'fit':\n        case 'cover':\n        default:\n            if (scaleX) PaintImage.fillOrFitMode(data, box, tempImage.x, tempImage.y, scaleX, scaleY, rotation)\n    }\n\n    if (!data.transform) {\n        if (box.x || box.y) translate(data.transform = get(), box.x, box.y)\n    }\n\n    if (scaleX) {\n        data.scaleX = scaleX\n        data.scaleY = scaleY\n    }\n\n    if (opacity && opacity < 1) data.opacity = opacity\n    if (filters) data.filters = filters\n    if (repeat) data.repeat = isString(repeat) ? (repeat === 'x' ? 'repeat-x' : 'repeat-y') : 'repeat'\n    if (interlace) data.interlace = (isNumber(interlace) || interlace.type === 'percent') ? { type: 'x', offset: interlace } : interlace\n    return data\n}\n\n\nfunction getGapData(gap: IGap | IPointGap, repeat: IPointData, width: number, height: number, box: IBoundsData): IPointData {\n    let xGap: IGap, yGap: IGap\n    if (isObject(gap)) xGap = gap.x, yGap = gap.y\n    else xGap = yGap = gap\n    return { x: getGapValue(xGap, width, box.width, repeat && repeat.x), y: getGapValue(yGap, height, box.height, repeat && repeat.y) }\n}\n\nfunction getGapValue(gap: IGap, size: number, totalSize: number, rows: number): number {\n    const auto = isString(gap) || rows\n    const remain = rows ? totalSize - rows * size : totalSize % size\n    const value = auto ? remain / ((rows || Math.floor(totalSize / size)) - 1) : gap\n    return gap === 'auto' ? (value < 0 ? 0 : value) : value\n}","import { IBoundsData, IPointData, IMatrixData, IAlign } from '@leafer/interface'\nimport { getMatrixData, MatrixHelper } from '@leafer/core'\n\nimport { ILeafPaintPatternData } from '@leafer-ui/interface'\n\n\nlet origin = {} as IPointData, tempMatrix = getMatrixData()\nconst { get, set, rotateOfOuter, translate, scaleOfOuter, multiplyParent, scale: scaleHelper, rotate, skew: skewHelper } = MatrixHelper\n\nexport function stretchMode(data: ILeafPaintPatternData, box: IBoundsData, scaleX: number, scaleY: number): void {\n    const transform: IMatrixData = get(), { x, y } = box\n    if (x || y) translate(transform, x, y)\n    else transform.onlyScale = true\n    scaleHelper(transform, scaleX, scaleY)\n    data.transform = transform\n}\n\nexport function fillOrFitMode(data: ILeafPaintPatternData, box: IBoundsData, x: number, y: number, scaleX: number, scaleY: number, rotation: number): void {\n    const transform: IMatrixData = get()\n    translate(transform, box.x + x, box.y + y)\n    scaleHelper(transform, scaleX, scaleY)\n    if (rotation) rotateOfOuter(transform, { x: box.x + box.width / 2, y: box.y + box.height / 2 }, rotation)\n    data.transform = transform\n}\n\nexport function clipMode(data: ILeafPaintPatternData, box: IBoundsData, x: number, y: number, scaleX: number, scaleY: number, rotation: number, skew: IPointData, clipScaleX?: number, clipScaleY?: number): void {\n    const transform: IMatrixData = get()\n    layout(transform, box, x, y, scaleX, scaleY, rotation, skew)\n    if (clipScaleX) {\n        if (rotation || skew) {\n            set(tempMatrix)\n            scaleOfOuter(tempMatrix, box, clipScaleX, clipScaleY)\n            multiplyParent(transform, tempMatrix)\n        } else scaleOfOuter(transform, box, clipScaleX, clipScaleY)\n    }\n    data.transform = transform\n}\n\nexport function repeatMode(data: ILeafPaintPatternData, box: IBoundsData, width: number, height: number, x: number, y: number, scaleX: number, scaleY: number, rotation: number, skew: IPointData, align: IAlign, freeTransform?: boolean): void {\n    const transform = get()\n    if (freeTransform) { // 自由变换\n        layout(transform, box, x, y, scaleX, scaleY, rotation, skew)\n    } else {\n        if (rotation) {\n            if (align === 'center') {\n                rotateOfOuter(transform, { x: width / 2, y: height / 2 }, rotation)\n            } else {\n                rotate(transform, rotation)\n                switch (rotation) {\n                    case 90:\n                        translate(transform, height, 0)\n                        break\n                    case 180:\n                        translate(transform, width, height)\n                        break\n                    case 270:\n                        translate(transform, 0, width)\n                        break\n                }\n            }\n        }\n        origin.x = box.x + x\n        origin.y = box.y + y\n        translate(transform, origin.x, origin.y)\n        if (scaleX) scaleOfOuter(transform, origin, scaleX, scaleY)\n    }\n    data.transform = transform\n}\n\nfunction layout(transform: IMatrixData, box: IBoundsData, x: number, y: number, scaleX: number, scaleY: number, rotation: number, skew: IPointData) {\n    // rotate -> skew -> scale -> translate\n    if (rotation) rotate(transform, rotation)\n    if (skew) skewHelper(transform, skew.x, skew.y)\n    if (scaleX) scaleHelper(transform, scaleX, scaleY)\n    translate(transform, box.x + x, box.y + y)\n}\n","import { ILeaferCanvas, IRenderOptions } from '@leafer/interface'\nimport { Platform, MatrixHelper, MathHelper, ImageManager } from '@leafer/core'\n\nimport { IUI, ILeafPaint, IMatrixData } from '@leafer-ui/interface'\nimport { PaintImage } from \"@leafer-ui/draw\"\n\n\nconst { get, scale, copy } = MatrixHelper\nconst { getFloorScale } = MathHelper, { abs } = Math\n\nexport function createPatternTask(paint: ILeafPaint, ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions): void {\n    if (!paint.patternTask) {\n        paint.patternTask = ImageManager.patternTasker.add(async () => {\n            PaintImage.createPattern(paint, ui, canvas, renderOptions)\n            ui.forceUpdate('surface')\n        }, 0, () => {\n            paint.patternTask = null\n            return canvas.bounds.hit(ui.__nowWorld)\n        })\n    }\n}\n\nexport function createPattern(paint: ILeafPaint, ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions): void {\n    let { scaleX, scaleY } = PaintImage.getImageRenderScaleData(paint, ui, canvas, renderOptions), id = scaleX + '-' + scaleY\n\n    if (paint.patternId !== id && !ui.destroyed) {\n        if (!(Platform.image.isLarge(paint.image, scaleX, scaleY) && !paint.data.repeat)) {\n\n            const { image, data } = paint, { transform, gap } = data, fixScale = PaintImage.getPatternFixScale(paint, scaleX, scaleY)\n            let imageMatrix: IMatrixData, xGap: number, yGap: number, { width, height } = image\n\n            if (fixScale) scaleX *= fixScale, scaleY *= fixScale\n\n            width *= scaleX\n            height *= scaleY\n\n            // 平铺间距\n            if (gap) {\n                xGap = gap.x * scaleX / abs(data.scaleX || 1)\n                yGap = gap.y * scaleY / abs(data.scaleY || 1)\n            }\n\n            if (transform || scaleX !== 1 || scaleY !== 1) {\n                scaleX *= getFloorScale(width + (xGap || 0)) // 缩放至floor画布宽高的状态\n                scaleY *= getFloorScale(height + (yGap || 0))\n\n                imageMatrix = get()\n                if (transform) copy(imageMatrix, transform)\n                scale(imageMatrix, 1 / scaleX, 1 / scaleY)\n            }\n\n            const imageCanvas = image.getCanvas(width, height, data.opacity, data.filters, xGap, yGap, ui.leafer && ui.leafer.config.smooth, data.interlace)\n            const pattern = image.getPattern(imageCanvas, data.repeat || (Platform.origin.noRepeat || 'no-repeat'), imageMatrix, paint)\n\n            paint.style = pattern\n            paint.patternId = id\n\n        }\n    }\n}\n\nexport function getPatternFixScale(paint: ILeafPaint, imageScaleX: number, imageScaleY: number): number {\n    const { image } = paint\n    let fixScale: number, maxSize = Platform.image.maxPatternSize, imageSize = image.width * image.height\n\n    if (image.isSVG) {\n        if (imageScaleX > 1) fixScale = Math.ceil(imageScaleX) / imageScaleX // fix: svg按整数倍放大，避免产生加深线条\n    } else {\n        if (maxSize > imageSize) maxSize = imageSize // 防止大于元素自身宽高\n    }\n\n    if ((imageSize *= imageScaleX * imageScaleY) > maxSize) fixScale = Math.sqrt(maxSize / imageSize)\n    return fixScale\n}","import { IPaintImageModule } from '@leafer-ui/interface'\n\nimport { image } from './image'\nimport { createData, getPatternData } from './data'\nimport { fillOrFitMode, clipMode, repeatMode, stretchMode } from './mode'\nimport { createPatternTask, createPattern, getPatternFixScale } from './pattern'\nimport { checkImage, drawImage, getImageRenderScaleData } from './check'\nimport { recycleImage } from './recycle'\n\n\nexport const PaintImageModule: IPaintImageModule = {\n    image,\n\n    checkImage,\n    drawImage,\n    getImageRenderScaleData,\n    recycleImage,\n\n    createPatternTask,\n    createPattern,\n    getPatternFixScale,\n\n    createData,\n    getPatternData,\n\n    stretchMode,\n    fillOrFitMode,\n    clipMode,\n    repeatMode\n}","import { ILeaferCanvas, IRenderOptions, IScaleData } from '@leafer/interface'\nimport { Platform, ResizeEvent } from '@leafer/core'\n\nimport { IUI, ILeafPaint, IImagePaint } from '@leafer-ui/interface'\nimport { PaintImage } from \"@leafer-ui/draw\"\n\n\nexport function checkImage(paint: ILeafPaint, drawImage: boolean, ui: IUI, canvas: ILeaferCanvas, renderOptions: IRenderOptions): boolean {\n    const { scaleX, scaleY } = PaintImage.getImageRenderScaleData(paint, ui, canvas, renderOptions)\n    const { image, data, originPaint } = paint, { exporting, snapshot } = renderOptions\n\n    if (!data || (paint.patternId === scaleX + '-' + scaleY && !exporting) || snapshot) {\n        return false // 生成图案中\n    } else {\n\n        if (drawImage) {\n            if (data.repeat) {\n                drawImage = false\n            } else if (!((originPaint as IImagePaint).changeful || (Platform.name === 'miniapp' && ResizeEvent.isResizing(ui)) || exporting)) { //  小程序resize过程中直接绘制原图（绕过垃圾回收bug)\n                drawImage = Platform.image.isLarge(image, scaleX, scaleY) || image.width * scaleX > 8096 || image.height * scaleY > 8096 // 大长图单边超过8096生成pattern会有问题\n            }\n        }\n\n        if (drawImage) {\n            if (ui.__.__isFastShadow) { // fix: 快速阴影时，直接 drawImage 会无阴影，需fill一下\n                canvas.fillStyle = paint.style || '#000'\n                canvas.fill()\n            }\n            PaintImage.drawImage(paint, scaleX, scaleY, ui, canvas, renderOptions) // 直接绘制图像，不生成图案\n            return true\n        } else {\n            if (!paint.style || (originPaint as IImagePaint).sync || exporting) PaintImage.createPattern(paint, ui, canvas, renderOptions)\n            else PaintImage.createPatternTask(paint, ui, canvas, renderOptions)\n            return false\n        }\n    }\n}\n\nexport function drawImage(paint: ILeafPaint, _imageScaleX: number, _imageScaleY: number, ui: IUI, canvas: ILeaferCanvas, _renderOptions: IRenderOptions): void {\n    const { data, image } = paint, { blendMode } = paint.originPaint as IImagePaint, { opacity, transform } = data, view = image.getFull(data.filters), u = ui.__\n    let { width, height } = image, clipUI: any\n\n    if ((clipUI = (transform && !transform.onlyScale) || u.path || u.cornerRadius) || opacity || blendMode) {\n        canvas.save()\n        clipUI && canvas.clipUI(ui)\n        blendMode && (canvas.blendMode = blendMode)\n        opacity && (canvas.opacity *= opacity)\n        transform && canvas.transform(transform)\n        canvas.drawImage(view, 0, 0, width, height) // svg need size\n        canvas.restore()\n    } else { // 简单矩形\n        if (data.scaleX) width *= data.scaleX, height *= data.scaleY\n        canvas.drawImage(view, 0, 0, width, height)\n    }\n\n}\n\nexport function getImageRenderScaleData(paint: ILeafPaint, ui: IUI, canvas?: ILeaferCanvas, _renderOptions?: IRenderOptions): IScaleData {\n    const scaleData = ui.getRenderScaleData(true, paint.originPaint.scaleFixed), { data } = paint\n    if (canvas) {\n        const { pixelRatio } = canvas\n        scaleData.scaleX *= pixelRatio\n        scaleData.scaleY *= pixelRatio\n    }\n    if (data && data.scaleX) {\n        scaleData.scaleX *= Math.abs(data.scaleX)\n        scaleData.scaleY *= Math.abs(data.scaleY)\n    }\n    return scaleData\n}","import { IBooleanMap, ILeaferImage, IObject } from '@leafer/interface'\nimport { ImageManager, isArray } from '@leafer/core'\n\nimport { IImagePaint, ILeafPaint, IPaintAttr, IUIData } from '@leafer-ui/interface'\n\n\nexport function recycleImage(attrName: IPaintAttr, data: IUIData): IBooleanMap {\n    const paints: ILeafPaint[] = (data as IObject)['_' + attrName]\n\n    if (isArray(paints)) {\n\n        let paint: ILeafPaint, image: ILeaferImage, recycleMap: IBooleanMap, input: IImagePaint[], url: string\n\n        for (let i = 0, len = paints.length; i < len; i++) {\n\n            paint = paints[i]\n            image = paint.image\n            url = image && image.url\n\n            if (url) {\n                if (!recycleMap) recycleMap = {}\n                recycleMap[url] = true\n                ImageManager.recyclePaint(paint)\n\n                // stop load\n                if (image.loading) {\n                    if (!input) {\n                        input = (data.__input && data.__input[attrName]) || []\n                        if (!isArray(input)) input = [input]\n                    }\n                    image.unload(paints[i].loadId, !input.some((item: IImagePaint) => item.url === url))\n                }\n            }\n\n        }\n\n        return recycleMap\n\n    }\n\n    return null\n}","import { IObject, IBoundsData, IPointData } from '@leafer/interface'\nimport { AroundHelper, Platform, isString } from '@leafer/core'\n\nimport { IGradientPaint, ILeafPaint, IColorStop, IColorString } from '@leafer-ui/interface'\nimport { ColorConvert } from '@leafer-ui/draw'\n\n\nconst { toPoint } = AroundHelper, { hasTransparent } = ColorConvert\nconst realFrom = {} as IPointData\nconst realTo = {} as IPointData\n\nexport function linearGradient(paint: IGradientPaint, box: IBoundsData): ILeafPaint {\n\n    let { from, to, type, opacity } = paint\n\n    toPoint(from || 'top', box, realFrom)\n    toPoint(to || 'bottom', box, realTo)\n\n    const style = Platform.canvas.createLinearGradient(realFrom.x, realFrom.y, realTo.x, realTo.y)\n    const data: ILeafPaint = { type, style }\n\n    applyStops(data, style, paint.stops, opacity)\n\n    return data\n\n}\n\nexport function applyStops(data: ILeafPaint, gradient: IObject, stops: IColorStop[] | IColorString[], opacity: number): void {\n    if (stops) {\n        let stop: IColorStop | string, color: string, offset: number, isTransparent: boolean\n        for (let i = 0, len = stops.length; i < len; i++) {\n            stop = stops[i]\n            if (isString(stop)) offset = i / (len - 1), color = ColorConvert.string(stop, opacity)\n            else offset = stop.offset, color = ColorConvert.string(stop.color, opacity)\n            gradient.addColorStop(offset, color)\n            if (!isTransparent && hasTransparent(color)) isTransparent = true\n        }\n        if (isTransparent) data.isTransparent = true\n    }\n}","import { IBoundsData } from '@leafer/interface'\nimport { Platform, PointHelper, MatrixHelper, AroundHelper } from '@leafer/core'\n\nimport { IGradientPaint, ILeafPaint, IMatrixData, IPointData } from '@leafer-ui/interface'\n\nimport { applyStops } from './linear'\n\n\nconst { getAngle, getDistance } = PointHelper\nconst { get, rotateOfOuter, scaleOfOuter } = MatrixHelper\n\nconst { toPoint } = AroundHelper\nconst realFrom = {} as IPointData\nconst realTo = {} as IPointData\n\nexport function radialGradient(paint: IGradientPaint, box: IBoundsData): ILeafPaint {\n\n    let { from, to, type, opacity, stretch } = paint\n\n    toPoint(from || 'center', box, realFrom)\n    toPoint(to || 'bottom', box, realTo)\n\n    const style = Platform.canvas.createRadialGradient(realFrom.x, realFrom.y, 0, realFrom.x, realFrom.y, getDistance(realFrom, realTo))\n    const data: ILeafPaint = { type, style }\n\n    applyStops(data, style, paint.stops, opacity)\n\n    const transform = getTransform(box, realFrom, realTo, stretch, true)\n    if (transform) data.transform = transform\n\n    return data\n\n}\n\nexport function getTransform(box: IBoundsData, from: IPointData, to: IPointData, stretch: number, rotate90: boolean): IMatrixData {\n    let transform: IMatrixData\n    const { width, height } = box\n\n    if (width !== height || stretch) {\n        const angle = getAngle(from, to)\n        transform = get()\n        if (rotate90) {\n            scaleOfOuter(transform, from, width / height * (stretch || 1), 1)\n            rotateOfOuter(transform, from, angle + 90)\n        } else {\n            scaleOfOuter(transform, from, 1, width / height * (stretch || 1))\n            rotateOfOuter(transform, from, angle)\n        }\n    }\n\n    return transform\n}","import { IPointData, IBoundsData } from '@leafer/interface'\nimport { Platform, PointHelper, AroundHelper } from '@leafer/core'\n\nimport { IGradientPaint, ILeafPaint } from '@leafer-ui/interface'\n\nimport { applyStops } from './linear'\nimport { getTransform } from './radial'\n\n\nconst { getDistance } = PointHelper\n\nconst { toPoint } = AroundHelper\nconst realFrom = {} as IPointData\nconst realTo = {} as IPointData\n\nexport function conicGradient(paint: IGradientPaint, box: IBoundsData): ILeafPaint {\n\n    let { from, to, type, opacity, stretch } = paint\n\n    toPoint(from || 'center', box, realFrom)\n    toPoint(to || 'bottom', box, realTo)\n\n    const style = Platform.conicGradientSupport ? Platform.canvas.createConicGradient(0, realFrom.x, realFrom.y) : Platform.canvas.createRadialGradient(realFrom.x, realFrom.y, 0, realFrom.x, realFrom.y, getDistance(realFrom, realTo))\n    const data: ILeafPaint = { type, style }\n\n    applyStops(data, style, paint.stops, opacity)\n\n    const transform = getTransform(box, realFrom, realTo, stretch || 1, Platform.conicGradientRotate90)\n    if (transform) data.transform = transform\n\n    return data\n\n}","import { IPaintGradientModule } from '@leafer-ui/interface'\n\nimport { linearGradient } from './linear'\nimport { radialGradient, getTransform } from './radial'\nimport { conicGradient } from './conic'\n\n\nexport const PaintGradientModule: IPaintGradientModule = {\n    linearGradient,\n    radialGradient,\n    conicGradient,\n    getTransform\n}","import { IBoundsData, IFourNumber, ILeaferCanvas, IMatrixData, IOffsetBoundsData } from '@leafer/interface'\nimport { BoundsHelper, LeafHelper, Matrix, Platform } from '@leafer/core'\n\nimport { IUI, ICachedShape, ILeafShadowEffect } from '@leafer-ui/interface'\nimport { ColorConvert, Effect } from '@leafer-ui/draw'\n\n\nconst { copy, move, toOffsetOutBounds } = BoundsHelper, { max, abs } = Math\nconst tempBounds = {} as IBoundsData, tempMatrix = new Matrix()\nconst offsetOutBounds = {} as IOffsetBoundsData\n\nexport function shadow(ui: IUI, current: ILeaferCanvas, shape: ICachedShape): void {\n\n    let copyBounds: IBoundsData, transform: IMatrixData\n\n    const { __nowWorld: nowWorld } = ui\n    const { shadow } = ui.__\n    const { worldCanvas, bounds, renderBounds, shapeBounds, scaleX, scaleY } = shape\n\n    const other = current.getSameCanvas()\n    const end = shadow.length - 1\n\n    toOffsetOutBounds(bounds, offsetOutBounds, renderBounds)\n\n    shadow.forEach((item, index) => {\n\n        let otherScale = 1 // 关联 scaleFixed 逻辑\n\n        if (item.scaleFixed) {\n            const sx = Math.abs(nowWorld.scaleX)\n            if (sx > 1) otherScale = 1 / sx\n        }\n\n        other.setWorldShadow((offsetOutBounds.offsetX + (item.x || 0) * scaleX * otherScale), (offsetOutBounds.offsetY + (item.y || 0) * scaleY * otherScale), (item.blur || 0) * scaleX * otherScale, ColorConvert.string(item.color))\n\n        transform = Effect.getShadowTransform(ui, other, shape, item, offsetOutBounds, otherScale)\n        if (transform) other.setTransform(transform)\n\n        drawWorldShadow(other, offsetOutBounds, shape)\n\n        if (transform) other.resetTransform()\n\n        copyBounds = renderBounds\n\n        if (item.box) {\n\n            other.restore() // remove shadow style\n            other.save()\n\n            if (worldCanvas) {\n                other.copyWorld(other, renderBounds, nowWorld, 'copy')\n                copyBounds = nowWorld\n            }\n\n            worldCanvas ? other.copyWorld(worldCanvas, nowWorld, nowWorld, 'destination-out') : other.copyWorld(shape.canvas, shapeBounds, bounds, 'destination-out')\n        }\n\n        LeafHelper.copyCanvasByWorld(ui, current, other, copyBounds, item.blendMode)\n\n        if (end && index < end) other.clearWorld(copyBounds)\n    })\n\n    other.recycle(copyBounds)\n\n}\n\nexport function getShadowRenderSpread(_ui: IUI, shadow: ILeafShadowEffect[]): IFourNumber {\n    let top = 0, right = 0, bottom = 0, left = 0, x: number, y: number, spread: number, blur: number\n    shadow.forEach(item => {\n        x = item.x || 0, y = item.y || 0, blur = (item.blur || 0) * 1.5, spread = abs(item.spread || 0) // must abs spread\n\n        top = max(top, spread + blur - y)\n        right = max(right, spread + blur + x)\n        bottom = max(bottom, spread + blur + y)\n        left = max(left, spread + blur - x)\n    })\n    return (top === right && right === bottom && bottom === left) ? top : [top, right, bottom, left]\n}\n\nexport function getShadowTransform(ui: IUI, canvas: ILeaferCanvas, _shape: ICachedShape, shadow: ILeafShadowEffect, outBounds: IBoundsData, otherScale: number, isInnerShaodw?: boolean): IMatrixData {\n    if (shadow.spread) {\n        const spread = shadow.spread * 2 * otherScale * (isInnerShaodw ? -1 : 1), { width, height } = ui.__layout.strokeBounds\n        tempMatrix.set().scaleOfOuter({ x: (outBounds.x + outBounds.width / 2) * canvas.pixelRatio, y: (outBounds.y + outBounds.height / 2) * canvas.pixelRatio }, 1 + spread / width, 1 + spread / height)\n        return tempMatrix\n    }\n    return undefined\n}\n\nexport function drawWorldShadow(canvas: ILeaferCanvas, outBounds: IBoundsData, shape: ICachedShape): void {\n    const { shapeBounds } = shape\n    let from: IBoundsData, to: IBoundsData\n\n    if (Platform.fullImageShadow) { // Safari\n        copy(tempBounds, canvas.bounds)\n        move(tempBounds, outBounds.x - shapeBounds.x, outBounds.y - shapeBounds.y)\n        from = canvas.bounds, to = tempBounds\n    } else {\n        from = shapeBounds, to = outBounds\n    }\n\n    canvas.copyWorld(shape.canvas, from, to)\n}","import { IBoundsData, IMatrixData, ILeaferCanvas, IOffsetBoundsData } from '@leafer/interface'\nimport { BoundsHelper, LeafHelper } from '@leafer/core'\n\nimport { IUI, ICachedShape } from '@leafer-ui/interface'\nimport { ColorConvert, Effect } from '@leafer-ui/draw'\n\nimport { drawWorldShadow, getShadowRenderSpread } from './Shadow'\n\n\nconst { toOffsetOutBounds } = BoundsHelper\nconst offsetOutBounds = {} as IOffsetBoundsData\n\nexport function innerShadow(ui: IUI, current: ILeaferCanvas, shape: ICachedShape): void {\n\n    let copyBounds: IBoundsData, transform: IMatrixData\n\n    const { __nowWorld: nowWorld } = ui\n    const { innerShadow } = ui.__\n    const { worldCanvas, bounds, renderBounds, shapeBounds, scaleX, scaleY } = shape\n\n    const other = current.getSameCanvas()\n    const end = innerShadow.length - 1\n\n    toOffsetOutBounds(bounds, offsetOutBounds, renderBounds)\n\n    innerShadow.forEach((item, index) => {\n\n        let otherScale = 1 // 关联 scaleFixed 逻辑\n\n        if (item.scaleFixed) {\n            const sx = Math.abs(nowWorld.scaleX)\n            if (sx > 1) otherScale = 1 / sx\n        }\n\n        other.save()\n\n        other.setWorldShadow((offsetOutBounds.offsetX + (item.x || 0) * scaleX * otherScale), (offsetOutBounds.offsetY + (item.y || 0) * scaleY * otherScale), (item.blur || 0) * scaleX * otherScale)\n\n        transform = Effect.getShadowTransform(ui, other, shape, item, offsetOutBounds, otherScale, true)\n        if (transform) other.setTransform(transform)\n\n        drawWorldShadow(other, offsetOutBounds, shape)\n\n        other.restore()\n\n        if (worldCanvas) {\n            other.copyWorld(other, renderBounds, nowWorld, 'copy')\n            other.copyWorld(worldCanvas, nowWorld, nowWorld, 'source-out')\n            copyBounds = nowWorld\n        } else {\n            other.copyWorld(shape.canvas, shapeBounds, bounds, 'source-out')\n            copyBounds = renderBounds\n        }\n\n        other.fillWorld(copyBounds, ColorConvert.string(item.color), 'source-in')\n\n        LeafHelper.copyCanvasByWorld(ui, current, other, copyBounds, item.blendMode)\n\n        if (end && index < end) other.clearWorld(copyBounds)\n\n    })\n\n    other.recycle(copyBounds)\n\n}\n\nexport const getInnerShadowSpread = getShadowRenderSpread","import { IEffectModule, ILeafShadowEffect } from '@leafer-ui/interface'\n\nimport { shadow, getShadowRenderSpread, getShadowTransform } from './Shadow'\nimport { innerShadow, getInnerShadowSpread } from './InnerShadow'\nimport { blur } from './Blur'\nimport { backgroundBlur } from './BackgroundBlur'\n\n\nexport const EffectModule: IEffectModule = {\n    shadow,\n    innerShadow,\n    blur,\n    backgroundBlur,\n\n    // @leafer-in/shadow will rewrite\n    getShadowRenderSpread,\n    getShadowTransform,\n    isTransformShadow(_shadow: ILeafShadowEffect): boolean { return undefined },\n\n    getInnerShadowSpread\n}","import { ILeaferCanvas } from '@leafer/interface'\n\nimport { IUI } from '@leafer-ui/interface'\n\nexport function blur(ui: IUI, current: ILeaferCanvas, origin: ILeaferCanvas): void {\n    const { blur } = ui.__\n    origin.setWorldBlur(blur * ui.__nowWorld.a)\n    origin.copyWorldToInner(current, ui.__nowWorld, ui.__layout.renderBounds)\n    origin.filter = 'none'\n}\n","import { ILeaferCanvas } from '@leafer/interface'\nimport { IUI, ICachedShape } from '@leafer-ui/interface'\n\nexport function backgroundBlur(_ui: IUI, _current: ILeaferCanvas, _shape: ICachedShape): void {\n\n}","import { IBlendMode, ILeaf, ILeaferCanvas, IMaskType, IRenderOptions } from '@leafer/interface'\nimport { LeafBoundsHelper } from '@leafer/core'\n\nimport { Group } from '@leafer-ui/draw'\n\n\ntype IMaskMode = 'path' | 'alpha' | 'grayscale' | 'opacity-path'\nconst { excludeRenderBounds } = LeafBoundsHelper\nlet usedGrayscaleAlpha: boolean\n\nGroup.prototype.__renderMask = function (canvas: ILeaferCanvas, options: IRenderOptions): void {\n\n    let child: ILeaf, maskCanvas: ILeaferCanvas, contentCanvas: ILeaferCanvas, maskOpacity: number, currentMask: IMaskMode, mask: boolean | IMaskType\n    const { children } = this\n\n    for (let i = 0, len = children.length; i < len; i++) {\n        child = children[i], mask = child.__.mask\n\n        if (mask) {\n\n            if (currentMask) {\n                maskEnd(this, currentMask, canvas, contentCanvas, maskCanvas, maskOpacity, undefined, true)\n                maskCanvas = contentCanvas = null\n            }\n\n            // mask start\n\n            if (mask === 'clipping' || mask === 'clipping-path') excludeRenderBounds(child, options) || child.__render(canvas, options) // 剪贴蒙版，需要渲染自身到原画布中，如果应用遮罩会造成透明度减半。clipping-path 支持渲染外描边。\n\n            maskOpacity = child.__.opacity\n            usedGrayscaleAlpha = false\n\n            if (mask === 'path' || mask === 'clipping-path') {\n\n                if (maskOpacity < 1) {\n\n                    currentMask = 'opacity-path'\n                    if (!contentCanvas) contentCanvas = getCanvas(canvas)\n\n                } else {\n                    currentMask = 'path'\n                    canvas.save()\n                }\n\n                child.__clip(contentCanvas || canvas, options)\n\n            } else { // pixel\n\n                currentMask = mask === 'grayscale' ? 'grayscale' : 'alpha'\n                if (!maskCanvas) maskCanvas = getCanvas(canvas)\n                if (!contentCanvas) contentCanvas = getCanvas(canvas)\n                child.__render(maskCanvas, options)\n\n            }\n\n            continue\n        }\n\n        const childBlendMode = maskOpacity === 1 && child.__.__blendMode\n\n        // 元素存在混合模式，将先前的内容绘制到原画布\n        if (childBlendMode) maskEnd(this, currentMask, canvas, contentCanvas, maskCanvas, maskOpacity, undefined, false)\n\n        excludeRenderBounds(child, options) || child.__render(contentCanvas || canvas, options)\n\n        // 元素存在混合模式，应用遮罩后直接与原画布混合\n        if (childBlendMode) maskEnd(this, currentMask, canvas, contentCanvas, maskCanvas, maskOpacity, childBlendMode as IBlendMode, false)\n\n    }\n\n    maskEnd(this, currentMask, canvas, contentCanvas, maskCanvas, maskOpacity, undefined, true)\n\n}\n\n\nfunction maskEnd(leaf: ILeaf, maskMode: IMaskMode, canvas: ILeaferCanvas, contentCanvas: ILeaferCanvas, maskCanvas: ILeaferCanvas, maskOpacity: number, blendMode: IBlendMode, recycle: boolean): void {\n    switch (maskMode) {\n        case 'grayscale':\n            if (!usedGrayscaleAlpha) usedGrayscaleAlpha = true, maskCanvas.useGrayscaleAlpha(leaf.__nowWorld)\n        case 'alpha':\n            usePixelMask(leaf, canvas, contentCanvas, maskCanvas, blendMode, recycle); break\n        case 'opacity-path':\n            copyContent(leaf, canvas, contentCanvas, maskOpacity, blendMode, recycle); break\n        case 'path':\n            if (recycle) canvas.restore()\n    }\n}\n\n\nfunction getCanvas(canvas: ILeaferCanvas): ILeaferCanvas {\n    return canvas.getSameCanvas(false, true)\n}\n\n\nfunction usePixelMask(leaf: ILeaf, canvas: ILeaferCanvas, content: ILeaferCanvas, mask: ILeaferCanvas, blendMode: IBlendMode, recycle: boolean): void {\n    const realBounds = leaf.__nowWorld\n    content.resetTransform()\n    content.opacity = 1\n    content.useMask(mask, realBounds)\n    if (recycle) mask.recycle(realBounds)\n\n    copyContent(leaf, canvas, content, 1, blendMode, recycle)\n}\n\n\nfunction copyContent(leaf: ILeaf, canvas: ILeaferCanvas, content: ILeaferCanvas, maskOpacity: number, blendMode: IBlendMode, recycle: boolean): void {\n    const realBounds = leaf.__nowWorld\n\n    canvas.resetTransform()\n    canvas.opacity = maskOpacity\n    canvas.copyWorld(content, realBounds, undefined, blendMode)\n\n    recycle ? content.recycle(realBounds) : content.clearWorld(realBounds)\n}","import { IBooleanMap } from '@leafer-ui/interface'\n\nconst money = '¥￥＄€£￡¢￠'\nconst letter = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz'\n\nconst langBefore = '《（「〈『〖【〔｛┌＜‘“＝' + money\nconst langAfter = '》）」〉』〗】〕｝┐＞’”！？，、。：；‰'\nconst langSymbol = '≮≯≈≠＝…'\nconst langBreak = '—／～｜┆·'\n\nconst beforeChar = '{[(<\\'\"' + langBefore\nconst afterChar = '>)]}%!?,.:;\\'\"' + langAfter\nconst symbolChar = afterChar + '_#~&*+\\\\=|' + langSymbol\nconst breakChar = '- ' + langBreak\n\nconst cjkRangeList = [\n    [0x4E00, 0x9FFF], // CJK Unified Ideographs\n    [0x3400, 0x4DBF], // CJK Unified Ideographs Extension A\n    [0x20000, 0x2A6DF], // CJK Unified Ideographs Extension B\n    [0x2A700, 0x2B73F], // CJK Unified Ideographs Extension C\n    [0x2B740, 0x2B81F], // CJK Unified Ideographs Extension D\n    [0x2B820, 0x2CEAF], // CJK Unified Ideographs Extension E\n    [0x2CEB0, 0x2EBEF], // CJK Unified Ideographs Extension F\n    [0x30000, 0x3134F], // CJK Unified Ideographs Extension G\n    [0x31350, 0x323AF], // CJK Unified Ideographs Extension H\n    [0x2E80, 0x2EFF], // CJK Radicals Supplement\n    [0x2F00, 0x2FDF], // Kangxi Radicals\n    [0x2FF0, 0x2FFF], // Ideographic Description Characters\n    [0x3000, 0x303F], // CJK Symbols and Punctuation\n    [0x31C0, 0x31EF], // CJK Strokes\n    [0x3200, 0x32FF], // Enclosed CJK Letters and Months\n    [0x3300, 0x33FF], // CJK Compatibility\n    [0xF900, 0xFAFF], // CJK Compatibility Ideographs\n    [0xFE30, 0xFE4F], // CJK Compatibility Forms\n    [0x1F200, 0x1F2FF], // Enclosed Ideographic Supplement\n    [0x2F800, 0x2FA1F], // CJK Compatibility Ideographs Supplement\n]\n\nconst cjkReg = new RegExp(cjkRangeList.map(([start, end]) => `[\\\\u${start.toString(16)}-\\\\u${end.toString(16)}]`).join('|'))\n\nfunction mapChar(str: string): IBooleanMap {\n    const map: IBooleanMap = {}\n    str.split('').forEach(char => map[char] = true)\n    return map\n}\n\nconst letterMap = mapChar(letter)\nconst beforeMap = mapChar(beforeChar)\nconst afterMap = mapChar(afterChar)\nconst symbolMap = mapChar(symbolChar)\nconst breakMap = mapChar(breakChar)\n\nexport enum CharType {\n    Letter, // en... number\n    Single, // cjk\n    Before, // (\n    After, // )\n    Symbol, // *\n    Break, // space\n}\n\nconst { Letter, Single, Before, After, Symbol, Break } = CharType\n\nexport function getCharType(char: string): CharType {\n\n    if (letterMap[char]) {\n        return Letter\n    } else if (breakMap[char]) {\n        return Break\n    } else if (beforeMap[char]) {\n        return Before\n    } else if (afterMap[char]) {\n        return After\n    } else if (symbolMap[char]) {\n        return Symbol\n    } else if (cjkReg.test(char)) {\n        return Single\n    } else {\n        return Letter\n    }\n\n}\n","import { ITextRowData, ITextCharData } from '@leafer-ui/interface'\n\n\nexport const TextRowHelper = {\n\n    trimRight(row: ITextRowData): void {\n        const { words } = row\n        let trimRight = 0, len = words.length, char: ITextCharData\n\n        for (let i = len - 1; i > -1; i--) {\n            char = words[i].data[0]\n            if (char.char === ' ') {\n                trimRight++\n                row.width -= char.width\n            } else {\n                break\n            }\n        }\n\n        if (trimRight) words.splice(len - trimRight, trimRight)\n    }\n\n}","import { ITextCase } from '@leafer-ui/interface'\n\nexport function getTextCase(char: string, textCase: ITextCase, firstChar?: boolean): string {\n    switch (textCase) {\n        case 'title':\n            return firstChar ? char.toUpperCase() : char\n        case 'upper':\n            return char.toUpperCase()\n        case 'lower':\n            return char.toLowerCase()\n        default:\n            return char\n    }\n}","import { Platform } from '@leafer/core'\n\nimport { IBoundsData, ITextData, ITextDrawData, ITextRowData, ITextWordData } from '@leafer-ui/interface'\n\nimport { CharType, getCharType } from './CharType'\nimport { TextRowHelper } from './TextRowHelper'\nimport { getTextCase } from './TextCase'\n\n\nconst { trimRight } = TextRowHelper\nconst { Letter, Single, Before, After, Symbol, Break } = CharType\n\nlet word: ITextWordData, row: ITextRowData, wordWidth: number, rowWidth: number, realWidth: number\nlet char: string, charWidth: number, startCharSize: number, charSize: number, charType: CharType, lastCharType: CharType, langBreak: boolean, afterBreak: boolean, paraStart: boolean\nlet textDrawData: ITextDrawData, rows: ITextRowData[] = [], bounds: IBoundsData, findMaxWidth: boolean\n\nexport function createRows(drawData: ITextDrawData, content: string, style: ITextData): void {\n\n    textDrawData = drawData\n    rows = drawData.rows\n    bounds = drawData.bounds\n    findMaxWidth = !bounds.width && !style.autoSizeAlign\n\n    const { __letterSpacing, paraIndent, textCase } = style\n    const { canvas } = Platform, { width } = bounds\n\n    if (style.__isCharMode) {\n\n        const wrap = style.textWrap !== 'none'\n        const breakAll = style.textWrap === 'break'\n\n        paraStart = true\n        lastCharType = null\n        startCharSize = charWidth = charSize = wordWidth = rowWidth = 0\n        word = { data: [] }, row = { words: [] }\n\n        if (__letterSpacing) content = [...content] as any // 防止切分表情等多个字符组成的字符，转成数组字符是最安全的\n\n        for (let i = 0, len = content.length; i < len; i++) {\n\n            char = content[i]\n\n            if (char === '\\n') {\n\n                if (wordWidth) addWord()\n                row.paraEnd = true\n                addRow()\n\n                paraStart = true\n\n            } else {\n\n                charType = getCharType(char)\n\n                if (charType === Letter && textCase !== 'none') char = getTextCase(char, textCase, !wordWidth)\n\n                charWidth = canvas.measureText(char).width\n                if (__letterSpacing) {\n                    if (__letterSpacing < 0) charSize = charWidth\n                    charWidth += __letterSpacing\n                }\n\n                langBreak = (charType === Single && (lastCharType === Single || lastCharType === Letter)) || (lastCharType === Single && charType !== After) // break  U字 文字 or 字U  字（  字*  exclude 字。\n                afterBreak = ((charType === Before || charType === Single) && (lastCharType === Symbol || lastCharType === After)) // split >(  =文 。哈  ;文\n\n                realWidth = paraStart && paraIndent ? width - paraIndent : width\n\n                if (wrap && (width && rowWidth + wordWidth + charWidth > realWidth)) { // wrap\n\n                    if (breakAll) {\n\n                        if (wordWidth) addWord() // break\n                        if (rowWidth) addRow()\n\n                    } else {\n                        if (!afterBreak) afterBreak = charType === Letter && lastCharType == After // split ，S  \n\n                        if (langBreak || afterBreak || charType === Break || charType === Before || charType === Single || (wordWidth + charWidth > realWidth)) {\n\n                            if (wordWidth) addWord() // break\n                            if (rowWidth) addRow()\n\n                        } else {\n\n                            if (rowWidth) addRow()\n                        }\n                    }\n\n                }\n\n                if (char === ' ' && paraStart !== true && (rowWidth + wordWidth) === 0) {\n\n                    // trim space\n\n                } else {\n\n                    if (charType === Break) {\n\n                        if (char === ' ' && wordWidth) addWord()\n                        addChar(char, charWidth)\n                        addWord()\n\n                    } else if (langBreak || afterBreak) {\n\n                        if (wordWidth) addWord()\n                        addChar(char, charWidth)\n\n                    } else {\n\n                        addChar(char, charWidth)\n\n                    }\n                }\n\n                lastCharType = charType\n\n            }\n\n        }\n\n        if (wordWidth) addWord()\n        if (rowWidth) addRow()\n\n        rows.length > 0 && (rows[rows.length - 1].paraEnd = true)\n\n    } else {\n\n        content.split('\\n').forEach(content => {\n            textDrawData.paraNumber++\n            rowWidth = canvas.measureText(content).width\n            rows.push({ x: paraIndent || 0, text: content, width: rowWidth, paraStart: true })\n            if (findMaxWidth) setMaxWidth()\n        })\n\n    }\n}\n\n\nfunction addChar(char: string, width: number): void {\n    if (charSize && !startCharSize) startCharSize = charSize\n    word.data.push({ char, width })\n    wordWidth += width\n}\n\nfunction addWord(): void {\n    rowWidth += wordWidth\n    word.width = wordWidth\n    row.words.push(word)\n    word = { data: [] }\n    wordWidth = 0\n}\n\nfunction addRow(): void {\n    if (paraStart) {\n        textDrawData.paraNumber++\n        row.paraStart = true\n        paraStart = false\n    }\n\n    if (charSize) { // letterSpacing < 0, like -20% -100%\n        row.startCharSize = startCharSize\n        row.endCharSize = charSize\n        startCharSize = 0\n    }\n\n    row.width = rowWidth\n    if (bounds.width) trimRight(row)\n    else if (findMaxWidth) setMaxWidth()\n    rows.push(row)\n    row = { words: [] }\n    rowWidth = 0\n}\n\nfunction setMaxWidth(): void {\n    if (rowWidth > (textDrawData.maxWidth || 0)) textDrawData.maxWidth = rowWidth\n}\n","import { Platform, Direction4, isString } from '@leafer/core'\n\nimport { ITextData, ITextDrawData } from '@leafer-ui/interface'\n\nimport { createRows } from './TextRows'\nimport { layoutChar } from './CharLayout'\nimport { layoutText } from './TextLayout'\nimport { clipText } from './TextClip'\nimport { decorationText } from './TextDecoration'\n\n\nconst { top, right, bottom, left } = Direction4\n\nexport function getDrawData(content: string | number, style: ITextData): ITextDrawData {\n\n    if (!isString(content)) content = String(content)\n\n    let x = 0, y = 0\n\n    let width = style.__getInput('width') || 0\n    let height = style.__getInput('height') || 0\n\n    const { __padding: padding } = style\n\n    if (padding) {\n        if (width) x = padding[left], width -= (padding[right] + padding[left]), !width && (width = 0.01) // 防止变为自动宽度\n        else if (!style.autoSizeAlign) x = padding[left]\n\n        if (height) y = padding[top], height -= (padding[top] + padding[bottom]), !height && (height = 0.01)\n        else if (!style.autoSizeAlign) y = padding[top]\n    }\n\n    const drawData: ITextDrawData = {\n        bounds: { x, y, width, height },\n        rows: [],\n        paraNumber: 0,\n        font: Platform.canvas.font = style.__font\n    }\n\n    createRows(drawData, content, style) // set rows, paraNumber\n\n    if (padding) padAutoText(padding, drawData, style, width, height)\n\n    layoutText(drawData, style) // set bounds\n\n    if (style.__isCharMode) layoutChar(drawData, style, width, height) // set char.x\n\n    if (drawData.overflow) clipText(drawData, style, x, width)\n\n    if (style.textDecoration !== 'none') decorationText(drawData, style)\n\n    return drawData\n\n}\n\n\nfunction padAutoText(padding: number[], drawData: ITextDrawData, style: ITextData, width: number, height: number): void {\n    if (!width && style.autoSizeAlign) {\n        switch (style.textAlign) {\n            case 'left': offsetText(drawData, 'x', padding[left]); break\n            case 'right': offsetText(drawData, 'x', -padding[right])\n        }\n    }\n\n    if (!height && style.autoSizeAlign) {\n        switch (style.verticalAlign) {\n            case 'top': offsetText(drawData, 'y', padding[top]); break\n            case 'bottom': offsetText(drawData, 'y', -padding[bottom])\n        }\n    }\n}\n\n\nfunction offsetText(drawData: ITextDrawData, attrName: 'x' | 'y', value: number): void {\n    const { bounds, rows } = drawData\n    bounds[attrName] += value\n    for (let i = 0; i < rows.length; i++) rows[i][attrName] += value\n}","import { ITextConvertModule } from '@leafer-ui/interface'\n\nimport { getDrawData } from './TextConvert'\n\nexport const TextConvertModule: ITextConvertModule = {\n    getDrawData\n}","import { ITextData, ITextDrawData, ITextRowData } from '@leafer-ui/interface'\n\n\nexport function layoutText(drawData: ITextDrawData, style: ITextData): void {\n\n    const { rows, bounds } = drawData, countRows = rows.length\n    const { __lineHeight, __baseLine, __letterSpacing, __clipText, textAlign, verticalAlign, paraSpacing, autoSizeAlign } = style\n\n    let { x, y, width, height } = bounds, realHeight = __lineHeight * countRows + (paraSpacing ? paraSpacing * (drawData.paraNumber - 1) : 0)\n    let starY: number = __baseLine\n\n    // verticalAlign\n\n    if (__clipText && realHeight > height) {\n        realHeight = Math.max(height, __lineHeight)\n        if (countRows > 1) drawData.overflow = countRows\n    } else if (height || autoSizeAlign) {\n        switch (verticalAlign) {\n            case 'middle': y += (height - realHeight) / 2; break\n            case 'bottom': y += (height - realHeight)\n        }\n    }\n    starY += y\n\n    // textAlign\n\n    let row: ITextRowData, rowX: number, rowWidth: number, layoutWidth = (width || autoSizeAlign) ? width : drawData.maxWidth\n\n    for (let i = 0, len = countRows; i < len; i++) {\n        row = rows[i]\n        row.x = x\n\n        if (row.width < width || (row.width > width && !__clipText)) {\n            switch (textAlign) {\n                case 'center': row.x += (layoutWidth - row.width) / 2; break\n                case 'right': row.x += layoutWidth - row.width\n            }\n        }\n\n        if (row.paraStart && paraSpacing && i > 0) starY += paraSpacing\n\n        row.y = starY\n\n        starY += __lineHeight\n\n        if (drawData.overflow > i && starY > realHeight) {\n            row.isOverflow = true\n            drawData.overflow = i + 1\n        }\n\n        rowX = row.x\n        rowWidth = row.width\n\n        if (__letterSpacing < 0) { // letterSpacing < 0, like -20% -100%\n            if (row.width < 0) {\n                rowWidth = -row.width + style.fontSize + __letterSpacing\n                rowX -= rowWidth\n                rowWidth += style.fontSize\n            } else {\n                rowWidth -= __letterSpacing\n            }\n        }\n\n        if (rowX < bounds.x) bounds.x = rowX\n        if (rowWidth > bounds.width) bounds.width = rowWidth\n\n        // clip nowrap\n        if (__clipText && width && width < rowWidth) {\n            row.isOverflow = true\n            if (!drawData.overflow) drawData.overflow = rows.length\n        }\n    }\n\n    bounds.y = y\n    bounds.height = realHeight\n\n}","import { ITextCharData, ITextData, ITextDrawData, ITextRowData } from '@leafer-ui/interface'\n\n\nconst CharMode = 0 // data: [{char:'a', x: 0}, {char:'b', x: 5}, {char:'d', x:20}]\nconst WordMode = 1 // data: [{ char:'ab', x: 0}, { char:'d', x:20}]\nconst TextMode = 2 // text: 'ab  c'\n\nexport function layoutChar(drawData: ITextDrawData, style: ITextData, width: number, _height: number): void {\n\n    const { rows } = drawData\n    const { textAlign, paraIndent, __letterSpacing } = style\n\n    const justifyLast = width && textAlign.includes('both')  // 最后一行是否两端对齐\n    const justify = justifyLast || (width && textAlign.includes('justify')) // 是否两端对齐文本\n    const justifyLetter = justify && textAlign.includes('letter') // 英文是否通过加大字符间距两端对齐\n\n    let charX: number, remainingWidth: number, addWordWidth: number, addLetterWidth: number, indentWidth: number, mode: number, wordChar: ITextCharData, wordsLength: number, isLastWord: boolean, canJustify: boolean\n\n    rows.forEach(row => {\n        if (row.words) {\n\n            indentWidth = paraIndent && row.paraStart ? paraIndent : 0, wordsLength = row.words.length\n            if (justify) {\n                canJustify = !row.paraEnd || justifyLast\n                remainingWidth = width - row.width - indentWidth\n                if (justifyLetter) addLetterWidth = remainingWidth / (row.words.reduce((total, item) => total + item.data.length, 0) - 1) //  remainingWidth / （lettersLength - 1）\n                else addWordWidth = wordsLength > 1 ? remainingWidth / (wordsLength - 1) : 0\n            }\n            mode = (__letterSpacing || row.isOverflow || justifyLetter) ? CharMode : (addWordWidth ? WordMode : TextMode)\n            if (row.isOverflow && !__letterSpacing) row.textMode = true\n\n            if (mode === TextMode) {\n\n                row.x += indentWidth\n                toTextChar(row)\n\n            } else {\n\n                row.x += indentWidth\n                charX = row.x\n                row.data = []\n\n                row.words.forEach((word, index) => {\n\n                    if (mode === WordMode) {\n\n                        wordChar = { char: '', x: charX }\n                        charX = toWordChar(word.data, charX, wordChar)\n                        if (row.isOverflow || wordChar.char !== ' ') row.data.push(wordChar)\n\n                    } else {\n\n                        charX = toChar(word.data, charX, row.data, row.isOverflow, canJustify && addLetterWidth)\n\n                    }\n\n                    if (canJustify) {\n                        isLastWord = index === wordsLength - 1\n\n                        if (addWordWidth) {\n                            if (!isLastWord) charX += addWordWidth, row.width += addWordWidth\n                        } else if (addLetterWidth) {\n                            row.width += addLetterWidth * (word.data.length - (isLastWord ? 1 : 0))\n                        }\n                    }\n\n                })\n            }\n\n            row.words = null\n        }\n    })\n\n}\n\nfunction toTextChar(row: ITextRowData): void {\n    row.text = ''\n    row.words.forEach(word => {\n        word.data.forEach(char => {\n            row.text += char.char\n        })\n    })\n}\n\nfunction toWordChar(data: ITextCharData[], charX: number, wordChar: ITextCharData): number {\n    data.forEach(char => {\n        wordChar.char += char.char\n        charX += char.width\n    })\n    return charX\n}\n\nfunction toChar(data: ITextCharData[], charX: number, rowData: ITextCharData[], isOverflow?: boolean, addLetterWidth?: number): number {\n    data.forEach(char => {\n        if (isOverflow || char.char !== ' ') {\n            char.x = charX\n            rowData.push(char)\n        }\n        charX += char.width\n        addLetterWidth && (charX += addLetterWidth)\n    })\n    return charX\n}","import { Platform } from '@leafer/core'\n\nimport { ITextCharData, ITextData, ITextDrawData, ITextRowData } from '@leafer-ui/interface'\n\n\nexport function clipText(drawData: ITextDrawData, style: ITextData, x: number, width: number): void {\n    if (!width) return\n\n    const { rows, overflow } = drawData\n    let { textOverflow } = style\n    rows.splice(overflow)\n\n    if (textOverflow && textOverflow !== 'show') {\n        if (textOverflow === 'hide') textOverflow = ''\n        else if (textOverflow === 'ellipsis') textOverflow = '...'\n\n        let char: ITextCharData, charRight: number\n        const ellipsisWidth = textOverflow ? Platform.canvas.measureText(textOverflow).width : 0\n        const right = x + width - ellipsisWidth\n        const list = style.textWrap === 'none' ? rows : [rows[overflow - 1]]\n\n        list.forEach(row => {\n\n            if (row.isOverflow && row.data) {\n\n                let end = row.data.length - 1\n\n                for (let i = end; i > -1; i--) {\n                    char = row.data[i]\n                    charRight = char.x + char.width\n                    if (i === end && charRight < right) {\n                        break\n                    } else if ((charRight < right && char.char !== ' ') || !i) { // 至少保留一个文字\n                        row.data.splice(i + 1)\n                        row.width -= char.width\n                        break\n                    }\n                    row.width -= char.width\n                }\n\n                row.width += ellipsisWidth\n                row.data.push({ char: textOverflow, x: charRight })\n\n                if (row.textMode) toTextChar(row)\n            }\n\n\n        })\n\n    }\n\n}\n\nfunction toTextChar(row: ITextRowData): void {\n    row.text = ''\n    row.data.forEach(char => {\n        row.text += char.char\n    })\n    row.data = null\n}","import { isObject } from '@leafer/core'\n\nimport { ITextData, ITextDecorationType, ITextDrawData } from '@leafer-ui/interface'\nimport { ColorConvert } from '@leafer-ui/draw'\n\n\nexport function decorationText(drawData: ITextDrawData, style: ITextData): void {\n    let type: ITextDecorationType, offset = 0\n    const { fontSize, textDecoration } = style\n    drawData.decorationHeight = fontSize / 11\n    if (isObject(textDecoration)) {\n        type = textDecoration.type\n        if (textDecoration.color) drawData.decorationColor = ColorConvert.string(textDecoration.color)\n        if (textDecoration.offset) offset = Math.min(fontSize * 0.3, Math.max(textDecoration.offset, -fontSize * 0.15))\n    } else type = textDecoration\n    switch (type) {\n        case 'under':\n            drawData.decorationY = [fontSize * 0.15 + offset]\n            break\n        case 'delete':\n            drawData.decorationY = [-fontSize * 0.35]\n            break\n        case 'under-delete':\n            drawData.decorationY = [fontSize * 0.15 + offset, -fontSize * 0.35]\n    }\n}","import { IColorConvertModule } from '@leafer-ui/interface'\n\nimport { string } from './color'\n\n\nexport const ColorConvertModule = {\n    string\n} as IColorConvertModule","import { isString, isNumber, isUndefined } from '@leafer/core'\n\nimport { IColor } from '@leafer-ui/interface'\nimport { ColorConvert } from '@leafer-ui/draw'\n\n\nexport function string(color: IColor, opacity?: number): string {\n    if (!color) return '#000'\n    const doOpacity = isNumber(opacity) && opacity < 1\n    if (isString(color)) {\n        if (doOpacity && ColorConvert.object) color = ColorConvert.object(color)\n        else return color\n    }\n    let a = isUndefined(color.a) ? 1 : color.a\n    if (doOpacity) a *= opacity\n    const rgb = color.r + ',' + color.g + ',' + color.b\n    return a === 1 ? 'rgb(' + rgb + ')' : 'rgba(' + rgb + ',' + a + ')'\n}","// leaferui's partner, allow replace\nimport { Paint, PaintImage, PaintGradient, Effect, TextConvert, ColorConvert } from '@leafer-ui/draw'\n\nimport { PaintModule } from '@leafer-ui/paint'\nimport { PaintImageModule } from '@leafer-ui/image'\nimport { PaintGradientModule } from '@leafer-ui/gradient'\nimport { EffectModule } from '@leafer-ui/effect'\nimport '@leafer-ui/mask'\n\nimport { TextConvertModule } from '@leafer-ui/text'\nimport { ColorConvertModule } from '@leafer-ui/color'\n\n\nObject.assign(TextConvert, TextConvertModule)\nObject.assign(ColorConvert, ColorConvertModule)\n\nObject.assign(Paint, PaintModule)\nObject.assign(PaintImage, PaintImageModule)\nObject.assign(PaintGradient, PaintGradientModule)\n\nObject.assign(Effect, EffectModule)","export * from '@leafer-ui/interface'\n\nexport * from './core'\nexport * from '@leafer/partner'\n\nexport * from '@leafer-ui/core'\nexport * from '@leafer-ui/interaction-web'\nexport * from '@leafer-ui/partner'\n\nimport { ICreator } from '@leafer/interface'\nimport { useCanvas, Creator, LeaferCanvas } from './core'\nimport { HitCanvasManager } from '@leafer-ui/core'\nimport { Interaction } from '@leafer-ui/interaction-web'\n\n\nObject.assign(Creator, {\n    interaction: (target, canvas, selector, options?) => new Interaction(target, canvas, selector, options),\n    hitCanvas: (options?, manager?) => new LeaferCanvas(options, manager),\n    hitCanvasManager: () => new HitCanvasManager()\n} as ICreator)\n\nuseCanvas('canvas')"],"names":["PathNodeHandleType","Answer","emptyData","isUndefined","value","undefined","isNull","isString","isFinite","Number","isNumber","numberReg","isArray","Array","isObject","isEmptyData","JSON","stringify","DataHelper","default","t","defaultData","assign","merge","exclude","Object","keys","forEach","key","constructor","_a","_b","copyAttrs","from","include","clone","data","parse","toMap","list","map","i","len","length","stintSet","attrName","LeafData","__useNaturalRatio","__isLinePath","path","this","__usePathBox","__pathInputed","__blendMode","eraser","blendMode","leaf","__leaf","__get","name","__input","__getData","tag","inputValue","__setInput","__getInput","__removeInput","__getInputData","names","options","matrix","a","b","c","d","e","f","__localMatrix","__setMiddle","__middle","__getMiddle","__checkSingle","opacity","isBranch","__hasMultiPaint","__hasEraser","filter","__single","__removeNaturalSize","__naturalWidth","__naturalHeight","destroy","IncrementId","RUNTIME","LEAF","TASK","CNAVAS","IMAGE","types","create","typeName","I","tempA","tempB","tempTo","max","Math","tempFour","FourNumberHelper","zero","set","to","top","right","bottom","left","setTemp","toTempAB","change","get","num","maxValue","other","add","swapAndScale","scaleX","scaleY","round","pow","floor","PI","MathHelper","within","min","fourNumber","formatRotation","rotation","unsign","float","getGapRotation","addRotation","gap","oldRotation","r","abs","maxLength","sign","getScaleData","scale","size","originSize","scaleData","width","height","assignScale","x","y","getFloorScale","randInt","randColor","random","OneRadian","PI2","PI_2","getPointData","getBoundsData","getMatrixData","sin","cos","acos","sqrt","tempPoint","getWorld","skewX","skewY","MatrixHelper","defaultMatrix","defaultWorld","tempMatrix","copy","translate","translateInner","hasOrigin","pixelScale","pixelRatio","scaleOfOuter","origin","M","toInnerPoint","scaleOfInner","rotate","cosR","sinR","rotateOfOuter","rotateOfInner","skew","skewOfOuter","skewOfInner","multiply","child","multiplyParent","parent","abcdChanged","childScaleData","divide","tempInvert","divideParent","invert","s","toOuterPoint","inner","distance","outer","setLayout","layout","around","bcChanged","sx","sy","getLayout","firstSkewY","withScale","world","reset","atan2","PointHelper","defaultPoint","tempRadiusPoint","setRadius","radiusX","radiusY","point","copyFrom","halfPixel","move","scaleOf","P","rx","ry","tempToInnerOf","temp","tempToOuterOf","tempToInnerRadiusPointOf","toInnerRadiusPointOf","copyRadiusPoint","toInnerOf","toOuterOf","getCenter","getCenterX","x1","x2","getCenterY","y1","y2","getDistance","getDistanceFrom","getMinDistanceFrom","x3","y3","getAngle","getAtan2","getRotation","toOrigin","getRadianFrom","fromX","fromY","originX","originY","toX","toY","toOriginX","toOriginY","getDistancePoint","changeTo","fromTo","toNumberPoints","originPoints","points","p","push","isSame","Point","rotateOf","Matrix","setWith","dataWithScale","scaleWith","angle","invertWith","TwoPointBoundsHelper","tempPointBounds","setPoint","minX","minY","maxX","maxY","addPoint","addBounds","pb","addPointBounds","toBounds","setBounds","Direction4","Direction9","directionData","item","type","AroundHelper","toPoint","box","onlyBoxSize","content","onlyContentSize","getPoint","AlignHelper","align","TB","ceil","boundsRight","boundsBottom","tempBounds","BoundsHelper","bounds","copyAndSpread","spread","isShrink","side","four","B","scroll","scrollX","scrollY","getByMove","toOffsetOutBounds","offsetBounds","offsetX","offsetY","onlySize","getOuterOf","getFitMatrix","put","baseScale","getFitScale","isCoverMode","sw","sh","putScale","changeSize","getSpread","n","shrink","isPoint","addList","setListWithFn","setList","addMode","addListWithFn","boundsDataFn","first","setPoints","index","getPoints","hitRadiusPoint","pointMatrix","hitPoint","hit","otherMatrix","includes","getIntersectData","intersect","isEmpty","hasSize","Bounds","boundsList","boundsMatrix","getIntersect","AutoBounds","autoSize","getBoundsFrom","UnitConvertHelper","number","percentRefer","StringNumberMap","E","Platform","toURL","text","fileType","url","encodeURIComponent","image","hitCanvasSize","maxCacheSize","maxPatternSize","crossOrigin","isLarge","largeSize","isSuperLarge","getRealURL","prefix","suffix","startsWith","resize","view","xGap","yGap","clip","smooth","_filters","interlace","realWidth","realHeight","interlaceX","interlaceY","interlaceOffset","offset","canvas","createCanvas","ctx","getContext","globalAlpha","imageSmoothingEnabled","canUse","setTransform","drawImage","__closed","setPatternTransform","pattern","transform","paint","Debug","repeatMap","filterList","getNameList","excludeList","drawRepaint","color","fillWorld","replace","strokeWorld","drawBounds","_options","showHit","showBounds","w","__nowWorld","setWorld","__drawHitPath","fillStyle","fill","resetTransform","setStroke","stroke","log","messages","D","enable","every","some","console","tip","warn","showWarn","repeat","error","Error","debug","Run","currentId","currentName","idMap","nameMap","nameToIdMap","start","microsecond","id","R","performance","now","Date","end","time","duration","endOfName","check","Plugin","needPlugins","has","rs","need","setTimeout","Creator","editor","UICreator","register","UI","__tag","prototype","ui","EventCreator","nameList","Event","changeName","oldName","newName","constName","find","params","CanvasManager","manager","old","recycled","isSameSize","recycle","clearRecycled","clear","__decorate","decorators","target","desc","arguments","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__awaiter","thisArg","_arguments","generator","Promise","resolve","reject","fulfilled","step","next","rejected","result","done","then","apply","contextAttr","realName","property","context","SuppressedError","contextMethodNameList","contextMethod","_target","emptyArray","Canvas","globalCompositeOperation","dashPattern","setLineDash","getLineDash","__bindContext","method","bind","textBaseline","_c","_d","_e","_f","getTransform","save","restore","_x","_y","_angle","_path2d","_rule","fillRect","_width","_height","strokeRect","clearRect","dx","dy","dw","dh","beginPath","moveTo","lineTo","bezierCurveTo","_cp1x","_cp1y","_cp2x","_cp2y","quadraticCurveTo","_cpx","_cpy","closePath","arc","_radius","_startAngle","_endAngle","_anticlockwise","arcTo","_x1","_y1","_x2","_y2","ellipse","_radiusX","_radiusY","_rotation","rect","roundRect","createConicGradient","createLinearGradient","_x0","_y0","createPattern","_image","_repetition","createRadialGradient","_r0","_r1","fillText","_text","_maxWidth","measureText","strokeText","tempPixelBounds","tempPixelBounds2","minSize","canvasSizeAttrs","LeaferCanvasBase","pixelWidth","pixelHeight","pixelSnap","config","allowBackgroundColor","parentView","super","worldTransform","innerId","autoLayout","devicePixelRatio","init","__createContext","contextSettings","_filename","toBlob","_type","_quality","toDataURL","saveAs","safeResize","takeCanvas","unreal","getSameCanvas","copyWorld","updateViewSize","updateClientBounds","clearWorld","getClientBounds","update","clientBounds","startAutoLayout","_autoBounds","_listener","stopAutoLayout","setCursor","_cursor","parentMatrix","ignorePixelSnap","half","useWorldTransform","strokeWidth","childOptions","strokeStyle","setStrokeOptions","strokeCap","strokeJoin","dashOffset","miterLimit","saveBlendMode","savedBlendMode","restoreBlendMode","hitFill","_point","_fillRule","hitStroke","_strokeWidth","hitPixel","_radiusPoint","_offset","_scale","setWorldShadow","blur","shadowOffsetX","shadowOffsetY","shadowBlur","shadowColor","setWorldBlur","ceilPixel","setTempPixelBounds","setTempPixelBounds2","copyWorldToInner","fromWorld","toInnerBounds","copyWorldByReset","onlyResetTransform","useGrayscaleAlpha","alpha","pixel","imageData","getImageData","putImageData","useMask","maskCanvas","fromBounds","useEraser","eraserCanvas","clipWorld","clipUI","ruleData","windingRule","copyToPixelBounds","pixelBounds","useSameWorldTransform","useSameSmooth","clearBounds","updateRender","_bounds","unrealCanvas","PathHelper","creator","_pathString","_curveMode","convertToCanvasData","_old","CanvasCommandOnlyMap","N","X","G","F","O","U","PathCommandMap","m","L","l","H","h","V","v","C","S","Q","q","T","A","Z","z","PathCommandLengthMap","NeedConvertToCanvasCommandMap","NeedConvertToCurveCommandMap","PathNumberCommandMap","PathNumberCommandLengthMap","RectHelper","drawRoundRect","drawer","cornerRadius","hypot","BezierHelper","curve","close","aX","aY","bX","bY","cX","cY","c1X","c1Y","c2X","c2Y","baX","baY","ba","cb","radius","setPointBounds","setEndPoint","setStartPoint","BAx","BAy","CBx","CBy","startRadian","endRadian","lenBA","lenCB","totalRadian","anticlockwise","centerX","centerY","startAngle","endAngle","cx","cy","rotationRadian","rotationSin","rotationCos","parts","partRadian","partRadian4Sin","control","endCos","endSin","startCos","startSin","startX","startY","toTwoPointBounds","toTwoPointBoundsByQuadraticCurve","pointBounds","tList","t1","t2","sqrtV","z1","z2","o","getPointAndSet","getDerivative","fromV","v1","v2","toV","EllipseHelper","ellipticalArc","largeFlag","sweepFlag","curveMode","halfX","halfY","px","py","rxSquare","rySquare","pySquare","pxSquare","ellipseToCurve","PathCommandNodeHelper","toCommand","_nodes","toNode","_data","Command","PathConvert","current","dot","floatLength","count","command","lastCommand","str","j","pathString","needConvert","char","lastChar","convertCommand","pushData","toCanvasData","controlX","controlY","copyData","objectToCanvasData","strNum","tan","startPoint","PathCommandDataHelper","fourCorners","lastX","lastY","drawEllipse","drawArc","drawPoints","PathCreator","__path","clearPath","PathDrawer","drawPathByData","PathBounds","PathCorner","_cornerSmoothing","commandLen","secondX","secondY","pen","canvasPatch","FileHelper","alphaPixelTypes","upperCaseTypeMap","mineType","filename","split","isOpaqueImage","getExportOptions","quality","blob","toUpperCase","TaskItem","task","parallel","run","isComplete","runing","cancel","complete","isCancel","TaskProcessor","total","delayNumber","finishedIndex","parallelSuccessNumber","remain","percent","totalTime","runTime","running","empty","taskCallback","delay","timer","parallelList","pause","clearTimeout","resume","skip","stop","setParallelList","runParallelTasks","runTask","onComplete","onTask","nextTask","catch","onError","runParallelTask","fillParallelTask","onParallelError","pop","parallelWaitNumber","nextIndex","Resource","tasker","remove","loadImage","format","setImage","load","ImageManager","maxRecycled","recycledList","patternTasker","use","clearLevels","recyclePaint","force","hasAlphaPixel","isFormat","LeaferImage","completed","ready","waitComplete","setView","isSVG","onSuccess","thumbSize","loading","getLoadUrl","img","setThumbView","unload","stopEvent","isSuccess","odd","getFull","getCanvas","filters","cache","getPattern","_thumbSize","_view","getThumbSize","_lod","getMinLevel","getLevelData","_level","_checkUse","defineKey","descriptor","noConfigurable","configurable","enumerable","getDescriptor","object","createDescriptor","defaultValue","privateKey","decorateLeafAttr","descriptorFn","defineLeafAttr","attr","partDescriptor","defaultDescriptor","__getAttr","__setAttr","defineDataProcessor","dataType","positionType","checkFiniteNumber","__layout","matrixChanged","matrixChange","scrollType","__scrollWorld","autoLayoutType","__hasAutoLayout","flow","__local","createLocal","doBoundsType","scaleType","scaleChanged","scaleChange","rotationType","rotationChanged","rotationChange","boundsType","naturalBoundsType","__","boxChanged","boxChange","pathInputType","__pathForRender","pathType","affectStrokeBoundsType","useStroke","doStrokeType","__useStroke","strokeChanged","strokeChange","__useArrow","strokeType","affectRenderBoundsType","renderChanged","renderChange","surfaceType","surfaceChanged","surfaceChange","dimType","dim","bright","dimskip","opacityType","opacityChanged","opacityChange","mask","checkMask","visibleType","oldValue","visible","animationOut","__runAnimation","doVisible","animation","__hasMask","__updateMask","forceUpdate","sortType","waitParent","childrenSortChange","maskType","eraserType","__updateEraser","hitType","hitCanvasChanged","leafer","updateCursor","cursorType","dataProcessor","processor","_key","__DataProcessor","computedKey","setMethodName","charAt","slice","getSetMethodName","isBox","isBranchLeaf","naturalWidth","pathInputed","boxBounds","children","naturalHeight","__proto__","excludeNames","rewrite","rewriteAble","doRewrite","useModule","module","getOwnPropertyNames","writable","registerUI","registerUIEvent","LeafHelper","updateAllMatrix","checkAutoLayout","waitAutoLayout","updateMatrix","__updateLocalMatrix","__updateWorldMatrix","updateBounds","boundsChanged","__updateLocalBounds","__updateWorldBounds","updateAllWorldOpacity","__updateWorldOpacity","updateChange","stateStyleChanged","updateState","__updateChange","updateAllChange","worldHittable","hittable","draggable","editable","hitSelf","locked","copyCanvasByWorld","currentCanvas","fromCanvas","__worldFlipped","fullImageShadow","renderBounds","moveWorld","isInnerPoint","transition","local","localTransform","scrollWorldTransform","moveLocal","pointSnap","animate","zoomOfWorld","zoomOfLocal","getTempLocal","hasHighPosition","scaleResize","rotateOfWorld","rotateOfLocal","skewOfWorld","skewOfLocal","transformWorld","originPoint","getInnerOrigin","hasOffset","changedPoint","getFlipTransform","axis","getLocalOrigin","innerOrigin","getRelativeWorld","relative","drop","hasParent","animateMove","speed","requestRender","worldPoint","updateLayout","LeafBoundsHelper","worldBounds","__world","localBoxBounds","localStrokeBounds","localRenderBounds","maskLocalBoxBounds","__localBoxBounds","maskLocalStrokeBounds","maskLocalRenderBounds","excludeRenderBounds","hideBounds","findMask","BranchHelper","sort","zIndex","__tempNumber","pushAllChildBranch","branch","leafList","__childBranchNumber","pushAllParent","pushAllBranchStack","pushList","branchStack","updateBoundsByBranchStack","changeScaleX","changeScaleY","WaitHelper","wait","splice","localContent","worldContent","worldBox","worldStroke","LeafLayout","contentBounds","_contentBounds","strokeBounds","_strokeBounds","_renderBounds","localContentBounds","_localStrokeBounds","_localRenderBounds","worldContentBounds","worldBoxBounds","worldStrokeBounds","isApp","watcher","changed","layouter","root","__fullLayouting","zoomLayer","getBounds","getWorldBounds","getLocalBounds","getInnerBounds","getLayoutBounds","unscale","layoutBounds","getWorldPoint","getLocalPointByInner","uScaleX","uScaleY","getLayoutPoints","relativeLeaf","innerToWorld","shrinkContent","spreadStroke","renderSpread","spreadRenderCancel","spreadRender","shrinkContentCancel","spreadStrokeCancel","same","localBoxChanged","localBoxChange","strokeSpread","_scaleOrRotationChange","affectRotation","affectScaleOrRotation","childrenSortChanged","affectChildrenSort","bubbles","stopDefault","isStopDefault","event","stopNow","isStopNow","isStop","ChildEvent","ADD","REMOVE","CREATED","MOUNTED","UNMOUNTED","DESTROY","SCROLL","PropertyEvent","newValue","CHANGE","LEAFER_CHANGE","extraPropertyEventMap","ImageEvent","LOAD","LOADED","ERROR","BoundsEvent","checkHas","mode","WORLD","__hasWorldEvent","__hasLocalEvent","hasEvent","RESIZE","INNER","LOCAL","emitLocal","leaferIsReady","resized","emit","emitWorld","boundsEventMap","ResizeEvent","bigger","smaller","samePixelRatio","oldSize","isResizing","resizingKeys","WatchEvent","REQUEST","DATA","LayoutEvent","times","START","BEFORE","LAYOUT","AFTER","AGAIN","END","RenderEvent","renderOptions","CHILD_START","CHILD_END","RENDER","NEXT","LeaferEvent","BEFORE_READY","READY","AFTER_READY","VIEW_READY","VIEW_COMPLETED","STOP","RESTART","UPDATE_MODE","TRANSFORM","MOVE","SCALE","ROTATE","SKEW","leaferTransformAttrMap","Eventer","on","listener","capture","once","events","__getListenerMap","typeList","findIndex","off","__bubbleMap","__captureMap","on_","off_","captureOrBind","syncEventer","emitEvent","hasB","hasC","eventer","LeafEventer","destroyEventer","LeafDataProxy","leaferIsCreated","innerName","__realSetAttr","isLeafer","transformEventName","emitPropertyEvent","extraPropertyEvent","__proxyData","setProxyAttr","normalStyle","lockNormalStyle","getProxyAttr","LeafMatrix","LeafBounds","__onUpdateSize","__updatePath","__updateRenderPath","__updateBoxBounds","__updateLocalBoxBounds","__updateStrokeSpread","__updateStrokeBounds","__updateLocalStrokeBounds","strokeBoxSpread","__updateRenderSpread","__updateRenderBounds","__updateLocalRenderBounds","__hasMotionPath","__updateMotionPath","__updateAutoLayout","_secondLayout","__extraUpdate","__updateFlowLayout","__autoSide","__updateNaturalSize","LeafRender","__render","shape","__renderShape","cellList","__worldOpacity","topRendering","topList","__getNowWorld","dimOpacity","__renderEraser","tempCanvas","__draw","__drawShape","__clip","__drawRenderPath","BranchRender","__updateSortChildren","nowWorld","__useDim","__renderBranch","__renderMask","tempScaleData","Leaf","_value","__LayoutProcessor","created","worldRenderBounds","worldOpacity","__onlyHitMask","hitChildren","__ignoreHitWorld","__inLazyBounds","lazyBounds","__emitLifeEvent","forceRender","__level","resetCustom","toJSON","waitLeafer","nextRender","removeNextRender","__bindLeafer","leafs","_isTemp","_name","setAttr","getAttr","getComputedAttr","toString","toSVG","__SVG","toHTML","_attrName","_newValue","_condition","findTag","_tag","findOne","findId","_id","focus","_sync","addExtra","__updateContentBounds","_canvas","__cameraWorld","cameraWorld","getClampRenderScale","getRenderScaleData","scaleFixed","patternLocked","worldToLocal","worldToInner","localToWorld","getBoxPoint","getBoxPointByInner","getInnerPoint","_relative","_distance","getInnerPointByBox","getInnerPointByLocal","getLocalPoint","getPagePoint","getWorldPointByBox","getWorldPointByLocal","getWorldPointByPage","page","moveInner","skewOf","scaleOfWorld","worldOrigin","flip","_noResize","__scaleResize","_scaleX","_scaleY","resizeWidth","resizeHeight","_world","_hitRadius","__hitWorld","_forceHitFill","__hit","_local","__hitFill","_inner","__hitStroke","__hitPixel","__updateHitCanvas","__drawFast","_originCanvas","__drawPath","getMotionPathData","getMotionPoint","_motionDistance","getMotionTotal","_complete","_child","_index","dropTo","_bind","_captureOrBind","_capture","_event","changeAttr","fn","addAttr","helpValue","destroyed","Branch","affectSort","noIndex","childLayout","__emitChildEvent","addMany","__remove","removeAll","__preRemove","__realRemoveChild","indexOf","hitCanvasManager","LeafList","indexAt","addAt","unshift","reverse","itemCallback","LeafLevelList","_length","without","levels","levelMap","level","LeaferCanvas","style","setAbsolute","childIndex","beforeNode","insertBefore","appendChild","__createViewFrom","__createView","display","parentElement","pStyle","webkitUserSelect","userSelect","classList","syncDomFont","document","body","backgroundColor","pointerEvents","createElement","inputView","getElementById","HTMLCanvasElement","window","div","position","hasChildNodes","getBoundingClientRect","autoBounds","resizeListener","resizeObserver","ResizeObserver","entries","entry","checkAutoBounds","contentRect","observe","imitateResizeObserver","stopListenPixelRatio","listenPixelRatio","windowListener","addEventListener","emitResize","removeEventListener","parentSize","marginLeft","marginTop","disconnect","CanvasRenderingContext2D","Path2D","useCanvas","_canvasType","_power","canvasToDataURL","imageType","canvasToBolb","canvasSaveAs","download","el","href","click","removeChild","src","Image","setAttribute","onload","onerror","PointerEvent","DragEvent","preventDefault","stopImmediatePropagation","stopPropagation","conicGradientSupport","isMobile","render","requestAnimationFrame","userAgent","navigator","conicGradientRotate90","intWheelDeltaY","test","os","Watcher","childrenChanged","hasAdd","hasRemove","hasVisible","updatedList","usePartLayout","__updatedList","userConfig","totalTimes","__listenEvents","disabled","disable","__removeListenEvents","__onAttrChange","__onChildEvent","__pushChild","__loopChildren","__onRquestData","__eventIds","updateOneBounds","updateOneChange","LayoutBlockData","updatedBounds","beforeBounds","afterBounds","setBefore","setAfter","Layouter","__levelList","layouting","layoutOnce","layoutedBlocks","layoutAgain","waitAgain","partLayout","fullLayout","updateList","blocks","getBlocks","extraBlock","levelList","proxyZoom","jLen","addBlocks","createBlock","__onReceiveWatchData","Renderer","needFill","FPS","usePartRender","ceilPartPixel","maxFPS","frames","requestTime","__requestRender","requestLayout","checkRender","renderer","callback","totalBounds","emitRender","renderOnce","rendering","renderAgain","ignore","partRender","fullRender","updateBlocks","mergeBlocks","block","clipRender","realBounds","clipSpread","showRepaint","useCellRender","getCellList","addBlock","parentApp","frameTime","nowFPS","shift","reduce","__onResize","__onLayoutEnd","Picker","selector","getByPoint","hitRadius","through","ignoreHittable","findList","hitBranch","getBestMatchLeaf","bottomList","getPath","getHitablePath","throughPath","getThroughPath","allowNull","hitChild","proxy","syncList","hittablePath","pathList","nextPath","eachFind","hitMask","__clipAfterFill","topChildren","findMasks","Selector","picker","finder","backgrounder","getBy","condition","one","effectType","__useEffect","resizeType","__updateSize","zoomLayerType","tree","topOptions","TextConvert","ColorConvert","lastIndexOf","parseFloat","UnitConvert","PathArrow","Paint","PaintImage","PaintGradient","Effect","Filter","Export","State","setStyleName","Transition","hasTransparent","emptyPaint","originPaint","UIData","__strokeWidth","__getRealStrokeWidth","__maxStrokeWidth","__hasMultiStrokeStyle","__isFills","__isStrokes","innerShadow","__hasSurface","__autoWidth","__autoHeight","__autoSize","setVisible","_visible","setWidth","setHeight","setFill","__removePaint","_fill","__setPaint","_stroke","setPath","isStr","_path","setShadow","setArray","setInnerShadow","setFilter","__computePaint","compute","__needComputePaint","childStyle","strokeWidthFixed","removeInput","recycleImage","GroupData","BoxData","__boxStroke","__drawAfterFill","overflow","isOverflow","LeaferData","FrameData","LineData","RectData","EllipseData","PolygonData","StarData","PathData","PenData","fontWeightMap","thin","light","normal","medium","bold","black","TextData","setFontWeight","_fontWeight","setBoxStyle","__box","boxStyle","boxLayout","_boxStyle","textEditing","ImageData","setUrl","__setImageFill","_url","CanvasData","__isCanvas","UIBounds","boxSpread","strokeAlign","miterLimitAddWidth","storkeCapAddWidth","shadow","backgroundBlur","getShadowRenderSpread","shapeSpread","getInnerShadowSpread","renderShapeSpread","UIRender","__isTransparentFill","otherEffect","isTransformShadow","useFastShadow","drawFast","originCanvas","__complex","__fillAfterStroke","__isFastShadow","strokes","fills","worldCanvas","string","ignoreFill","__isAlphaPixelFill","ignoreStroke","__isAlphaPixelStroke","__drawContent","RectRender","UI_1","app","isFrame","isAutoWidth","autoWidth","isAutoHeight","autoHeight","__drawPathByBox","_transition","createProxyData","pathForRender","getPathString","lazy","cornerSmoothing","addArrows","__drawPathByData","ignoreCornerRadius","drawImagePlaceholder","_paint","placeholderColor","keyframe","killAnimate","_nextStyle","syncExport","json","registerData","setEditConfig","_config","setEditOuter","_toolName","setEditInner","_editorName","__animate","Group","__setBranch","childlessJSON","pick","_hitPoint","addAfter","after","addBefore","before","_children","_destroy","Leafer","Leafer_1","imageReady","viewReady","layoutLocked","cursorPoint","interaction","hoverData","lazySpeard","__controllers","__readyWait","__viewReadyWait","__viewCompletedWait","__nextRenderWait","__setLeafer","__bindApp","initType","__setApp","__checkAutoLayout","canvasManager","__startTimer","__initWait","onInit","waitInit","emitLeafer","unlockLayout","lockLayout","sync","cursor","updateLazyBounds","__doResize","__changeCanvasSize","__changeFill","__onCreated","__onReady","__onViewReady","grow","fixedWidth","fixedHeight","__onNextRender","viewCompleted","__checkViewCompleted","__onWatchData","waitReady","waitViewReady","waitViewCompleted","zoom","_zoomType","_optionsOrPadding","_scroll","getValidMove","moveX","moveY","_checkLimit","getValidScale","changeScale","getWorldPointByClient","clientPoint","updateClient","getLocal","getPagePointByClient","getClientPointByWorld","receiveEvent","runId","doDestory","Rect","group","Box","__updateRectRenderSpread","__updateRectBoxBounds","isScrollMode","childrenRenderBounds","__updateRectRenderBounds","__checkScroll","_isScrollMode","__updateRectChange","__renderRect","__renderGroup","hasScroller","scroller","Frame","Ellipse","innerRadius","open","Polygon","sides","Star","corners","Line","closed","MyImage","draw","Text","textDrawData","__textDrawData","__updateTextDrawData","lineHeight","letterSpacing","fontFamily","fontSize","fontWeight","italic","textCase","textOverflow","padding","__lineHeight","__letterSpacing","__baseLine","__font","getDrawData","__isPlacehold","placeholder","__padding","__textBoxBounds","font","exporting","Path","Pen","setStyle","pathElement","pathStyle","_cornerRadius","_points","_curve","_close","App","ground","sky","addLeafer","realCanvas","__getChildConfig","__listenChildEvents","__onChildRenderEnd","downKeyMap","Keyboard","isHoldSpaceKey","isHold","code","isHoldKeys","shortcutKeys","setDownCode","setUpCode","PointerButton","LEFT","RIGHT","MIDDLE","defaultLeft","buttons","middle","UIEvent","spaceKey","getInner","getPage","tempContent","tempDragBounds","DragBoundsHelper","limitMove","dragBounds","dragBoundsType","getDragBounds","axisMove","limitScaleOf","lockRatio","getValidScaleOf","isInnerMode","sideType","originLeftScale","originRightScale","originTopScale","originBottomScale","aScale","bScale","aSize","bSize","correctScaleX","correctScaleY","POINTER","BEFORE_DOWN","BEFORE_MOVE","BEFORE_UP","DOWN","UP","OVER","OUT","ENTER","LEAVE","TAP","DOUBLE_TAP","CLICK","DOUBLE_CLICK","LONG_PRESS","LONG_TAP","MENU","MENU_TAP","MyPointerEvent","tempMove","setData","localStart","worldTotal","checkLimit","getPageMove","assignMove","getInnerMove","getLocalMove","getPageTotal","getInnerTotal","getLocalTotal","getPageBounds","totalX","totalY","BEFORE_DRAG","DRAG","MyDragEvent","DropEvent","DROP","MoveEvent","DRAG_ANIMATE","PULL_DOWN","REACH_BOTTOM","TouchEvent","MyTouchEvent","RotateEvent","BEFORE_ROTATE","SwipeEvent","SWIPE","ZoomEvent","BEFORE_ZOOM","ZOOM","KeyEvent","HOLD","InteractionHelper","getDragEventData","lastPoint","getDropEventData","getSwipeDirection","getSwipeEventData","lastDragData","getBase","pointerUpButtons","button","altKey","ctrlKey","shiftKey","metaKey","pathHasEventType","filterPathByEventType","pathCanDrag","pathHasOutside","isOutside","emptyList","Dragger","dragDataList","setDragData","animateWait","dragEndReal","downData","dragData","canAnimate","canDragOut","getList","realDraggable","hover","hasProxyList","dragList","draggableList","dragging","dragHoverExclude","checkDrag","canDrag","moving","pointerCancel","canMove","isHoldRightKey","isMobileDragEmpty","moveType","dragStart","drag","getDraggableList","setDragStartPoints","realDraggableList","dragStartPoints","dragReal","isDragEnd","dragLimitAnimate","checkLimitMove","axisDrag","dragOverOrOut","dragOverPath","dragEnterOrLeave","dragEnterPath","dragEnd","checkDragEndAnimate","endDragData","dropList","swipe","autoMoveCancel","dragReset","pointer","swipeDistance","swipeData","dropData","_speed","_func","_off","stopAnimate","checkDragOut","autoMoveOnDragOut","allowTypes","emitAppChildren","excludePath","updateEventStyle","phase","wheel","zoomSpeed","moveSpeed","rotateSpeed","delta","snap","tapTime","longPressTime","transformTime","dragHover","dragDistance","touch","multiTouch","autoDistance","keyEvent","InteractionBase","dragger","transforming","transformer","moveMode","isHoldMiddleKey","isDragEmpty","canHover","mobile","dragEmpty","isRootPath","isTreePath","holdMiddleKey","holdRightKey","holdSpaceKey","tapCount","defaultPath","createTransformer","receive","pointerDown","useDefaultPath","updateDownData","checkPath","downTime","tapWait","longPressWait","waitRightTap","pointerMove","pointerMoveReal","pointerWaitCancel","updateHoverData","pointerHover","pointerUp","findPath","upData","touchLeave","tap","menuTap","menu","waitMenuTap","transformEnd","_list","keyDown","cancelHover","keyUp","pointerOverOrOut","pointerEnterOrLeave","overPath","enterPath","pointerType","hasLong","longTap","tapMore","waitTap","emitTap","useTime","hasDouble","tapWaitCancel","emitDoubleTap","tapTimer","isDrag","isPress","isHover","isFocus","focusData","stopDragAnimate","clientX","clientY","longPressWaitCancel","longPressTimer","longPressed","dragOut","shrinkCanvasBounds","Cursor","custom","HitCanvasManager","maxTotal","pixelList","getPixelType","__autoClear","hitCanvas","getPathType","clearImageType","__clearLeafList","clearPathType","__hitCanvas","getSelector","worldRadiusPoint","forceHitFill","isSmall","hitBox","hitScale","isHitPixelFill","isHitPixelStroke","isHitPixel","willReadFrequently","snapshot","__isHitPixel","needHitFillPath","needHitStrokePath","radiusWidth","hitWidth","call","rows","row","fillRule","isPointInPath","isPointInStroke","radiusPoint","PointerEventHelper","convert","base","pressure","tangentialPressure","tiltX","tiltY","twist","convertMouse","convertTouch","getTouch","touches","targetTouches","changedTouches","KeyEventHelper","Interaction","notPointer","useMultiTouch","notTouch","usePointer","notMouse","useTouch","viewEvents","pointerdown","onPointerDown","mousedown","onMouseDown","touchstart","onTouchStart","pointerleave","onPointerLeave","contextmenu","onContextMenu","onWheel","gesturestart","onGesturestart","gesturechange","onGesturechange","gestureend","onGestureend","windowEvents","pointermove","onPointerMove","pointerup","onPointerUp","pointercancel","onPointerCancel","mousemove","onMouseMove","mouseup","onMouseUp","touchmove","onTouchMove","touchend","onTouchEnd","touchcancel","onTouchCancel","keydown","onKeyDown","keyup","onKeyUp","onScroll","getTouches","preventDefaultPointer","preventDefaultWheel","preventWindowPointer","preventDefaultMenu","isLeave","onMouseCancel","multiTouchStart","touchTimer","multiTouchMove","multiTouchEnd","getKeepTouchList","identifier","getLocalTouchs","deltaX","deltaY","lastGestureScale","lastGestureRotation","eventBase","eachCursor","join","fillPathOrText","drawCenter","strokeWidthScale","drawStrokesStyle","strokeArrow","drawTextStroke","drawAlign","out","recycleMap","getLeafPaint","leafPaint","linearGradient","radialGradient","conicGradient","isTransparent","PaintModule","leafPaints","isAlphaPixel","maxChildStrokeWidth","paints","countImage","checkImage","isPlacehold","_renderOptions","decorationY","charData","decorationColor","decorationHeight","drawInside","drawOutside","isText","currentBounds","nowWorldShapeBounds","__nowWorldShapeBounds","fitMatrix","shapeBounds","worldClipBounds","spreadBounds","fitScaleX","fitScaleY","userMatrix","checkSizeAndCreateData","createData","onLoad","onLoadSuccess","onLoadError","ignoreRender","tempBox","tempImage","getGapValue","totalSize","scaleHelper","skewHelper","PaintImageModule","firstUse","attrValue","loadId","lod","placeholderDelay","getImageRenderScaleData","patternId","changeful","createPatternTask","_imageScaleX","_imageScaleY","u","onlyScale","input","patternTask","fixScale","getPatternFixScale","imageMatrix","imageCanvas","noRepeat","imageScaleX","imageScaleY","maxSize","imageSize","getPatternData","clipSize","sameBox","swapSize","stretchMode","clipScaleX","clipScaleY","clipMode","repeatMode","freeTransform","getGapData","fillOrFitMode","realFrom","realTo","applyStops","gradient","stops","addColorStop","stretch","rotate90","PaintGradientModule","offsetOutBounds","_ui","drawWorldShadow","outBounds","EffectModule","copyBounds","otherScale","getShadowTransform","_current","_shape","isInnerShaodw","_shadow","usedGrayscaleAlpha","maskEnd","maskMode","contentCanvas","maskOpacity","copyContent","usePixelMask","currentMask","childBlendMode","afterChar","symbolChar","cjkReg","RegExp","mapChar","letterMap","beforeMap","afterMap","symbolMap","breakMap","CharType","Letter","Single","Before","After","Symbol","Break","getCharType","TextRowHelper","trimRight","words","getTextCase","firstChar","toLowerCase","word","wordWidth","rowWidth","charWidth","startCharSize","charSize","charType","lastCharType","langBreak","afterBreak","paraStart","findMaxWidth","addChar","addWord","addRow","paraNumber","endCharSize","setMaxWidth","maxWidth","offsetText","drawData","TextConvertModule","String","autoSizeAlign","paraIndent","__isCharMode","wrap","textWrap","breakAll","paraEnd","createRows","textAlign","verticalAlign","padAutoText","countRows","__clipText","paraSpacing","starY","rowX","layoutWidth","layoutText","justifyLast","justify","justifyLetter","charX","remainingWidth","addWordWidth","addLetterWidth","indentWidth","wordChar","wordsLength","isLastWord","canJustify","textMode","toTextChar","toWordChar","rowData","toChar","layoutChar","charRight","ellipsisWidth","clipText","textDecoration","decorationText","ColorConvertModule","doOpacity","rgb","g"],"mappings":"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","x_google_ignoreList":[28]}